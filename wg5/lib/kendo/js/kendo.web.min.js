!function(f,define){define([],f)}(function(){return function($,undefined){function Class(){}function compilePart(part,stringPart){if(stringPart)return"'"+part.split("'").join("\\'").split('\\"').join('\\\\\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t")+"'";var first=part.charAt(0),rest=part.substring(1);return"="===first?"+("+rest+")+":":"===first?"+e("+rest+")+":";"+part+";o+="}function pad(number,digits,end){return number+="",digits=digits||2,end=digits-number.length,end?zeros[digits].substring(0,end)+number:number}function getShadows(element){var shadow=element.css(kendo.support.transitions.css+"box-shadow")||element.css("box-shadow"),radius=shadow?shadow.match(boxShadowRegExp)||[0,0,0,0,0]:[0,0,0,0,0],blur=math.max(+radius[3],+(radius[4]||0));return{left:-radius[1]+blur,right:+radius[1]+blur,bottom:+radius[2]+blur}}function wrap(element,autosize){var percentage,browser=support.browser,isRtl="rtl"==element.css("direction");if(element.parent().hasClass("k-animation-container")){var wrapper=element.parent(".k-animation-container"),wrapperStyle=wrapper[0].style;wrapper.is(":hidden")&&wrapper.show(),percentage=percentRegExp.test(wrapperStyle.width)||percentRegExp.test(wrapperStyle.height),percentage||wrapper.css({width:element.outerWidth(),height:element.outerHeight(),boxSizing:"content-box",mozBoxSizing:"content-box",webkitBoxSizing:"content-box"})}else{var shadows=getShadows(element),width=element[0].style.width,height=element[0].style.height,percentWidth=percentRegExp.test(width),percentHeight=percentRegExp.test(height);browser.opera&&(shadows.left=shadows.right=shadows.bottom=5),percentage=percentWidth||percentHeight,!percentWidth&&(!autosize||autosize&&width)&&(width=element.outerWidth()),!percentHeight&&(!autosize||autosize&&height)&&(height=element.outerHeight()),element.wrap($("<div/>").addClass("k-animation-container").css({width:width,height:height,marginLeft:shadows.left*(isRtl?1:-1),paddingLeft:shadows.left,paddingRight:shadows.right,paddingBottom:shadows.bottom})),percentage&&element.css({width:"100%",height:"100%",boxSizing:"border-box",mozBoxSizing:"border-box",webkitBoxSizing:"border-box"})}return browser.msie&&math.floor(browser.version)<=7&&(element.css({zoom:1}),element.children(".k-menu").width(element.width())),element.parent()}function deepExtend(destination){var i=1,length=arguments.length;for(i=1;i<length;i++)deepExtendOne(destination,arguments[i]);return destination}function deepExtendOne(destination,source){var property,propValue,propType,destProp,ObservableArray=kendo.data.ObservableArray,DataSource=kendo.data.DataSource,HierarchicalDataSource=kendo.data.HierarchicalDataSource;for(property in source)propValue=source[property],propType=typeof propValue,propType===OBJECT&&null!==propValue&&propValue.constructor!==Array&&propValue.constructor!==ObservableArray&&propValue.constructor!==DataSource&&propValue.constructor!==HierarchicalDataSource?propValue instanceof Date?destination[property]=new Date(propValue.getTime()):isFunction(propValue.clone)?destination[property]=propValue.clone():(destProp=destination[property],typeof destProp===OBJECT?destination[property]=destProp||{}:destination[property]={},deepExtendOne(destination[property],propValue)):propType!==UNDEFINED&&(destination[property]=propValue);return destination}function testRx(agent,rxs,dflt){for(var rx in rxs)if(rxs.hasOwnProperty(rx)&&rxs[rx].test(agent))return rx;return dflt!==undefined?dflt:agent}function toHyphens(str){return str.replace(/([a-z][A-Z])/g,function(g){return g.charAt(0)+"-"+g.charAt(1).toLowerCase()})}function toCamelCase(str){return str.replace(/\-(\w)/g,function(strMatch,g1){return g1.toUpperCase()})}function getComputedStyles(element,properties){var computedStyle,styles={};return document.defaultView&&document.defaultView.getComputedStyle?(computedStyle=document.defaultView.getComputedStyle(element,""),properties&&$.each(properties,function(idx,value){styles[value]=computedStyle.getPropertyValue(value)})):(computedStyle=element.currentStyle,properties&&$.each(properties,function(idx,value){styles[value]=computedStyle[toCamelCase(value)]})),kendo.size(styles)||(styles=computedStyle),styles}function size(obj){var key,result=0;for(key in obj)obj.hasOwnProperty(key)&&"toJSON"!=key&&result++;return result}function getOffset(element,type,positioned){type||(type="offset");var result=element[type]();support.mobileOS;return support.browser.msie&&(support.pointers||support.msPointers)&&!positioned&&(result.top-=window.pageYOffset-document.documentElement.scrollTop,result.left-=window.pageXOffset-document.documentElement.scrollLeft),result}function parseEffects(input){var effects={};return each("string"==typeof input?input.split(" "):input,function(idx){effects[idx]=this}),effects}function fx(element){return new kendo.effects.Element(element)}function prepareAnimationOptions(options,duration,reverse,complete){return typeof options===STRING&&(isFunction(duration)&&(complete=duration,duration=400,reverse=!1),isFunction(reverse)&&(complete=reverse,reverse=!1),typeof duration===BOOLEAN&&(reverse=duration,duration=400),options={effects:options,duration:duration,reverse:reverse,complete:complete}),extend({effects:{},duration:400,reverse:!1,init:noop,teardown:noop,hide:!1},options,{completeCallback:options.complete,complete:noop})}function animate(element,options,duration,reverse,complete){for(var instance,idx=0,length=element.length;idx<length;idx++)instance=$(element[idx]),instance.queue(function(){effects.promise(instance,prepareAnimationOptions(options,duration,reverse,complete))});return element}function toggleClass(element,classes,options,add){return classes&&(classes=classes.split(" "),each(classes,function(idx,value){element.toggleClass(value,add)})),element}function htmlEncode(value){return(""+value).replace(ampRegExp,"&amp;").replace(ltRegExp,"&lt;").replace(gtRegExp,"&gt;").replace(quoteRegExp,"&quot;").replace(aposRegExp,"&#39;")}function parseOption(element,option){var value;return 0===option.indexOf("data")&&(option=option.substring(4),option=option.charAt(0).toLowerCase()+option.substring(1)),option=option.replace(dashRegExp,"-$1"),value=element.getAttribute("data-"+kendo.ns+option),null===value?value=undefined:"null"===value?value=null:"true"===value?value=!0:"false"===value?value=!1:numberRegExp.test(value)?value=parseFloat(value):jsonRegExp.test(value)&&!jsonFormatRegExp.test(value)&&(value=new Function("return ("+value+")")()),value}function parseOptions(element,options){var option,value,result={};for(option in options)value=parseOption(element,option),value!==undefined&&(templateRegExp.test(option)&&(value=kendo.template($("#"+value).html())),result[option]=value);return result}function containmentComparer(a,b){return $.contains(a,b)?-1:1}function resizableWidget(){var widget=$(this);return $.inArray(widget.attr("data-role"),["slider","rangeslider"])>0||widget.is(":visible")}function focusable(element,isTabIndexNotNaN){var nodeName=element.nodeName.toLowerCase();return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return!$(element).parents().addBack().filter(function(){return"hidden"===$.css(this,"visibility")||$.expr.filters.hidden(this)}).length}function kendoJQuery(selector,context){return new kendoJQuery.fn.init(selector,context)}var Template,kendo=window.kendo=window.kendo||{cultures:{}},extend=$.extend,each=$.each,isArray=$.isArray,proxy=$.proxy,noop=$.noop,math=Math,JSON=window.JSON||{},support={},percentRegExp=/%/,formatRegExp=/\{(\d+)(:[^\}]+)?\}/g,boxShadowRegExp=/(\d+(?:\.?)\d*)px\s*(\d+(?:\.?)\d*)px\s*(\d+(?:\.?)\d*)px\s*(\d+)?/i,numberRegExp=/^(\+|-?)\d+(\.?)\d*$/,FUNCTION="function",STRING="string",NUMBER="number",OBJECT="object",NULL="null",BOOLEAN="boolean",UNDEFINED="undefined",getterCache={},setterCache={},slice=[].slice,globalize=window.Globalize;kendo.version="2014.1.528",Class.extend=function(proto){var member,fn,base=function(){},that=this,subclass=proto&&proto.init?proto.init:function(){that.apply(this,arguments)};base.prototype=that.prototype,fn=subclass.fn=subclass.prototype=new base;for(member in proto)null!=proto[member]&&proto[member].constructor===Object?fn[member]=extend(!0,{},base.prototype[member],proto[member]):fn[member]=proto[member];return fn.constructor=subclass,subclass.extend=that.extend,subclass},Class.prototype._initOptions=function(options){this.options=deepExtend({},this.options,options)};var isFunction=kendo.isFunction=function(fn){return"function"==typeof fn},preventDefault=function(){this._defaultPrevented=!0},isDefaultPrevented=function(){return this._defaultPrevented===!0},Observable=Class.extend({init:function(){this._events={}},bind:function(eventName,handlers,one){var idx,length,original,handler,events,that=this,eventNames=typeof eventName===STRING?[eventName]:eventName,handlersIsFunction=typeof handlers===FUNCTION;if(handlers===undefined){for(idx in eventName)that.bind(idx,eventName[idx]);return that}for(idx=0,length=eventNames.length;idx<length;idx++)eventName=eventNames[idx],handler=handlersIsFunction?handlers:handlers[eventName],handler&&(one&&(original=handler,handler=function(){that.unbind(eventName,handler),original.apply(that,arguments)},handler.original=original),events=that._events[eventName]=that._events[eventName]||[],events.push(handler));return that},one:function(eventNames,handlers){return this.bind(eventNames,handlers,!0)},first:function(eventName,handlers){var idx,length,handler,events,that=this,eventNames=typeof eventName===STRING?[eventName]:eventName,handlersIsFunction=typeof handlers===FUNCTION;for(idx=0,length=eventNames.length;idx<length;idx++)eventName=eventNames[idx],handler=handlersIsFunction?handlers:handlers[eventName],handler&&(events=that._events[eventName]=that._events[eventName]||[],events.unshift(handler));return that},trigger:function(eventName,e){var idx,length,that=this,events=that._events[eventName];if(events){for(e=e||{},e.sender=that,e._defaultPrevented=!1,e.preventDefault=preventDefault,e.isDefaultPrevented=isDefaultPrevented,events=events.slice(),idx=0,length=events.length;idx<length;idx++)events[idx].call(that,e);return e._defaultPrevented===!0}return!1},unbind:function(eventName,handler){var idx,that=this,events=that._events[eventName];if(eventName===undefined)that._events={};else if(events)if(handler)for(idx=events.length-1;idx>=0;idx--)events[idx]!==handler&&events[idx].original!==handler||events.splice(idx,1);else that._events[eventName]=[];return that}}),argumentNameRegExp=/^\w+/,encodeRegExp=/\$\{([^}]*)\}/g,escapedCurlyRegExp=/\\\}/g,curlyRegExp=/__CURLY__/g,escapedSharpRegExp=/\\#/g,sharpRegExp=/__SHARP__/g,zeros=["","0","00","000","0000"];Template={paramName:"data",useWithBlock:!0,render:function(template,data){var idx,length,html="";for(idx=0,length=data.length;idx<length;idx++)html+=template(data[idx]);return html},compile:function(template,options){var fn,parts,idx,settings=extend({},this,options),paramName=settings.paramName,argumentName=paramName.match(argumentNameRegExp)[0],useWithBlock=settings.useWithBlock,functionBody="var o,e=kendo.htmlEncode;";if(isFunction(template))return template;for(functionBody+=useWithBlock?"with("+paramName+"){":"",functionBody+="o=",parts=template.replace(escapedCurlyRegExp,"__CURLY__").replace(encodeRegExp,"#=e($1)#").replace(curlyRegExp,"}").replace(escapedSharpRegExp,"__SHARP__").split("#"),idx=0;idx<parts.length;idx++)functionBody+=compilePart(parts[idx],idx%2===0);functionBody+=useWithBlock?";}":";",functionBody+="return o;",functionBody=functionBody.replace(sharpRegExp,"#");try{return fn=new Function(argumentName,functionBody),fn._slotCount=Math.floor(parts.length/2),fn}catch(e){throw new Error(kendo.format("Invalid template:'{0}' Generated code:'{1}'",template,functionBody))}}},function(){function quote(string){return escapable.lastIndex=0,escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c===STRING?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,type,mind=gap,value=holder[key];if(value&&typeof value===OBJECT&&typeof value.toJSON===FUNCTION&&(value=value.toJSON(key)),typeof rep===FUNCTION&&(value=rep.call(holder,key,value)),type=typeof value,type===STRING)return quote(value);if(type===NUMBER)return isFinite(value)?String(value):NULL;if(type===BOOLEAN||type===NULL)return String(value);if(type===OBJECT){if(!value)return NULL;if(gap+=indent,partial=[],"[object Array]"===toString.apply(value)){for(length=value.length,i=0;i<length;i++)partial[i]=str(i,value)||NULL;return v=0===partial.length?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]",gap=mind,v}if(rep&&typeof rep===OBJECT)for(length=rep.length,i=0;i<length;i++)typeof rep[i]===STRING&&(k=rep[i],v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));else for(k in value)Object.hasOwnProperty.call(value,k)&&(v=str(k,value),v&&partial.push(quote(k)+(gap?": ":":")+v));return v=0===partial.length?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}",gap=mind,v}}var gap,indent,rep,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},toString={}.toString;typeof Date.prototype.toJSON!==FUNCTION&&(Date.prototype.toJSON=function(){var that=this;return isFinite(that.valueOf())?pad(that.getUTCFullYear(),4)+"-"+pad(that.getUTCMonth()+1)+"-"+pad(that.getUTCDate())+"T"+pad(that.getUTCHours())+":"+pad(that.getUTCMinutes())+":"+pad(that.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}),typeof JSON.stringify!==FUNCTION&&(JSON.stringify=function(value,replacer,space){var i;if(gap="",indent="",typeof space===NUMBER)for(i=0;i<space;i+=1)indent+=" ";else typeof space===STRING&&(indent=space);if(rep=replacer,replacer&&typeof replacer!==FUNCTION&&(typeof replacer!==OBJECT||typeof replacer.length!==NUMBER))throw new Error("JSON.stringify");return str("",{"":value})})}(),function(){function findCulture(culture){if(culture){if(culture.numberFormat)return culture;if(typeof culture===STRING){var cultures=kendo.cultures;return cultures[culture]||cultures[culture.split("-")[0]]||null}return null}return null}function getCulture(culture){return culture&&(culture=findCulture(culture)),culture||kendo.cultures.current}function expandNumberFormat(numberFormat){numberFormat.groupSizes=numberFormat.groupSize,numberFormat.percent.groupSizes=numberFormat.percent.groupSize,numberFormat.currency.groupSizes=numberFormat.currency.groupSize}function formatDate(date,format,culture){culture=getCulture(culture);var calendar=culture.calendars.standard,days=calendar.days,months=calendar.months;return format=calendar.patterns[format]||format,format.replace(dateFormatRegExp,function(match){var result;return"d"===match?result=date.getDate():"dd"===match?result=pad(date.getDate()):"ddd"===match?result=days.namesAbbr[date.getDay()]:"dddd"===match?result=days.names[date.getDay()]:"M"===match?result=date.getMonth()+1:"MM"===match?result=pad(date.getMonth()+1):"MMM"===match?result=months.namesAbbr[date.getMonth()]:"MMMM"===match?result=months.names[date.getMonth()]:"yy"===match?result=pad(date.getFullYear()%100):"yyyy"===match?result=pad(date.getFullYear(),4):"h"===match?result=date.getHours()%12||12:"hh"===match?result=pad(date.getHours()%12||12):"H"===match?result=date.getHours():"HH"===match?result=pad(date.getHours()):"m"===match?result=date.getMinutes():"mm"===match?result=pad(date.getMinutes()):"s"===match?result=date.getSeconds():"ss"===match?result=pad(date.getSeconds()):"f"===match?result=math.floor(date.getMilliseconds()/100):"ff"===match?(result=date.getMilliseconds(),result>99&&(result=math.floor(result/10)),result=pad(result)):"fff"===match?result=pad(date.getMilliseconds(),3):"tt"===match&&(result=date.getHours()<12?calendar.AM[0]:calendar.PM[0]),result!==undefined?result:match.slice(1,match.length-1)})}function formatNumber(number,format,culture){culture=getCulture(culture);var symbol,isCurrency,isPercent,customPrecision,formatAndPrecision,integer,fraction,integerLength,fractionLength,idx,length,ch,hasGroup,hasNegativeFormat,decimalIndex,sharpIndex,zeroIndex,hasZero,hasSharp,percentIndex,currencyIndex,startZeroIndex,end,numberFormat=culture.numberFormat,groupSize=numberFormat.groupSize[0],groupSeparator=numberFormat[COMMA],decimal=numberFormat[POINT],precision=numberFormat.decimals,pattern=numberFormat.pattern[0],literals=[],negative=number<0,replacement=EMPTY,value=EMPTY,start=-1;if(number===undefined)return EMPTY;if(!isFinite(number))return number;if(!format)return culture.name.length?number.toLocaleString():number.toString();if(formatAndPrecision=standardFormatRegExp.exec(format)){if(format=formatAndPrecision[1].toLowerCase(),isCurrency="c"===format,isPercent="p"===format,(isCurrency||isPercent)&&(numberFormat=isCurrency?numberFormat.currency:numberFormat.percent,groupSize=numberFormat.groupSize[0],groupSeparator=numberFormat[COMMA],decimal=numberFormat[POINT],precision=numberFormat.decimals,symbol=numberFormat.symbol,pattern=numberFormat.pattern[negative?0:1]),customPrecision=formatAndPrecision[2],customPrecision&&(precision=+customPrecision),"e"===format)return customPrecision?number.toExponential(precision):number.toExponential();if(isPercent&&(number*=100),number=round(number,precision),negative=number<0,number=number.split(POINT),integer=number[0],fraction=number[1],negative&&(integer=integer.substring(1)),value=integer,integerLength=integer.length,integerLength>=groupSize)for(value=EMPTY,idx=0;idx<integerLength;idx++)idx>0&&(integerLength-idx)%groupSize===0&&(value+=groupSeparator),value+=integer.charAt(idx);if(fraction&&(value+=decimal+fraction),"n"===format&&!negative)return value;for(number=EMPTY,idx=0,length=pattern.length;idx<length;idx++)ch=pattern.charAt(idx),number+="n"===ch?value:"$"===ch||"%"===ch?symbol:ch;return number}if(negative&&(number=-number),(format.indexOf("'")>-1||format.indexOf('"')>-1||format.indexOf("\\")>-1)&&(format=format.replace(literalRegExp,function(match){var quoteChar=match.charAt(0).replace("\\",""),literal=match.slice(1).replace(quoteChar,"");return literals.push(literal),PLACEHOLDER})),format=format.split(";"),negative&&format[1])format=format[1],hasNegativeFormat=!0;else if(0===number){if(format=format[2]||format[0],format.indexOf(SHARP)==-1&&format.indexOf(ZERO)==-1)return format}else format=format[0];if(percentIndex=format.indexOf("%"),currencyIndex=format.indexOf("$"),isPercent=percentIndex!=-1,isCurrency=currencyIndex!=-1,isPercent&&(number*=100),isCurrency&&"\\"===format[currencyIndex-1]&&(format=format.split("\\").join(""),isCurrency=!1),(isCurrency||isPercent)&&(numberFormat=isCurrency?numberFormat.currency:numberFormat.percent,groupSize=numberFormat.groupSize[0],groupSeparator=numberFormat[COMMA],decimal=numberFormat[POINT],precision=numberFormat.decimals,symbol=numberFormat.symbol),hasGroup=format.indexOf(COMMA)>-1,hasGroup&&(format=format.replace(commaRegExp,EMPTY)),decimalIndex=format.indexOf(POINT),length=format.length,decimalIndex!=-1?(fraction=number.toString().split("e"),fraction=fraction[1]?round(number,Math.abs(fraction[1])):fraction[0],fraction=fraction.split(POINT)[1]||EMPTY,zeroIndex=format.lastIndexOf(ZERO)-decimalIndex,sharpIndex=format.lastIndexOf(SHARP)-decimalIndex,hasZero=zeroIndex>-1,hasSharp=sharpIndex>-1,idx=fraction.length,hasZero||hasSharp||(format=format.substring(0,decimalIndex)+format.substring(decimalIndex+1),length=format.length,decimalIndex=-1,idx=0),hasZero&&zeroIndex>sharpIndex?idx=zeroIndex:sharpIndex>zeroIndex&&(hasSharp&&idx>sharpIndex?idx=sharpIndex:hasZero&&idx<zeroIndex&&(idx=zeroIndex)),idx>-1&&(number=round(number,idx))):number=round(number),sharpIndex=format.indexOf(SHARP),startZeroIndex=zeroIndex=format.indexOf(ZERO),start=sharpIndex==-1&&zeroIndex!=-1?zeroIndex:sharpIndex!=-1&&zeroIndex==-1?sharpIndex:sharpIndex>zeroIndex?zeroIndex:sharpIndex,sharpIndex=format.lastIndexOf(SHARP),zeroIndex=format.lastIndexOf(ZERO),end=sharpIndex==-1&&zeroIndex!=-1?zeroIndex:sharpIndex!=-1&&zeroIndex==-1?sharpIndex:sharpIndex>zeroIndex?sharpIndex:zeroIndex,start==length&&(end=start),start!=-1){if(value=number.toString().split(POINT),integer=value[0],fraction=value[1]||EMPTY,integerLength=integer.length,fractionLength=fraction.length,negative&&number*-1>=0&&(negative=!1),hasGroup)if(integerLength===groupSize&&integerLength<decimalIndex-startZeroIndex)integer=groupSeparator+integer;else if(integerLength>groupSize){for(value=EMPTY,idx=0;idx<integerLength;idx++)idx>0&&(integerLength-idx)%groupSize===0&&(value+=groupSeparator),value+=integer.charAt(idx);integer=value}for(number=format.substring(0,start),negative&&!hasNegativeFormat&&(number+="-"),idx=start;idx<length;idx++){if(ch=format.charAt(idx),decimalIndex==-1){if(end-idx<integerLength){number+=integer;break}}else if(zeroIndex!=-1&&zeroIndex<idx&&(replacement=EMPTY),decimalIndex-idx<=integerLength&&decimalIndex-idx>-1&&(number+=integer,idx=decimalIndex),decimalIndex===idx){number+=(fraction?decimal:EMPTY)+fraction,idx+=end-decimalIndex+1;continue}ch===ZERO?(number+=ch,replacement=ch):ch===SHARP&&(number+=replacement)}if(end>=start&&(number+=format.substring(end+1)),isCurrency||isPercent){for(value=EMPTY,idx=0,length=number.length;idx<length;idx++)ch=number.charAt(idx),value+="$"===ch||"%"===ch?symbol:ch;number=value}if(length=literals.length)for(idx=0;idx<length;idx++)number=number.replace(PLACEHOLDER,literals[idx])}return number}var dateFormatRegExp=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|HH|H|hh|h|mm|m|fff|ff|f|tt|ss|s|"[^"]*"|'[^']*'/g,standardFormatRegExp=/^(n|c|p|e)(\d*)$/i,literalRegExp=/(\\.)|(['][^']*[']?)|(["][^"]*["]?)/g,commaRegExp=/\,/g,EMPTY="",POINT=".",COMMA=",",SHARP="#",ZERO="0",PLACEHOLDER="??",EN="en-US",objectToString={}.toString;kendo.cultures["en-US"]={name:EN,numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSize:[3],percent:{pattern:["-n %","n %"],decimals:2,",":",",".":".",groupSize:[3],symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,",":",",".":".",groupSize:[3],symbol:"$"}},calendars:{standard:{days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December"],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},AM:["AM","am","AM"],PM:["PM","pm","PM"],patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",F:"dddd, MMMM dd, yyyy h:mm:ss tt",g:"M/d/yyyy h:mm tt",G:"M/d/yyyy h:mm:ss tt",m:"MMMM dd",M:"MMMM dd",s:"yyyy'-'MM'-'ddTHH':'mm':'ss",t:"h:mm tt",T:"h:mm:ss tt",u:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",y:"MMMM, yyyy",Y:"MMMM, yyyy"},"/":"/",":":":",firstDay:0,twoDigitYearMax:2029}}},kendo.culture=function(cultureName){var culture,cultures=kendo.cultures;return cultureName===undefined?cultures.current:(culture=findCulture(cultureName)||cultures[EN],culture.calendar=culture.calendars.standard,cultures.current=culture,globalize&&expandNumberFormat(culture.numberFormat),void 0)},kendo.findCulture=findCulture,kendo.getCulture=getCulture,kendo.culture(EN);var round=function(value,precision){return precision=precision||0,value=value.toString().split("e"),value=Math.round(+(value[0]+"e"+(value[1]?+value[1]+precision:precision))),value=value.toString().split("e"),value=+(value[0]+"e"+(value[1]?+value[1]-precision:-precision)),value.toFixed(precision)},toString=function(value,fmt,culture){if(fmt){if("[object Date]"===objectToString.call(value))return formatDate(value,fmt,culture);if(typeof value===NUMBER)return formatNumber(value,fmt,culture)}return value!==undefined?value:""};globalize&&(toString=function(value,format,culture){return $.isPlainObject(culture)&&(culture=culture.name),globalize.format(value,format,culture)}),kendo.format=function(fmt){var values=arguments;return fmt.replace(formatRegExp,function(match,index,placeholderFormat){var value=values[parseInt(index,10)+1];return toString(value,placeholderFormat?placeholderFormat.substring(1):"")})},kendo._extractFormat=function(format){return"{0:"===format.slice(0,3)&&(format=format.slice(3,format.length-1)),format},kendo._activeElement=function(){try{return document.activeElement}catch(e){return document.documentElement.activeElement}},kendo._round=round,kendo.toString=toString}(),function(){function outOfRange(value,start,end){return!(value>=start&&value<=end)}function designatorPredicate(designator){return designator.charAt(0)}function mapDesignators(designators){return $.map(designators,designatorPredicate)}function adjustDST(date,hours){hours||23!==date.getHours()||date.setHours(date.getHours()+2)}function lowerArray(data){for(var idx=0,length=data.length,array=[];idx<length;idx++)array[idx]=(data[idx]+"").toLowerCase();return array}function lowerLocalInfo(localInfo){var property,newLocalInfo={};for(property in localInfo)newLocalInfo[property]=lowerArray(localInfo[property]);return newLocalInfo}function parseExact(value,format,culture){if(!value)return null;var ch,count,length,pattern,pmHour,UTC,ISO8601,matches,amDesignators,pmDesignators,hoursOffset,minutesOffset,hasTime,match,lookAhead=function(match){for(var i=0;format[idx]===match;)i++,idx++;return i>0&&(idx-=1),i},getNumber=function(size){var rg=numberRegExp[size]||new RegExp("^\\d{1,"+size+"}"),match=value.substr(valueIdx,size).match(rg);return match?(match=match[0],valueIdx+=match.length,parseInt(match,10)):null},getIndexByName=function(names,lower){for(var name,nameLength,subValue,i=0,length=names.length;i<length;i++)if(name=names[i],nameLength=name.length,subValue=value.substr(valueIdx,nameLength),lower&&(subValue=subValue.toLowerCase()),subValue==name)return valueIdx+=nameLength,i+1;return null},checkLiteral=function(){var result=!1;return value.charAt(valueIdx)===format[idx]&&(valueIdx++,result=!0),result},calendar=culture.calendars.standard,year=null,month=null,day=null,hours=null,minutes=null,seconds=null,milliseconds=null,idx=0,valueIdx=0,literal=!1,date=new Date,twoDigitYearMax=calendar.twoDigitYearMax||2029,defaultYear=date.getFullYear();for(format||(format="d"),pattern=calendar.patterns[format],pattern&&(format=pattern),format=format.split(""),length=format.length;idx<length;idx++)if(ch=format[idx],literal)"'"===ch?literal=!1:checkLiteral();else if("d"===ch){if(count=lookAhead("d"),calendar._lowerDays||(calendar._lowerDays=lowerLocalInfo(calendar.days)),day=count<3?getNumber(2):getIndexByName(calendar._lowerDays[3==count?"namesAbbr":"names"],!0),null===day||outOfRange(day,1,31))return null}else if("M"===ch){if(count=lookAhead("M"),calendar._lowerMonths||(calendar._lowerMonths=lowerLocalInfo(calendar.months)),month=count<3?getNumber(2):getIndexByName(calendar._lowerMonths[3==count?"namesAbbr":"names"],!0),null===month||outOfRange(month,1,12))return null;month-=1}else if("y"===ch){if(count=lookAhead("y"),year=getNumber(count),null===year)return null;2==count&&("string"==typeof twoDigitYearMax&&(twoDigitYearMax=defaultYear+parseInt(twoDigitYearMax,10)),year=defaultYear-defaultYear%100+year,year>twoDigitYearMax&&(year-=100))}else if("h"===ch){if(lookAhead("h"),hours=getNumber(2),12==hours&&(hours=0),null===hours||outOfRange(hours,0,11))return null}else if("H"===ch){if(lookAhead("H"),hours=getNumber(2),null===hours||outOfRange(hours,0,23))return null}else if("m"===ch){if(lookAhead("m"),minutes=getNumber(2),null===minutes||outOfRange(minutes,0,59))return null}else if("s"===ch){if(lookAhead("s"),seconds=getNumber(2),null===seconds||outOfRange(seconds,0,59))return null}else if("f"===ch){if(count=lookAhead("f"),match=value.substr(valueIdx,count).match(numberRegExp[3]),milliseconds=getNumber(count),null!==milliseconds&&(match=match[0].length,match<3&&(milliseconds*=Math.pow(10,3-match)),count>3&&(milliseconds=parseInt(milliseconds.toString().substring(0,3),10))),null===milliseconds||outOfRange(milliseconds,0,999))return null}else if("t"===ch){if(count=lookAhead("t"),amDesignators=calendar.AM,pmDesignators=calendar.PM,1===count&&(amDesignators=mapDesignators(amDesignators),pmDesignators=mapDesignators(pmDesignators)),pmHour=getIndexByName(pmDesignators),!pmHour&&!getIndexByName(amDesignators))return null}else if("z"===ch){if(UTC=!0,count=lookAhead("z"),"Z"===value.substr(valueIdx,1)){if(!ISO8601)return null;checkLiteral();continue}if(matches=value.substr(valueIdx,6).match(count>2?longTimeZoneRegExp:shortTimeZoneRegExp),!matches)return null;if(matches=matches[0],valueIdx=matches.length,matches=matches.split(":"),hoursOffset=parseInt(matches[0],10),outOfRange(hoursOffset,-12,13))return null;if(count>2&&(minutesOffset=parseInt(matches[1],10),isNaN(minutesOffset)||outOfRange(minutesOffset,0,59)))return null}else if("T"===ch)ISO8601=checkLiteral();else if("'"===ch)literal=!0,checkLiteral();else if(!checkLiteral())return null;return hasTime=null!==hours||null!==minutes||seconds||null,null===year&&null===month&&null===day&&hasTime?(year=defaultYear,month=date.getMonth(),day=date.getDate()):(null===year&&(year=defaultYear),null===day&&(day=1)),pmHour&&hours<12&&(hours+=12),UTC?(hoursOffset&&(hours+=-hoursOffset),minutesOffset&&(minutes+=-minutesOffset),value=new Date(Date.UTC(year,month,day,hours,minutes,seconds,milliseconds))):(value=new Date(year,month,day,hours,minutes,seconds,milliseconds),adjustDST(value,hours)),year<100&&value.setFullYear(year),value.getDate()!==day&&UTC===undefined?null:value}function parseMicrosoftFormatOffset(offset){var sign="-"===offset.substr(0,1)?-1:1;return offset=offset.substring(1),offset=60*parseInt(offset.substr(0,2),10)+parseInt(offset.substring(2),10),sign*offset}var nonBreakingSpaceRegExp=/\u00A0/g,exponentRegExp=/[eE][\-+]?[0-9]+/,shortTimeZoneRegExp=/[+|\-]\d{1,2}/,longTimeZoneRegExp=/[+|\-]\d{1,2}:\d{2}/,dateRegExp=/^\/Date\((.*?)\)\/$/,offsetRegExp=/[+-]\d*/,formatsSequence=["G","g","d","F","D","y","m","T","t"],numberRegExp={2:/^\d{1,2}/,3:/^\d{1,3}/,4:/^\d{4}/},objectToString={}.toString;kendo.parseDate=function(value,formats,culture){if("[object Date]"===objectToString.call(value))return value;var length,patterns,tzoffset,idx=0,date=null;if(value&&0===value.indexOf("/D")&&(date=dateRegExp.exec(value)))return date=date[1],tzoffset=offsetRegExp.exec(date.substring(1)),date=new Date(parseInt(date,10)),tzoffset&&(tzoffset=parseMicrosoftFormatOffset(tzoffset[0]),date=kendo.timezone.apply(date,0),date=kendo.timezone.convert(date,0,-1*tzoffset)),date;if(culture=kendo.getCulture(culture),!formats){for(formats=[],patterns=culture.calendar.patterns,length=formatsSequence.length;idx<length;idx++)formats[idx]=patterns[formatsSequence[idx]];idx=0,formats=["yyyy/MM/dd HH:mm:ss","yyyy/MM/dd HH:mm","yyyy/MM/dd","ddd MMM dd yyyy HH:mm:ss","yyyy-MM-ddTHH:mm:ss.fffffffzzz","yyyy-MM-ddTHH:mm:ss.fffzzz","yyyy-MM-ddTHH:mm:sszzz","yyyy-MM-ddTHH:mm:ss.fffffff","yyyy-MM-ddTHH:mm:ss.fff","yyyy-MM-ddTHH:mmzzz","yyyy-MM-ddTHH:mmzz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mm","yyyy-MM-dd HH:mm:ss","yyyy-MM-dd HH:mm","yyyy-MM-dd","HH:mm:ss","HH:mm"].concat(formats)}for(formats=isArray(formats)?formats:[formats],length=formats.length;idx<length;idx++)if(date=parseExact(value,formats[idx],culture))return date;return date},kendo.parseInt=function(value,culture){var result=kendo.parseFloat(value,culture);return result&&(result=0|result),result},kendo.parseFloat=function(value,culture,format){if(!value&&0!==value)return null;if(typeof value===NUMBER)return value;value=value.toString(),culture=kendo.getCulture(culture);var parts,isPercent,number=culture.numberFormat,percent=number.percent,currency=number.currency,symbol=currency.symbol,percentSymbol=percent.symbol,negative=value.indexOf("-");
return exponentRegExp.test(value)?(value=parseFloat(value.replace(number["."],".")),isNaN(value)&&(value=null),value):negative>0?null:(negative=negative>-1,value.indexOf(symbol)>-1||format&&format.toLowerCase().indexOf("c")>-1?(number=currency,parts=number.pattern[0].replace("$",symbol).split("n"),value.indexOf(parts[0])>-1&&value.indexOf(parts[1])>-1&&(value=value.replace(parts[0],"").replace(parts[1],""),negative=!0)):value.indexOf(percentSymbol)>-1&&(isPercent=!0,number=percent,symbol=percentSymbol),value=value.replace("-","").replace(symbol,"").replace(nonBreakingSpaceRegExp," ").split(number[","].replace(nonBreakingSpaceRegExp," ")).join("").replace(number["."],"."),value=parseFloat(value),isNaN(value)?value=null:negative&&(value*=-1),value&&isPercent&&(value/=100),value)},globalize&&(kendo.parseDate=function(value,format,culture){return"[object Date]"===objectToString.call(value)?value:globalize.parseDate(value,format,culture)},kendo.parseFloat=function(value,culture){return typeof value===NUMBER?value:value===undefined||null===value?null:($.isPlainObject(culture)&&(culture=culture.name),value=globalize.parseFloat(value,culture),isNaN(value)?null:value)})}(),function(){support.scrollbar=function(){var result,div=document.createElement("div");return div.style.cssText="overflow:scroll;overflow-x:hidden;zoom:1;clear:both;display:block",div.innerHTML="&nbsp;",document.body.appendChild(div),result=div.offsetWidth-div.scrollWidth,document.body.removeChild(div),result},support.isRtl=function(element){return $(element).closest(".k-rtl").length>0};var table=document.createElement("table");try{table.innerHTML="<tr><td></td></tr>",support.tbodyInnerHtml=!0}catch(e){support.tbodyInnerHtml=!1}support.touch="ontouchstart"in window,support.msPointers=window.MSPointerEvent,support.pointers=window.PointerEvent;var transitions=support.transitions=!1,transforms=support.transforms=!1,elementProto="HTMLElement"in window?HTMLElement.prototype:[];support.hasHW3D="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix||"MozPerspective"in document.documentElement.style||"msPerspective"in document.documentElement.style,each(["Moz","webkit","O","ms"],function(){var prefix=this.toString(),hasTransitions=typeof table.style[prefix+"Transition"]===STRING;if(hasTransitions||typeof table.style[prefix+"Transform"]===STRING){var lowPrefix=prefix.toLowerCase();return transforms={css:"ms"!=lowPrefix?"-"+lowPrefix+"-":"",prefix:prefix,event:"o"===lowPrefix||"webkit"===lowPrefix?lowPrefix:""},hasTransitions&&(transitions=transforms,transitions.event=transitions.event?transitions.event+"TransitionEnd":"transitionend"),!1}}),table=null,support.transforms=transforms,support.transitions=transitions,support.devicePixelRatio=window.devicePixelRatio===undefined?1:window.devicePixelRatio;try{support.screenWidth=window.outerWidth||window.screen?window.screen.availWidth:window.innerWidth,support.screenHeight=window.outerHeight||window.screen?window.screen.availHeight:window.innerHeight}catch(e){support.screenWidth=window.screen.availWidth,support.screenHeight=window.screen.availHeight}support.detectOS=function(ua){var minorVersion,os=!1,match=[],notAndroidPhone=!/mobile safari/i.test(ua),agentRxs={fire:/(Silk)\/(\d+)\.(\d+(\.\d+)?)/,android:/(Android|Android.*(?:Opera|Firefox).*?\/)\s*(\d+)\.(\d+(\.\d+)?)/,iphone:/(iPhone|iPod).*OS\s+(\d+)[\._]([\d\._]+)/,ipad:/(iPad).*OS\s+(\d+)[\._]([\d_]+)/,meego:/(MeeGo).+NokiaBrowser\/(\d+)\.([\d\._]+)/,webos:/(webOS)\/(\d+)\.(\d+(\.\d+)?)/,blackberry:/(BlackBerry|BB10).*?Version\/(\d+)\.(\d+(\.\d+)?)/,playbook:/(PlayBook).*?Tablet\s*OS\s*(\d+)\.(\d+(\.\d+)?)/,wp:/(Windows Phone(?: OS)?)\s(\d+)\.(\d+(\.\d+)?)/,windows:/(MSIE)\s+(\d+)\.(\d+(\.\d+)?)/,tizen:/(tizen).*?Version\/(\d+)\.(\d+(\.\d+)?)/i,sailfish:/(sailfish).*rv:(\d+)\.(\d+(\.\d+)?).*firefox/i,ffos:/(Mobile).*rv:(\d+)\.(\d+(\.\d+)?).*Firefox/},osRxs={ios:/^i(phone|pad|pod)$/i,android:/^android|fire$/i,blackberry:/^blackberry|playbook/i,windows:/windows/,wp:/wp/,flat:/sailfish|ffos|tizen/i,meego:/meego/},formFactorRxs={tablet:/playbook|ipad|fire/i},browserRxs={omini:/Opera\sMini/i,omobile:/Opera\sMobi/i,firefox:/Firefox|Fennec/i,mobilesafari:/version\/.*safari/i,chrome:/chrome|crios/i,webkit:/webkit/i,ie:/MSIE|Windows\sPhone/i};for(var agent in agentRxs)if(agentRxs.hasOwnProperty(agent)&&(match=ua.match(agentRxs[agent]))){if("windows"==agent&&"plugins"in navigator)return!1;os={},os.device=agent,os.tablet=testRx(agent,formFactorRxs,!1),os.browser=testRx(ua,browserRxs,"default"),os.name=testRx(agent,osRxs),os[os.name]=!0,os.majorVersion=match[2],os.minorVersion=match[3].replace("_","."),minorVersion=os.minorVersion.replace(".","").substr(0,2),os.flatVersion=os.majorVersion+minorVersion+new Array(3-(minorVersion.length<3?minorVersion.length:2)).join("0"),os.cordova=typeof window.PhoneGap!==UNDEFINED||typeof window.cordova!==UNDEFINED,os.appMode=window.navigator.standalone||/file|local|wmapp/.test(window.location.protocol)||os.cordova,os.android&&(support.devicePixelRatio<1.5&&os.flatVersion<400||notAndroidPhone)&&(support.screenWidth>800||support.screenHeight>800)&&(os.tablet=agent);break}return os};var mobileOS=support.mobileOS=support.detectOS(navigator.userAgent);support.wpDevicePixelRatio=mobileOS.wp?screen.width/320:0,support.kineticScrollNeeded=mobileOS&&(support.touch||support.msPointers||support.pointers),support.hasNativeScrolling=!1,(mobileOS.ios||mobileOS.android&&mobileOS.majorVersion>2||mobileOS.wp)&&(support.hasNativeScrolling=mobileOS),support.mouseAndTouchPresent=support.touch&&!(support.mobileOS.ios||support.mobileOS.android),support.detectBrowser=function(ua){var browser=!1,match=[],browserRxs={webkit:/(chrome)[ \/]([\w.]+)/i,safari:/(webkit)[ \/]([\w.]+)/i,opera:/(opera)(?:.*version|)[ \/]([\w.]+)/i,msie:/(msie\s|trident.*? rv:)([\w.]+)/i,mozilla:/(mozilla)(?:.*? rv:([\w.]+)|)/i};for(var agent in browserRxs)if(browserRxs.hasOwnProperty(agent)&&(match=ua.match(browserRxs[agent]))){browser={},browser[agent]=!0,browser[match[1].toLowerCase()]=!0,browser.version=parseInt(document.documentMode||match[2],10);break}return browser},support.browser=support.detectBrowser(navigator.userAgent),support.zoomLevel=function(){try{return support.touch?document.documentElement.clientWidth/window.innerWidth:support.browser.msie&&support.browser.version>=10?(top||window).document.documentElement.offsetWidth/(top||window).innerWidth:1}catch(e){return 1}},support.cssBorderSpacing="undefined"!=typeof document.documentElement.style.borderSpacing&&!(support.browser.msie&&support.browser.version<8),function(browser){var cssClass="",docElement=$(document.documentElement),majorVersion=parseInt(browser.version,10);browser.msie?cssClass="ie":browser.mozilla?cssClass="ff":browser.safari?cssClass="safari":browser.webkit?cssClass="webkit":browser.opera&&(cssClass="opera"),cssClass&&(cssClass="k-"+cssClass+" k-"+cssClass+majorVersion),support.mobileOS&&(cssClass+=" k-mobile"),docElement.addClass(cssClass)}(support.browser),support.eventCapture=document.documentElement.addEventListener;var input=document.createElement("input");support.placeholder="placeholder"in input,support.propertyChangeEvent="onpropertychange"in input,support.input=function(){for(var type,types=["number","date","time","month","week","datetime","datetime-local"],length=types.length,value="test",result={},idx=0;idx<length;idx++)type=types[idx],input.setAttribute("type",type),input.value=value,result[type.replace("-","")]="text"!==input.type&&input.value!==value;return result}(),input.style.cssText="float:left;",support.cssFloat=!!input.style.cssFloat,input=null,support.stableSort=function(){for(var threshold=513,sorted=[{index:0,field:"b"}],i=1;i<threshold;i++)sorted.push({index:i,field:"a"});return sorted.sort(function(a,b){return a.field>b.field?1:a.field<b.field?-1:0}),1===sorted[0].index}(),support.matchesSelector=elementProto.webkitMatchesSelector||elementProto.mozMatchesSelector||elementProto.msMatchesSelector||elementProto.oMatchesSelector||elementProto.matchesSelector||elementProto.matches||function(selector){for(var nodeList=document.querySelectorAll?(this.parentNode||document).querySelectorAll(selector)||[]:$(selector),i=nodeList.length;i--;)if(nodeList[i]==this)return!0;return!1},support.pushState=window.history&&window.history.pushState;var documentMode=document.documentMode;support.hashChange="onhashchange"in window&&!(support.browser.msie&&(!documentMode||documentMode<=8))}();var directions={left:{reverse:"right"},right:{reverse:"left"},down:{reverse:"up"},up:{reverse:"down"},top:{reverse:"bottom"},bottom:{reverse:"top"},"in":{reverse:"out"},out:{reverse:"in"}},effects={};$.extend(effects,{enabled:!0,Element:function(element){this.element=$(element)},promise:function(element,options){element.is(":visible")||element.css({display:element.data("olddisplay")||"block"}).css("display"),options.hide&&element.data("olddisplay",element.css("display")).hide(),options.init&&options.init(),options.completeCallback&&options.completeCallback(element),element.dequeue()},disable:function(){this.enabled=!1,this.promise=this.promiseShim},enable:function(){this.enabled=!0,this.promise=this.animatedPromise}}),effects.promiseShim=effects.promise,"kendoAnimate"in $.fn||extend($.fn,{kendoStop:function(clearQueue,gotoEnd){return this.stop(clearQueue,gotoEnd)},kendoAnimate:function(options,duration,reverse,complete){return animate(this,options,duration,reverse,complete)},kendoAddClass:function(classes,options){return kendo.toggleClass(this,classes,options,!0)},kendoRemoveClass:function(classes,options){return kendo.toggleClass(this,classes,options,!1)},kendoToggleClass:function(classes,options,toggle){return kendo.toggleClass(this,classes,options,toggle)}});var ampRegExp=/&/g,ltRegExp=/</g,quoteRegExp=/"/g,aposRegExp=/'/g,gtRegExp=/>/g,eventTarget=function(e){return e.target};support.touch&&(eventTarget=function(e){var touches="originalEvent"in e?e.originalEvent.changedTouches:"changedTouches"in e?e.changedTouches:null;return touches?document.elementFromPoint(touches[0].clientX,touches[0].clientY):e.target},each(["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap"],function(m,value){$.fn[value]=function(callback){return this.bind(value,callback)}})),support.touch?support.mobileOS?(support.mousedown="touchstart",support.mouseup="touchend",support.mousemove="touchmove",support.mousecancel="touchcancel",support.click="touchend",support.resize="orientationchange"):(support.mousedown="mousedown touchstart",support.mouseup="mouseup touchend",support.mousemove="mousemove touchmove",support.mousecancel="mouseleave touchcancel",support.click="click",support.resize="resize"):support.pointers?(support.mousemove="pointermove",support.mousedown="pointerdown",support.mouseup="pointerup",support.mousecancel="pointercancel",support.click="pointerup",support.resize="orientationchange resize"):support.msPointers?(support.mousemove="MSPointerMove",support.mousedown="MSPointerDown",support.mouseup="MSPointerUp",support.mousecancel="MSPointerCancel",support.click="MSPointerUp",support.resize="orientationchange resize"):(support.mousemove="mousemove",support.mousedown="mousedown",support.mouseup="mouseup",support.mousecancel="mouseleave",support.click="click",support.resize="resize");var wrapExpression=function(members,paramName){var index,idx,length,member,result=paramName||"d",count=1;for(idx=0,length=members.length;idx<length;idx++)member=members[idx],""!==member&&(index=member.indexOf("["),0!==index&&(index==-1?member="."+member:(count++,member="."+member.substring(0,index)+" || {})"+member.substring(index))),count++,result+=member+(idx<length-1?" || {})":")"));return new Array(count).join("(")+result},localUrlRe=/^([a-z]+:)?\/\//i;extend(kendo,{ui:kendo.ui||{},fx:kendo.fx||fx,effects:kendo.effects||effects,mobile:kendo.mobile||{},data:kendo.data||{},dataviz:kendo.dataviz||{ui:{roles:{}}},keys:{INSERT:45,DELETE:46,BACKSPACE:8,TAB:9,ENTER:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,END:35,HOME:36,SPACEBAR:32,PAGEUP:33,PAGEDOWN:34,F2:113,F10:121,F12:123,NUMPAD_PLUS:107,NUMPAD_MINUS:109,NUMPAD_DOT:110},support:kendo.support||support,animate:kendo.animate||animate,ns:"",attr:function(value){return"data-"+kendo.ns+value},getShadows:getShadows,wrap:wrap,deepExtend:deepExtend,getComputedStyles:getComputedStyles,size:size,toCamelCase:toCamelCase,toHyphens:toHyphens,getOffset:kendo.getOffset||getOffset,parseEffects:kendo.parseEffects||parseEffects,toggleClass:kendo.toggleClass||toggleClass,directions:kendo.directions||directions,Observable:Observable,Class:Class,Template:Template,template:proxy(Template.compile,Template),render:proxy(Template.render,Template),stringify:proxy(JSON.stringify,JSON),eventTarget:eventTarget,htmlEncode:htmlEncode,isLocalUrl:function(url){return url&&!localUrlRe.test(url)},expr:function(expression,safe,paramName){return expression=expression||"",typeof safe==STRING&&(paramName=safe,safe=!1),paramName=paramName||"d",expression&&"["!==expression.charAt(0)&&(expression="."+expression),expression=safe?wrapExpression(expression.split("."),paramName):paramName+expression},getter:function(expression,safe){return getterCache[expression]=getterCache[expression]||new Function("d","return "+kendo.expr(expression,safe))},setter:function(expression){return setterCache[expression]=setterCache[expression]||new Function("d,value",kendo.expr(expression)+"=value")},accessor:function(expression){return{get:kendo.getter(expression),set:kendo.setter(expression)}},guid:function(){var i,random,id="";for(i=0;i<32;i++)random=16*math.random()|0,8!=i&&12!=i&&16!=i&&20!=i||(id+="-"),id+=(12==i?4:16==i?3&random|8:random).toString(16);return id},roleSelector:function(role){return role.replace(/(\S+)/g,"["+kendo.attr("role")+"=$1],").slice(0,-1)},triggeredByInput:function(e){return/^(label|input|textarea|select)$/i.test(e.target.tagName)},logToConsole:function(message){var console=window.console;"undefined"!=typeof console&&console.log&&console.log(message)}});var Widget=Observable.extend({init:function(element,options){var that=this;that.element=kendo.jQuery(element).handler(that),Observable.fn.init.call(that),options=that.options=extend(!0,{},that.options,options),that.element.attr(kendo.attr("role"))||that.element.attr(kendo.attr("role"),(options.name||"").toLowerCase()),that.element.data("kendo"+options.prefix+options.name,that),that.bind(that.events,options)},events:[],options:{prefix:""},_hasBindingTarget:function(){return!!this.element[0].kendoBindingTarget},_tabindex:function(target){target=target||this.wrapper;var element=this.element,TABINDEX="tabindex",tabindex=target.attr(TABINDEX)||element.attr(TABINDEX);element.removeAttr(TABINDEX),target.attr(TABINDEX,isNaN(tabindex)?0:tabindex)},setOptions:function(options){this._setEvents(options),$.extend(this.options,options)},_setEvents:function(options){for(var e,that=this,idx=0,length=that.events.length;idx<length;idx++)e=that.events[idx],that.options[e]&&options[e]&&that.unbind(e,that.options[e]);that.bind(that.events,options)},resize:function(force){var size=this.getSize(),currentSize=this._size;!force&&currentSize&&size.width===currentSize.width&&size.height===currentSize.height||(this._resize(size),this.trigger("resize",size),this._size=size)},getSize:function(){return kendo.dimensions(this.element)},size:function(size){return size?void this.setSize(size):this.getSize()},setSize:$.noop,_resize:$.noop,destroy:function(){var that=this;that.element.removeData("kendo"+that.options.prefix+that.options.name),that.element.removeData("handler"),that.unbind()}});kendo.dimensions=function(element,dimensions){var domElement=element[0];return dimensions&&element.css(dimensions),{width:domElement.offsetWidth,height:domElement.offsetHeight}},kendo.notify=noop;var templateRegExp=/template$/i,jsonRegExp=/^\s*(?:\{(?:.|\r\n|\n)*\}|\[(?:.|\r\n|\n)*\])\s*$/,jsonFormatRegExp=/^\{(\d+)(:[^\}]+)?\}|^\[[A-Za-z_]*\]$/,dashRegExp=/([A-Z])/g;kendo.initWidget=function(element,options,roles){var result,option,widget,idx,length,role,value,dataSource;if(roles?roles.roles&&(roles=roles.roles):roles=kendo.ui.roles,element=element.nodeType?element:element[0],role=element.getAttribute("data-"+kendo.ns+"role"),role&&(widget=role.indexOf(".")===-1?roles[role]:kendo.getter(role)(window))){for(dataSource=parseOption(element,"dataSource"),options=$.extend({},parseOptions(element,widget.fn.options),options),dataSource&&(typeof dataSource===STRING?options.dataSource=kendo.getter(dataSource)(window):options.dataSource=dataSource),idx=0,length=widget.fn.events.length;idx<length;idx++)option=widget.fn.events[idx],value=parseOption(element,option),value!==undefined&&(options[option]=kendo.getter(value)(window));return result=$(element).data("kendo"+widget.fn.options.prefix+widget.fn.options.name),result?result.setOptions(options):result=new widget(element,options),result}},kendo.rolesFromNamespaces=function(namespaces){var idx,length,roles=[];for(namespaces[0]||(namespaces=[kendo.ui,kendo.dataviz.ui]),idx=0,length=namespaces.length;idx<length;idx++)roles[idx]=namespaces[idx].roles;return extend.apply(null,[{}].concat(roles.reverse()))},kendo.init=function(element){var roles=kendo.rolesFromNamespaces(slice.call(arguments,1));$(element).find("[data-"+kendo.ns+"role]").addBack().each(function(){kendo.initWidget(this,{},roles)})},kendo.destroy=function(element){$(element).find("[data-"+kendo.ns+"role]").addBack().each(function(){var data=$(this).data();for(var key in data)0===key.indexOf("kendo")&&typeof data[key].destroy===FUNCTION&&data[key].destroy()})},kendo.resize=function(element,force){var widgets=$(element).find("[data-"+kendo.ns+"role]").addBack().filter(resizableWidget);if(widgets.length){var widgetsArray=$.makeArray(widgets);widgetsArray.sort(containmentComparer),$.each(widgetsArray,function(){var widget=kendo.widgetInstance($(this));widget&&widget.resize(force)})}},kendo.parseOptions=parseOptions,extend(kendo.ui,{Widget:Widget,roles:{},progress:function(container,toggle){var isRtl,leftRight,webkitCorrection,containerScrollLeft,mask=container.find(".k-loading-mask"),support=kendo.support,browser=support.browser;toggle?mask.length||(isRtl=support.isRtl(container),leftRight=isRtl?"right":"left",containerScrollLeft=container.scrollLeft(),webkitCorrection=browser.webkit&&isRtl?container[0].scrollWidth-container.width()-2*containerScrollLeft:0,mask=$("<div class='k-loading-mask'><span class='k-loading-text'>Loading...</span><div class='k-loading-image'/><div class='k-loading-color'/></div>").width("100%").height("100%").css("top",container.scrollTop()).css(leftRight,Math.abs(containerScrollLeft)+webkitCorrection).prependTo(container)):mask&&mask.remove()},plugin:function(widget,register,prefix){var getter,name=widget.fn.options.name;register=register||kendo.ui,prefix=prefix||"",register[name]=widget,register.roles[name.toLowerCase()]=widget,getter="getKendo"+prefix+name,name="kendo"+prefix+name,$.fn[name]=function(options){var args,value=this;return typeof options===STRING?(args=slice.call(arguments,1),this.each(function(){var method,result,widget=$.data(this,name);if(!widget)throw new Error(kendo.format("Cannot call method '{0}' of {1} before it is initialized",options,name));if(method=widget[options],typeof method!==FUNCTION)throw new Error(kendo.format("Cannot find method '{0}' of {1}",options,name));if(result=method.apply(widget,args),result!==undefined)return value=result,!1})):this.each(function(){new widget(this,options)}),value},$.fn[getter]=function(){return this.data(name)}}});var ContainerNullObject={bind:function(){return this},nullObject:!0,options:{}},MobileWidget=Widget.extend({init:function(element,options){Widget.fn.init.call(this,element,options),this.element.autoApplyNS(),this.wrapper=this.element,this.element.addClass("km-widget")},destroy:function(){Widget.fn.destroy.call(this),this.element.kendoDestroy()},options:{prefix:"Mobile"},events:[],view:function(){var viewElement=this.element.closest(kendo.roleSelector("view splitview modalview drawer"));return kendo.widgetInstance(viewElement,kendo.mobile.ui)||ContainerNullObject},viewHasNativeScrolling:function(){var view=this.view();return view&&view.options.useNativeScrolling},container:function(){var element=this.element.closest(kendo.roleSelector("view layout modalview drawer"));return kendo.widgetInstance(element,kendo.mobile.ui)||ContainerNullObject}});extend(kendo.mobile,{init:function(element){kendo.init(element,kendo.mobile.ui,kendo.ui,kendo.dataviz.ui)},appLevelNativeScrolling:function(){return kendo.mobile.application&&kendo.mobile.application.options&&kendo.mobile.application.options.useNativeScrolling},ui:{Widget:MobileWidget,roles:{},plugin:function(widget){kendo.ui.plugin(widget,kendo.mobile.ui,"Mobile")}}}),kendo.touchScroller=function(elements,options){return $(elements).map(function(idx,element){return element=$(element),!(!support.kineticScrollNeeded||!kendo.mobile.ui.Scroller||element.data("kendoMobileScroller"))&&(element.kendoMobileScroller(options),element.data("kendoMobileScroller"))})[0]},kendo.preventDefault=function(e){e.preventDefault()},kendo.widgetInstance=function(element,suites){var i,length,role=element.data(kendo.ns+"role"),widgets=[];if(role){if("content"===role&&(role="scroller"),suites)if(suites[0])for(i=0,length=suites.length;i<length;i++)widgets.push(suites[i].roles[role]);else widgets.push(suites.roles[role]);else widgets=[kendo.ui.roles[role],kendo.dataviz.ui.roles[role],kendo.mobile.ui.roles[role]];for(role.indexOf(".")>=0&&(widgets=[kendo.getter(role)(window)]),i=0,length=widgets.length;i<length;i++){var widget=widgets[i];if(widget){var instance=element.data("kendo"+widget.fn.options.prefix+widget.fn.options.name);if(instance)return instance}}}},kendo.onResize=function(callback){var handler=callback;return support.mobileOS.android&&(handler=function(){setTimeout(callback,600)}),$(window).on(support.resize,handler),handler},kendo.unbindResize=function(callback){$(window).off(support.resize,callback)},kendo.attrValue=function(element,key){return element.data(kendo.ns+key)},kendo.days={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},$.extend($.expr[":"],{kendoFocusable:function(element){var idx=$.attr(element,"tabindex");return focusable(element,!isNaN(idx)&&idx>-1)}});var MOUSE_EVENTS=["mousedown","mousemove","mouseenter","mouseleave","mouseover","mouseout","mouseup","click"],EXCLUDE_BUST_CLICK_SELECTOR="label, input, [data-rel=external]",MouseEventNormalizer={setupMouseMute:function(){var idx=0,length=MOUSE_EVENTS.length,element=document.documentElement;if(!MouseEventNormalizer.mouseTrap&&support.eventCapture){MouseEventNormalizer.mouseTrap=!0,MouseEventNormalizer.bustClick=!1,MouseEventNormalizer.captureMouse=!1;for(var handler=function(e){MouseEventNormalizer.captureMouse&&("click"===e.type?MouseEventNormalizer.bustClick&&!$(e.target).is(EXCLUDE_BUST_CLICK_SELECTOR)&&(e.preventDefault(),e.stopPropagation()):e.stopPropagation())};idx<length;idx++)element.addEventListener(MOUSE_EVENTS[idx],handler,!0)}},muteMouse:function(e){MouseEventNormalizer.captureMouse=!0,e.data.bustClick&&(MouseEventNormalizer.bustClick=!0),clearTimeout(MouseEventNormalizer.mouseTrapTimeoutID)},unMuteMouse:function(){clearTimeout(MouseEventNormalizer.mouseTrapTimeoutID),MouseEventNormalizer.mouseTrapTimeoutID=setTimeout(function(){MouseEventNormalizer.captureMouse=!1,MouseEventNormalizer.bustClick=!1},400)}},eventMap={down:"touchstart mousedown",move:"mousemove touchmove",up:"mouseup touchend touchcancel",cancel:"mouseleave touchcancel"};support.touch&&(support.mobileOS.ios||support.mobileOS.android)?eventMap={down:"touchstart",move:"touchmove",up:"touchend touchcancel",cancel:"touchcancel"}:support.pointers?eventMap={down:"pointerdown",move:"pointermove",up:"pointerup",cancel:"pointercancel pointerleave"}:support.msPointers&&(eventMap={down:"MSPointerDown",move:"MSPointerMove",up:"MSPointerUp",cancel:"MSPointerCancel MSPointerLeave"}),!support.msPointers||"onmspointerenter"in window||$.each({MSPointerEnter:"MSPointerOver",MSPointerLeave:"MSPointerOut"},function(orig,fix){$.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||$.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}});var getEventMap=function(e){return eventMap[e]||e},eventRegEx=/([^ ]+)/g;kendo.applyEventMap=function(events,ns){return events=events.replace(eventRegEx,getEventMap),ns&&(events=events.replace(eventRegEx,"$1."+ns)),events};var on=$.fn.on;extend(!0,kendoJQuery,$),kendoJQuery.fn=kendoJQuery.prototype=new $,kendoJQuery.fn.constructor=kendoJQuery,kendoJQuery.fn.init=function(selector,context){return context&&context instanceof $&&!(context instanceof kendoJQuery)&&(context=kendoJQuery(context)),$.fn.init.call(this,selector,context,rootjQuery)},kendoJQuery.fn.init.prototype=kendoJQuery.fn;var rootjQuery=kendoJQuery(document);extend(kendoJQuery.fn,{handler:function(handler){return this.data("handler",handler),this},autoApplyNS:function(ns){return this.data("kendoNS",ns||kendo.guid()),this},on:function(){var that=this,ns=that.data("kendoNS");if(1===arguments.length)return on.call(that,arguments[0]);var context=that,args=slice.call(arguments);typeof args[args.length-1]===UNDEFINED&&args.pop();var callback=args[args.length-1],events=kendo.applyEventMap(args[0],ns);if(support.mouseAndTouchPresent&&events.search(/mouse|click/)>-1&&this[0]!==document.documentElement){MouseEventNormalizer.setupMouseMute();var selector=2===args.length?null:args[1],bustClick=events.indexOf("click")>-1&&events.indexOf("touchend")>-1;on.call(this,{touchstart:MouseEventNormalizer.muteMouse,touchend:MouseEventNormalizer.unMuteMouse},selector,{bustClick:bustClick})}return typeof callback===STRING&&(context=that.data("handler"),callback=context[callback],args[args.length-1]=function(e){callback.call(context,e)}),args[0]=events,on.apply(that,args),that},kendoDestroy:function(ns){return ns=ns||this.data("kendoNS"),ns&&this.off("."+ns),this}}),kendo.jQuery=kendoJQuery,kendo.eventMap=eventMap,kendo.timezone=function(){function ruleToDate(year,rule){var date,targetDay,ourDay,month=rule[3],on=rule[4],time=rule[5],cache=rule[8];return cache||(rule[8]=cache={}),cache[year]?cache[year]:(isNaN(on)?0===on.indexOf("last")?(date=new Date(Date.UTC(year,months[month]+1,1,time[0]-24,time[1],time[2],0)),targetDay=days[on.substr(4,3)],ourDay=date.getUTCDay(),date.setUTCDate(date.getUTCDate()+targetDay-ourDay-(targetDay>ourDay?7:0))):on.indexOf(">=")>=0&&(date=new Date(Date.UTC(year,months[month],on.substr(5),time[0],time[1],time[2],0)),targetDay=days[on.substr(0,3)],ourDay=date.getUTCDay(),date.setUTCDate(date.getUTCDate()+targetDay-ourDay+(targetDay<ourDay?7:0))):date=new Date(Date.UTC(year,months[month],on,time[0],time[1],time[2],0)),cache[year]=date)}function findRule(utcTime,rules,zone){if(rules=rules[zone],!rules){var time=zone.split(":"),offset=0;return time.length>1&&(offset=60*time[0]+Number(time[1])),[-1e6,"max","-","Jan",1,[0,0,0],offset,"-"]}var year=new Date(utcTime).getUTCFullYear();rules=jQuery.grep(rules,function(rule){var from=rule[0],to=rule[1];return from<=year&&(to>=year||from==year&&"only"==to||"max"==to)}),rules.push(utcTime),rules.sort(function(a,b){return"number"!=typeof a&&(a=Number(ruleToDate(year,a))),"number"!=typeof b&&(b=Number(ruleToDate(year,b))),a-b});var rule=rules[jQuery.inArray(utcTime,rules)-1]||rules[rules.length-1];return isNaN(rule)?rule:null}function findZone(utcTime,zones,timezone){var zoneRules=zones[timezone];if("string"==typeof zoneRules&&(zoneRules=zones[zoneRules]),!zoneRules)throw new Error('Timezone "'+timezone+'" is either incorrect, or kendo.timezones.min.js is not included.');for(var idx=zoneRules.length-1;idx>=0;idx--){var until=zoneRules[idx][3];if(until&&utcTime>until)break}var zone=zoneRules[idx+1];if(!zone)throw new Error('Timezone "'+timezone+'" not found on '+utcTime+".");return zone}function zoneAndRule(utcTime,zones,rules,timezone){typeof utcTime!=NUMBER&&(utcTime=Date.UTC(utcTime.getFullYear(),utcTime.getMonth(),utcTime.getDate(),utcTime.getHours(),utcTime.getMinutes(),utcTime.getSeconds(),utcTime.getMilliseconds()));var zone=findZone(utcTime,zones,timezone);return{zone:zone,rule:findRule(utcTime,rules,zone[1])}}function offset(utcTime,timezone){if("Etc/UTC"==timezone||"Etc/GMT"==timezone)return 0;var info=zoneAndRule(utcTime,this.zones,this.rules,timezone),zone=info.zone,rule=info.rule;return rule?zone[0]-rule[6]:zone[0]}function abbr(utcTime,timezone){var info=zoneAndRule(utcTime,this.zones,this.rules,timezone),zone=info.zone,rule=info.rule,base=zone[2];return base.indexOf("/")>=0?base.split("/")[rule&&+rule[6]?1:0]:base.indexOf("%s")>=0?base.replace("%s",rule&&"-"!=rule[7]?rule[7]:""):base}function convert(date,fromOffset,toOffset){typeof fromOffset==STRING&&(fromOffset=this.offset(date,fromOffset)),typeof toOffset==STRING&&(toOffset=this.offset(date,toOffset));var fromLocalOffset=date.getTimezoneOffset();date=new Date(date.getTime()+6e4*(fromOffset-toOffset));var toLocalOffset=date.getTimezoneOffset();return new Date(date.getTime()+6e4*(toLocalOffset-fromLocalOffset))}function apply(date,timezone){return this.convert(date,date.getTimezoneOffset(),timezone)}function remove(date,timezone){return this.convert(date,timezone,date.getTimezoneOffset())}function toLocalDate(time){return this.apply(new Date(time),"Etc/UTC")}var months={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},days={Sun:0,Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6};return{zones:{},rules:{},offset:offset,convert:convert,apply:apply,remove:remove,abbr:abbr,toLocalDate:toLocalDate}}(),kendo.date=function(){function adjustDST(date,hours){return 0===hours&&23===date.getHours()&&(date.setHours(date.getHours()+2),!0)}function setDayOfWeek(date,day,dir){var hours=date.getHours();dir=dir||1,day=(day-date.getDay()+7*dir)%7,date.setDate(date.getDate()+day),adjustDST(date,hours)}function dayOfWeek(date,day,dir){return date=new Date(date),setDayOfWeek(date,day,dir),date}function firstDayOfMonth(date){return new Date(date.getFullYear(),date.getMonth(),1)}function lastDayOfMonth(date){var last=new Date(date.getFullYear(),date.getMonth()+1,0),first=firstDayOfMonth(date),timeOffset=Math.abs(last.getTimezoneOffset()-first.getTimezoneOffset());return timeOffset&&last.setHours(first.getHours()+timeOffset/60),last}function getDate(date){return date=new Date(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0),adjustDST(date,0),date}function toUtcTime(date){return Date.UTC(date.getFullYear(),date.getMonth(),date.getDate(),date.getHours(),date.getMinutes(),date.getSeconds(),date.getMilliseconds())}function getMilliseconds(date){return date.getTime()-getDate(date)}function isInTimeRange(value,min,max){var msValue,msMin=getMilliseconds(min),msMax=getMilliseconds(max);return!value||msMin==msMax||(min>=max&&(max+=MS_PER_DAY),msValue=getMilliseconds(value),msMin>msValue&&(msValue+=MS_PER_DAY),msMax<msMin&&(msMax+=MS_PER_DAY),msValue>=msMin&&msValue<=msMax)}function isInDateRange(value,min,max){var msValue,msMin=min.getTime(),msMax=max.getTime();return msMin>=msMax&&(msMax+=MS_PER_DAY),msValue=value.getTime(),msValue>=msMin&&msValue<=msMax}function addDays(date,offset){var hours=date.getHours();return date=new Date(date),setTime(date,offset*MS_PER_DAY),adjustDST(date,hours),date}function setTime(date,milliseconds,ignoreDST){var difference,offset=date.getTimezoneOffset();date.setTime(date.getTime()+milliseconds),ignoreDST||(difference=date.getTimezoneOffset()-offset,date.setTime(date.getTime()+difference*MS_PER_MINUTE))}function today(){return getDate(new Date)}function isToday(date){return getDate(date).getTime()==today().getTime()}function toInvariantTime(date){var staticDate=new Date(1980,1,1,0,0,0);return date&&staticDate.setHours(date.getHours(),date.getMinutes(),date.getSeconds(),date.getMilliseconds()),
staticDate}var MS_PER_MINUTE=6e4,MS_PER_DAY=864e5;return{adjustDST:adjustDST,dayOfWeek:dayOfWeek,setDayOfWeek:setDayOfWeek,getDate:getDate,isInDateRange:isInDateRange,isInTimeRange:isInTimeRange,isToday:isToday,nextDay:function(date){return addDays(date,1)},previousDay:function(date){return addDays(date,-1)},toUtcTime:toUtcTime,MS_PER_DAY:MS_PER_DAY,MS_PER_HOUR:60*MS_PER_MINUTE,MS_PER_MINUTE:MS_PER_MINUTE,setTime:setTime,addDays:addDays,today:today,toInvariantTime:toInvariantTime,firstDayOfMonth:firstDayOfMonth,lastDayOfMonth:lastDayOfMonth,getMilliseconds:getMilliseconds}}(),kendo.stripWhitespace=function(element){if(document.createNodeIterator)for(var iterator=document.createNodeIterator(element,NodeFilter.SHOW_TEXT,function(node){return node.parentNode==element?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},!1);iterator.nextNode();)iterator.referenceNode&&!iterator.referenceNode.textContent.trim()&&iterator.referenceNode.parentNode.removeChild(iterator.referenceNode);else for(var i=0;i<element.childNodes.length;i++){var child=element.childNodes[i];3!=child.nodeType||/\S/.test(child.nodeValue)||(element.removeChild(child),i--),1==child.nodeType&&kendo.stripWhitespace(child)}};var animationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){setTimeout(callback,1e3/60)};kendo.animationFrame=function(callback){animationFrame.call(window,callback)};var animationQueue=[];kendo.queueAnimation=function(callback){animationQueue[animationQueue.length]=callback,1===animationQueue.length&&kendo.runNextAnimation()},kendo.runNextAnimation=function(){kendo.animationFrame(function(){animationQueue[0]&&(animationQueue.shift()(),animationQueue[0]&&kendo.runNextAnimation())})},kendo.parseQueryStringParams=function(url){for(var queryString=url.split("?")[1]||"",params={},paramParts=queryString.split(/&|=/),length=paramParts.length,idx=0;idx<length;idx+=2)""!==paramParts[idx]&&(params[decodeURIComponent(paramParts[idx])]=decodeURIComponent(paramParts[idx+1]));return params},kendo.elementUnderCursor=function(e){return document.elementFromPoint(e.x.client,e.y.client)},kendo.wheelDeltaY=function(jQueryEvent){var delta,e=jQueryEvent.originalEvent,deltaY=e.wheelDeltaY;return e.wheelDelta?(deltaY===undefined||deltaY)&&(delta=e.wheelDelta):e.detail&&e.axis===e.VERTICAL_AXIS&&(delta=10*-e.detail),delta},kendo.throttle=function(fn,delay){var timeout,lastExecTime=0;return!delay||delay<=0?fn:function(){function exec(){lastExecTime=+new Date,fn.apply(that,args)}var that=this,elapsed=+new Date-lastExecTime,args=arguments;return lastExecTime?(timeout&&clearTimeout(timeout),void(elapsed>delay?exec():timeout=setTimeout(exec,delay-elapsed))):exec()}},kendo.caret=function(element,start,end){var rangeElement,isPosition=start!==undefined;if(end===undefined&&(end=start),element[0]&&(element=element[0]),!isPosition||!element.disabled){try{if(element.selectionStart!==undefined)isPosition?(element.focus(),element.setSelectionRange(start,end)):start=[element.selectionStart,element.selectionEnd];else if(document.selection)if($(element).is(":visible")&&element.focus(),rangeElement=element.createTextRange(),isPosition)rangeElement.collapse(!0),rangeElement.moveStart("character",start),rangeElement.moveEnd("character",end-start),rangeElement.select();else{var selectionStart,selectionEnd,rangeDuplicated=rangeElement.duplicate();rangeElement.moveToBookmark(document.selection.createRange().getBookmark()),rangeDuplicated.setEndPoint("EndToStart",rangeElement),selectionStart=rangeDuplicated.text.length,selectionEnd=selectionStart+rangeElement.text.length,start=[selectionStart,selectionEnd]}}catch(e){start=[]}return start}}}(jQuery),function($,undefined){function absoluteURL(path,pathPrefix){if(!pathPrefix)return path;path+"/"===pathPrefix&&(path=pathPrefix);var regEx=new RegExp("^"+pathPrefix,"i");return regEx.test(path)||(path=pathPrefix+"/"+path),location.protocol+"//"+(location.host+"/"+path).replace(/\/\/+/g,"/")}function hashDelimiter(bang){return bang?"#!":"#"}function locationHash(hashDelimiter){var href=location.href;return"#!"===hashDelimiter&&href.indexOf("#")>-1&&href.indexOf("#!")<0?null:href.split(hashDelimiter)[1]||""}function stripRoot(root,url){return 0===url.indexOf(root)?url.substr(root.length).replace(/\/\//g,"/"):url}function fixHash(url){return url.replace(/^(#)?/,"#")}function fixBang(url){return url.replace(/^(#(!)?)?/,"#!")}var kendo=window.kendo,CHANGE="change",BACK="back",SAME="same",support=kendo.support,location=window.location,history=window.history,CHECK_URL_INTERVAL=50,BROKEN_BACK_NAV=kendo.support.browser.msie,hashStrip=/^#*/,document=window.document,HistoryAdapter=kendo.Class.extend({back:function(){BROKEN_BACK_NAV?setTimeout(function(){history.back()}):history.back()},forward:function(){BROKEN_BACK_NAV?setTimeout(function(){history.forward()}):history.forward()},length:function(){return history.length},replaceLocation:function(url){location.replace(url)}}),PushStateAdapter=HistoryAdapter.extend({init:function(root){this.root=root},navigate:function(to){history.pushState({},document.title,absoluteURL(to,this.root))},replace:function(to){history.replaceState({},document.title,absoluteURL(to,this.root))},normalize:function(url){return stripRoot(this.root,url)},current:function(){var current=location.pathname;return location.search&&(current+=location.search),stripRoot(this.root,current)},change:function(callback){$(window).bind("popstate.kendo",callback)},stop:function(){$(window).unbind("popstate.kendo")},normalizeCurrent:function(options){var fixedUrl,root=options.root,pathname=location.pathname,hash=locationHash(hashDelimiter(options.hashBang));root===pathname+"/"&&(fixedUrl=root),root===pathname&&hash&&(fixedUrl=absoluteURL(hash.replace(hashStrip,""),root)),fixedUrl&&history.pushState({},document.title,fixedUrl)}}),HashAdapter=HistoryAdapter.extend({init:function(bang){this._id=kendo.guid(),this.prefix=hashDelimiter(bang),this.fix=bang?fixBang:fixHash},navigate:function(to){location.hash=this.fix(to)},replace:function(to){this.replaceLocation(this.fix(to))},normalize:function(url){return url.indexOf(this.prefix)<0?url:url.split(this.prefix)[1]},change:function(callback){support.hashChange?$(window).on("hashchange."+this._id,callback):this._interval=setInterval(callback,CHECK_URL_INTERVAL)},stop:function(){$(window).off("hashchange."+this._id),clearInterval(this._interval)},current:function(){return locationHash(this.prefix)},normalizeCurrent:function(options){var pathname=location.pathname,root=options.root;return!(!options.pushState||root===pathname)&&(this.replaceLocation(root+this.prefix+stripRoot(root,pathname)),!0)}}),History=kendo.Observable.extend({start:function(options){if(options=options||{},this.bind([CHANGE,BACK,SAME],options),!this._started){this._started=!0,options.root=options.root||"/";var current,adapter=this.createAdapter(options);adapter.normalizeCurrent(options)||(current=adapter.current(),$.extend(this,{adapter:adapter,root:options.root,historyLength:adapter.length(),current:current,locations:[current]}),adapter.change($.proxy(this,"_checkUrl")))}},createAdapter:function(options){return support.pushState&&options.pushState?new PushStateAdapter(options.root):new HashAdapter(options.hashBang)},stop:function(){this._started&&(this.adapter.stop(),this.unbind(CHANGE),this._started=!1)},change:function(callback){this.bind(CHANGE,callback)},replace:function(to,silent){this._navigate(to,silent,function(adapter){adapter.replace(to),this.locations[this.locations-1]=this.current})},navigate:function(to,silent){return"#:back"===to?void this.adapter.back():void this._navigate(to,silent,function(adapter){adapter.navigate(to),this.locations.push(this.current)})},_navigate:function(to,silent,callback){var adapter=this.adapter;return to=adapter.normalize(to),this.current===to||this.current===decodeURIComponent(to)?void this.trigger(SAME):void(!silent&&this.trigger(CHANGE,{url:to})||(this.current=to,callback.call(this,adapter),this.historyLength=adapter.length()))},_checkUrl:function(){var adapter=this.adapter,current=adapter.current(),newLength=adapter.length(),navigatingInExisting=this.historyLength===newLength,back=current===this.locations[this.locations.length-2]&&navigatingInExisting,prev=this.current;return null===current||this.current===current||this.current===decodeURIComponent(current)||(this.historyLength=newLength,this.current=current,back&&this.trigger("back",{url:prev,to:current})?(adapter.forward(),void(this.current=prev)):this.trigger(CHANGE,{url:current})?(back?adapter.forward():(adapter.back(),this.historyLength--),void(this.current=prev)):void(back?this.locations.pop():this.locations.push(current)))}});kendo.History=History,kendo.History.HistoryAdapter=HistoryAdapter,kendo.History.HashAdapter=HashAdapter,kendo.History.PushStateAdapter=PushStateAdapter,kendo.absoluteURL=absoluteURL,kendo.history=new History}(window.kendo.jQuery),function(){function namedParamReplace(match,optional){return optional?match:"([^/]+)"}function routeToRegExp(route){return new RegExp("^"+route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,namedParamReplace).replace(splatParam,"(.*?)")+"$")}function stripUrl(url){return url.replace(/(\?.*)|(#.*)/g,"")}var kendo=window.kendo,history=kendo.history,Observable=kendo.Observable,INIT="init",ROUTE_MISSING="routeMissing",CHANGE="change",BACK="back",SAME="same",optionalParam=/\((.*?)\)/g,namedParam=/(\(\?)?:\w+/g,splatParam=/\*\w+/g,escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g,Route=kendo.Class.extend({init:function(route,callback){route instanceof RegExp||(route=routeToRegExp(route)),this.route=route,this._callback=callback},callback:function(url){var params,length,idx=0,queryStringParams=kendo.parseQueryStringParams(url);for(url=stripUrl(url),params=this.route.exec(url).slice(1),length=params.length;idx<length;idx++)"undefined"!=typeof params[idx]&&(params[idx]=decodeURIComponent(params[idx]));params.push(queryStringParams),this._callback.apply(null,params)},worksWith:function(url){return!!this.route.test(stripUrl(url))&&(this.callback(url),!0)}}),Router=Observable.extend({init:function(options){options||(options={}),Observable.fn.init.call(this),this.routes=[],this.pushState=options.pushState,this.hashBang=options.hashBang,this.root=options.root,this.bind([INIT,ROUTE_MISSING,CHANGE,SAME],options)},destroy:function(){history.unbind(CHANGE,this._urlChangedProxy),history.unbind(SAME,this._sameProxy),history.unbind(BACK,this._backProxy),this.unbind()},start:function(){var that=this,sameProxy=function(){that._same()},backProxy=function(e){that._back(e)},urlChangedProxy=function(e){that._urlChanged(e)};history.start({same:sameProxy,change:urlChangedProxy,back:backProxy,pushState:that.pushState,hashBang:that.hashBang,root:that.root});var initEventObject={url:history.current||"/",preventDefault:$.noop};that.trigger(INIT,initEventObject)||that._urlChanged(initEventObject),this._urlChangedProxy=urlChangedProxy,this._backProxy=backProxy},route:function(route,callback){this.routes.push(new Route(route,callback))},navigate:function(url,silent){kendo.history.navigate(url,silent)},replace:function(url,silent){kendo.history.replace(url,silent)},_back:function(e){this.trigger(BACK,{url:e.url,to:e.to})&&e.preventDefault()},_same:function(e){this.trigger(SAME)},_urlChanged:function(e){var url=e.url;if(url||(url="/"),this.trigger(CHANGE,{url:e.url,params:kendo.parseQueryStringParams(e.url)}))return void e.preventDefault();for(var route,idx=0,routes=this.routes,length=routes.length;idx<length;idx++)if(route=routes[idx],route.worksWith(url))return;this.trigger(ROUTE_MISSING,{url:url,params:kendo.parseQueryStringParams(url)})&&e.preventDefault()}});kendo.Router=Router}(),function($,undefined){function toOdataFilter(filter){var idx,length,field,type,format,operator,value,ignoreCase,result=[],logic=filter.logic||"and",filters=filter.filters;for(idx=0,length=filters.length;idx<length;idx++)filter=filters[idx],field=filter.field,value=filter.value,operator=filter.operator,filter.filters?filter=toOdataFilter(filter):(ignoreCase=filter.ignoreCase,field=field.replace(/\./g,"/"),filter=odataFilters[operator],filter&&value!==undefined&&(type=$.type(value),"string"===type?(format="'{1}'",value=value.replace(/'/g,"''"),ignoreCase===!0&&(field="tolower("+field+")")):format="date"===type?"datetime'{1:yyyy-MM-ddTHH:mm:ss}'":"{1}",filter.length>3?"substringof"!==filter?format="{0}({2},"+format+")":(format="{0}("+format+",{2})","doesnotcontain"===operator&&(format+=" eq false")):format="{2} {0} "+format,filter=kendo.format(format,filter,value,field))),result.push(filter);return filter=result.join(" "+logic+" "),result.length>1&&(filter="("+filter+")"),filter}var kendo=window.kendo,extend=$.extend,odataFilters={eq:"eq",neq:"ne",gt:"gt",gte:"ge",lt:"lt",lte:"le",contains:"substringof",doesnotcontain:"substringof",endswith:"endswith",startswith:"startswith"},mappers={pageSize:$.noop,page:$.noop,filter:function(params,filter){filter&&(params.$filter=toOdataFilter(filter))},sort:function(params,orderby){var expr=$.map(orderby,function(value){var order=value.field.replace(/\./g,"/");return"desc"===value.dir&&(order+=" desc"),order}).join(",");expr&&(params.$orderby=expr)},skip:function(params,skip){skip&&(params.$skip=skip)},take:function(params,take){take&&(params.$top=take)}},defaultDataType={read:{dataType:"jsonp"}};extend(!0,kendo.data,{schemas:{odata:{type:"json",data:function(data){return data.d.results||[data.d]},total:"d.__count"}},transports:{odata:{read:{cache:!0,dataType:"jsonp",jsonp:"$callback"},update:{cache:!0,dataType:"json",contentType:"application/json",type:"PUT"},create:{cache:!0,dataType:"json",contentType:"application/json",type:"POST"},destroy:{cache:!0,dataType:"json",type:"DELETE"},parameterMap:function(options,type){var params,value,option,dataType;if(options=options||{},type=type||"read",dataType=(this.options||defaultDataType)[type],dataType=dataType?dataType.dataType:"json","read"===type){params={$inlinecount:"allpages"},"json"!=dataType&&(params.$format="json");for(option in options)mappers[option]?mappers[option](params,options[option]):params[option]=options[option]}else{if("json"!==dataType)throw new Error("Only json dataType can be used for "+type+" operation.");if("destroy"!==type){for(option in options)value=options[option],"number"==typeof value&&(options[option]=value+"");params=kendo.stringify(options)}}return params}}}})}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,isArray=$.isArray,isPlainObject=$.isPlainObject,map=$.map,each=$.each,extend=$.extend,getter=kendo.getter,Class=kendo.Class,XmlDataReader=Class.extend({init:function(options){var that=this,total=options.total,model=options.model,parse=options.parse,errors=options.errors,serialize=options.serialize,data=options.data;if(model){if(isPlainObject(model)){var base=options.modelBase||kendo.data.Model;model.fields&&each(model.fields,function(field,value){value=isPlainObject(value)&&value.field?extend(value,{field:that.getter(value.field)}):{field:that.getter(value)},model.fields[field]=value});var id=model.id;if(id){var idField={};idField[that.xpathToMember(id,!0)]={field:that.getter(id)},model.fields=extend(idField,model.fields),model.id=that.xpathToMember(id)}model=base.define(model)}that.model=model}if(total&&("string"==typeof total?(total=that.getter(total),that.total=function(data){return parseInt(total(data),10)}):"function"==typeof total&&(that.total=total)),errors&&("string"==typeof errors?(errors=that.getter(errors),that.errors=function(data){return errors(data)||null}):"function"==typeof errors&&(that.errors=errors)),data&&("string"==typeof data?(data=that.xpathToMember(data),that.data=function(value){var modelInstance,result=that.evaluate(value,data);return result=isArray(result)?result:[result],that.model&&model.fields?(modelInstance=new that.model,map(result,function(value){if(value){var field,record={};for(field in model.fields)record[field]=modelInstance._parse(field,model.fields[field].field(value));return record}})):result}):"function"==typeof data&&(that.data=data)),"function"==typeof parse){var xmlParse=that.parse;that.parse=function(data){var xml=parse.call(that,data);return xmlParse.call(that,xml)}}"function"==typeof serialize&&(that.serialize=serialize)},total:function(result){return this.data(result).length},errors:function(data){return data?data.errors:null},serialize:function(data){return data},parseDOM:function(element){var parsedNode,node,nodeType,nodeName,member,attribute,idx,result={},attributes=element.attributes,attributeCount=attributes.length;for(idx=0;idx<attributeCount;idx++)attribute=attributes[idx],result["@"+attribute.nodeName]=attribute.nodeValue;for(node=element.firstChild;node;node=node.nextSibling)nodeType=node.nodeType,3===nodeType||4===nodeType?result["#text"]=node.nodeValue:1===nodeType&&(parsedNode=this.parseDOM(node),nodeName=node.nodeName,member=result[nodeName],isArray(member)?member.push(parsedNode):member=member!==undefined?[member,parsedNode]:parsedNode,result[nodeName]=member);return result},evaluate:function(value,expression){for(var member,result,length,intermediateResult,idx,members=expression.split(".");member=members.shift();)if(value=value[member],isArray(value)){for(result=[],expression=members.join("."),idx=0,length=value.length;idx<length;idx++)intermediateResult=this.evaluate(value[idx],expression),intermediateResult=isArray(intermediateResult)?intermediateResult:[intermediateResult],result.push.apply(result,intermediateResult);return result}return value},parse:function(xml){var documentElement,tree,result={};return documentElement=xml.documentElement||$.parseXML(xml).documentElement,tree=this.parseDOM(documentElement),result[documentElement.nodeName]=tree,result},xpathToMember:function(member,raw){return member?(member=member.replace(/^\//,"").replace(/\//g,"."),member.indexOf("@")>=0?member.replace(/\.?(@.*)/,raw?"$1":'["$1"]'):member.indexOf("text()")>=0?member.replace(/(\.?text\(\))/,raw?"#text":'["#text"]'):member):""},getter:function(member){return getter(this.xpathToMember(member),!0)}});$.extend(!0,kendo.data,{XmlDataReader:XmlDataReader,readers:{xml:XmlDataReader}})}(window.kendo.jQuery),function($,undefined){function eventHandler(context,type,field,prefix){return function(e){var key,event={};for(key in e)event[key]=e[key];prefix?event.field=field+"."+e.field:event.field=field,type==CHANGE&&context._notifyChange&&context._notifyChange(event),context.trigger(type,event)}}function equal(x,y){if(x===y)return!0;var field,xtype=$.type(x),ytype=$.type(y);if(xtype!==ytype)return!1;if("date"===xtype)return x.getTime()===y.getTime();if("object"!==xtype&&"array"!==xtype)return!1;for(field in x)if(!equal(x[field],y[field]))return!1;return!0}function getFieldByName(obj,name){var field,fieldName;for(fieldName in obj){if(field=obj[fieldName],isPlainObject(field)&&field.field&&field.field===name)return field;if(field===name)return field}return null}function Query(data){this.data=data||[]}function normalizeSort(field,dir){if(field){var descriptor=typeof field===STRING?{field:field,dir:dir}:field,descriptors=isArray(descriptor)?descriptor:descriptor!==undefined?[descriptor]:[];return grep(descriptors,function(d){return!!d.dir})}}function normalizeOperator(expression){var idx,length,filter,operator,filters=expression.filters;if(filters)for(idx=0,length=filters.length;idx<length;idx++)filter=filters[idx],operator=filter.operator,operator&&typeof operator===STRING&&(filter.operator=operatorMap[operator.toLowerCase()]||operator),normalizeOperator(filter)}function normalizeFilter(expression){if(expression&&!isEmptyObject(expression))return!isArray(expression)&&expression.filters||(expression={logic:"and",filters:isArray(expression)?expression:[expression]}),normalizeOperator(expression),expression}function normalizeAggregate(expressions){return isArray(expressions)?expressions:[expressions]}function normalizeGroup(field,dir){var descriptor=typeof field===STRING?{field:field,dir:dir}:field,descriptors=isArray(descriptor)?descriptor:descriptor!==undefined?[descriptor]:[];return map(descriptors,function(d){return{field:d.field,dir:d.dir||"asc",aggregates:d.aggregates}})}function groupValueComparer(a,b){return a&&a.getTime&&b&&b.getTime?a.getTime()===b.getTime():a===b}function calculateAggregate(accumulator,aggregates,item,index,length,state){aggregates=aggregates||[];var idx,aggr,functionName,len=aggregates.length;for(idx=0;idx<len;idx++){aggr=aggregates[idx],functionName=aggr.aggregate;var field=aggr.field;accumulator[field]=accumulator[field]||{},state[field]=state[field]||{},state[field][functionName]=state[field][functionName]||{},accumulator[field][functionName]=functions[functionName.toLowerCase()](accumulator[field][functionName],item,kendo.accessor(field),index,length,state[field][functionName])}}function isNumber(val){return"number"==typeof val&&!isNaN(val)}function isDate(val){return val&&val.getTime}function toJSON(array){var idx,length=array.length,result=new Array(length);for(idx=0;idx<length;idx++)result[idx]=array[idx].toJSON();return result}function calculateAggregates(data,options){options=options||{};var query=new Query(data),aggregates=options.aggregate,filter=options.filter;return filter&&(query=query.filter(filter)),query.aggregate(aggregates)}function serializeRecords(data,getters,modelInstance,originalFieldNames,fieldNames){var record,getter,originalName,idx,length;for(idx=0,length=data.length;idx<length;idx++){record=data[idx];for(getter in getters)originalName=fieldNames[getter],originalName&&originalName!==getter&&(record[originalName]=getters[getter](record),delete record[getter])}}function convertRecords(data,getters,modelInstance,originalFieldNames,fieldNames){var record,getter,originalName,idx,length;for(idx=0,length=data.length;idx<length;idx++){record=data[idx];for(getter in getters)record[getter]=modelInstance._parse(getter,getters[getter](record)),originalName=fieldNames[getter],originalName&&originalName!==getter&&delete record[originalName]}}function convertGroup(data,getters,modelInstance,originalFieldNames,fieldNames){var record,idx,fieldName,length;for(idx=0,length=data.length;idx<length;idx++)record=data[idx],fieldName=originalFieldNames[record.field],fieldName&&fieldName!=record.field&&(record.field=fieldName),record.value=modelInstance._parse(record.field,record.value),record.hasSubgroups?convertGroup(record.items,getters,modelInstance,originalFieldNames,fieldNames):convertRecords(record.items,getters,modelInstance,originalFieldNames,fieldNames)}function wrapDataAccess(originalFunction,model,converter,getters,originalFieldNames,fieldNames){return function(data){return data=originalFunction(data),data&&!isEmptyObject(getters)&&("[object Array]"===toString.call(data)||data instanceof ObservableArray||(data=[data]),converter(data,getters,new model,originalFieldNames,fieldNames)),data||[]}}function mergeGroups(target,dest,skip,take){for(var group,items,idx=0;dest.length&&take;){group=dest[idx],items=group.items;var length=items.length;if(target&&target.field===group.field&&target.value===group.value?(target.hasSubgroups&&target.items.length?mergeGroups(target.items[target.items.length-1],group.items,skip,take):(items=items.slice(skip,skip+take),target.items=target.items.concat(items)),dest.splice(idx--,1)):group.hasSubgroups&&items.length?mergeGroups(group,items,skip,take):(items=items.slice(skip,skip+take),group.items=items,group.items.length||dest.splice(idx--,1)),0===items.length?skip-=length:(skip=0,take-=items.length),++idx>=dest.length)break}idx<dest.length&&dest.splice(idx,dest.length-idx)}function flattenGroups(data){var idx,length,result=[];for(idx=0,length=data.length;idx<length;idx++)result=data[idx].hasSubgroups?result.concat(flattenGroups(data[idx].items)):result.concat(data[idx].items.slice());return result}function wrapGroupItems(data,model){var idx,length,group,items;if(model)for(idx=0,length=data.length;idx<length;idx++)group=data[idx],items=group.items,group.hasSubgroups?wrapGroupItems(items,model):!items.length||items[0]instanceof model||(items.type=model,items.wrapAll(items,items))}function eachGroupItems(data,func){var idx,length;for(idx=0,length=data.length;idx<length;idx++)if(data[idx].hasSubgroups){if(eachGroupItems(data[idx].items,func))return!0}else if(func(data[idx].items,data[idx]))return!0}function removeModel(data,model){var idx,length;for(idx=0,length=data.length;idx<length;idx++)if(data[idx].uid==model.uid)return model=data[idx],data.splice(idx,1),model}function wrapInEmptyGroup(groups,model){var parent,group,idx,length;for(idx=groups.length-1,length=0;idx>=length;idx--)group=groups[idx],parent={value:model.get(group.field),field:group.field,items:parent?[parent]:[model],hasSubgroups:!!parent,aggregates:{}};return parent}function indexOfPristineModel(data,model){return model?indexOf(data,function(item){return item[model.idField]===model.id}):-1}function indexOfModel(data,model){return model?indexOf(data,function(item){return item.uid==model.uid}):-1}function indexOf(data,comparer){var idx,length;for(idx=0,length=data.length;idx<length;idx++)if(comparer(data[idx]))return idx;return-1}function fieldNameFromModel(fields,name){if(fields&&!isEmptyObject(fields)){var fieldName,descriptor=fields[name];return fieldName=isPlainObject(descriptor)?descriptor.from||descriptor.field||name:fields[name]||name,isFunction(fieldName)?name:fieldName}return name}function convertFilterDescriptorsField(descriptor,model){var idx,length,target={};for(var field in descriptor)"filters"!==field&&(target[field]=descriptor[field]);if(descriptor.filters)for(target.filters=[],idx=0,length=descriptor.filters.length;idx<length;idx++)target.filters[idx]=convertFilterDescriptorsField(descriptor.filters[idx],model);else target.field=fieldNameFromModel(model.fields,target.field);return target}function convertDescriptorsField(descriptors,model){var idx,length,target,descriptor,result=[];for(idx=0,length=descriptors.length;idx<length;idx++){target={},descriptor=descriptors[idx];for(var field in descriptor)target[field]=descriptor[field];target.field=fieldNameFromModel(model.fields,target.field),target.aggregates&&isArray(target.aggregates)&&(target.aggregates=convertDescriptorsField(target.aggregates,model)),result.push(target)}return result}function inferSelect(select,fields){var idx,length,record,value,option,options=$(select)[0].children,data=[],firstField=fields[0],secondField=fields[1];for(idx=0,length=options.length;idx<length;idx++)record={},option=options[idx],option.disabled||(record[firstField.field]=option.text,value=option.attributes.value,value=value&&value.specified?option.value:option.text,record[secondField.field]=value,data.push(record));return data}function inferTable(table,fields){var idx,length,fieldIndex,cells,record,cell,empty,tbody=$(table)[0].tBodies[0],rows=tbody?tbody.rows:[],fieldCount=fields.length,data=[];for(idx=0,length=rows.length;idx<length;idx++){for(record={},empty=!0,cells=rows[idx].cells,fieldIndex=0;fieldIndex<fieldCount;fieldIndex++)cell=cells[fieldIndex],"th"!==cell.nodeName.toLowerCase()&&(empty=!1,record[fields[fieldIndex].field]=cell.innerHTML);empty||data.push(record)}return data}function dataMethod(name){return function(){var data=this._data,result=DataSource.fn[name].apply(this,slice.call(arguments));return this._data!=data&&this._attachBubbleHandlers(),result}}function inferList(list,fields){function elements(collection,tagName){return collection.filter(tagName).add(collection.find(tagName))}var idx,length,record,item,id,textChild,className,children,items=$(list).children(),data=[],textField=fields[0].field,urlField=fields[1]&&fields[1].field,spriteCssClassField=fields[2]&&fields[2].field,imageUrlField=fields[3]&&fields[3].field;for(idx=0,length=items.length;idx<length;idx++)record={_loaded:!0},item=items.eq(idx),textChild=item[0].firstChild,children=item.children(),list=children.filter("ul"),children=children.filter(":not(ul)"),id=item.attr("data-id"),id&&(record.id=id),textChild&&(record[textField]=3==textChild.nodeType?textChild.nodeValue:children.text()),urlField&&(record[urlField]=elements(children,"a").attr("href")),imageUrlField&&(record[imageUrlField]=elements(children,"img").attr("src")),spriteCssClassField&&(className=elements(children,".k-sprite").prop("className"),record[spriteCssClassField]=className&&$.trim(className.replace("k-sprite",""))),list.length&&(record.items=inferList(list.eq(0),fields)),"true"==item.attr("data-hasChildren")&&(record.hasChildren=!0),data.push(record);return data}var map,extend=$.extend,proxy=$.proxy,isPlainObject=$.isPlainObject,isEmptyObject=$.isEmptyObject,isArray=$.isArray,grep=$.grep,ajax=$.ajax,each=$.each,noop=$.noop,kendo=window.kendo,isFunction=kendo.isFunction,Observable=kendo.Observable,Class=kendo.Class,STRING="string",FUNCTION="function",CREATE="create",READ="read",UPDATE="update",DESTROY="destroy",CHANGE="change",SYNC="sync",GET="get",ERROR="error",REQUESTSTART="requestStart",PROGRESS="progress",REQUESTEND="requestEnd",crud=[CREATE,READ,UPDATE,DESTROY],identity=function(o){return o},getter=kendo.getter,stringify=kendo.stringify,math=Math,push=[].push,join=[].join,pop=[].pop,splice=[].splice,shift=[].shift,slice=[].slice,unshift=[].unshift,toString={}.toString,stableSort=kendo.support.stableSort,dateRegExp=/^\/Date\((.*?)\)\/$/,newLineRegExp=/(\r+|\n+)/g,quoteRegExp=/(?=['\\])/g,ObservableArray=Observable.extend({init:function(array,type){var that=this;that.type=type||ObservableObject,Observable.fn.init.call(that),that.length=array.length,that.wrapAll(array,that)},toJSON:function(){var idx,value,length=this.length,json=new Array(length);for(idx=0;idx<length;idx++)value=this[idx],value instanceof ObservableObject&&(value=value.toJSON()),json[idx]=value;return json},parent:noop,wrapAll:function(source,target){var idx,length,that=this,parent=function(){return that};for(target=target||[],idx=0,length=source.length;idx<length;idx++)target[idx]=that.wrap(source[idx],parent);return target},wrap:function(object,parent){var observable,that=this;return null!==object&&"[object Object]"===toString.call(object)&&(observable=object instanceof that.type||object instanceof Model,observable||(object=object instanceof ObservableObject?object.toJSON():object,object=new that.type(object)),object.parent=parent,object.bind(CHANGE,function(e){that.trigger(CHANGE,{field:e.field,node:e.node,index:e.index,items:e.items||[this],action:e.node?e.action||"itemchange":"itemchange"})})),object},push:function(){var result,index=this.length,items=this.wrapAll(arguments);return result=push.apply(this,items),this.trigger(CHANGE,{action:"add",index:index,items:items}),result},slice:slice,join:join,pop:function(){var length=this.length,result=pop.apply(this);return length&&this.trigger(CHANGE,{action:"remove",index:length-1,items:[result]}),result},splice:function(index,howMany,item){var result,i,len,items=this.wrapAll(slice.call(arguments,2));if(result=splice.apply(this,[index,howMany].concat(items)),result.length)for(this.trigger(CHANGE,{action:"remove",index:index,items:result}),i=0,len=result.length;i<len;i++)result[i].children&&result[i].unbind(CHANGE);return item&&this.trigger(CHANGE,{action:"add",index:index,items:items}),result},shift:function(){var length=this.length,result=shift.apply(this);return length&&this.trigger(CHANGE,{action:"remove",index:0,items:[result]}),result},unshift:function(){var result,items=this.wrapAll(arguments);return result=unshift.apply(this,items),this.trigger(CHANGE,{action:"add",index:0,items:items}),result},indexOf:function(item){var idx,length,that=this;for(idx=0,length=that.length;idx<length;idx++)if(that[idx]===item)return idx;return-1},forEach:function(callback){for(var idx=0,length=this.length;idx<length;idx++)callback(this[idx],idx,this)},map:function(callback){
for(var idx=0,result=[],length=this.length;idx<length;idx++)result[idx]=callback(this[idx],idx,this);return result},filter:function(callback){for(var item,idx=0,result=[],length=this.length;idx<length;idx++)item=this[idx],callback(item,idx,this)&&(result[result.length]=item);return result},find:function(callback){for(var item,idx=0,length=this.length;idx<length;idx++)if(item=this[idx],callback(item,idx,this))return item},every:function(callback){for(var item,idx=0,length=this.length;idx<length;idx++)if(item=this[idx],!callback(item,idx,this))return!1;return!0},some:function(callback){for(var item,idx=0,length=this.length;idx<length;idx++)if(item=this[idx],callback(item,idx,this))return!0;return!1},remove:function(item){this.splice(this.indexOf(item),1)},empty:function(){this.splice(0,this.length)}}),ObservableObject=Observable.extend({init:function(value){var member,field,that=this,parent=function(){return that};Observable.fn.init.call(this);for(field in value)member=value[field],"_"!=field.charAt(0)&&(member=that.wrap(member,field,parent)),that[field]=member;that.uid=kendo.guid()},shouldSerialize:function(field){return this.hasOwnProperty(field)&&"_events"!==field&&typeof this[field]!==FUNCTION&&"uid"!==field},forEach:function(f){for(var i in this)this.shouldSerialize(i)&&f(this[i],i)},toJSON:function(){var value,field,result={};for(field in this)this.shouldSerialize(field)&&(value=this[field],(value instanceof ObservableObject||value instanceof ObservableArray)&&(value=value.toJSON()),result[field]=value);return result},get:function(field){var result,that=this;return that.trigger(GET,{field:field}),result="this"===field?that:kendo.getter(field,!0)(that)},_set:function(field,value){var that=this,composite=field.indexOf(".")>=0;if(composite)for(var paths=field.split("."),path="";paths.length>1;){path+=paths.shift();var obj=kendo.getter(path,!0)(that);if(obj instanceof ObservableObject)return obj.set(paths.join("."),value),composite;path+="."}return kendo.setter(field)(that,value),composite},set:function(field,value){var that=this,composite=field.indexOf(".")>=0,current=kendo.getter(field,!0)(that);current!==value&&(that.trigger("set",{field:field,value:value})||(composite||(value=that.wrap(value,field,function(){return that})),(!that._set(field,value)||field.indexOf("(")>=0||field.indexOf("[")>=0)&&that.trigger(CHANGE,{field:field})))},parent:noop,wrap:function(object,field,parent){var that=this,type=toString.call(object);if(null!=object&&("[object Object]"===type||"[object Array]"===type)){var isObservableArray=object instanceof ObservableArray,isDataSource=object instanceof DataSource;"[object Object]"!==type||isDataSource||isObservableArray?("[object Array]"===type||isObservableArray||isDataSource)&&(isObservableArray||isDataSource||(object=new ObservableArray(object)),object.parent()!=parent()&&object.bind(CHANGE,eventHandler(that,CHANGE,field,!1))):(object instanceof ObservableObject||(object=new ObservableObject(object)),object.parent()!=parent()&&(object.bind(GET,eventHandler(that,GET,field,!0)),object.bind(CHANGE,eventHandler(that,CHANGE,field,!0)))),object.parent=parent}return object}}),parsers={number:function(value){return kendo.parseFloat(value)},date:function(value){return kendo.parseDate(value)},"boolean":function(value){return typeof value===STRING?"true"===value.toLowerCase():null!=value?!!value:value},string:function(value){return null!=value?value+"":value},"default":function(value){return value}},defaultValues={string:"",number:0,date:new Date,"boolean":!1,"default":""},Model=ObservableObject.extend({init:function(data){var that=this;data&&!$.isEmptyObject(data)||(data=$.extend({},that.defaults,data)),ObservableObject.fn.init.call(that,data),that.dirty=!1,that.idField&&(that.id=that.get(that.idField),that.id===undefined&&(that.id=that._defaultId))},shouldSerialize:function(field){return ObservableObject.fn.shouldSerialize.call(this,field)&&"uid"!==field&&!("id"!==this.idField&&"id"===field)&&"dirty"!==field&&"_accessors"!==field},_parse:function(field,value){var parse,that=this,fieldName=field,fields=that.fields||{};return field=fields[field],field||(field=getFieldByName(fields,fieldName)),field&&(parse=field.parse,!parse&&field.type&&(parse=parsers[field.type.toLowerCase()])),parse?parse(value):value},_notifyChange:function(e){var action=e.action;"add"!=action&&"remove"!=action||(this.dirty=!0)},editable:function(field){return field=(this.fields||{})[field],!field||field.editable!==!1},set:function(field,value,initiator){var that=this;that.editable(field)&&(value=that._parse(field,value),equal(value,that.get(field))||(that.dirty=!0,ObservableObject.fn.set.call(that,field,value,initiator)))},accept:function(data){var field,that=this,parent=function(){return that};for(field in data){var value=data[field];"_"!=field.charAt(0)&&(value=that.wrap(data[field],field,parent)),that._set(field,value)}that.idField&&(that.id=that.get(that.idField)),that.dirty=!1},isNew:function(){return this.id===this._defaultId}});Model.define=function(base,options){options===undefined&&(options=base,base=Model);var model,name,field,type,value,idx,length,originalName,proto=extend({defaults:{}},options),fields={},id=proto.id;if(id&&(proto.idField=id),proto.id&&delete proto.id,id&&(proto.defaults[id]=proto._defaultId=""),"[object Array]"===toString.call(proto.fields)){for(idx=0,length=proto.fields.length;idx<length;idx++)field=proto.fields[idx],typeof field===STRING?fields[field]={}:field.field&&(fields[field.field]=field);proto.fields=fields}for(name in proto.fields)field=proto.fields[name],type=field.type||"default",value=null,originalName=name,name=typeof field.field===STRING?field.field:name,field.nullable||(value=proto.defaults[originalName!==name?originalName:name]=field.defaultValue!==undefined?field.defaultValue:defaultValues[type.toLowerCase()]),options.id===name&&(proto._defaultId=value),proto.defaults[originalName!==name?originalName:name]=value,field.parse=field.parse||parsers[type];return model=base.extend(proto),model.define=function(options){return Model.define(model,options)},proto.fields&&(model.fields=proto.fields,model.idField=proto.idField),model};var Comparer={selector:function(field){return isFunction(field)?field:getter(field)},compare:function(field){var selector=this.selector(field);return function(a,b){return a=selector(a),b=selector(b),null==a&&null==b?0:null==a?-1:null==b?1:a.localeCompare?a.localeCompare(b):a>b?1:a<b?-1:0}},create:function(sort){var compare=sort.compare||this.compare(sort.field);return"desc"==sort.dir?function(a,b){return compare(b,a,!0)}:compare},combine:function(comparers){return function(a,b){var idx,length,result=comparers[0](a,b);for(idx=1,length=comparers.length;idx<length;idx++)result=result||comparers[idx](a,b);return result}}},StableComparer=extend({},Comparer,{asc:function(field){var selector=this.selector(field);return function(a,b){var valueA=selector(a),valueB=selector(b);return valueA&&valueA.getTime&&valueB&&valueB.getTime&&(valueA=valueA.getTime(),valueB=valueB.getTime()),valueA===valueB?a.__position-b.__position:null==valueA?-1:null==valueB?1:valueA.localeCompare?valueA.localeCompare(valueB):valueA>valueB?1:-1}},desc:function(field){var selector=this.selector(field);return function(a,b){var valueA=selector(a),valueB=selector(b);return valueA&&valueA.getTime&&valueB&&valueB.getTime&&(valueA=valueA.getTime(),valueB=valueB.getTime()),valueA===valueB?a.__position-b.__position:null==valueA?1:null==valueB?-1:valueB.localeCompare?valueB.localeCompare(valueA):valueA<valueB?1:-1}},create:function(sort){return this[sort.dir](sort.field)}});map=function(array,callback){var idx,length=array.length,result=new Array(length);for(idx=0;idx<length;idx++)result[idx]=callback(array[idx],idx,array);return result};var operators=function(){function quote(value){return value.replace(quoteRegExp,"\\").replace(newLineRegExp,"")}function operator(op,a,b,ignore){var date;return null!=b&&(typeof b===STRING&&(b=quote(b),date=dateRegExp.exec(b),date?b=new Date((+date[1])):ignore?(b="'"+b.toLowerCase()+"'",a="("+a+" || '').toLowerCase()"):b="'"+b+"'"),b.getTime&&(a="("+a+"?"+a+".getTime():"+a+")",b=b.getTime())),a+" "+op+" "+b}return{eq:function(a,b,ignore){return operator("==",a,b,ignore)},neq:function(a,b,ignore){return operator("!=",a,b,ignore)},gt:function(a,b,ignore){return operator(">",a,b,ignore)},gte:function(a,b,ignore){return operator(">=",a,b,ignore)},lt:function(a,b,ignore){return operator("<",a,b,ignore)},lte:function(a,b,ignore){return operator("<=",a,b,ignore)},startswith:function(a,b,ignore){return ignore&&(a="("+a+" || '').toLowerCase()",b&&(b=b.toLowerCase())),b&&(b=quote(b)),a+".lastIndexOf('"+b+"', 0) == 0"},endswith:function(a,b,ignore){return ignore&&(a="("+a+" || '').toLowerCase()",b&&(b=b.toLowerCase())),b&&(b=quote(b)),a+".indexOf('"+b+"', "+a+".length - "+(b||"").length+") >= 0"},contains:function(a,b,ignore){return ignore&&(a="("+a+" || '').toLowerCase()",b&&(b=b.toLowerCase())),b&&(b=quote(b)),a+".indexOf('"+b+"') >= 0"},doesnotcontain:function(a,b,ignore){return ignore&&(a="("+a+" || '').toLowerCase()",b&&(b=b.toLowerCase())),b&&(b=quote(b)),a+".indexOf('"+b+"') == -1"}}}();Query.filterExpr=function(expression){var idx,length,filter,expr,field,operator,expressions=[],logic={and:" && ",or:" || "},fieldFunctions=[],operatorFunctions=[],filters=expression.filters;for(idx=0,length=filters.length;idx<length;idx++)filter=filters[idx],field=filter.field,operator=filter.operator,filter.filters?(expr=Query.filterExpr(filter),filter=expr.expression.replace(/__o\[(\d+)\]/g,function(match,index){return index=+index,"__o["+(operatorFunctions.length+index)+"]"}).replace(/__f\[(\d+)\]/g,function(match,index){return index=+index,"__f["+(fieldFunctions.length+index)+"]"}),operatorFunctions.push.apply(operatorFunctions,expr.operators),fieldFunctions.push.apply(fieldFunctions,expr.fields)):(typeof field===FUNCTION?(expr="__f["+fieldFunctions.length+"](d)",fieldFunctions.push(field)):expr=kendo.expr(field),typeof operator===FUNCTION?(filter="__o["+operatorFunctions.length+"]("+expr+", "+filter.value+")",operatorFunctions.push(operator)):filter=operators[(operator||"eq").toLowerCase()](expr,filter.value,filter.ignoreCase===undefined||filter.ignoreCase)),expressions.push(filter);return{expression:"("+expressions.join(logic[expression.logic])+")",fields:fieldFunctions,operators:operatorFunctions}};var operatorMap={"==":"eq",equals:"eq",isequalto:"eq",equalto:"eq",equal:"eq","!=":"neq",ne:"neq",notequals:"neq",isnotequalto:"neq",notequalto:"neq",notequal:"neq","<":"lt",islessthan:"lt",lessthan:"lt",less:"lt","<=":"lte",le:"lte",islessthanorequalto:"lte",lessthanequal:"lte",">":"gt",isgreaterthan:"gt",greaterthan:"gt",greater:"gt",">=":"gte",isgreaterthanorequalto:"gte",greaterthanequal:"gte",ge:"gte",notsubstringof:"doesnotcontain"};Query.normalizeFilter=normalizeFilter,Query.prototype={toArray:function(){return this.data},range:function(index,count){return new Query(this.data.slice(index,index+count))},skip:function(count){return new Query(this.data.slice(count))},take:function(count){return new Query(this.data.slice(0,count))},select:function(selector){return new Query(map(this.data,selector))},order:function(selector,dir){var sort={dir:dir};return selector&&(selector.compare?sort.compare=selector.compare:sort.field=selector),new Query(this.data.slice(0).sort(Comparer.create(sort)))},orderBy:function(selector){return this.order(selector,"asc")},orderByDescending:function(selector){return this.order(selector,"desc")},sort:function(field,dir,comparer){var idx,length,descriptors=normalizeSort(field,dir),comparers=[];if(comparer=comparer||Comparer,descriptors.length){for(idx=0,length=descriptors.length;idx<length;idx++)comparers.push(comparer.create(descriptors[idx]));return this.orderBy({compare:comparer.combine(comparers)})}return this},filter:function(expressions){var idx,current,length,compiled,predicate,fields,operators,filter,data=this.data,result=[];if(expressions=normalizeFilter(expressions),!expressions||0===expressions.filters.length)return this;for(compiled=Query.filterExpr(expressions),fields=compiled.fields,operators=compiled.operators,predicate=filter=new Function("d, __f, __o","return "+compiled.expression),(fields.length||operators.length)&&(filter=function(d){return predicate(d,fields,operators)}),idx=0,length=data.length;idx<length;idx++)current=data[idx],filter(current)&&result.push(current);return new Query(result)},group:function(descriptors,allData){descriptors=normalizeGroup(descriptors||[]),allData=allData||this.data;var descriptor,that=this,result=new Query(that.data);return descriptors.length>0&&(descriptor=descriptors[0],result=result.groupBy(descriptor).select(function(group){var data=new Query(allData).filter([{field:group.field,operator:"eq",value:group.value,ignoreCase:!1}]);return{field:group.field,value:group.value,items:descriptors.length>1?new Query(group.items).group(descriptors.slice(1),data.toArray()).toArray():group.items,hasSubgroups:descriptors.length>1,aggregates:data.aggregate(descriptor.aggregates)}})),result},groupBy:function(descriptor){if(isEmptyObject(descriptor)||!this.data.length)return new Query([]);var item,currentValue,idx,len,field=descriptor.field,sorted=this._sortForGrouping(field,descriptor.dir||"asc"),accessor=kendo.accessor(field),groupValue=accessor.get(sorted[0],field),group={field:field,value:groupValue,items:[]},result=[group];for(idx=0,len=sorted.length;idx<len;idx++)item=sorted[idx],currentValue=accessor.get(item,field),groupValueComparer(groupValue,currentValue)||(groupValue=currentValue,group={field:field,value:groupValue,items:[]},result.push(group)),group.items.push(item);return new Query(result)},_sortForGrouping:function(field,dir){var idx,length,data=this.data;if(!stableSort){for(idx=0,length=data.length;idx<length;idx++)data[idx].__position=idx;for(data=new Query(data).sort(field,dir,StableComparer).toArray(),idx=0,length=data.length;idx<length;idx++)delete data[idx].__position;return data}return this.sort(field,dir).toArray()},aggregate:function(aggregates){var idx,len,result={},state={};if(aggregates&&aggregates.length)for(idx=0,len=this.data.length;idx<len;idx++)calculateAggregate(result,aggregates,this.data[idx],idx,len,state);return result}};var functions={sum:function(accumulator,item,accessor){var value=accessor.get(item);return isNumber(accumulator)?isNumber(value)&&(accumulator+=value):accumulator=value,accumulator},count:function(accumulator){return(accumulator||0)+1},average:function(accumulator,item,accessor,index,length,state){var value=accessor.get(item);return state.count===undefined&&(state.count=0),isNumber(accumulator)?isNumber(value)&&(accumulator+=value):accumulator=value,isNumber(value)&&state.count++,index==length-1&&isNumber(accumulator)&&(accumulator/=state.count),accumulator},max:function(accumulator,item,accessor){var value=accessor.get(item);return isNumber(accumulator)||isDate(accumulator)||(accumulator=value),accumulator<value&&(isNumber(value)||isDate(value))&&(accumulator=value),accumulator},min:function(accumulator,item,accessor){var value=accessor.get(item);return isNumber(accumulator)||isDate(accumulator)||(accumulator=value),accumulator>value&&(isNumber(value)||isDate(value))&&(accumulator=value),accumulator}};Query.process=function(data,options){options=options||{};var total,query=new Query(data),group=options.group,sort=normalizeGroup(group||[]).concat(normalizeSort(options.sort||[])),filter=options.filter,skip=options.skip,take=options.take;return filter&&(query=query.filter(filter),total=query.toArray().length),sort&&(query=query.sort(sort),group&&(data=query.toArray())),skip!==undefined&&take!==undefined&&(query=query.range(skip,take)),group&&(query=query.group(group,data)),{total:total,data:query.toArray()}};var LocalTransport=Class.extend({init:function(options){this.data=options.data},read:function(options){options.success(this.data)},update:function(options){options.success(options.data)},create:function(options){options.success(options.data)},destroy:function(options){options.success(options.data)}}),RemoteTransport=Class.extend({init:function(options){var parameterMap,that=this;options=that.options=extend({},that.options,options),each(crud,function(index,type){typeof options[type]===STRING&&(options[type]={url:options[type]})}),that.cache=options.cache?Cache.create(options.cache):{find:noop,add:noop},parameterMap=options.parameterMap,isFunction(options.push)&&(that.push=options.push),that.push||(that.push=identity),that.parameterMap=isFunction(parameterMap)?parameterMap:function(options){var result={};return each(options,function(option,value){option in parameterMap&&(option=parameterMap[option],isPlainObject(option)&&(value=option.value(value),option=option.key)),result[option]=value}),result}},options:{parameterMap:identity},create:function(options){return ajax(this.setup(options,CREATE))},read:function(options){var success,error,result,that=this,cache=that.cache;options=that.setup(options,READ),success=options.success||noop,error=options.error||noop,result=cache.find(options.data),result!==undefined?success(result):(options.success=function(result){cache.add(options.data,result),success(result)},$.ajax(options))},update:function(options){return ajax(this.setup(options,UPDATE))},destroy:function(options){return ajax(this.setup(options,DESTROY))},setup:function(options,type){options=options||{};var parameters,that=this,operation=that.options[type],data=isFunction(operation.data)?operation.data(options.data):operation.data;return options=extend(!0,{},operation,options),parameters=extend(!0,{},data,options.data),options.data=that.parameterMap(parameters,type),isFunction(options.url)&&(options.url=options.url(parameters)),options}}),Cache=Class.extend({init:function(){this._store={}},add:function(key,data){key!==undefined&&(this._store[stringify(key)]=data)},find:function(key){return this._store[stringify(key)]},clear:function(){this._store={}},remove:function(key){delete this._store[stringify(key)]}});Cache.create=function(options){var store={inmemory:function(){return new Cache}};return isPlainObject(options)&&isFunction(options.find)?options:options===!0?new Cache:store[options]()};var DataReader=Class.extend({init:function(schema){var member,get,model,base,that=this;schema=schema||{};for(member in schema)get=schema[member],that[member]=typeof get===STRING?getter(get):get;if(base=schema.modelBase||Model,isPlainObject(that.model)&&(that.model=model=base.define(that.model)),that.model){var fieldName,dataFunction=proxy(that.data,that),groupsFunction=proxy(that.groups,that),serializeFunction=proxy(that.serialize,that),originalFieldNames={},getters={},serializeGetters={},fieldNames={},shouldSerialize=!1;model=that.model,model.fields&&(each(model.fields,function(field,value){var fromName;fieldName=field,isPlainObject(value)&&value.field?fieldName=value.field:typeof value===STRING&&(fieldName=value),isPlainObject(value)&&value.from&&(fromName=value.from),shouldSerialize=shouldSerialize||fromName&&fromName!==field||fieldName!==field,getters[field]=getter(fromName||fieldName),serializeGetters[field]=getter(field),originalFieldNames[fromName||fieldName]=field,fieldNames[field]=fromName||fieldName}),!schema.serialize&&shouldSerialize&&(that.serialize=wrapDataAccess(serializeFunction,model,serializeRecords,serializeGetters,originalFieldNames,fieldNames))),that._dataAccessFunction=dataFunction,that.data=wrapDataAccess(dataFunction,model,convertRecords,getters,originalFieldNames,fieldNames),that.groups=wrapDataAccess(groupsFunction,model,convertGroup,getters,originalFieldNames,fieldNames)}},errors:function(data){return data?data.errors:null},parse:identity,data:identity,total:function(data){return data.length},groups:identity,aggregates:function(){return{}},serialize:function(data){return data}}),DataSource=Observable.extend({init:function(options){var model,data,that=this;options&&(data=options.data),options=that.options=extend({},that.options,options),that._map={},that._prefetch={},that._data=[],that._pristineData=[],that._ranges=[],that._view=[],that._pristineTotal=0,that._destroyed=[],that._pageSize=options.pageSize,that._page=options.page||(options.pageSize?1:undefined),that._sort=normalizeSort(options.sort),that._filter=normalizeFilter(options.filter),that._group=normalizeGroup(options.group),that._aggregate=options.aggregate,that._total=options.total,Observable.fn.init.call(that),that.transport=Transport.create(options,data),isFunction(that.transport.push)&&that.transport.push({pushCreate:proxy(that._pushCreate,that),pushUpdate:proxy(that._pushUpdate,that),pushDestroy:proxy(that._pushDestroy,that)}),that.reader=new kendo.data.readers[options.schema.type||"json"](options.schema),model=that.reader.model||{},that._data=that._observe(that._data),that.bind(["push",ERROR,CHANGE,REQUESTSTART,SYNC,REQUESTEND,PROGRESS],options)},options:{data:[],schema:{modelBase:Model},serverSorting:!1,serverPaging:!1,serverFiltering:!1,serverGrouping:!1,serverAggregates:!1,batch:!1},_isServerGrouped:function(){var group=this.group()||[];return this.options.serverGrouping&&group.length},_pushCreate:function(result){this._push(result,"pushCreate")},_pushUpdate:function(result){this._push(result,"pushUpdate")},_pushDestroy:function(result){this._push(result,"pushDestroy")},_push:function(result,operation){var data=this._readData(result);data||(data=result),this[operation](data)},_flatData:function(data){return this._isServerGrouped()?flattenGroups(data):data},parent:noop,get:function(id){var idx,length,data=this._flatData(this._data);for(idx=0,length=data.length;idx<length;idx++)if(data[idx].id==id)return data[idx]},getByUid:function(id){var idx,length,data=this._flatData(this._data);if(data)for(idx=0,length=data.length;idx<length;idx++)if(data[idx].uid==id)return data[idx]},indexOf:function(model){return indexOfModel(this._data,model)},at:function(index){return this._data[index]},data:function(value){var that=this;return value===undefined?that._data:(that._data=this._observe(value),that._pristineData=value.slice(0),that._ranges=[],that._addRange(that._data),that._total=that._data.length,that._pristineTotal=that._total,that._process(that._data),void 0)},view:function(){return this._view},add:function(model){return this.insert(this._data.length,model)},_createNewModel:function(model){return this.reader.model?new this.reader.model(model):new ObservableObject(model)},insert:function(index,model){return model||(model=index,index=0),model instanceof Model||(model=this._createNewModel(model)),this._isServerGrouped()?this._data.splice(index,0,wrapInEmptyGroup(this.group(),model)):this._data.splice(index,0,model),model},pushCreate:function(items){isArray(items)||(items=[items]);var pushed=[],autoSync=this.options.autoSync;this.options.autoSync=!1;try{for(var idx=0;idx<items.length;idx++){var item=items[idx],result=this.add(item);pushed.push(result);var pristine=result.toJSON();this._isServerGrouped()&&(pristine=wrapInEmptyGroup(this.group(),pristine)),this._pristineData.push(pristine)}}finally{this.options.autoSync=autoSync}pushed.length&&this.trigger("push",{type:"create",items:pushed})},pushUpdate:function(items){isArray(items)||(items=[items]);for(var pushed=[],idx=0;idx<items.length;idx++){var item=items[idx],model=this._createNewModel(item),target=this.get(model.id);target?(pushed.push(target),target.accept(item),target.trigger("change"),this._updatePristineForModel(target,item)):this.pushCreate(item)}pushed.length&&this.trigger("push",{type:"update",items:pushed})},pushDestroy:function(items){isArray(items)||(items=[items]);var pushed=[],autoSync=this.options.autoSync;this.options.autoSync=!1;try{for(var idx=0;idx<items.length;idx++){var item=items[idx],model=this._createNewModel(item),found=!1;this._eachItem(this._data,function(items){for(var idx=0;idx<items.length;idx++)if(items[idx].id===model.id){pushed.push(items[idx]),items.splice(idx,1),found=!0;break}}),found&&(this._removePristineForModel(model),this._destroyed.pop())}}finally{this.options.autoSync=autoSync}pushed.length&&this.trigger("push",{type:"destroy",items:pushed})},remove:function(model){var result,that=this,hasGroups=that._isServerGrouped();return this._eachItem(that._data,function(items){if(result=removeModel(items,model),result&&hasGroups)return result.isNew&&result.isNew()||that._destroyed.push(result),!0}),this._removeModelFromRanges(model),this._updateRangesLength(),model},sync:function(){var idx,length,that=this,created=[],updated=[],destroyed=that._destroyed,data=that._flatData(that._data);if(that.reader.model){for(idx=0,length=data.length;idx<length;idx++)data[idx].isNew()?created.push(data[idx]):data[idx].dirty&&updated.push(data[idx]);var promises=that._send("create",created);promises.push.apply(promises,that._send("update",updated)),promises.push.apply(promises,that._send("destroy",destroyed)),$.when.apply(null,promises).then(function(){var idx,length;for(idx=0,length=arguments.length;idx<length;idx++)that._accept(arguments[idx]);that._change({action:"sync"}),that.trigger(SYNC)})}},cancelChanges:function(model){var that=this;model instanceof kendo.data.Model?that._cancelModel(model):(that._destroyed=[],that._data=that._observe(that._pristineData),that.options.serverPaging&&(that._total=that._pristineTotal),that._change())},hasChanges:function(){var idx,length,data=this._data;if(this._destroyed.length)return!0;for(idx=0,length=data.length;idx<length;idx++)if(data[idx].isNew()||data[idx].dirty)return!0;return!1},_accept:function(result){var length,that=this,models=result.models,response=result.response,idx=0,serverGroup=that._isServerGrouped(),pristine=that._pristineData,type=result.type;if(that.trigger(REQUESTEND,{response:response,type:type}),response&&!isEmptyObject(response)){if(response=that.reader.parse(response),that._handleCustomErrors(response))return;response=that.reader.data(response),isArray(response)||(response=[response])}else response=$.map(models,function(model){return model.toJSON()});for("destroy"===type&&(that._destroyed=[]),idx=0,length=models.length;idx<length;idx++)"destroy"!==type?(models[idx].accept(response[idx]),"create"===type?pristine.push(serverGroup?wrapInEmptyGroup(that.group(),models[idx]):response[idx]):"update"===type&&that._updatePristineForModel(models[idx],response[idx])):that._removePristineForModel(models[idx])},_updatePristineForModel:function(model,values){this._executeOnPristineForModel(model,function(index,items){kendo.deepExtend(items[index],values)})},_executeOnPristineForModel:function(model,callback){this._eachPristineItem(function(items){var index=indexOfPristineModel(items,model);if(index>-1)return callback(index,items),!0})},_removePristineForModel:function(model){this._executeOnPristineForModel(model,function(index,items){items.splice(index,1)})},_readData:function(data){var read=this._isServerGrouped()?this.reader.groups:this.reader.data;return read(data)},_eachPristineItem:function(callback){this._eachItem(this._pristineData,callback)},_eachItem:function(data,callback){data&&data.length&&(this._isServerGrouped()?eachGroupItems(data,callback):callback(data))},_pristineForModel:function(model){var pristine,idx,callback=function(items){if(idx=indexOfPristineModel(items,model),idx>-1)return pristine=items[idx],!0};return this._eachPristineItem(callback),pristine},_cancelModel:function(model){var idx,pristine=this._pristineForModel(model);this._eachItem(this._data,function(items){idx=indexOfModel(items,model),idx!=-1&&(!model.isNew()&&pristine?items[idx].accept(pristine):items.splice(idx,1))})},_promise:function(data,models,type){var that=this,transport=that.transport;return $.Deferred(function(deferred){that.trigger(REQUESTSTART,{type:type}),transport[type].call(transport,extend({success:function(response){deferred.resolve({response:response,models:models,type:type})},error:function(response,status,error){deferred.reject(response),that.error(response,status,error)}},data))}).promise()},_send:function(method,data){var idx,length,that=this,promises=[],converted=that.reader.serialize(toJSON(data));if(that.options.batch)data.length&&promises.push(that._promise({data:{models:converted}},data,method));else for(idx=0,length=data.length;idx<length;idx++)promises.push(that._promise({data:converted[idx]},[data[idx]],method));return promises},read:function(data){var that=this,params=that._params(data);that._queueRequest(params,function(){that.trigger(REQUESTSTART,{type:"read"})?that._dequeueRequest():(that.trigger(PROGRESS),that._ranges=[],that.transport.read({data:params,success:proxy(that.success,that),error:proxy(that.error,that)}))})},success:function(data){var that=this,options=that.options;return that.trigger(REQUESTEND,{response:data,type:"read"}),data=that.reader.parse(data),that._handleCustomErrors(data)?void that._dequeueRequest():(that._total=that.reader.total(data),that._pristineTotal=that._total,that._aggregate&&options.serverAggregates&&(that._aggregateResult=that.reader.aggregates(data)),data=that._readData(data),that._pristineData=data.slice(0),that._data=that._observe(data),that._addRange(that._data),that._process(that._data),void that._dequeueRequest())},_addRange:function(data){var that=this,start=that._skip||0,end=start+that._flatData(data).length;that._ranges.push({start:start,end:end,data:data}),that._ranges.sort(function(x,y){return x.start-y.start})},error:function(xhr,status,errorThrown){this._dequeueRequest(),this.trigger(REQUESTEND,{}),this.trigger(ERROR,{xhr:xhr,status:status,errorThrown:errorThrown})},_params:function(data){var that=this,options=extend({take:that.take(),skip:that.skip(),page:that.page(),pageSize:that.pageSize(),sort:that._sort,filter:that._filter,group:that._group,aggregate:that._aggregate},data);return that.options.serverPaging||(delete options.take,delete options.skip,delete options.page,delete options.pageSize),that.options.serverGrouping?that.reader.model&&options.group&&(options.group=convertDescriptorsField(options.group,that.reader.model)):delete options.group,that.options.serverFiltering?that.reader.model&&options.filter&&(options.filter=convertFilterDescriptorsField(options.filter,that.reader.model)):delete options.filter,that.options.serverSorting?that.reader.model&&options.sort&&(options.sort=convertDescriptorsField(options.sort,that.reader.model)):delete options.sort,that.options.serverAggregates?that.reader.model&&options.aggregate&&(options.aggregate=convertDescriptorsField(options.aggregate,that.reader.model)):delete options.aggregate,options},_queueRequest:function(options,callback){var that=this;that._requestInProgress?that._pending={callback:proxy(callback,that),options:options}:(that._requestInProgress=!0,that._pending=undefined,callback())},_dequeueRequest:function(){var that=this;that._requestInProgress=!1,that._pending&&that._queueRequest(that._pending.options,that._pending.callback)},_handleCustomErrors:function(response){if(this.reader.errors){var errors=this.reader.errors(response);if(errors)return this.trigger(ERROR,{xhr:null,status:"customerror",errorThrown:"custom error",errors:errors}),!0}return!1},_observe:function(data){var that=this,model=that.reader.model,wrap=!1;return model&&data.length&&(wrap=!(data[0]instanceof model)),data instanceof ObservableArray?wrap&&(data.type=that.reader.model,data.wrapAll(data,data)):(data=new ObservableArray(data,that.reader.model),data.parent=function(){return that.parent()}),that._isServerGrouped()&&wrapGroupItems(data,model),that._changeHandler&&that._data&&that._data instanceof ObservableArray?that._data.unbind(CHANGE,that._changeHandler):that._changeHandler=proxy(that._change,that),data.bind(CHANGE,that._changeHandler)},_change:function(e){var idx,length,that=this,action=e?e.action:"";if("remove"===action)for(idx=0,length=e.items.length;idx<length;idx++)e.items[idx].isNew&&e.items[idx].isNew()||that._destroyed.push(e.items[idx]);if(!that.options.autoSync||"add"!==action&&"remove"!==action&&"itemchange"!==action){
var total=parseInt(that._total,10);isNumber(that._total)||(total=parseInt(that._pristineTotal,10)),"add"===action?total+=e.items.length:"remove"===action?total-=e.items.length:"itemchange"===action||"sync"===action||that.options.serverPaging?"sync"===action&&(total=that._pristineTotal=parseInt(that._total,10)):total=that._pristineTotal,that._total=total,that._process(that._data,e)}else that.sync()},_process:function(data,e){var result,that=this,options={};that.options.serverPaging!==!0&&(options.skip=that._skip,options.take=that._take||that._pageSize,options.skip===undefined&&that._page!==undefined&&that._pageSize!==undefined&&(options.skip=(that._page-1)*that._pageSize)),that.options.serverSorting!==!0&&(options.sort=that._sort),that.options.serverFiltering!==!0&&(options.filter=that._filter),that.options.serverGrouping!==!0&&(options.group=that._group),that.options.serverAggregates!==!0&&(options.aggregate=that._aggregate,that._aggregateResult=calculateAggregates(data,options)),result=Query.process(data,options),that._view=result.data,result.total===undefined||that.options.serverFiltering||(that._total=result.total),e=e||{},e.items=e.items||that._view,that.trigger(CHANGE,e)},_mergeState:function(options){var that=this;return options!==undefined&&(that._pageSize=options.pageSize,that._page=options.page,that._sort=options.sort,that._filter=options.filter,that._group=options.group,that._aggregate=options.aggregate,that._skip=options.skip,that._take=options.take,that._skip===undefined&&(that._skip=that.skip(),options.skip=that.skip()),that._take===undefined&&that._pageSize!==undefined&&(that._take=that._pageSize,options.take=that._take),options.sort&&(that._sort=options.sort=normalizeSort(options.sort)),options.filter&&(that._filter=options.filter=normalizeFilter(options.filter)),options.group&&(that._group=options.group=normalizeGroup(options.group)),options.aggregate&&(that._aggregate=options.aggregate=normalizeAggregate(options.aggregate))),options},query:function(options){var result,that=this,remote=that.options.serverSorting||that.options.serverPaging||that.options.serverFiltering||that.options.serverGrouping||that.options.serverAggregates;remote||(that._data===undefined||0===that._data.length)&&!that._destroyed.length?that.read(that._mergeState(options)):that.trigger(REQUESTSTART,{type:"read"})||(that.trigger(PROGRESS),result=Query.process(that._data,that._mergeState(options)),that.options.serverFiltering||(result.total!==undefined?that._total=result.total:that._total=that._data.length),that._view=result.data,that._aggregateResult=calculateAggregates(that._data,options),that.trigger(REQUESTEND,{}),that.trigger(CHANGE,{items:result.data}))},fetch:function(callback){var that=this;return $.Deferred(function(deferred){var success=function(e){that.unbind(ERROR,error),deferred.resolve(),callback&&callback.call(that,e)},error=function(e){deferred.reject(e)};that.one(CHANGE,success),that.one(ERROR,error),that._query()}).promise()},_query:function(options){var that=this;that.query(extend({},{page:that.page(),pageSize:that.pageSize(),sort:that.sort(),filter:that.filter(),group:that.group(),aggregate:that.aggregate()},options))},next:function(options){var that=this,page=that.page(),total=that.total();if(options=options||{},page&&!(total&&page+1>that.totalPages()))return that._skip=page*that.take(),page+=1,options.page=page,that._query(options),page},prev:function(options){var that=this,page=that.page();if(options=options||{},page&&1!==page)return that._skip=that._skip-that.take(),page-=1,options.page=page,that._query(options),page},page:function(val){var skip,that=this;return val!==undefined?(val=math.max(math.min(math.max(val,1),that.totalPages()),1),void that._query({page:val})):(skip=that.skip(),skip!==undefined?math.round((skip||0)/(that.take()||1))+1:undefined)},pageSize:function(val){var that=this;return val!==undefined?void that._query({pageSize:val,page:1}):that.take()},sort:function(val){var that=this;return val!==undefined?void that._query({sort:val}):that._sort},filter:function(val){var that=this;return val===undefined?that._filter:void that._query({filter:val,page:1})},group:function(val){var that=this;return val!==undefined?void that._query({group:val}):that._group},total:function(){return parseInt(this._total||0,10)},aggregate:function(val){var that=this;return val!==undefined?void that._query({aggregate:val}):that._aggregate},aggregates:function(){return this._aggregateResult},totalPages:function(){var that=this,pageSize=that.pageSize()||that.total();return math.ceil((that.total()||0)/pageSize)},inRange:function(skip,take){var that=this,end=math.min(skip+take,that.total());return!that.options.serverPaging&&that._data.length>0||that._findRange(skip,end).length>0},lastRange:function(){var ranges=this._ranges;return ranges[ranges.length-1]||{start:0,end:0,data:[]}},firstItemUid:function(){var ranges=this._ranges;return ranges.length&&ranges[0].data.length&&ranges[0].data[0].uid},range:function(skip,take){skip=math.min(skip||0,this.total());var data,that=this,pageSkip=math.max(math.floor(skip/take),0)*take,size=math.min(pageSkip+take,that.total());if(that._skipRequestsInProgress=!1,data=that._findRange(skip,math.min(skip+take,that.total())),data.length){that._requestInProgress&&(that._skipRequestsInProgress=!0),that._skip=skip>that.skip()?math.min(size,(that.totalPages()-1)*that.take()):pageSkip,that._take=take;var paging=that.options.serverPaging,sorting=that.options.serverSorting,filtering=that.options.serverFiltering,aggregates=that.options.serverAggregates;try{that.options.serverPaging=!0,that._isServerGrouped()||that.group()&&that.group().length||(that.options.serverSorting=!0),that.options.serverFiltering=!0,that.options.serverPaging=!0,that.options.serverAggregates=!0,paging&&(that._data=data=that._observe(data)),that._process(data)}finally{that.options.serverPaging=paging,that.options.serverSorting=sorting,that.options.serverFiltering=filtering,that.options.serverAggregates=aggregates}}else take!==undefined&&(that._rangeExists(pageSkip,size)?pageSkip<skip&&that.prefetch(size,take,function(){that.range(skip,take)}):that.prefetch(pageSkip,take,function(){skip>pageSkip&&size<that.total()&&!that._rangeExists(size,math.min(size+take,that.total()))?that.prefetch(size,take,function(){that.range(skip,take)}):that.range(skip,take)}))},_findRange:function(start,end){var range,skipIdx,takeIdx,startIndex,endIndex,rangeData,rangeEnd,processed,flatData,count,length,that=this,ranges=that._ranges,data=[],options=that.options,remote=options.serverSorting||options.serverPaging||options.serverFiltering||options.serverGrouping||options.serverAggregates;for(skipIdx=0,length=ranges.length;skipIdx<length;skipIdx++)if(range=ranges[skipIdx],start>=range.start&&start<=range.end){for(count=0,takeIdx=skipIdx;takeIdx<length;takeIdx++)if(range=ranges[takeIdx],flatData=that._flatData(range.data),flatData.length&&start+count>=range.start){if(rangeData=range.data,rangeEnd=range.end,!remote){var sort=normalizeGroup(that.group()||[]).concat(normalizeSort(that.sort()||[]));processed=Query.process(range.data,{sort:sort,filter:that.filter()}),flatData=rangeData=processed.data,processed.total!==undefined&&(rangeEnd=processed.total)}if(startIndex=0,start+count>range.start&&(startIndex=start+count-range.start),endIndex=flatData.length,rangeEnd>end&&(endIndex-=rangeEnd-end),count+=endIndex-startIndex,data=that._mergeGroups(data,rangeData,startIndex,endIndex),end<=range.end&&count==end-start)return data}break}return[]},_mergeGroups:function(data,range,skip,take){if(this._isServerGrouped()){var prevGroup,temp=range.toJSON();return data.length&&(prevGroup=data[data.length-1]),mergeGroups(prevGroup,temp,skip,take),data.concat(temp)}return data.concat(range.slice(skip,take))},skip:function(){var that=this;return that._skip===undefined?that._page!==undefined?(that._page-1)*(that.take()||1):undefined:that._skip},take:function(){return this._take||this._pageSize},_prefetchSuccessHandler:function(skip,size,callback){var that=this;return function(data){var idx,length,temp,found=!1,range={start:skip,end:size,data:[]};if(that._dequeueRequest(),that.trigger(REQUESTEND,{response:data,type:"read"}),data=that.reader.parse(data),temp=that._readData(data),temp.length){for(idx=0,length=that._ranges.length;idx<length;idx++)if(that._ranges[idx].start===skip){found=!0,range=that._ranges[idx];break}found||that._ranges.push(range)}range.data=that._observe(temp),range.end=range.start+that._flatData(range.data).length,that._ranges.sort(function(x,y){return x.start-y.start}),that._total=that.reader.total(data),that._skipRequestsInProgress||(callback&&temp.length?callback():that.trigger(CHANGE,{}))}},prefetch:function(skip,take,callback){var that=this,size=math.min(skip+take,that.total()),options={take:take,skip:skip,page:skip/take+1,pageSize:take,sort:that._sort,filter:that._filter,group:that._group,aggregate:that._aggregate};that._rangeExists(skip,size)?callback&&callback():(clearTimeout(that._timeout),that._timeout=setTimeout(function(){that._queueRequest(options,function(){that.trigger(REQUESTSTART,{type:"read"})?that._dequeueRequest():that.transport.read({data:that._params(options),success:that._prefetchSuccessHandler(skip,size,callback)})})},100))},_rangeExists:function(start,end){var idx,length,that=this,ranges=that._ranges;for(idx=0,length=ranges.length;idx<length;idx++)if(ranges[idx].start<=start&&ranges[idx].end>=end)return!0;return!1},_removeModelFromRanges:function(model){for(var result,found,range,idx=0,length=this._ranges.length;idx<length&&(range=this._ranges[idx],this._eachItem(range.data,function(items){result=removeModel(items,model),result&&(found=!0)}),!found);idx++);},_updateRangesLength:function(){for(var range,rangeLength,startOffset=0,idx=0,length=this._ranges.length;idx<length;idx++)range=this._ranges[idx],range.start=range.start-startOffset,rangeLength=this._flatData(range.data).length,startOffset=range.end-rangeLength,range.end=range.start+rangeLength}}),Transport={};Transport.create=function(options,data){var transport,transportOptions=options.transport;return transportOptions?(transportOptions.read=typeof transportOptions.read===STRING?{url:transportOptions.read}:transportOptions.read,options.type&&(kendo.data.transports[options.type]&&!isPlainObject(kendo.data.transports[options.type])?transport=new kendo.data.transports[options.type](extend(transportOptions,{data:data})):transportOptions=extend(!0,{},kendo.data.transports[options.type],transportOptions),options.schema=extend(!0,{},kendo.data.schemas[options.type],options.schema)),transport||(transport=isFunction(transportOptions.read)?transportOptions:new RemoteTransport(transportOptions))):transport=new LocalTransport({data:options.data}),transport},DataSource.create=function(options){(isArray(options)||options instanceof ObservableArray)&&(options={data:options});var idx,length,field,dataSource=options||{},data=dataSource.data,fields=dataSource.fields,table=dataSource.table,select=dataSource.select,model={};if(data||!fields||dataSource.transport||(table?data=inferTable(table,fields):select&&(data=inferSelect(select,fields))),kendo.data.Model&&fields&&(!dataSource.schema||!dataSource.schema.model)){for(idx=0,length=fields.length;idx<length;idx++)field=fields[idx],field.type&&(model[field.field]=field);isEmptyObject(model)||(dataSource.schema=extend(!0,dataSource.schema,{model:{fields:model}}))}return dataSource.data=data,table=null,dataSource.table=null,dataSource instanceof DataSource?dataSource:new DataSource(dataSource)};var Node=Model.define({init:function(value){var that=this,hasChildren=that.hasChildren||value&&value.hasChildren,childrenField="items",childrenOptions={};kendo.data.Model.fn.init.call(that,value),typeof that.children===STRING&&(childrenField=that.children),childrenOptions={schema:{data:childrenField,model:{hasChildren:hasChildren,id:that.idField,fields:that.fields}}},typeof that.children!==STRING&&extend(childrenOptions,that.children),childrenOptions.data=value,hasChildren||(hasChildren=childrenOptions.schema.data),typeof hasChildren===STRING&&(hasChildren=kendo.getter(hasChildren)),isFunction(hasChildren)&&(that.hasChildren=!!hasChildren.call(that,that)),that._childrenOptions=childrenOptions,that.hasChildren&&that._initChildren(),that._loaded=!(!value||!value[childrenField]&&!value._loaded)},_initChildren:function(){var children,transport,parameterMap,that=this;that.children instanceof HierarchicalDataSource||(children=that.children=new HierarchicalDataSource(that._childrenOptions),transport=children.transport,parameterMap=transport.parameterMap,transport.parameterMap=function(data,type){return data[that.idField||"id"]=that.id,parameterMap&&(data=parameterMap(data,type)),data},children.parent=function(){return that},children.bind(CHANGE,function(e){e.node=e.node||that,that.trigger(CHANGE,e)}),children.bind(ERROR,function(e){var collection=that.parent();collection&&(e.node=e.node||that,collection.trigger(ERROR,e))}),that._updateChildrenField())},append:function(model){this._initChildren(),this.loaded(!0),this.children.add(model)},hasChildren:!1,level:function(){for(var parentNode=this.parentNode(),level=0;parentNode&&parentNode.parentNode;)level++,parentNode=parentNode.parentNode?parentNode.parentNode():null;return level},_updateChildrenField:function(){var fieldName=this._childrenOptions.schema.data;this[fieldName||"items"]=this.children.data()},_childrenLoaded:function(){this._loaded=!0,this._updateChildrenField()},load:function(){var children,options={},method="_query";this.hasChildren?(this._initChildren(),children=this.children,options[this.idField||"id"]=this.id,this._loaded||(children._data=undefined,method="read"),children.one(CHANGE,proxy(this._childrenLoaded,this)),children[method](options)):this.loaded(!0)},parentNode:function(){var array=this.parent();return array.parent()},loaded:function(value){return value===undefined?this._loaded:void(this._loaded=value)},shouldSerialize:function(field){return Model.fn.shouldSerialize.call(this,field)&&"children"!==field&&"_loaded"!==field&&"hasChildren"!==field&&"_childrenOptions"!==field}}),HierarchicalDataSource=DataSource.extend({init:function(options){var node=Node.define({children:options});DataSource.fn.init.call(this,extend(!0,{},{schema:{modelBase:node,model:node}},options)),this._attachBubbleHandlers()},_attachBubbleHandlers:function(){var that=this;that._data.bind(ERROR,function(e){that.trigger(ERROR,e)})},remove:function(node){var result,parentNode=node.parentNode(),dataSource=this;return parentNode&&parentNode._initChildren&&(dataSource=parentNode.children),result=DataSource.fn.remove.call(dataSource,node),parentNode&&!dataSource.data().length&&(parentNode.hasChildren=!1),result},success:dataMethod("success"),data:dataMethod("data"),insert:function(index,model){var parentNode=this.parent();return parentNode&&parentNode._initChildren&&(parentNode.hasChildren=!0,parentNode._initChildren()),DataSource.fn.insert.call(this,index,model)},_find:function(method,value){var idx,length,node,data,children;if(node=DataSource.fn[method].call(this,value))return node;if(data=this._flatData(this.data()))for(idx=0,length=data.length;idx<length;idx++)if(children=data[idx].children,children instanceof HierarchicalDataSource&&(node=children[method](value)))return node},get:function(id){return this._find("get",id)},getByUid:function(uid){return this._find("getByUid",uid)}});HierarchicalDataSource.create=function(options){options=options&&options.push?{data:options}:options;var dataSource=options||{},data=dataSource.data,fields=dataSource.fields,list=dataSource.list;return data&&data._dataSource?data._dataSource:(data||!fields||dataSource.transport||list&&(data=inferList(list,fields)),dataSource.data=data,dataSource instanceof HierarchicalDataSource?dataSource:new HierarchicalDataSource(dataSource))};var Buffer=kendo.Observable.extend({init:function(dataSource,viewSize,disablePrefetch){kendo.Observable.fn.init.call(this),this._prefetching=!1,this.dataSource=dataSource,this.prefetch=!disablePrefetch;var buffer=this;dataSource.bind("change",function(){buffer._change()}),this._syncWithDataSource(),this.setViewSize(viewSize)},setViewSize:function(viewSize){this.viewSize=viewSize,this._recalculate()},at:function(index){var item,pageSize=this.pageSize;if(index>=this.total())return void this.trigger("endreached",{index:index});if(!this.useRanges)return this.dataSource.view()[index];if(this.useRanges){if(index<this.dataOffset||index>this.skip+pageSize){var offset=Math.floor(index/pageSize)*pageSize;this.range(offset)}index===this.prefetchThreshold&&this._prefetch(),index===this.midPageThreshold?this.range(this.nextMidRange):index===this.nextPageThreshold?this.range(this.nextFullRange):index===this.pullBackThreshold&&(this.offset===this.skip?this.range(this.previousMidRange):this.range(this.previousFullRange)),item=this.dataSource.at(index-this.dataOffset)}return item===undefined&&this.trigger("endreached",{index:index}),item},indexOf:function(item){return this.dataSource.data().indexOf(item)+this.dataOffset},total:function(){return parseInt(this.dataSource.total(),10)},next:function(){var buffer=this,pageSize=buffer.pageSize,offset=buffer.skip-buffer.viewSize,pageSkip=math.max(math.floor(offset/pageSize),0)*pageSize+pageSize;this.offset=offset,this.dataSource.prefetch(pageSkip,pageSize,function(){buffer._goToRange(offset,!0)})},range:function(offset){if(this.offset!==offset){var buffer=this,pageSize=this.pageSize,pageSkip=math.max(math.floor(offset/pageSize),0)*pageSize+pageSize,dataSource=this.dataSource;this.offset=offset,this._recalculate(),dataSource.inRange(offset,pageSize)?this._goToRange(offset):this.prefetch&&dataSource.prefetch(pageSkip,pageSize,function(){buffer._goToRange(offset,!0)})}},syncDataSource:function(){var offset=this.offset;this.offset=null,this.range(offset)},destroy:function(){this.unbind()},_prefetch:function(){var buffer=this,pageSize=this.pageSize,prefetchOffset=this.skip+pageSize,dataSource=this.dataSource;dataSource.inRange(prefetchOffset,pageSize)||this._prefetching||!this.prefetch||(this._prefetching=!0,this.trigger("prefetching",{skip:prefetchOffset,take:pageSize}),dataSource.prefetch(prefetchOffset,pageSize,function(){buffer._prefetching=!1,buffer.trigger("prefetched",{skip:prefetchOffset,take:pageSize})}))},_goToRange:function(offset,expanding){this.offset===offset&&(this.dataOffset=offset,this._expanding=expanding,this.dataSource.range(offset,this.pageSize))},_change:function(){var dataSource=this.dataSource,firstItemUid=dataSource.firstItemUid();this.length=this.useRanges?dataSource.lastRange().end:dataSource.view().length,this._firstItemUid===firstItemUid&&this.useRanges||(this._syncWithDataSource(),this._recalculate(),this.trigger("reset",{offset:this.offset})),this.trigger("resize"),this._expanding&&this.trigger("expand"),delete this._expanding},_syncWithDataSource:function(){var dataSource=this.dataSource;this._firstItemUid=dataSource.firstItemUid(),this.dataOffset=this.offset=dataSource.skip()||0,this.pageSize=dataSource.pageSize(),this.useRanges=dataSource.options.serverPaging},_recalculate:function(){var pageSize=this.pageSize,offset=this.offset,viewSize=this.viewSize,skip=Math.ceil(offset/pageSize)*pageSize;this.skip=skip,this.midPageThreshold=skip+pageSize-1,this.nextPageThreshold=skip+viewSize-1,this.prefetchThreshold=skip+Math.floor(pageSize/3*2),this.pullBackThreshold=this.offset-1,this.nextMidRange=skip+pageSize-viewSize,this.nextFullRange=skip,this.previousMidRange=offset-viewSize,this.previousFullRange=skip-pageSize}}),BatchBuffer=kendo.Observable.extend({init:function(dataSource,batchSize){var batchBuffer=this;kendo.Observable.fn.init.call(batchBuffer),this.dataSource=dataSource,this.batchSize=batchSize,this._total=0,this.buffer=new Buffer(dataSource,3*batchSize),this.buffer.bind({endreached:function(e){batchBuffer.trigger("endreached",{index:e.index})},prefetching:function(e){batchBuffer.trigger("prefetching",{skip:e.skip,take:e.take})},prefetched:function(e){batchBuffer.trigger("prefetched",{skip:e.skip,take:e.take})},reset:function(){batchBuffer._total=0,batchBuffer.trigger("reset")},resize:function(){batchBuffer._total=Math.ceil(this.length/batchBuffer.batchSize),batchBuffer.trigger("resize",{total:batchBuffer.total(),offset:this.offset})}})},syncDataSource:function(){this.buffer.syncDataSource()},at:function(index){var item,buffer=this.buffer,skip=index*this.batchSize,take=this.batchSize,view=[];buffer.offset>skip&&buffer.at(buffer.offset-1);for(var i=0;i<take&&(item=buffer.at(skip+i),item!==undefined);i++)view.push(item);return view},total:function(){return this._total},destroy:function(){this.buffer.destroy(),this.unbind()}});extend(!0,kendo.data,{readers:{json:DataReader},Query:Query,DataSource:DataSource,HierarchicalDataSource:HierarchicalDataSource,Node:Node,ObservableObject:ObservableObject,ObservableArray:ObservableArray,LocalTransport:LocalTransport,RemoteTransport:RemoteTransport,Cache:Cache,DataReader:DataReader,Model:Model,Buffer:Buffer,BatchBuffer:BatchBuffer})}(window.kendo.jQuery),function($,undefined){function flattenGroups(data){var idx,length,items,itemIndex,result=[];for(idx=0,length=data.length;idx<length;idx++)if(data[idx].hasSubgroups)result=result.concat(flattenGroups(data[idx].items));else for(items=data[idx].items,itemIndex=0;itemIndex<items.length;itemIndex++)result.push(items[itemIndex]);return result}function bindingTargetForRole(element,roles){var widget=kendo.initWidget(element,{},roles);if(widget)return new WidgetBindingTarget(widget)}function parseBindings(bind){var idx,length,token,colonIndex,key,value,tokens,result={};for(tokens=bind.match(keyValueRegExp),idx=0,length=tokens.length;idx<length;idx++)token=tokens[idx],colonIndex=token.indexOf(":"),key=token.substring(0,colonIndex),value=token.substring(colonIndex+1),"{"==value.charAt(0)&&(value=parseBindings(value)),result[key]=value;return result}function createBindings(bindings,source,type){var binding,result={};for(binding in bindings)result[binding]=new type(source,bindings[binding]);return result}function bindElement(element,source,roles,parents){var idx,bindings,target,role=element.getAttribute("data-"+kendo.ns+"role"),bind=element.getAttribute("data-"+kendo.ns+"bind"),children=element.children,childrenCopy=[],deep=!0,options={};if(parents=parents||[source],(role||bind)&&unbindElement(element),role&&(target=bindingTargetForRole(element,roles)),bind&&(bind=parseBindings(bind.replace(whiteSpaceRegExp,"")),target||(options=kendo.parseOptions(element,{textField:"",valueField:"",template:"",valueUpdate:CHANGE,valuePrimitive:!1,autoBind:!0}),options.roles=roles,target=new BindingTarget(element,options)),target.source=source,bindings=createBindings(bind,parents,Binding),options.template&&(bindings.template=new TemplateBinding(parents,"",options.template)),bindings.click&&(bind.events=bind.events||{},bind.events.click=bind.click,bindings.click.destroy(),delete bindings.click),bindings.source&&(deep=!1),bind.attr&&(bindings.attr=createBindings(bind.attr,parents,Binding)),bind.style&&(bindings.style=createBindings(bind.style,parents,Binding)),bind.events&&(bindings.events=createBindings(bind.events,parents,EventBinding)),target.bind(bindings)),target&&(element.kendoBindingTarget=target),deep&&children){for(idx=0;idx<children.length;idx++)childrenCopy[idx]=children[idx];for(idx=0;idx<childrenCopy.length;idx++)bindElement(childrenCopy[idx],source,roles,parents)}}function bind(dom,object){var idx,length,node,roles=kendo.rolesFromNamespaces([].slice.call(arguments,2));for(object=kendo.observable(object),dom=$(dom),idx=0,length=dom.length;idx<length;idx++)node=dom[idx],1===node.nodeType&&bindElement(node,object,roles)}function unbindElement(element){var bindingTarget=element.kendoBindingTarget;bindingTarget&&(bindingTarget.destroy(),deleteExpando?delete element.kendoBindingTarget:element.removeAttribute?element.removeAttribute("kendoBindingTarget"):element.kendoBindingTarget=null)}function unbindElementTree(element){unbindElement(element),unbindElementChildren(element)}function unbindElementChildren(element){var children=element.children;if(children)for(var idx=0,length=children.length;idx<length;idx++)unbindElementTree(children[idx])}function unbind(dom){var idx,length;for(dom=$(dom),idx=0,length=dom.length;idx<length;idx++)unbindElementTree(dom[idx])}function notify(widget,namespace){var element=widget.element,bindingTarget=element[0].kendoBindingTarget;bindingTarget&&bind(element,bindingTarget.source,namespace)}var innerText,kendo=window.kendo,Observable=(kendo.support.browser,kendo.Observable),ObservableObject=kendo.data.ObservableObject,ObservableArray=kendo.data.ObservableArray,toString={}.toString,binders={},Class=(Array.prototype.slice,kendo.Class),proxy=$.proxy,VALUE="value",SOURCE="source",EVENTS="events",CHECKED="checked",deleteExpando=!0,CHANGE="change";!function(){var a=document.createElement("a");a.innerText!==undefined?innerText="innerText":a.textContent!==undefined&&(innerText="textContent");try{delete a.test}catch(e){deleteExpando=!1}}();var Binding=Observable.extend({init:function(parents,path){var that=this;Observable.fn.init.call(that),that.source=parents[0],that.parents=parents,that.path=path,that.dependencies={},that.dependencies[path]=!0,that.observable=that.source instanceof Observable,that._access=function(e){that.dependencies[e.field]=!0},that.observable&&(that._change=function(e){that.change(e)},that.source.bind(CHANGE,that._change))},_parents:function(){var parents=this.parents,value=this.get();if(value&&"function"==typeof value.parent){var parent=value.parent();$.inArray(parent,parents)<0&&(parents=[parent].concat(parents))}return parents},change:function(e){var dependency,ch,field=e.field,that=this;if("this"===that.path)that.trigger(CHANGE,e);else for(dependency in that.dependencies)if(0===dependency.indexOf(field)&&(ch=dependency.charAt(field.length),!ch||"."===ch||"["===ch)){that.trigger(CHANGE,e);break}},start:function(source){source.bind("get",this._access)},stop:function(source){source.unbind("get",this._access)},get:function(){var that=this,source=that.source,index=0,path=that.path,result=source;if(!that.observable)return result;for(that.start(that.source),result=source.get(path);result===undefined&&source;)source=that.parents[++index],source instanceof ObservableObject&&(result=source.get(path));if(result===undefined)for(source=that.source;result===undefined&&source;)source=source.parent(),source instanceof ObservableObject&&(result=source.get(path));return"function"==typeof result&&(index=path.lastIndexOf("."),index>0&&(source=source.get(path.substring(0,index))),that.start(source),result=source!==that.source?result.call(source,that.source):result.call(source),that.stop(source)),source&&source!==that.source&&(that.currentSource=source,source.unbind(CHANGE,that._change).bind(CHANGE,that._change)),that.stop(that.source),result},set:function(value){var source=this.currentSource||this.source,field=kendo.getter(this.path)(source);"function"==typeof field?source!==this.source?field.call(source,this.source,value):field.call(source,value):source.set(this.path,value)},destroy:function(){this.observable&&this.source.unbind(CHANGE,this._change),this.unbind()}}),EventBinding=Binding.extend({get:function(){var handler,source=this.source,path=this.path,index=0;for(handler=source.get(path);!handler&&source;)source=this.parents[++index],source instanceof ObservableObject&&(handler=source.get(path));return proxy(handler,source)}}),TemplateBinding=Binding.extend({init:function(source,path,template){var that=this;Binding.fn.init.call(that,source,path),that.template=template},render:function(value){var html;return this.start(this.source),html=kendo.render(this.template,value),this.stop(this.source),html}}),Binder=Class.extend({init:function(element,bindings,options){this.element=element,this.bindings=bindings,this.options=options},bind:function(binding,attribute){var that=this;binding=attribute?binding[attribute]:binding,binding.bind(CHANGE,function(e){that.refresh(attribute||e)}),that.refresh(attribute)},destroy:function(){}});binders.attr=Binder.extend({refresh:function(key){this.element.setAttribute(key,this.bindings.attr[key].get())}}),binders.style=Binder.extend({refresh:function(key){this.element.style[key]=this.bindings.style[key].get()||""}}),binders.enabled=Binder.extend({refresh:function(){this.bindings.enabled.get()?this.element.removeAttribute("disabled"):this.element.setAttribute("disabled","disabled")}}),binders.readonly=Binder.extend({refresh:function(){this.bindings.readonly.get()?this.element.setAttribute("readonly","readonly"):this.element.removeAttribute("readonly")}}),binders.disabled=Binder.extend({refresh:function(){this.bindings.disabled.get()?this.element.setAttribute("disabled","disabled"):this.element.removeAttribute("disabled")}}),binders.events=Binder.extend({init:function(element,bindings,options){Binder.fn.init.call(this,element,bindings,options),this.handlers={}},refresh:function(key){var element=$(this.element),binding=this.bindings.events[key],handler=this.handlers[key];handler&&element.off(key,handler),handler=this.handlers[key]=binding.get(),element.on(key,binding.source,handler)},destroy:function(){var handler,element=$(this.element);for(handler in this.handlers)element.off(handler,this.handlers[handler])}}),binders.text=Binder.extend({refresh:function(){var text=this.bindings.text.get();null==text&&(text=""),this.element[innerText]=text}}),binders.visible=Binder.extend({refresh:function(){this.bindings.visible.get()?this.element.style.display="":this.element.style.display="none"}}),binders.invisible=Binder.extend({refresh:function(){this.bindings.invisible.get()?this.element.style.display="none":this.element.style.display=""}}),binders.html=Binder.extend({refresh:function(){this.element.innerHTML=this.bindings.html.get()}}),binders.value=Binder.extend({init:function(element,bindings,options){Binder.fn.init.call(this,element,bindings,options),this._change=proxy(this.change,this),this.eventName=options.valueUpdate||CHANGE,$(this.element).on(this.eventName,this._change),this._initChange=!1},change:function(){this._initChange=this.eventName!=CHANGE;var value=this.element.value,type=this.element.type;"date"==type?value=kendo.parseDate(value,"yyyy-MM-dd"):"datetime-local"==type?value=kendo.parseDate(value,["yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mm"]):"number"==type&&(value=kendo.parseFloat(value)),this.bindings[VALUE].set(value),this._initChange=!1},refresh:function(){if(!this._initChange){var value=this.bindings[VALUE].get();null==value&&(value="");var type=this.element.type;"date"==type?value=kendo.toString(value,"yyyy-MM-dd"):"datetime-local"==type&&(value=kendo.toString(value,"yyyy-MM-ddTHH:mm:ss")),this.element.value=value}this._initChange=!1},destroy:function(){$(this.element).off(this.eventName,this._change)}}),binders.source=Binder.extend({init:function(element,bindings,options){Binder.fn.init.call(this,element,bindings,options);var source=this.bindings.source.get();source instanceof kendo.data.DataSource&&options.autoBind!==!1&&source.fetch()},refresh:function(e){var that=this,source=that.bindings.source.get();source instanceof ObservableArray||source instanceof kendo.data.DataSource?(e=e||{},"add"==e.action?that.add(e.index,e.items):"remove"==e.action?that.remove(e.index,e.items):"itemchange"!=e.action&&that.render()):that.render()},container:function(){var element=this.element;return"table"==element.nodeName.toLowerCase()&&(element.tBodies[0]||element.appendChild(document.createElement("tbody")),element=element.tBodies[0]),element},template:function(){var options=this.options,template=options.template,nodeName=this.container().nodeName.toLowerCase();return template||(template="select"==nodeName?options.valueField||options.textField?kendo.format('<option value="#:{0}#">#:{1}#</option>',options.valueField||options.textField,options.textField||options.valueField):"<option>#:data#</option>":"tbody"==nodeName?"<tr><td>#:data#</td></tr>":"ul"==nodeName||"ol"==nodeName?"<li>#:data#</li>":"#:data#",
template=kendo.template(template)),template},add:function(index,items){var parents,idx,length,child,element=this.container(),clone=element.cloneNode(!1),reference=element.children[index];if($(clone).html(kendo.render(this.template(),items)),clone.children.length)for(parents=this.bindings.source._parents(),idx=0,length=items.length;idx<length;idx++)child=clone.children[0],element.insertBefore(child,reference||null),bindElement(child,items[idx],this.options.roles,[items[idx]].concat(parents))},remove:function(index,items){var idx,element=this.container();for(idx=0;idx<items.length;idx++){var child=element.children[index];unbindElementTree(child),element.removeChild(child)}},render:function(){var parents,idx,length,source=this.bindings.source.get(),element=this.container(),template=this.template();if(source instanceof kendo.data.DataSource&&(source=source.view()),source instanceof ObservableArray||"[object Array]"===toString.call(source)||(source=[source]),this.bindings.template){if(unbindElementChildren(element),$(element).html(this.bindings.template.render(source)),element.children.length)for(parents=this.bindings.source._parents(),idx=0,length=source.length;idx<length;idx++)bindElement(element.children[idx],source[idx],this.options.roles,[source[idx]].concat(parents))}else $(element).html(kendo.render(template,source))}}),binders.input={checked:Binder.extend({init:function(element,bindings,options){Binder.fn.init.call(this,element,bindings,options),this._change=proxy(this.change,this),$(this.element).change(this._change)},change:function(){var element=this.element,value=this.value();if("radio"==element.type)this.bindings[CHECKED].set(value);else if("checkbox"==element.type){var index,source=this.bindings[CHECKED].get();source instanceof ObservableArray?(value=this.element.value,"on"!==value&&"off"!==value&&(index=source.indexOf(value),index>-1?source.splice(index,1):source.push(value))):this.bindings[CHECKED].set(value)}},refresh:function(){var value=this.bindings[CHECKED].get(),source=value,element=this.element;"checkbox"==element.type?(source instanceof ObservableArray&&(value=this.element.value,source.indexOf(value)>=0&&(value=!0)),element.checked=value===!0):"radio"==element.type&&null!=value&&element.value===value.toString()&&(element.checked=!0)},value:function(){var element=this.element,value=element.value;return"checkbox"==element.type&&(value=element.checked),value},destroy:function(){$(this.element).off(CHANGE,this._change)}})},binders.select={value:Binder.extend({init:function(target,bindings,options){Binder.fn.init.call(this,target,bindings,options),this._change=proxy(this.change,this),$(this.element).change(this._change)},change:function(){var source,option,valueIndex,value,idx,length,values=[],element=this.element,field=this.options.valueField||this.options.textField,valuePrimitive=this.options.valuePrimitive;for(idx=0,length=element.options.length;idx<length;idx++)option=element.options[idx],option.selected&&(value=option.attributes.value,value=value&&value.specified?option.value:option.text,values.push(value));if(field)for(source=this.bindings.source.get(),valueIndex=0;valueIndex<values.length;valueIndex++)for(idx=0,length=source.length;idx<length;idx++)if(source[idx].get(field)==values[valueIndex]){values[valueIndex]=source[idx];break}value=this.bindings[VALUE].get(),value instanceof ObservableArray?value.splice.apply(value,[0,value.length].concat(values)):valuePrimitive||!(value instanceof ObservableObject)&&field?this.bindings[VALUE].set(values[0].get(field)):this.bindings[VALUE].set(values[0])},refresh:function(){var optionIndex,optionValue,element=this.element,options=element.options,value=this.bindings[VALUE].get(),values=value,field=this.options.valueField||this.options.textField,found=!1;values instanceof ObservableArray||(values=new ObservableArray([value])),element.selectedIndex=-1;for(var valueIndex=0;valueIndex<values.length;valueIndex++)for(value=values[valueIndex],field&&value instanceof ObservableObject&&(value=value.get(field)),optionIndex=0;optionIndex<options.length;optionIndex++)optionValue=options[optionIndex].value,""===optionValue&&""!==value&&(optionValue=options[optionIndex].text),optionValue==value&&(options[optionIndex].selected=!0,found=!0)},destroy:function(){$(this.element).off(CHANGE,this._change)}})},binders.widget={events:Binder.extend({init:function(widget,bindings,options){Binder.fn.init.call(this,widget.element[0],bindings,options),this.widget=widget,this.handlers={}},refresh:function(key){var binding=this.bindings.events[key],handler=this.handlers[key];handler&&this.widget.unbind(key,handler),handler=binding.get(),this.handlers[key]=function(e){e.data=binding.source,handler(e),e.data===binding.source&&delete e.data},this.widget.bind(key,this.handlers[key])},destroy:function(){var handler;for(handler in this.handlers)this.widget.unbind(handler,this.handlers[handler])}}),checked:Binder.extend({init:function(widget,bindings,options){Binder.fn.init.call(this,widget.element[0],bindings,options),this.widget=widget,this._change=proxy(this.change,this),this.widget.bind(CHANGE,this._change)},change:function(){this.bindings[CHECKED].set(this.value())},refresh:function(){this.widget.check(this.bindings[CHECKED].get()===!0)},value:function(){var element=this.element,value=element.value;return"on"!=value&&"off"!=value||(value=element.checked),value},destroy:function(){this.widget.unbind(CHANGE,this._change)}}),visible:Binder.extend({init:function(widget,bindings,options){Binder.fn.init.call(this,widget.element[0],bindings,options),this.widget=widget},refresh:function(){var visible=this.bindings.visible.get();this.widget.wrapper[0].style.display=visible?"":"none"}}),invisible:Binder.extend({init:function(widget,bindings,options){Binder.fn.init.call(this,widget.element[0],bindings,options),this.widget=widget},refresh:function(){var invisible=this.bindings.invisible.get();this.widget.wrapper[0].style.display=invisible?"none":""}}),enabled:Binder.extend({init:function(widget,bindings,options){Binder.fn.init.call(this,widget.element[0],bindings,options),this.widget=widget},refresh:function(){this.widget.enable&&this.widget.enable(this.bindings.enabled.get())}}),disabled:Binder.extend({init:function(widget,bindings,options){Binder.fn.init.call(this,widget.element[0],bindings,options),this.widget=widget},refresh:function(){this.widget.enable&&this.widget.enable(!this.bindings.disabled.get())}}),source:Binder.extend({init:function(widget,bindings,options){var that=this;Binder.fn.init.call(that,widget.element[0],bindings,options),that.widget=widget,that._dataBinding=proxy(that.dataBinding,that),that._dataBound=proxy(that.dataBound,that),that._itemChange=proxy(that.itemChange,that)},itemChange:function(e){bindElement(e.item[0],e.data,this._ns(e.ns),[e.data].concat(this.bindings.source._parents()))},dataBinding:function(){var idx,length,widget=this.widget,items=widget.items();for(idx=0,length=items.length;idx<length;idx++)unbindElementTree(items[idx])},_ns:function(ns){ns=ns||kendo.ui;var all=[kendo.ui,kendo.dataviz.ui,kendo.mobile.ui];return all.splice($.inArray(ns,all),1),all.unshift(ns),kendo.rolesFromNamespaces(all)},dataBound:function(e){var idx,length,parents,widget=this.widget,items=widget.items(),dataSource=widget.dataSource,view=dataSource.view(),groups=dataSource.group()||[];if(items.length)for(groups.length&&(view=flattenGroups(view)),parents=this.bindings.source._parents(),idx=0,length=view.length;idx<length;idx++)bindElement(items[idx],view[idx],this._ns(e.ns),[view[idx]].concat(parents))},refresh:function(e){var source,that=this,widget=that.widget;e=e||{},e.action||(that.destroy(),widget.bind("dataBinding",that._dataBinding),widget.bind("dataBound",that._dataBound),widget.bind("itemChange",that._itemChange),source=that.bindings.source.get(),widget.dataSource instanceof kendo.data.DataSource&&widget.dataSource!=source&&(source instanceof kendo.data.DataSource?widget.setDataSource(source):source&&source._dataSource?widget.setDataSource(source._dataSource):widget.dataSource.data(source)))},destroy:function(){var widget=this.widget;widget.unbind("dataBinding",this._dataBinding),widget.unbind("dataBound",this._dataBound),widget.unbind("itemChange",this._itemChange)}}),value:Binder.extend({init:function(widget,bindings,options){Binder.fn.init.call(this,widget.element[0],bindings,options),this.widget=widget,this._change=$.proxy(this.change,this),this.widget.first(CHANGE,this._change);var value=this.bindings.value.get();this._valueIsObservableObject=!options.valuePrimitive&&(null==value||value instanceof ObservableObject),this._valueIsObservableArray=value instanceof ObservableArray,this._initChange=!1},change:function(){var valueIndex,valueLength,sourceItem,sourceValue,idx,length,source,value=this.widget.value(),field=this.options.dataValueField||this.options.dataTextField,isArray="[object Array]"===toString.call(value),isObservableObject=this._valueIsObservableObject,values=[];if(this._initChange=!0,field)if(this.bindings.source&&(source=this.bindings.source.get()),""===value&&(isObservableObject||this.options.valuePrimitive))value=null;else{for((!source||source instanceof kendo.data.DataSource)&&(source=this.widget.dataSource.view()),isArray&&(valueLength=value.length,values=value.slice(0)),idx=0,length=source.length;idx<length;idx++)if(sourceItem=source[idx],sourceValue=sourceItem.get(field),isArray){for(valueIndex=0;valueIndex<valueLength;valueIndex++)if(sourceValue==values[valueIndex]){values[valueIndex]=sourceItem;break}}else if(sourceValue==value){value=isObservableObject?sourceItem:sourceValue;break}values[0]&&(value=this._valueIsObservableArray?values:isObservableObject||!field?values[0]:values[0].get(field))}this.bindings.value.set(value),this._initChange=!1},refresh:function(){if(!this._initChange){var length,field=this.options.dataValueField||this.options.dataTextField,value=this.bindings.value.get(),idx=0,values=[];if(value===undefined&&(value=null),field)if(value instanceof ObservableArray){for(length=value.length;idx<length;idx++)values[idx]=value[idx].get(field);value=values}else value instanceof ObservableObject&&(value=value.get(field));this.widget.value(value)}this._initChange=!1},destroy:function(){this.widget.unbind(CHANGE,this._change)}}),multiselect:{value:Binder.extend({init:function(widget,bindings,options){Binder.fn.init.call(this,widget.element[0],bindings,options),this.widget=widget,this._change=$.proxy(this.change,this),this.widget.first(CHANGE,this._change),this._initChange=!1},change:function(){var that=this,oldValues=that.bindings[VALUE].get(),valuePrimitive=that.options.valuePrimitive,newValues=valuePrimitive?that.widget.value():that.widget.dataItems(),field=this.options.dataValueField||this.options.dataTextField;if(newValues=newValues.slice(0),that._initChange=!0,oldValues instanceof ObservableArray){for(var removeIndex,newValue,found,remove=[],newLength=newValues.length,i=0,j=0,old=oldValues[i],same=!1;old;){for(found=!1,j=0;j<newLength;j++)if(valuePrimitive?same=newValues[j]==old:(newValue=newValues[j],newValue=newValue.get?newValue.get(field):newValue,same=newValue==(old.get?old.get(field):old)),same){newValues.splice(j,1),newLength-=1,found=!0;break}found?i+=1:(remove.push(old),arraySplice(oldValues,i,1),removeIndex=i),old=oldValues[i]}arraySplice(oldValues,oldValues.length,0,newValues),remove.length&&oldValues.trigger("change",{action:"remove",items:remove,index:removeIndex}),newValues.length&&oldValues.trigger("change",{action:"add",items:newValues,index:oldValues.length-1})}else that.bindings[VALUE].set(newValues);that._initChange=!1},refresh:function(){if(!this._initChange){var length,selectedValue,field=this.options.dataValueField||this.options.dataTextField,value=this.bindings.value.get(),idx=0,values=[];if(value===undefined&&(value=null),field)if(value instanceof ObservableArray){for(length=value.length;idx<length;idx++)selectedValue=value[idx],values[idx]=selectedValue.get?selectedValue.get(field):selectedValue;value=values}else value instanceof ObservableObject&&(value=value.get(field));this.widget.value(value)}},destroy:function(){this.widget.unbind(CHANGE,this._change)}})}};var arraySplice=function(arr,idx,remove,add){add=add||[],remove=remove||0;var index,addLength=add.length,oldLength=arr.length,shifted=[].slice.call(arr,idx+remove),shiftedLength=shifted.length;if(addLength){for(addLength=idx+addLength,index=0;idx<addLength;idx++)arr[idx]=add[index],index++;arr.length=addLength}else if(remove)for(arr.length=idx,remove+=idx;idx<remove;)delete arr[--remove];if(shiftedLength){for(shiftedLength=idx+shiftedLength,index=0;idx<shiftedLength;idx++)arr[idx]=shifted[index],index++;arr.length=shiftedLength}for(idx=arr.length;idx<oldLength;)delete arr[idx],idx++},BindingTarget=Class.extend({init:function(target,options){this.target=target,this.options=options,this.toDestroy=[]},bind:function(bindings){var key,hasValue,hasSource,hasEvents,nodeName=this.target.nodeName.toLowerCase(),specificBinders=binders[nodeName]||{};for(key in bindings)key==VALUE?hasValue=!0:key==SOURCE?hasSource=!0:key==EVENTS?hasEvents=!0:this.applyBinding(key,bindings,specificBinders);hasSource&&this.applyBinding(SOURCE,bindings,specificBinders),hasValue&&this.applyBinding(VALUE,bindings,specificBinders),hasEvents&&this.applyBinding(EVENTS,bindings,specificBinders)},applyBinding:function(name,bindings,specificBinders){var attribute,binder=specificBinders[name]||binders[name],toDestroy=this.toDestroy,binding=bindings[name];if(binder)if(binder=new binder(this.target,bindings,this.options),toDestroy.push(binder),binding instanceof Binding)binder.bind(binding),toDestroy.push(binding);else for(attribute in binding)binder.bind(binding,attribute),toDestroy.push(binding[attribute]);else if("template"!==name)throw new Error("The "+name+" binding is not supported by the "+this.target.nodeName.toLowerCase()+" element")},destroy:function(){var idx,length,toDestroy=this.toDestroy;for(idx=0,length=toDestroy.length;idx<length;idx++)toDestroy[idx].destroy()}}),WidgetBindingTarget=BindingTarget.extend({bind:function(bindings){var binding,that=this,hasValue=!1,hasSource=!1,specificBinders=binders.widget[that.target.options.name.toLowerCase()]||{};for(binding in bindings)binding==VALUE?hasValue=!0:binding==SOURCE?hasSource=!0:that.applyBinding(binding,bindings,specificBinders);hasSource&&that.applyBinding(SOURCE,bindings,specificBinders),hasValue&&that.applyBinding(VALUE,bindings,specificBinders)},applyBinding:function(name,bindings,specificBinders){var attribute,binder=specificBinders[name]||binders.widget[name],toDestroy=this.toDestroy,binding=bindings[name];if(!binder)throw new Error("The "+name+" binding is not supported by the "+this.target.options.name+" widget");if(binder=new binder(this.target,bindings,this.target.options),toDestroy.push(binder),binding instanceof Binding)binder.bind(binding),toDestroy.push(binding);else for(attribute in binding)binder.bind(binding,attribute),toDestroy.push(binding[attribute])}}),keyValueRegExp=/[A-Za-z0-9_\-]+:(\{([^}]*)\}|[^,}]+)/g,whiteSpaceRegExp=/\s/g;kendo.unbind=unbind,kendo.bind=bind,kendo.data.binders=binders,kendo.data.Binder=Binder,kendo.notify=notify,kendo.observable=function(object){return object instanceof ObservableObject||(object=new ObservableObject(object)),object},kendo.observableHierarchy=function(array){function recursiveRead(data){var i,children;for(i=0;i<data.length;i++)data[i]._initChildren(),children=data[i].children,children.fetch(),data[i].items=children.data(),recursiveRead(data[i].items)}var dataSource=kendo.data.HierarchicalDataSource.create(array);return dataSource.fetch(),recursiveRead(dataSource.data()),dataSource._data._dataSource=dataSource,dataSource._data}}(window.kendo.jQuery),function($,undefined){function parseInteger(value){return parseInt(value,10)}function parseCSS(element,property){return parseInteger(element.css(property))}function keys(obj){var acc=[];for(var propertyName in obj)acc.push(propertyName);return acc}function strip3DTransforms(properties){for(var key in properties)transformProps.indexOf(key)!=-1&&transform2d.indexOf(key)==-1&&delete properties[key];return properties}function normalizeCSS(element,properties){var lowerKey,key,value,isTransformed,transformation=[],cssValues={};for(key in properties)lowerKey=key.toLowerCase(),isTransformed=transforms&&transformProps.indexOf(lowerKey)!=-1,!support.hasHW3D&&isTransformed&&transform2d.indexOf(lowerKey)==-1?delete properties[key]:(value=properties[key],isTransformed?transformation.push(key+"("+value+")"):cssValues[key]=value);return transformation.length&&(cssValues[TRANSFORM]=transformation.join(" ")),cssValues}function animationProperty(element,property){if(transforms){var transform=element.css(TRANSFORM);if(transform==NONE)return"scale"==property?1:0;var match=transform.match(new RegExp(property+"\\s*\\(([\\d\\w\\.]+)")),computed=0;return match?computed=parseInteger(match[1]):(match=transform.match(matrix3dRegExp)||[0,0,0,0,0],property=property.toLowerCase(),translateXRegExp.test(property)?computed=parseFloat(match[3]/match[2]):"translatey"==property?computed=parseFloat(match[4]/match[2]):"scale"==property?computed=parseFloat(match[2]):"rotate"==property&&(computed=parseFloat(Math.atan2(match[2],match[1])))),computed}return parseFloat(element.css(property))}function capitalize(word){return word.charAt(0).toUpperCase()+word.substring(1)}function createEffect(name,definition){var effectClass=Effect.extend(definition),directions=effectClass.prototype.directions;fx[capitalize(name)]=effectClass,fx.Element.prototype[name]=function(direction,opt1,opt2,opt3){return new effectClass(this.element,direction,opt1,opt2,opt3)},each(directions,function(idx,theDirection){fx.Element.prototype[name+capitalize(theDirection)]=function(opt1,opt2,opt3){return new effectClass(this.element,theDirection,opt1,opt2,opt3)}})}function createToggleEffect(name,property,defaultStart,defaultEnd){createEffect(name,{directions:IN_OUT,startValue:function(value){return this._startValue=value,this},endValue:function(value){return this._endValue=value,this},shouldHide:function(){return this._shouldHide},prepare:function(start,end){var startValue,endValue,that=this,out="out"===this._direction,startDataValue=that.element.data(property),startDataValueIsSet=!(isNaN(startDataValue)||startDataValue==defaultStart);startValue=startDataValueIsSet?startDataValue:"undefined"!=typeof this._startValue?this._startValue:out?defaultStart:defaultEnd,endValue="undefined"!=typeof this._endValue?this._endValue:out?defaultEnd:defaultStart,this._reverse?(start[property]=endValue,end[property]=startValue):(start[property]=startValue,end[property]=endValue),that._shouldHide=end[property]===defaultEnd}})}function clipInHalf(container,direction){var vertical=kendo.directions[direction].vertical,size=container[vertical?HEIGHT:WIDTH]()/2+"px";return CLIPS[direction].replace("$size",size)}var kendo=window.kendo,fx=kendo.effects,each=$.each,extend=$.extend,proxy=$.proxy,support=kendo.support,browser=support.browser,transforms=support.transforms,transitions=support.transitions,scaleProperties={scale:0,scalex:0,scaley:0,scale3d:0},translateProperties={translate:0,translatex:0,translatey:0,translate3d:0},hasZoom="undefined"!=typeof document.documentElement.style.zoom&&!transforms,matrix3dRegExp=/matrix3?d?\s*\(.*,\s*([\d\.\-]+)\w*?,\s*([\d\.\-]+)\w*?,\s*([\d\.\-]+)\w*?,\s*([\d\.\-]+)\w*?/i,cssParamsRegExp=/^(-?[\d\.\-]+)?[\w\s]*,?\s*(-?[\d\.\-]+)?[\w\s]*/i,translateXRegExp=/translatex?$/i,oldEffectsRegExp=/(zoom|fade|expand)(\w+)/,singleEffectRegExp=/(zoom|fade|expand)/,unitRegExp=/[xy]$/i,transformProps=["perspective","rotate","rotatex","rotatey","rotatez","rotate3d","scale","scalex","scaley","scalez","scale3d","skew","skewx","skewy","translate","translatex","translatey","translatez","translate3d","matrix","matrix3d"],transform2d=["rotate","scale","scalex","scaley","skew","skewx","skewy","translate","translatex","translatey","matrix"],transform2units={rotate:"deg",scale:"",skew:"px",translate:"px"},cssPrefix=transforms.css,round=Math.round,BLANK="",PX="px",NONE="none",AUTO="auto",WIDTH="width",HEIGHT="height",HIDDEN="hidden",ORIGIN="origin",ABORT_ID="abortId",OVERFLOW="overflow",TRANSLATE="translate",POSITION="position",COMPLETE_CALLBACK="completeCallback",TRANSITION=cssPrefix+"transition",TRANSFORM=cssPrefix+"transform",BACKFACE=cssPrefix+"backface-visibility",PERSPECTIVE=cssPrefix+"perspective",DEFAULT_PERSPECTIVE="1500px",TRANSFORM_PERSPECTIVE="perspective("+DEFAULT_PERSPECTIVE+")",directions=(support.mobileOS&&7==support.mobileOS.majorVersion,{left:{reverse:"right",property:"left",transition:"translatex",vertical:!1,modifier:-1},right:{reverse:"left",property:"left",transition:"translatex",vertical:!1,modifier:1},down:{reverse:"up",property:"top",transition:"translatey",vertical:!0,modifier:1},up:{reverse:"down",property:"top",transition:"translatey",vertical:!0,modifier:-1},top:{reverse:"bottom"},bottom:{reverse:"top"},"in":{reverse:"out",modifier:-1},out:{reverse:"in",modifier:1},vertical:{reverse:"vertical"},horizontal:{reverse:"horizontal"}});if(kendo.directions=directions,extend($.fn,{kendoStop:function(clearQueue,gotoEnd){return transitions?fx.stopQueue(this,clearQueue||!1,gotoEnd||!1):this.stop(clearQueue,gotoEnd)}}),transforms&&!transitions){each(transform2d,function(idx,value){$.fn[value]=function(val){if("undefined"==typeof val)return animationProperty(this,value);var that=$(this)[0],transformValue=value+"("+val+transform2units[value.replace(unitRegExp,"")]+")";return that.style.cssText.indexOf(TRANSFORM)==-1?$(this).css(TRANSFORM,transformValue):that.style.cssText=that.style.cssText.replace(new RegExp(value+"\\(.*?\\)","i"),transformValue),this},$.fx.step[value]=function(fx){$(fx.elem)[value](fx.now)}});var curProxy=$.fx.prototype.cur;$.fx.prototype.cur=function(){return transform2d.indexOf(this.prop)!=-1?parseFloat($(this.elem)[this.prop]()):curProxy.apply(this,arguments)}}kendo.toggleClass=function(element,classes,options,add){return classes&&(classes=classes.split(" "),transitions&&(options=extend({exclusive:"all",duration:400,ease:"ease-out"},options),element.css(TRANSITION,options.exclusive+" "+options.duration+"ms "+options.ease),setTimeout(function(){element.css(TRANSITION,"").css(HEIGHT)},options.duration)),each(classes,function(idx,value){element.toggleClass(value,add)})),element},kendo.parseEffects=function(input,mirror){var effects={};return"string"==typeof input?each(input.split(" "),function(idx,value){var redirectedEffect=!singleEffectRegExp.test(value),resolved=value.replace(oldEffectsRegExp,function(match,$1,$2){return $1+":"+$2.toLowerCase()}),effect=resolved.split(":"),direction=effect[1],effectBody={};effect.length>1&&(effectBody.direction=mirror&&redirectedEffect?directions[direction].reverse:direction),effects[effect[0]]=effectBody}):each(input,function(idx){var direction=this.direction;direction&&mirror&&!singleEffectRegExp.test(idx)&&(this.direction=directions[direction].reverse),effects[idx]=this}),effects},transitions&&extend(fx,{transition:function(element,properties,options){var css,timeoutID,delay=0,oldKeys=element.data("keys")||[];options=extend({duration:200,ease:"ease-out",complete:null,exclusive:"all"},options);var stopTransitionCalled=!1,stopTransition=function(){stopTransitionCalled||(stopTransitionCalled=!0,timeoutID&&(clearTimeout(timeoutID),timeoutID=null),element.removeData(ABORT_ID).dequeue().css(TRANSITION,"").css(TRANSITION),options.complete.call(element))};options.duration=$.fx?$.fx.speeds[options.duration]||options.duration:options.duration,css=normalizeCSS(element,properties),$.merge(oldKeys,keys(css)),element.data("keys",$.unique(oldKeys)).height(),element.css(TRANSITION,options.exclusive+" "+options.duration+"ms "+options.ease).css(TRANSITION),element.css(css).css(TRANSFORM),transitions.event&&(element.one(transitions.event,stopTransition),0!==options.duration&&(delay=500)),timeoutID=setTimeout(stopTransition,options.duration+delay),element.data(ABORT_ID,timeoutID),element.data(COMPLETE_CALLBACK,stopTransition)},stopQueue:function(element,clearQueue,gotoEnd){var cssValues,taskKeys=element.data("keys"),retainPosition=!gotoEnd&&taskKeys,completeCallback=element.data(COMPLETE_CALLBACK);return retainPosition&&(cssValues=kendo.getComputedStyles(element[0],taskKeys)),completeCallback&&completeCallback(),retainPosition&&element.css(cssValues),element.removeData("keys").stop(clearQueue)}});var EffectSet=kendo.Class.extend({init:function(element,options){var that=this;that.element=element,that.effects=[],that.options=options,that.restore=[]},run:function(effects){var effect,idx,jdx,target,children,childrenLength,that=this,length=effects.length,element=that.element,options=that.options,deferred=$.Deferred(),start={},end={};for(that.effects=effects,deferred.then($.proxy(that,"complete")),element.data("animating",!0),idx=0;idx<length;idx++)for(effect=effects[idx],effect.setReverse(options.reverse),effect.setOptions(options),that.addRestoreProperties(effect.restore),effect.prepare(start,end),children=effect.children(),jdx=0,childrenLength=children.length;jdx<childrenLength;jdx++)children[jdx].duration(options.duration).run();for(var effectName in options.effects)extend(end,options.effects[effectName].properties);for(element.is(":visible")||extend(start,{display:element.data("olddisplay")||"block"}),transforms&&!options.reset&&(target=element.data("targetTransform"),target&&(start=extend(target,start))),start=normalizeCSS(element,start),transforms&&!transitions&&(start=strip3DTransforms(start)),element.css(start).css(TRANSFORM),idx=0;idx<length;idx++)effects[idx].setup();return options.init&&options.init(),element.data("targetTransform",end),fx.animate(element,end,extend({},options,{complete:deferred.resolve})),deferred.promise()},stop:function(){$(this.element).kendoStop(!0,!0)},addRestoreProperties:function(restore){for(var value,element=this.element,i=0,length=restore.length;i<length;i++)value=restore[i],this.restore.push(value),element.data(value)||element.data(value,element.css(value))},restoreCallback:function(){for(var element=this.element,i=0,length=this.restore.length;i<length;i++){var value=this.restore[i];element.css(value,element.data(value))}},complete:function(){var that=this,idx=0,element=that.element,options=that.options,effects=that.effects,length=effects.length;for(element.removeData("animating").dequeue(),options.hide&&element.data("olddisplay",element.css("display")).hide(),this.restoreCallback(),hasZoom&&!transforms&&setTimeout($.proxy(this,"restoreCallback"),0);idx<length;idx++)effects[idx].teardown();options.completeCallback&&options.completeCallback(element)}});fx.promise=function(element,options){var effectClass,effect,effects=[],effectSet=new EffectSet(element,options),parsedEffects=kendo.parseEffects(options.effects);options.effects=parsedEffects;for(var effectName in parsedEffects)effectClass=fx[capitalize(effectName)],effectClass&&(effect=new effectClass(element,parsedEffects[effectName].direction),effects.push(effect));effects[0]?effectSet.run(effects):(element.is(":visible")||element.css({display:element.data("olddisplay")||"block"}).css("display"),options.init&&options.init(),element.dequeue(),effectSet.complete())},extend(fx,{animate:function(elements,properties,options){var useTransition=options.transition!==!1;delete options.transition,transitions&&"transition"in fx&&useTransition?fx.transition(elements,properties,options):transforms?elements.animate(strip3DTransforms(properties),{queue:!1,show:!1,hide:!1,duration:options.duration,complete:options.complete}):elements.each(function(){var element=$(this),multiple={};each(transformProps,function(idx,value){var params,currentValue=properties?properties[value]+" ":null;if(currentValue){var single=properties;if(value in scaleProperties&&properties[value]!==undefined)params=currentValue.match(cssParamsRegExp),transforms&&extend(single,{scale:+params[0]});else if(value in translateProperties&&properties[value]!==undefined){var position=element.css(POSITION),isFixed="absolute"==position||"fixed"==position;element.data(TRANSLATE)||(isFixed?element.data(TRANSLATE,{top:parseCSS(element,"top")||0,left:parseCSS(element,"left")||0,bottom:parseCSS(element,"bottom"),right:parseCSS(element,"right")}):element.data(TRANSLATE,{top:parseCSS(element,"marginTop")||0,left:parseCSS(element,"marginLeft")||0}));var originalPosition=element.data(TRANSLATE);if(params=currentValue.match(cssParamsRegExp)){var dX=value==TRANSLATE+"y"?0:+params[1],dY=value==TRANSLATE+"y"?+params[1]:+params[2];isFixed?(isNaN(originalPosition.right)?isNaN(dX)||extend(single,{left:originalPosition.left+dX}):isNaN(dX)||extend(single,{right:originalPosition.right-dX}),isNaN(originalPosition.bottom)?isNaN(dY)||extend(single,{top:originalPosition.top+dY}):isNaN(dY)||extend(single,{bottom:originalPosition.bottom-dY})):(isNaN(dX)||extend(single,{marginLeft:originalPosition.left+dX}),isNaN(dY)||extend(single,{marginTop:originalPosition.top+dY}))}}!transforms&&"scale"!=value&&value in single&&delete single[value],single&&extend(multiple,single)}}),browser.msie&&delete multiple.scale,element.animate(multiple,{queue:!1,show:!1,hide:!1,duration:options.duration,complete:options.complete})})}}),fx.animatedPromise=fx.promise;var Effect=kendo.Class.extend({init:function(element,direction){var that=this;that.element=element,that._direction=direction,that.options={},that._additionalEffects=[],that.restore||(that.restore=[])},reverse:function(){return this._reverse=!0,this.run()},play:function(){return this._reverse=!1,this.run()},add:function(additional){return this._additionalEffects.push(additional),this},direction:function(value){return this._direction=value,this},duration:function(duration){return this._duration=duration,this},compositeRun:function(){var that=this,effectSet=new EffectSet(that.element,{reverse:that._reverse,duration:that._duration}),effects=that._additionalEffects.concat([that]);return effectSet.run(effects)},run:function(){if(this._additionalEffects&&this._additionalEffects[0])return this.compositeRun();var value,target,that=this,element=that.element,idx=0,restore=that.restore,length=restore.length,deferred=$.Deferred(),start={},end={},children=that.children(),childrenLength=children.length;for(deferred.then($.proxy(that,"_complete")),element.data("animating",!0),idx=0;idx<length;idx++)value=restore[idx],element.data(value)||element.data(value,element.css(value));for(idx=0;idx<childrenLength;idx++)children[idx].duration(that._duration).run();return that.prepare(start,end),element.is(":visible")||extend(start,{display:element.data("olddisplay")||"block"}),transforms&&(target=element.data("targetTransform"),target&&(start=extend(target,start))),start=normalizeCSS(element,start),transforms&&!transitions&&(start=strip3DTransforms(start)),element.css(start).css(TRANSFORM),that.setup(),element.data("targetTransform",end),fx.animate(element,end,{duration:that._duration,complete:deferred.resolve}),deferred.promise()},stop:function(){var idx=0,children=this.children(),childrenLength=children.length;for(idx=0;idx<childrenLength;idx++)children[idx].stop();return $(this.element).kendoStop(!0,!0),this},restoreCallback:function(){for(var element=this.element,i=0,length=this.restore.length;i<length;i++){var value=this.restore[i];element.css(value,element.data(value))}},_complete:function(){var that=this,element=that.element;element.removeData("animating").dequeue(),that.restoreCallback(),that.shouldHide()&&element.data("olddisplay",element.css("display")).hide(),hasZoom&&!transforms&&setTimeout($.proxy(that,"restoreCallback"),0),that.teardown()},setOptions:function(options){extend(!0,this.options,options)},children:function(){return[]},shouldHide:$.noop,setup:$.noop,prepare:$.noop,teardown:$.noop,directions:[],setReverse:function(reverse){return this._reverse=reverse,this}}),FOUR_DIRECTIONS=["left","right","up","down"],IN_OUT=["in","out"];
createEffect("slideIn",{directions:FOUR_DIRECTIONS,divisor:function(value){return this.options.divisor=value,this},prepare:function(start,end){var tmp,that=this,element=that.element,direction=directions[that._direction],offset=-direction.modifier*(direction.vertical?element.outerHeight():element.outerWidth()),startValue=offset/(that.options&&that.options.divisor||1)+PX,endValue="0px";that._reverse&&(tmp=start,start=end,end=tmp),transforms?(start[direction.transition]=startValue,end[direction.transition]=endValue):(start[direction.property]=startValue,end[direction.property]=endValue)}}),createEffect("tile",{directions:FOUR_DIRECTIONS,init:function(element,direction,previous){Effect.prototype.init.call(this,element,direction),this.options={previous:previous}},previousDivisor:function(value){return this.options.previousDivisor=value,this},children:function(){var that=this,reverse=that._reverse,previous=that.options.previous,divisor=that.options.previousDivisor||1,dir=that._direction,children=[kendo.fx(that.element).slideIn(dir).setReverse(reverse)];return previous&&children.push(kendo.fx(previous).slideIn(directions[dir].reverse).divisor(divisor).setReverse(!reverse)),children}}),createToggleEffect("fade","opacity",1,0),createToggleEffect("zoom","scale",1,.01),createEffect("slideMargin",{prepare:function(start,end){var margin,that=this,element=that.element,options=that.options,origin=element.data(ORIGIN),offset=options.offset,reverse=that._reverse;reverse||null!==origin||element.data(ORIGIN,parseFloat(element.css("margin-"+options.axis))),margin=element.data(ORIGIN)||0,end["margin-"+options.axis]=reverse?margin:margin+offset}}),createEffect("slideTo",{prepare:function(start,end){var that=this,element=that.element,options=that.options,offset=options.offset.split(","),reverse=that._reverse;transforms?(end.translatex=reverse?0:offset[0],end.translatey=reverse?0:offset[1]):(end.left=reverse?0:offset[0],end.top=reverse?0:offset[1]),element.css("left")}}),createEffect("expand",{directions:["horizontal","vertical"],restore:[OVERFLOW],prepare:function(start,end){var that=this,element=that.element,options=that.options,reverse=that._reverse,property="vertical"===that._direction?HEIGHT:WIDTH,setLength=element[0].style[property],oldLength=element.data(property),length=parseFloat(oldLength||setLength),realLength=round(element.css(property,AUTO)[property]());start.overflow=HIDDEN,length=options&&options.reset?realLength||length:length||realLength,end[property]=(reverse?0:length)+PX,start[property]=(reverse?length:0)+PX,oldLength===undefined&&element.data(property,setLength)},shouldHide:function(){return this._reverse},teardown:function(){var that=this,element=that.element,property="vertical"===that._direction?HEIGHT:WIDTH,length=element.data(property);length!=AUTO&&length!==BLANK||setTimeout(function(){element.css(property,AUTO).css(property)},0)}});var TRANSFER_START_STATE={position:"absolute",marginLeft:0,marginTop:0,scale:1};createEffect("transfer",{init:function(element,target){this.element=element,this.options={target:target},this.restore=[]},setup:function(){this.element.appendTo(document.body)},prepare:function(start,end){var offset,that=this,element=that.element,options=that.options,reverse=that._reverse,target=options.target,currentScale=animationProperty(element,"scale"),targetOffset=target.offset(),scale=target.outerHeight()/element.outerHeight();extend(start,TRANSFER_START_STATE),end.scale=1,element.css(TRANSFORM,"scale(1)").css(TRANSFORM),offset=element.offset(),element.css(TRANSFORM,"scale("+currentScale+")");var x1=0,y1=0,x2=targetOffset.left-offset.left,y2=targetOffset.top-offset.top,x3=x1+element.outerWidth(),y3=y1,x4=x2+target.outerWidth(),y4=y2,Z1=(y2-y1)/(x2-x1),Z2=(y4-y3)/(x4-x3),X=(y1-y3-Z1*x1+Z2*x3)/(Z2-Z1),Y=y1+Z1*(X-x1);start.top=offset.top,start.left=offset.left,start.transformOrigin=X+PX+" "+Y+PX,reverse?start.scale=scale:end.scale=scale}});var CLIPS={top:"rect(auto auto $size auto)",bottom:"rect($size auto auto auto)",left:"rect(auto $size auto auto)",right:"rect(auto auto auto $size)"},ROTATIONS={top:{start:"rotatex(0deg)",end:"rotatex(180deg)"},bottom:{start:"rotatex(-180deg)",end:"rotatex(0deg)"},left:{start:"rotatey(0deg)",end:"rotatey(-180deg)"},right:{start:"rotatey(180deg)",end:"rotatey(0deg)"}};createEffect("turningPage",{directions:FOUR_DIRECTIONS,init:function(element,direction,container){Effect.prototype.init.call(this,element,direction),this._container=container},prepare:function(start,end){var that=this,reverse=that._reverse,direction=reverse?directions[that._direction].reverse:that._direction,rotation=ROTATIONS[direction];start.zIndex=1,that._clipInHalf&&(start.clip=clipInHalf(that._container,kendo.directions[direction].reverse)),start[BACKFACE]=HIDDEN,end[TRANSFORM]=TRANSFORM_PERSPECTIVE+(reverse?rotation.start:rotation.end),start[TRANSFORM]=TRANSFORM_PERSPECTIVE+(reverse?rotation.end:rotation.start)},setup:function(){this._container.append(this.element)},face:function(value){return this._face=value,this},shouldHide:function(){var that=this,reverse=that._reverse,face=that._face;return reverse&&!face||!reverse&&face},clipInHalf:function(value){return this._clipInHalf=value,this},temporary:function(){return this.element.addClass("temp-page"),this}}),createEffect("staticPage",{directions:FOUR_DIRECTIONS,init:function(element,direction,container){Effect.prototype.init.call(this,element,direction),this._container=container},restore:["clip"],prepare:function(start,end){var that=this,direction=that._reverse?directions[that._direction].reverse:that._direction;start.clip=clipInHalf(that._container,direction),start.opacity=.999,end.opacity=1},shouldHide:function(){var that=this,reverse=that._reverse,face=that._face;return reverse&&!face||!reverse&&face},face:function(value){return this._face=value,this}}),createEffect("pageturn",{directions:["horizontal","vertical"],init:function(element,direction,face,back){Effect.prototype.init.call(this,element,direction),this.options={},this.options.face=face,this.options.back=back},children:function(){var temp,that=this,options=that.options,direction="horizontal"===that._direction?"left":"top",reverseDirection=kendo.directions[direction].reverse,reverse=that._reverse,faceClone=options.face.clone(!0).removeAttr("id"),backClone=options.back.clone(!0).removeAttr("id"),element=that.element;return reverse&&(temp=direction,direction=reverseDirection,reverseDirection=temp),[kendo.fx(options.face).staticPage(direction,element).face(!0).setReverse(reverse),kendo.fx(options.back).staticPage(reverseDirection,element).setReverse(reverse),kendo.fx(faceClone).turningPage(direction,element).face(!0).clipInHalf(!0).temporary().setReverse(reverse),kendo.fx(backClone).turningPage(reverseDirection,element).clipInHalf(!0).temporary().setReverse(reverse)]},prepare:function(start,end){start[PERSPECTIVE]=DEFAULT_PERSPECTIVE,start.transformStyle="preserve-3d",start.opacity=.999,end.opacity=1},teardown:function(){this.element.find(".temp-page").remove()}}),createEffect("flip",{directions:["horizontal","vertical"],init:function(element,direction,face,back){Effect.prototype.init.call(this,element,direction),this.options={},this.options.face=face,this.options.back=back},children:function(){var temp,that=this,options=that.options,direction="horizontal"===that._direction?"left":"top",reverseDirection=kendo.directions[direction].reverse,reverse=that._reverse,element=that.element;return reverse&&(temp=direction,direction=reverseDirection,reverseDirection=temp),[kendo.fx(options.face).turningPage(direction,element).face(!0).setReverse(reverse),kendo.fx(options.back).turningPage(reverseDirection,element).setReverse(reverse)]},prepare:function(start){start[PERSPECTIVE]=DEFAULT_PERSPECTIVE,start.transformStyle="preserve-3d"}});var RESTORE_OVERFLOW=!support.mobileOS.android,IGNORE_TRANSITION_EVENT_SELECTOR=".km-touch-scrollbar";createEffect("replace",{init:function(element,previous,transitionClass){Effect.prototype.init.call(this,element),this._previous=$(previous),this._transitionClass=transitionClass},duration:function(){throw new Error("The replace effect does not support duration setting; the effect duration may be customized through the transition class rule")},_both:function(){return $().add(this._element).add(this._previous)},_containerClass:function(){var direction=this._direction,containerClass="k-fx k-fx-start k-fx-"+this._transitionClass;return direction&&(containerClass+=" k-fx-"+direction),this._reverse&&(containerClass+=" k-fx-reverse"),containerClass},complete:function(e){if(!(!this.deferred||e&&$(e.target).is(IGNORE_TRANSITION_EVENT_SELECTOR))){var container=this.container;container.removeClass("k-fx-end").removeClass(this._containerClass()).off(transitions.event,this.completeProxy),this._previous.hide().removeClass("k-fx-current"),this.element.removeClass("k-fx-next"),RESTORE_OVERFLOW&&container.css(OVERFLOW,""),this.isAbsolute||this._both().css(POSITION,""),this.deferred.resolve(),delete this.deferred}},run:function(){if(this._additionalEffects&&this._additionalEffects[0])return this.compositeRun();var originalOverflow,that=this,element=that.element,previous=that._previous,container=(that._direction,element.parents().filter(previous.parents()).first()),both=that._both(),deferred=$.Deferred(),originalPosition=element.css(POSITION);return container.length||(container=element.parent()),this.container=container,this.deferred=deferred,this.isAbsolute="absolute"==originalPosition,this.isAbsolute||both.css(POSITION,"absolute"),RESTORE_OVERFLOW&&(originalOverflow=container.css(OVERFLOW),container.css(OVERFLOW,"hidden")),transitions?(element.addClass("k-fx-hidden"),container.addClass(this._containerClass()),this.completeProxy=$.proxy(this,"complete"),container.on(transitions.event,this.completeProxy),kendo.animationFrame(function(){element.removeClass("k-fx-hidden").addClass("k-fx-next"),previous.css("display","").addClass("k-fx-current"),kendo.animationFrame(function(){container.removeClass("k-fx-start").addClass("k-fx-end")})})):this.complete(),deferred.promise()},stop:function(){this.complete()}});var Animation=kendo.Class.extend({init:function(){var that=this;that._tickProxy=proxy(that._tick,that),that._started=!1},tick:$.noop,done:$.noop,onEnd:$.noop,onCancel:$.noop,start:function(){this.enabled()&&(this.done()?this.onEnd():(this._started=!0,kendo.animationFrame(this._tickProxy)))},enabled:function(){return!0},cancel:function(){this._started=!1,this.onCancel()},_tick:function(){var that=this;that._started&&(that.tick(),that.done()?(that._started=!1,that.onEnd()):kendo.animationFrame(that._tickProxy))}}),Transition=Animation.extend({init:function(options){var that=this;extend(that,options),Animation.fn.init.call(that)},done:function(){return this.timePassed()>=this.duration},timePassed:function(){return Math.min(this.duration,new Date-this.startDate)},moveTo:function(options){var that=this,movable=that.movable;that.initial=movable[that.axis],that.delta=options.location-that.initial,that.duration="number"==typeof options.duration?options.duration:300,that.tick=that._easeProxy(options.ease),that.startDate=new Date,that.start()},_easeProxy:function(ease){var that=this;return function(){that.movable.moveAxis(that.axis,ease(that.timePassed(),that.initial,that.delta,that.duration))}}});extend(Transition,{easeOutExpo:function(t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeOutBack:function(t,b,c,d,s){return s=1.70158,c*((t=t/d-1)*t*((s+1)*t+s)+1)+b}}),fx.Animation=Animation,fx.Transition=Transition,fx.createEffect=createEffect}(window.kendo.jQuery),function($,undefined){function parseTransition(transition){if(!transition)return{};var matches=transition.match(transitionRegExp)||[];return{type:matches[1],direction:matches[3],reverse:"reverse"===matches[5]}}var kendo=window.kendo,Observable=kendo.Observable,SCRIPT="SCRIPT",INIT="init",SHOW="show",HIDE="hide",ATTACH="attach",DETACH="detach",sizzleErrorRegExp=/unrecognized expression/,View=Observable.extend({init:function(content,options){var that=this;options=options||{},Observable.fn.init.call(that),that.content=content,that.id=kendo.guid(),that.tagName=options.tagName||"div",that.model=options.model,that._wrap=options.wrap!==!1,that._fragments={},that.bind([INIT,SHOW,HIDE],options)},render:function(container){var that=this,notInitialized=!that.element;return notInitialized&&(that.element=that._createElement()),container&&$(container).append(that.element),notInitialized&&(kendo.bind(that.element,that.model),that.trigger(INIT)),container&&(that._eachFragment(ATTACH),that.trigger(SHOW)),that.element},clone:function(back){return new ViewClone(this)},triggerBeforeShow:function(){return!0},showStart:function(){this.element.css("display","")},showEnd:function(){},hideStart:function(){},hideEnd:function(){this.hide()},hide:function(){this._eachFragment(DETACH),this.element.detach(),this.trigger(HIDE)},destroy:function(){var element=this.element;element&&(kendo.unbind(element),kendo.destroy(element),element.remove())},fragments:function(fragments){$.extend(this._fragments,fragments)},_eachFragment:function(methodName){for(var placeholder in this._fragments)this._fragments[placeholder][methodName](this,placeholder)},_createElement:function(){var element,content,that=this,wrap=that._wrap,wrapper="<"+that.tagName+" />";try{content=$(document.getElementById(that.content)||that.content),content[0].tagName===SCRIPT&&(content=content.html())}catch(e){sizzleErrorRegExp.test(e.message)&&(content=that.content)}return"string"==typeof content?(element=$(wrapper).append(content),kendo.stripWhitespace(element[0]),wrap||(element=element.contents())):(element=content,wrap&&(element=element.wrapAll(wrapper).parent())),element}}),ViewClone=kendo.Class.extend({init:function(view){$.extend(this,{element:view.element.clone(!0),transition:view.transition,id:view.id}),view.element.parent().append(this.element)},hideStart:$.noop,hideEnd:function(){this.element.remove()}}),Layout=View.extend({init:function(content,options){View.fn.init.call(this,content,options),this.containers={}},container:function(selector){var container=this.containers[selector];return container||(container=this._createContainer(selector),this.containers[selector]=container),container},showIn:function(selector,view,transition){this.container(selector).show(view,transition)},_createContainer:function(selector){var container,root=this.render(),element=root.find(selector);if(!element.length&&root.is(selector)){if(!root.is(selector))throw new Error("can't find a container with the specified "+selector+" selector");element=root}return container=new ViewContainer(element),container.bind("accepted",function(e){e.view.render(element)}),container}}),Fragment=View.extend({attach:function(view,placeholder){view.element.find(placeholder).replaceWith(this.render())},detach:function(){}}),transitionRegExp=/^(\w+)(:(\w+))?( (\w+))?$/,ViewContainer=Observable.extend({init:function(container){Observable.fn.init.call(this),this.container=container,this.history=[],this.view=null,this.running=!1},after:function(){this.running=!1,this.trigger("complete",{view:this.view}),this.trigger("after")},end:function(){this.view.showEnd(),this.previous.hideEnd(),this.after()},show:function(view,transition,locationID){if(!view.triggerBeforeShow())return this.trigger("after"),!1;locationID=locationID||view.id;var that=this,current=view===that.view?view.clone():that.view,history=that.history,previousEntry=history[history.length-2]||{},back=previousEntry.id===locationID,theTransition=transition||(back?history[history.length-1].transition:view.transition),transitionData=parseTransition(theTransition);return that.running&&that.effect.stop(),"none"===theTransition&&(theTransition=null),that.trigger("accepted",{view:view}),that.view=view,that.previous=current,that.running=!0,back?history.pop():history.push({id:locationID,transition:theTransition}),current?(current.hideStart(),theTransition&&kendo.effects.enabled?(view.element.addClass("k-fx-hidden"),view.showStart(),back&&!transition&&(transitionData.reverse=!transitionData.reverse),that.effect=kendo.fx(view.element).replace(current.element,transitionData.type).direction(transitionData.direction).setReverse(transitionData.reverse),that.effect.run().then(function(){that.end()})):(view.showStart(),that.end()),!0):(view.showStart(),view.showEnd(),that.after(),!0)}});kendo.ViewContainer=ViewContainer,kendo.Fragment=Fragment,kendo.Layout=Layout,kendo.View=View,kendo.ViewClone=ViewClone}(window.kendo.jQuery),function(){kendo.data.transports.signalr=kendo.data.RemoteTransport.extend({init:function(options){var signalr=options&&options.signalr?options.signalr:{},promise=signalr.promise;if(!promise)throw new Error('The "promise" option must be set.');if("function"!=typeof promise.done||"function"!=typeof promise.fail)throw new Error('The "promise" option must be a Promise.');this.promise=promise;var hub=signalr.hub;if(!hub)throw new Error('The "hub" option must be set.');if("function"!=typeof hub.on||"function"!=typeof hub.invoke)throw new Error('The "hub" option is not a valid SignalR hub proxy.');this.hub=hub,kendo.data.RemoteTransport.fn.init.call(this,options)},push:function(callbacks){var client=this.options.signalr.client||{};client.create&&this.hub.on(client.create,callbacks.pushCreate),client.update&&this.hub.on(client.update,callbacks.pushUpdate),client.destroy&&this.hub.on(client.destroy,callbacks.pushDestroy)},_crud:function(options,type){var hub=this.hub,server=this.options.signalr.server;if(!server||!server[type])throw new Error(kendo.format('The "server.{0}" option must be set.',type));var args=[server[type]],data=this.parameterMap(options.data,type);$.isEmptyObject(data)||args.push(data),this.promise.done(function(){hub.invoke.apply(hub,args).done(options.success).fail(options.error)})},read:function(options){this._crud(options,"read")},create:function(options){this._crud(options,"create")},update:function(options){this._crud(options,"update")},destroy:function(options){this._crud(options,"destroy")}})}(),function($,undefined){function resolveRules(element){var name,resolvers=kendo.ui.validator.ruleResolvers||{},rules={};for(name in resolvers)$.extend(!0,rules,resolvers[name].resolve(element));return rules}function decode(value){return value.replace(/&amp/g,"&amp;").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">")}function numberOfDecimalDigits(value){return value=(value+"").split("."),value.length>1?value[1].length:0}function parseHtml(text){return $($.parseHTML?$.parseHTML(text):text)}function searchForMessageContainer(elements,fieldName){for(var element,attr,containers=$(),idx=0,length=elements.length;idx<length;idx++)element=elements[idx],invalidMsgRegExp.test(element.className)&&(attr=element.getAttribute(kendo.attr("for")),attr===fieldName&&(containers=containers.add(element)));return containers}var kendo=window.kendo,Widget=kendo.ui.Widget,NS=".kendoValidator",INVALIDMSG="k-invalid-msg",invalidMsgRegExp=new RegExp(INVALIDMSG,"i"),INVALIDINPUT="k-invalid",emailRegExp=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,urlRegExp=/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,INPUTSELECTOR=":input:not(:button,[type=submit],[type=reset],[disabled],[readonly])",CHECKBOXSELECTOR=":checkbox:not([disabled],[readonly])",NUMBERINPUTSELECTOR="[type=number],[type=range]",BLUR="blur",NAME="name",FORM="form",NOVALIDATE="novalidate",proxy=$.proxy,patternMatcher=function(value,pattern){return"string"==typeof pattern&&(pattern=new RegExp("^(?:"+pattern+")$")),pattern.test(value)},matcher=function(input,selector,pattern){var value=input.val();return!input.filter(selector).length||""===value||patternMatcher(value,pattern)},hasAttribute=function(input,name){return!!input.length&&null!=input[0].attributes[name]};kendo.ui.validator||(kendo.ui.validator={rules:{},messages:{}});var Validator=Widget.extend({init:function(element,options){var that=this,resolved=resolveRules(element),validateAttributeSelector="["+kendo.attr("validate")+"!=false]";options=options||{},options.rules=$.extend({},kendo.ui.validator.rules,resolved.rules,options.rules),options.messages=$.extend({},kendo.ui.validator.messages,resolved.messages,options.messages),Widget.fn.init.call(that,element,options),that._errorTemplate=kendo.template(that.options.errorTemplate),that.element.is(FORM)&&that.element.attr(NOVALIDATE,NOVALIDATE),that._inputSelector=INPUTSELECTOR+validateAttributeSelector,that._checkboxSelector=CHECKBOXSELECTOR+validateAttributeSelector,that._errors={},that._attachEvents()},events:["validate"],options:{name:"Validator",errorTemplate:'<span class="k-widget k-tooltip k-tooltip-validation"><span class="k-icon k-warning"> </span> #=message#</span>',messages:{required:"{0} is required",pattern:"{0} is not valid",min:"{0} should be greater than or equal to {1}",max:"{0} should be smaller than or equal to {1}",step:"{0} is not valid",email:"{0} is not valid email",url:"{0} is not valid URL",date:"{0} is not valid date"},rules:{required:function(input){var checkbox=input.filter("[type=checkbox]").length&&!input.is(":checked"),value=input.val();return!(hasAttribute(input,"required")&&(""===value||!value||checkbox))},pattern:function(input){return!input.filter("[type=text],[type=email],[type=url],[type=tel],[type=search],[type=password]").filter("[pattern]").length||""===input.val()||patternMatcher(input.val(),input.attr("pattern"))},min:function(input){if(input.filter(NUMBERINPUTSELECTOR+",["+kendo.attr("type")+"=number]").filter("[min]").length&&""!==input.val()){var min=parseFloat(input.attr("min"))||0,val=kendo.parseFloat(input.val());return min<=val}return!0},max:function(input){if(input.filter(NUMBERINPUTSELECTOR+",["+kendo.attr("type")+"=number]").filter("[max]").length&&""!==input.val()){var max=parseFloat(input.attr("max"))||0,val=kendo.parseFloat(input.val());return max>=val}return!0},step:function(input){if(input.filter(NUMBERINPUTSELECTOR+",["+kendo.attr("type")+"=number]").filter("[step]").length&&""!==input.val()){var raise,min=parseFloat(input.attr("min"))||0,step=parseFloat(input.attr("step"))||1,val=parseFloat(input.val()),decimals=numberOfDecimalDigits(step);return decimals?(raise=Math.pow(10,decimals),(val-min)*raise%(step*raise)/Math.pow(100,decimals)===0):(val-min)%step===0}return!0},email:function(input){return matcher(input,"[type=email],["+kendo.attr("type")+"=email]",emailRegExp)},url:function(input){return matcher(input,"[type=url],["+kendo.attr("type")+"=url]",urlRegExp)},date:function(input){return!input.filter("[type^=date],["+kendo.attr("type")+"=date]").length||""===input.val()||null!==kendo.parseDate(input.val(),input.attr(kendo.attr("format")))}},validateOnBlur:!0},destroy:function(){Widget.fn.destroy.call(this),this.element.off(NS)},_submit:function(e){return!!this.validate()||(e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),!1)},_attachEvents:function(){var that=this;that.element.is(FORM)&&that.element.on("submit"+NS,proxy(that._submit,that)),that.options.validateOnBlur&&(that.element.is(INPUTSELECTOR)?(that.element.on(BLUR+NS,function(){that.validateInput(that.element)}),that.element.is(CHECKBOXSELECTOR)&&that.element.on("click"+NS,function(){that.validateInput(that.element)})):(that.element.on(BLUR+NS,that._inputSelector,function(){that.validateInput($(this))}),that.element.on("click"+NS,that._checkboxSelector,function(){that.validateInput($(this))})))},validate:function(){var inputs,idx,length,result=!1;if(this._errors={},this.element.is(INPUTSELECTOR))result=this.validateInput(this.element);else{var invalid=!1;for(inputs=this.element.find(this._inputSelector),idx=0,length=inputs.length;idx<length;idx++)this.validateInput(inputs.eq(idx))||(invalid=!0);result=!invalid}return this.trigger("validate",{valid:result}),result},validateInput:function(input){input=$(input);var messageText,that=this,template=that._errorTemplate,result=that._checkValidity(input),valid=result.valid,className="."+INVALIDMSG,fieldName=input.attr(NAME)||"",lbl=that._findMessageContainer(fieldName).add(input.next(className)).hide();if(input.removeAttr("aria-invalid"),!valid){messageText=that._extractMessage(input,result.key),that._errors[fieldName]=messageText;var messageLabel=parseHtml(template({message:decode(messageText)}));that._decorateMessageContainer(messageLabel,fieldName),lbl.replaceWith(messageLabel).length||messageLabel.insertAfter(input),messageLabel.show(),input.attr("aria-invalid",!0)}return input.toggleClass(INVALIDINPUT,!valid),valid},hideMessages:function(){var that=this,className="."+INVALIDMSG,element=that.element;element.is(INPUTSELECTOR)?element.next(className).hide():element.find(className).hide()},_findMessageContainer:function(fieldName){for(var name,locators=kendo.ui.validator.messageLocators,containers=$(),idx=0,length=this.element.length;idx<length;idx++)containers=containers.add(searchForMessageContainer(this.element[idx].getElementsByTagName("*"),fieldName));for(name in locators)containers=containers.add(locators[name].locate(this.element,fieldName));return containers},_decorateMessageContainer:function(container,fieldName){var name,locators=kendo.ui.validator.messageLocators;container.addClass(INVALIDMSG).attr(kendo.attr("for"),fieldName||"");for(name in locators)locators[name].decorate(container,fieldName);container.attr("role","alert")},_extractMessage:function(input,ruleKey){var that=this,customMessage=that.options.messages[ruleKey],fieldName=input.attr(NAME);return customMessage=kendo.isFunction(customMessage)?customMessage(input):customMessage,kendo.format(input.attr(kendo.attr(ruleKey+"-msg"))||input.attr("validationMessage")||input.attr("title")||customMessage||"",fieldName,input.attr(ruleKey))},_checkValidity:function(input){var rule,rules=this.options.rules;for(rule in rules)if(!rules[rule](input))return{valid:!1,key:rule};return{valid:!0}},errors:function(){var error,results=[],errors=this._errors;for(error in errors)results.push(errors[error]);return results}});kendo.ui.plugin(Validator)}(window.kendo.jQuery),function($,undefined){function touchDelta(touch1,touch2){var x1=touch1.x.location,y1=touch1.y.location,x2=touch2.x.location,y2=touch2.y.location,dx=x1-x2,dy=y1-y2;return{center:{x:(x1+x2)/2,y:(y1+y2)/2},distance:Math.sqrt(dx*dx+dy*dy)}}function getTouches(e){var length,changedTouches,touch,touches=[],originalEvent=e.originalEvent,currentTarget=e.currentTarget,idx=0;if(e.api)touches.push({id:2,event:e,target:e.target,currentTarget:e.target,location:e});else if(e.type.match(/touch/))for(changedTouches=originalEvent?originalEvent.changedTouches:[],length=changedTouches.length;idx<length;idx++)touch=changedTouches[idx],touches.push({location:touch,event:e,target:touch.target,currentTarget:currentTarget,id:touch.identifier});else support.pointers||support.msPointers?touches.push({location:originalEvent,event:e,target:e.target,currentTarget:currentTarget,id:originalEvent.pointerId}):touches.push({id:1,event:e,target:e.target,currentTarget:currentTarget,location:e});return touches}function withEachUpEvent(callback){for(var downEvents=kendo.eventMap.up.split(" "),idx=0,length=downEvents.length;idx<length;idx++)callback(downEvents[idx])}var kendo=window.kendo,support=kendo.support,document=window.document,Class=kendo.Class,Observable=kendo.Observable,SELECT_START="onselectstart"in document.documentElement&&support.browser.msie,now=$.now,extend=$.extend,OS=support.mobileOS,invalidZeroEvents=OS&&OS.android,DEFAULT_MIN_HOLD=800,DEFAULT_THRESHOLD=support.browser.msie?5:0,PRESS="press",HOLD="hold",SELECT="select",START="start",MOVE="move",END="end",CANCEL="cancel",TAP="tap",RELEASE="release",GESTURESTART="gesturestart",GESTURECHANGE="gesturechange",GESTUREEND="gestureend",GESTURETAP="gesturetap",TouchAxis=Class.extend({init:function(axis,location){var that=this;that.axis=axis,that._updateLocationData(location),that.startLocation=that.location,that.velocity=that.delta=0,that.timeStamp=now()},move:function(location){var that=this,offset=location["page"+that.axis],timeStamp=now(),timeDelta=timeStamp-that.timeStamp||1;!offset&&invalidZeroEvents||(that.delta=offset-that.location,that._updateLocationData(location),that.initialDelta=offset-that.startLocation,that.velocity=that.delta/timeDelta,that.timeStamp=timeStamp)},_updateLocationData:function(location){var that=this,axis=that.axis;that.location=location["page"+axis],that.client=location["client"+axis],that.screen=location["screen"+axis]}}),Touch=Class.extend({init:function(userEvents,target,touchInfo){extend(this,{x:new TouchAxis("X",touchInfo.location),y:new TouchAxis("Y",touchInfo.location),userEvents:userEvents,target:target,currentTarget:touchInfo.currentTarget,initialTouch:touchInfo.target,id:touchInfo.id,pressEvent:touchInfo,_moved:!1,_finished:!1})},press:function(){this._holdTimeout=setTimeout($.proxy(this,"_hold"),this.userEvents.minHold),this._trigger(PRESS,this.pressEvent)},_hold:function(){this._trigger(HOLD,this.pressEvent)},move:function(touchInfo){var that=this;if(!that._finished){if(that.x.move(touchInfo.location),that.y.move(touchInfo.location),!that._moved){if(that._withinIgnoreThreshold())return;if(UserEvents.current&&UserEvents.current!==that.userEvents)return that.dispose();that._start(touchInfo)}that._finished||that._trigger(MOVE,touchInfo)}},end:function(touchInfo){var that=this;that.endTime=now(),that._finished||(that._finished=!0,that._moved?that._trigger(END,touchInfo):that._trigger(TAP,touchInfo),clearTimeout(that._holdTimeout),that._trigger(RELEASE,touchInfo),that.dispose())},dispose:function(){var userEvents=this.userEvents,activeTouches=userEvents.touches;this._finished=!0,this.pressEvent=null,clearTimeout(this._holdTimeout),activeTouches.splice($.inArray(this,activeTouches),1)},skip:function(){this.dispose()},cancel:function(){this.dispose()},isMoved:function(){return this._moved},_start:function(touchInfo){clearTimeout(this._holdTimeout),this.startTime=now(),
this._moved=!0,this._trigger(START,touchInfo)},_trigger:function(name,touchInfo){var that=this,jQueryEvent=touchInfo.event,data={touch:that,x:that.x,y:that.y,target:that.target,event:jQueryEvent};that.userEvents.notify(name,data)&&jQueryEvent.preventDefault()},_withinIgnoreThreshold:function(){var xDelta=this.x.initialDelta,yDelta=this.y.initialDelta;return Math.sqrt(xDelta*xDelta+yDelta*yDelta)<=this.userEvents.threshold}}),UserEvents=Observable.extend({init:function(element,options){var filter,that=this,ns=kendo.guid();if(options=options||{},filter=that.filter=options.filter,that.threshold=options.threshold||DEFAULT_THRESHOLD,that.minHold=options.minHold||DEFAULT_MIN_HOLD,that.touches=[],that._maxTouches=options.multiTouch?2:1,that.allowSelection=options.allowSelection,that.captureUpIfMoved=options.captureUpIfMoved,that.eventNS=ns,element=$(element).handler(that),Observable.fn.init.call(that),extend(that,{element:element,surface:$(options.global?document.documentElement:options.surface||element),stopPropagation:options.stopPropagation,pressed:!1}),that.surface.handler(that).on(kendo.applyEventMap("move",ns),"_move").on(kendo.applyEventMap("up cancel",ns),"_end"),element.on(kendo.applyEventMap("down",ns),filter,"_start"),(support.pointers||support.msPointers)&&element.css("-ms-touch-action","pinch-zoom double-tap-zoom"),options.preventDragEvent&&element.on(kendo.applyEventMap("dragstart",ns),kendo.preventDefault),SELECT_START?element.on(kendo.applyEventMap("selectstart",ns),filter,{root:element},"_select"):element.on(kendo.applyEventMap("mousedown",ns),filter,{root:element},"_select"),that.captureUpIfMoved&&support.eventCapture){var surfaceElement=that.surface[0],preventIfMovingProxy=$.proxy(that.preventIfMoving,that);withEachUpEvent(function(eventName){surfaceElement.addEventListener(eventName,preventIfMovingProxy,!0)})}that.bind([PRESS,HOLD,TAP,START,MOVE,END,RELEASE,CANCEL,GESTURESTART,GESTURECHANGE,GESTUREEND,GESTURETAP,SELECT],options)},preventIfMoving:function(e){this._isMoved()&&e.preventDefault()},destroy:function(){var that=this;if(!that._destroyed){if(that._destroyed=!0,that.captureUpIfMoved&&support.eventCapture){var surfaceElement=that.surface[0];withEachUpEvent(function(eventName){surfaceElement.removeEventListener(eventName,that.preventIfMoving)})}that.element.kendoDestroy(that.eventNS),that.surface.kendoDestroy(that.eventNS),that.element.removeData("handler"),that.surface.removeData("handler"),that._disposeAll(),that.unbind(),delete that.surface,delete that.element,delete that.currentTarget}},capture:function(){UserEvents.current=this},cancel:function(){this._disposeAll(),this.trigger(CANCEL)},notify:function(eventName,data){var that=this,touches=that.touches;if(this._isMultiTouch()){switch(eventName){case MOVE:eventName=GESTURECHANGE;break;case END:eventName=GESTUREEND;break;case TAP:eventName=GESTURETAP}extend(data,{touches:touches},touchDelta(touches[0],touches[1]))}return SELECT_START||eventName!=CANCEL&&eventName!=END||$(document.body).css("userSelect",""),this.trigger(eventName,data)},press:function(x,y,target){this._apiCall("_start",x,y,target)},move:function(x,y){this._apiCall("_move",x,y)},end:function(x,y){this._apiCall("_end",x,y)},_isMultiTouch:function(){return this.touches.length>1},_maxTouchesReached:function(){return this.touches.length>=this._maxTouches},_disposeAll:function(){for(var touches=this.touches;touches.length>0;)touches.pop().dispose()},_isMoved:function(){return $.grep(this.touches,function(touch){return touch.isMoved()}).length},_select:function(e){this.allowSelection&&!this.trigger(SELECT,{event:e})||(SELECT_START?e.preventDefault():$(document.body).css("userSelect","none"))},_start:function(e){var target,touch,that=this,idx=0,filter=that.filter,touches=getTouches(e),length=touches.length,which=e.which;if(!(which&&which>1||that._maxTouchesReached()))for(UserEvents.current=null,that.currentTarget=e.currentTarget,that.stopPropagation&&e.stopPropagation();idx<length&&!that._maxTouchesReached();idx++)touch=touches[idx],target=filter?$(touch.currentTarget):that.element,target.length&&(touch=new Touch(that,target,touch),that.touches.push(touch),touch.press(),that._isMultiTouch()&&that.notify("gesturestart",{}))},_move:function(e){this._eachTouch("move",e)},_end:function(e){this._eachTouch("end",e)},_eachTouch:function(methodName,e){var idx,touch,touchInfo,matchingTouch,that=this,dict={},touches=getTouches(e),activeTouches=that.touches;for(idx=0;idx<activeTouches.length;idx++)touch=activeTouches[idx],dict[touch.id]=touch;for(idx=0;idx<touches.length;idx++)touchInfo=touches[idx],matchingTouch=dict[touchInfo.id],matchingTouch&&matchingTouch[methodName](touchInfo)},_apiCall:function(type,x,y,target){this[type]({api:!0,pageX:x,pageY:y,clientX:x,clientY:y,target:$(target||this.element)[0],stopPropagation:$.noop,preventDefault:$.noop})}});UserEvents.minHold=function(value){DEFAULT_MIN_HOLD=value},kendo.getTouches=getTouches,kendo.touchDelta=touchDelta,kendo.UserEvents=UserEvents}(window.kendo.jQuery),function($,undefined){function contains(parent,child){try{return $.contains(parent,child)||parent==child}catch(e){return!1}}function numericCssPropery(element,property){return parseInt(element.css(property),10)||0}function within(value,range){return Math.min(Math.max(value,range.min),range.max)}function containerBoundaries(container,element){var offset=getOffset(container),minX=offset.left+numericCssPropery(container,"borderLeftWidth")+numericCssPropery(container,"paddingLeft"),minY=offset.top+numericCssPropery(container,"borderTopWidth")+numericCssPropery(container,"paddingTop"),maxX=minX+container.width()-element.outerWidth(!0),maxY=minY+container.height()-element.outerHeight(!0);return{x:{min:minX,max:maxX},y:{min:minY,max:maxY}}}function checkTarget(target,targets,areas){for(var theTarget,theFilter,i=0,targetLen=targets&&targets.length,areaLen=areas&&areas.length;target&&target.parentNode;){for(i=0;i<targetLen;i++)if(theTarget=targets[i],theTarget.element[0]===target)return{target:theTarget,targetElement:target};for(i=0;i<areaLen;i++)if(theFilter=areas[i],support.matchesSelector.call(target,theFilter.options.filter))return{target:theFilter,targetElement:target};target=target.parentNode}return undefined}var lastDropTarget,translate,kendo=window.kendo,support=kendo.support,document=window.document,Class=kendo.Class,Widget=kendo.ui.Widget,Observable=kendo.Observable,UserEvents=kendo.UserEvents,proxy=$.proxy,extend=$.extend,getOffset=kendo.getOffset,draggables={},dropTargets={},dropAreas={},elementUnderCursor=kendo.elementUnderCursor,KEYUP="keyup",CHANGE="change",DRAGSTART="dragstart",HOLD="hold",DRAG="drag",DRAGEND="dragend",DRAGCANCEL="dragcancel",DRAGENTER="dragenter",DRAGLEAVE="dragleave",DROP="drop",TapCapture=Observable.extend({init:function(element,options){var that=this,domElement=element[0];that.capture=!1,domElement.addEventListener?($.each(kendo.eventMap.down.split(" "),function(){domElement.addEventListener(this,proxy(that._press,that),!0)}),$.each(kendo.eventMap.up.split(" "),function(){domElement.addEventListener(this,proxy(that._release,that),!0)})):($.each(kendo.eventMap.down.split(" "),function(){domElement.attachEvent(this,proxy(that._press,that))}),$.each(kendo.eventMap.up.split(" "),function(){domElement.attachEvent(this,proxy(that._release,that))})),Observable.fn.init.call(that),that.bind(["press","release"],options||{})},captureNext:function(){this.capture=!0},cancelCapture:function(){this.capture=!1},_press:function(e){var that=this;that.trigger("press"),that.capture&&e.preventDefault()},_release:function(e){var that=this;that.trigger("release"),that.capture&&(e.preventDefault(),that.cancelCapture())}}),PaneDimension=Observable.extend({init:function(options){var that=this;Observable.fn.init.call(that),that.forcedEnabled=!1,$.extend(that,options),that.scale=1,that.horizontal?(that.measure="offsetWidth",that.scrollSize="scrollWidth",that.axis="x"):(that.measure="offsetHeight",that.scrollSize="scrollHeight",that.axis="y")},makeVirtual:function(){$.extend(this,{virtual:!0,forcedEnabled:!0,_virtualMin:0,_virtualMax:0})},virtualSize:function(min,max){this._virtualMin===min&&this._virtualMax===max||(this._virtualMin=min,this._virtualMax=max,this.update())},outOfBounds:function(offset){return offset>this.max||offset<this.min},forceEnabled:function(){this.forcedEnabled=!0},getSize:function(){return this.container[0][this.measure]},getTotal:function(){return this.element[0][this.scrollSize]},rescale:function(scale){this.scale=scale},update:function(silent){var that=this,total=that.virtual?that._virtualMax:that.getTotal(),scaledTotal=total*that.scale,size=that.getSize();that.max=that.virtual?-that._virtualMin:0,that.size=size,that.total=scaledTotal,that.min=Math.min(that.max,size-scaledTotal),that.minScale=size/total,that.centerOffset=(scaledTotal-size)/2,that.enabled=that.forcedEnabled||scaledTotal>size,silent||that.trigger(CHANGE,that)}}),PaneDimensions=Observable.extend({init:function(options){var that=this;Observable.fn.init.call(that),that.x=new PaneDimension(extend({horizontal:!0},options)),that.y=new PaneDimension(extend({horizontal:!1},options)),that.container=options.container,that.forcedMinScale=options.minScale,that.maxScale=options.maxScale||100,that.bind(CHANGE,options)},rescale:function(newScale){this.x.rescale(newScale),this.y.rescale(newScale),this.refresh()},centerCoordinates:function(){return{x:Math.min(0,-this.x.centerOffset),y:Math.min(0,-this.y.centerOffset)}},refresh:function(){var that=this;that.x.update(),that.y.update(),that.enabled=that.x.enabled||that.y.enabled,that.minScale=that.forcedMinScale||Math.min(that.x.minScale,that.y.minScale),that.fitScale=Math.max(that.x.minScale,that.y.minScale),that.trigger(CHANGE)}}),PaneAxis=Observable.extend({init:function(options){var that=this;extend(that,options),Observable.fn.init.call(that)},outOfBounds:function(){return this.dimension.outOfBounds(this.movable[this.axis])},dragMove:function(delta){var that=this,dimension=that.dimension,axis=that.axis,movable=that.movable,position=movable[axis]+delta;dimension.enabled&&((position<dimension.min&&delta<0||position>dimension.max&&delta>0)&&(delta*=that.resistance),movable.translateAxis(axis,delta),that.trigger(CHANGE,that))}}),Pane=Class.extend({init:function(options){var x,y,resistance,movable,that=this;extend(that,{elastic:!0},options),resistance=that.elastic?.5:0,movable=that.movable,that.x=x=new PaneAxis({axis:"x",dimension:that.dimensions.x,resistance:resistance,movable:movable}),that.y=y=new PaneAxis({axis:"y",dimension:that.dimensions.y,resistance:resistance,movable:movable}),that.userEvents.bind(["move","end","gesturestart","gesturechange"],{gesturestart:function(e){that.gesture=e,that.offset=that.dimensions.container.offset()},gesturechange:function(e){var coordinates,previousGesture=that.gesture,previousCenter=previousGesture.center,center=e.center,scaleDelta=e.distance/previousGesture.distance,minScale=that.dimensions.minScale,maxScale=that.dimensions.maxScale;movable.scale<=minScale&&scaleDelta<1&&(scaleDelta+=.8*(1-scaleDelta)),movable.scale*scaleDelta>=maxScale&&(scaleDelta=maxScale/movable.scale);var offsetX=movable.x+that.offset.left,offsetY=movable.y+that.offset.top;coordinates={x:(offsetX-previousCenter.x)*scaleDelta+center.x-offsetX,y:(offsetY-previousCenter.y)*scaleDelta+center.y-offsetY},movable.scaleWith(scaleDelta),x.dragMove(coordinates.x),y.dragMove(coordinates.y),that.dimensions.rescale(movable.scale),that.gesture=e,e.preventDefault()},move:function(e){e.event.target.tagName.match(/textarea|input/i)||(x.dimension.enabled||y.dimension.enabled?(x.dragMove(e.x.delta),y.dragMove(e.y.delta),e.preventDefault()):e.touch.skip())},end:function(e){e.preventDefault()}})}}),TRANSFORM_STYLE=support.transitions.prefix+"Transform";translate=support.hasHW3D?function(x,y,scale){return"translate3d("+x+"px,"+y+"px,0) scale("+scale+")"}:function(x,y,scale){return"translate("+x+"px,"+y+"px) scale("+scale+")"};var Movable=Observable.extend({init:function(element){var that=this;Observable.fn.init.call(that),that.element=$(element),that.element[0].style.webkitTransformOrigin="left top",that.x=0,that.y=0,that.scale=1,that._saveCoordinates(translate(that.x,that.y,that.scale))},translateAxis:function(axis,by){this[axis]+=by,this.refresh()},scaleTo:function(scale){this.scale=scale,this.refresh()},scaleWith:function(scaleDelta){this.scale*=scaleDelta,this.refresh()},translate:function(coordinates){this.x+=coordinates.x,this.y+=coordinates.y,this.refresh()},moveAxis:function(axis,value){this[axis]=value,this.refresh()},moveTo:function(coordinates){extend(this,coordinates),this.refresh()},refresh:function(){var newCoordinates,that=this,x=that.x,y=that.y;that.round&&(x=Math.round(x),y=Math.round(y)),newCoordinates=translate(x,y,that.scale),newCoordinates!=that.coordinates&&(kendo.support.browser.msie&&kendo.support.browser.version<10?(that.element[0].style.position="absolute",that.element[0].style.left=that.x+"px",that.element[0].style.top=that.y+"px"):that.element[0].style[TRANSFORM_STYLE]=newCoordinates,that._saveCoordinates(newCoordinates),that.trigger(CHANGE))},_saveCoordinates:function(coordinates){this.coordinates=coordinates}}),DropTarget=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options);var group=that.options.group;group in dropTargets?dropTargets[group].push(that):dropTargets[group]=[that]},events:[DRAGENTER,DRAGLEAVE,DROP],options:{name:"DropTarget",group:"default"},destroy:function(){var i,groupName=this.options.group,group=dropTargets[groupName]||dropAreas[groupName];if(group.length>1){for(Widget.fn.destroy.call(this),i=0;i<group.length;i++)if(group[i]==this){group.splice(i,1);break}}else DropTarget.destroyGroup(groupName)},_trigger:function(eventName,e){var that=this,draggable=draggables[that.options.group];if(draggable)return that.trigger(eventName,extend({},e.event,{draggable:draggable,dropTarget:e.dropTarget}))},_over:function(e){this._trigger(DRAGENTER,e)},_out:function(e){this._trigger(DRAGLEAVE,e)},_drop:function(e){var that=this,draggable=draggables[that.options.group];draggable&&(draggable.dropped=!that._trigger(DROP,e))}});DropTarget.destroyGroup=function(groupName){var i,group=dropTargets[groupName]||dropAreas[groupName];if(group){for(i=0;i<group.length;i++)Widget.fn.destroy.call(group[i]);group.length=0,delete dropTargets[groupName],delete dropAreas[groupName]}},DropTarget._cache=dropTargets;var DropTargetArea=DropTarget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options);var group=that.options.group;group in dropAreas?dropAreas[group].push(that):dropAreas[group]=[that]},options:{name:"DropTargetArea",group:"default",filter:null}}),Draggable=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),that._activated=!1,that.userEvents=new UserEvents(that.element,{global:!0,allowSelection:!0,stopPropagation:!0,filter:that.options.filter,threshold:that.options.distance,start:proxy(that._start,that),hold:proxy(that._hold,that),move:proxy(that._drag,that),end:proxy(that._end,that),cancel:proxy(that._cancel,that),select:proxy(that._select,that)}),that._afterEndHandler=proxy(that._afterEnd,that),that._captureEscape=proxy(that._captureEscape,that)},events:[HOLD,DRAGSTART,DRAG,DRAGEND,DRAGCANCEL],options:{name:"Draggable",distance:5,group:"default",cursorOffset:null,axis:null,container:null,filter:null,ignore:null,holdToDrag:!1,dropped:!1},cancelHold:function(){this._activated=!1},_captureEscape:function(e){var that=this;e.keyCode===kendo.keys.ESC&&(that._trigger(DRAGCANCEL,{event:e}),that.userEvents.cancel())},_updateHint:function(e){var coordinates,that=this,options=that.options,boundaries=that.boundaries,axis=options.axis,cursorOffset=that.options.cursorOffset;cursorOffset?coordinates={left:e.x.location+cursorOffset.left,top:e.y.location+cursorOffset.top}:(that.hintOffset.left+=e.x.delta,that.hintOffset.top+=e.y.delta,coordinates=$.extend({},that.hintOffset)),boundaries&&(coordinates.top=within(coordinates.top,boundaries.y),coordinates.left=within(coordinates.left,boundaries.x)),"x"===axis?delete coordinates.top:"y"===axis&&delete coordinates.left,that.hint.css(coordinates)},_shouldIgnoreTarget:function(target){var ignoreSelector=this.options.ignore;return ignoreSelector&&$(target).is(ignoreSelector)},_select:function(e){this._shouldIgnoreTarget(e.event.target)||e.preventDefault()},_start:function(e){var that=this,options=that.options,container=options.container,hint=options.hint;if(this._shouldIgnoreTarget(e.touch.initialTouch)||options.holdToDrag&&!that._activated)return void that.userEvents.cancel();if(that.currentTarget=e.target,that.currentTargetOffset=getOffset(that.currentTarget),hint){that.hint&&that.hint.stop(!0,!0).remove(),that.hint=kendo.isFunction(hint)?$(hint.call(that,that.currentTarget)):hint;var offset=getOffset(that.currentTarget);that.hintOffset=offset,that.hint.css({position:"absolute",zIndex:2e4,left:offset.left,top:offset.top}).appendTo(document.body)}draggables[options.group]=that,that.dropped=!1,container&&(that.boundaries=containerBoundaries(container,that.hint)),that._trigger(DRAGSTART,e)&&(that.userEvents.cancel(),that._afterEnd()),$(document).on(KEYUP,that._captureEscape)},_hold:function(e){this.currentTarget=e.target,this._trigger(HOLD,e)?this.userEvents.cancel():this._activated=!0},_drag:function(e){var that=this;e.preventDefault(),that._withDropTarget(e,function(target,targetElement){if(!target)return void(lastDropTarget&&(lastDropTarget._trigger(DRAGLEAVE,extend(e,{dropTarget:$(lastDropTarget.targetElement)})),lastDropTarget=null));if(lastDropTarget){if(targetElement===lastDropTarget.targetElement)return;lastDropTarget._trigger(DRAGLEAVE,extend(e,{dropTarget:$(lastDropTarget.targetElement)}))}target._trigger(DRAGENTER,extend(e,{dropTarget:$(targetElement)})),lastDropTarget=extend(target,{targetElement:targetElement})}),that._trigger(DRAG,e),that.hint&&that._updateHint(e)},_end:function(e){var that=this;that._withDropTarget(e,function(target,targetElement){target&&(target._drop(extend({},e,{dropTarget:$(targetElement)})),lastDropTarget=null)}),that._trigger(DRAGEND,e),that._cancel(e.event)},_cancel:function(){var that=this;that._activated=!1,that.hint&&!that.dropped?setTimeout(function(){that.hint.stop(!0,!0).animate(that.currentTargetOffset,"fast",that._afterEndHandler)},0):that._afterEnd()},_trigger:function(eventName,e){var that=this;return that.trigger(eventName,extend({},e.event,{x:e.x,y:e.y,currentTarget:that.currentTarget,dropTarget:e.dropTarget}))},_withDropTarget:function(e,callback){var target,result,that=this,options=that.options,targets=dropTargets[options.group],areas=dropAreas[options.group];(targets&&targets.length||areas&&areas.length)&&(target=elementUnderCursor(e),that.hint&&contains(that.hint[0],target)&&(that.hint.hide(),target=elementUnderCursor(e),target||(target=elementUnderCursor(e)),that.hint.show()),result=checkTarget(target,targets,areas),result?callback(result.target,result.targetElement):callback())},destroy:function(){var that=this;Widget.fn.destroy.call(that),that._afterEnd(),that.userEvents.destroy(),that.currentTarget=null},_afterEnd:function(){var that=this;that.hint&&that.hint.remove(),delete draggables[that.options.group],that.trigger("destroy"),$(document).off(KEYUP,that._captureEscape)}});kendo.ui.plugin(DropTarget),kendo.ui.plugin(DropTargetArea),kendo.ui.plugin(Draggable),kendo.TapCapture=TapCapture,kendo.containerBoundaries=containerBoundaries,extend(kendo.ui,{Pane:Pane,PaneDimensions:PaneDimensions,Movable:Movable})}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,mobile=kendo.mobile,fx=kendo.effects,ui=mobile.ui,proxy=$.proxy,extend=$.extend,Widget=ui.Widget,Class=kendo.Class,Movable=kendo.ui.Movable,Pane=kendo.ui.Pane,PaneDimensions=kendo.ui.PaneDimensions,Transition=fx.Transition,Animation=fx.Animation,abs=Math.abs,SNAPBACK_DURATION=500,SCROLLBAR_OPACITY=.7,FRICTION=.96,VELOCITY_MULTIPLIER=10,MAX_VELOCITY=55,OUT_OF_BOUNDS_FRICTION=.5,ANIMATED_SCROLLER_PRECISION=5,RELEASECLASS="km-scroller-release",REFRESHCLASS="km-scroller-refresh",PULL="pull",CHANGE="change",RESIZE="resize",SCROLL="scroll",MOUSE_WHEEL_ID=2,ZoomSnapBack=Animation.extend({init:function(options){var that=this;Animation.fn.init.call(that),extend(that,options),that.userEvents.bind("gestureend",proxy(that.start,that)),that.tapCapture.bind("press",proxy(that.cancel,that))},enabled:function(){return this.movable.scale<this.dimensions.minScale},done:function(){return this.dimensions.minScale-this.movable.scale<.01},tick:function(){var movable=this.movable;movable.scaleWith(1.1),this.dimensions.rescale(movable.scale)},onEnd:function(){var movable=this.movable;movable.scaleTo(this.dimensions.minScale),this.dimensions.rescale(movable.scale)}}),DragInertia=Animation.extend({init:function(options){var that=this;Animation.fn.init.call(that),extend(that,options,{transition:new Transition({axis:options.axis,movable:options.movable,onEnd:function(){that._end()}})}),that.tapCapture.bind("press",function(){that.cancel()}),that.userEvents.bind("end",proxy(that.start,that)),that.userEvents.bind("gestureend",proxy(that.start,that)),that.userEvents.bind("tap",proxy(that.onEnd,that))},onCancel:function(){this.transition.cancel()},freeze:function(location){var that=this;that.cancel(),that._moveTo(location)},onEnd:function(){var that=this;that.paneAxis.outOfBounds()?that._snapBack():that._end()},done:function(){return abs(this.velocity)<1},start:function(e){var velocity,that=this;that.dimension.enabled&&(that.paneAxis.outOfBounds()?that._snapBack():(velocity=e.touch.id===MOUSE_WHEEL_ID?0:e.touch[that.axis].velocity,that.velocity=Math.max(Math.min(velocity*that.velocityMultiplier,MAX_VELOCITY),-MAX_VELOCITY),that.tapCapture.captureNext(),Animation.fn.start.call(that)))},tick:function(){var that=this,dimension=that.dimension,friction=that.paneAxis.outOfBounds()?OUT_OF_BOUNDS_FRICTION:that.friction,delta=that.velocity*=friction,location=that.movable[that.axis]+delta;!that.elastic&&dimension.outOfBounds(location)&&(location=Math.max(Math.min(location,dimension.max),dimension.min),that.velocity=0),that.movable.moveAxis(that.axis,location)},_end:function(){this.tapCapture.cancelCapture(),this.end()},_snapBack:function(){var that=this,dimension=that.dimension,snapBack=that.movable[that.axis]>dimension.max?dimension.max:dimension.min;that._moveTo(snapBack)},_moveTo:function(location){this.transition.moveTo({location:location,duration:SNAPBACK_DURATION,ease:Transition.easeOutExpo})}}),AnimatedScroller=Animation.extend({init:function(options){var that=this;kendo.effects.Animation.fn.init.call(this),extend(that,options,{origin:{},destination:{},offset:{}})},tick:function(){this._updateCoordinates(),this.moveTo(this.origin)},done:function(){return abs(this.offset.y)<ANIMATED_SCROLLER_PRECISION&&abs(this.offset.x)<ANIMATED_SCROLLER_PRECISION},onEnd:function(){this.moveTo(this.destination)},setCoordinates:function(from,to){this.offset={},this.origin=from,this.destination=to},_updateCoordinates:function(){this.offset={x:(this.destination.x-this.origin.x)/4,y:(this.destination.y-this.origin.y)/4},this.origin={y:this.origin.y+this.offset.y,x:this.origin.x+this.offset.x}}}),ScrollBar=Class.extend({init:function(options){var that=this,horizontal="x"===options.axis,element=$('<div class="km-touch-scrollbar km-'+(horizontal?"horizontal":"vertical")+'-scrollbar" />');extend(that,options,{element:element,elementSize:0,movable:new Movable(element),scrollMovable:options.movable,size:horizontal?"width":"height"}),that.scrollMovable.bind(CHANGE,proxy(that._move,that)),that.container.append(element)},_move:function(){var that=this,axis=that.axis,dimension=that.dimension,paneSize=dimension.size,scrollMovable=that.scrollMovable,sizeRatio=paneSize/dimension.total,position=Math.round(-scrollMovable[axis]*sizeRatio),size=Math.round(paneSize*sizeRatio);position+size>paneSize?size=paneSize-position:position<0&&(size+=position,position=0),that.elementSize!=size&&(that.element.css(that.size,size+"px"),that.elementSize=size),that.movable.moveAxis(axis,position)},show:function(){this.element.css({opacity:SCROLLBAR_OPACITY,visibility:"visible"})},hide:function(){this.element.css({opacity:0})}}),Scroller=Widget.extend({init:function(element,options){var that=this;if(Widget.fn.init.call(that,element,options),element=that.element,that._native=that.options.useNative&&kendo.support.hasNativeScrolling,that._native)return element.addClass("km-native-scroller").prepend('<div class="km-scroll-header"/>'),void extend(that,{scrollElement:element,fixedContainer:element.children().first()});element.css("overflow","hidden").addClass("km-scroll-wrapper").wrapInner('<div class="km-scroll-container"/>').prepend('<div class="km-scroll-header"/>');var inner=element.children().eq(1),tapCapture=new kendo.TapCapture(element),movable=new Movable(inner),dimensions=new PaneDimensions({element:inner,container:element,forcedEnabled:that.options.zoom}),avoidScrolling=this.options.avoidScrolling,userEvents=new kendo.UserEvents(element,{allowSelection:!0,preventDragEvent:!0,captureUpIfMoved:!0,multiTouch:that.options.zoom,start:function(e){dimensions.refresh();var velocityX=abs(e.x.velocity),velocityY=abs(e.y.velocity),horizontalSwipe=2*velocityX>=velocityY,originatedFromFixedContainer=$.contains(that.fixedContainer[0],e.event.target),verticalSwipe=2*velocityY>=velocityX;!originatedFromFixedContainer&&!avoidScrolling(e)&&that.enabled&&(dimensions.x.enabled&&horizontalSwipe||dimensions.y.enabled&&verticalSwipe)?userEvents.capture():userEvents.cancel()}}),pane=new Pane({movable:movable,dimensions:dimensions,userEvents:userEvents,elastic:that.options.elastic}),zoomSnapBack=new ZoomSnapBack({movable:movable,dimensions:dimensions,userEvents:userEvents,tapCapture:tapCapture}),animatedScroller=new AnimatedScroller({moveTo:function(coordinates){that.scrollTo(coordinates.x,coordinates.y)}});movable.bind(CHANGE,function(){that.scrollTop=-movable.y,that.scrollLeft=-movable.x,that.trigger(SCROLL,{scrollTop:that.scrollTop,scrollLeft:that.scrollLeft})}),that.options.mousewheelScrolling&&element.on("DOMMouseScroll mousewheel",proxy(this,"_wheelScroll")),extend(that,{movable:movable,dimensions:dimensions,zoomSnapBack:zoomSnapBack,animatedScroller:animatedScroller,userEvents:userEvents,pane:pane,tapCapture:tapCapture,pulled:!1,enabled:!0,scrollElement:inner,scrollTop:0,scrollLeft:0,fixedContainer:element.children().first()}),that._initAxis("x"),that._initAxis("y"),that._wheelEnd=function(){that._wheel=!1,that.userEvents.end(0,that._wheelY)},dimensions.refresh(),that.options.pullToRefresh&&that._initPullToRefresh()},_wheelScroll:function(e){this._wheel||(this._wheel=!0,this._wheelY=0,this.userEvents.press(0,this._wheelY)),clearTimeout(this._wheelTimeout),this._wheelTimeout=setTimeout(this._wheelEnd,50);var delta=kendo.wheelDeltaY(e);delta&&(this._wheelY+=delta,this.userEvents.move(0,this._wheelY)),e.preventDefault()},makeVirtual:function(){this.dimensions.y.makeVirtual()},virtualSize:function(min,max){this.dimensions.y.virtualSize(min,max)},height:function(){return this.dimensions.y.size},scrollHeight:function(){return this.scrollElement[0].scrollHeight},scrollWidth:function(){return this.scrollElement[0].scrollWidth},options:{name:"Scroller",zoom:!1,pullOffset:140,elastic:!0,useNative:!1,mousewheelScrolling:!0,avoidScrolling:function(){return!1},pullToRefresh:!1,pullTemplate:"Pull to refresh",releaseTemplate:"Release to refresh",refreshTemplate:"Refreshing"},events:[PULL,SCROLL,RESIZE],_resize:function(){this._native||this.contentResized()},setOptions:function(options){var that=this;Widget.fn.setOptions.call(that,options),options.pullToRefresh&&that._initPullToRefresh()},reset:function(){this._native?this.scrollElement.scrollTop(0):(this.movable.moveTo({x:0,y:0}),this._scale(1))},contentResized:function(){this.dimensions.refresh(),this.pane.x.outOfBounds()&&this.movable.moveAxis("x",this.dimensions.x.min),this.pane.y.outOfBounds()&&this.movable.moveAxis("y",this.dimensions.y.min)},zoomOut:function(){var dimensions=this.dimensions;dimensions.refresh(),this._scale(dimensions.fitScale),this.movable.moveTo(dimensions.centerCoordinates())},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},scrollTo:function(x,y){this._native?(this.scrollElement.scrollLeft(abs(x)),this.scrollElement.scrollTop(abs(y))):(this.dimensions.refresh(),this.movable.moveTo({x:x,y:y}))},animatedScrollTo:function(x,y){var from,to;this._native?this.scrollTo(x,y):(from={x:this.movable.x,y:this.movable.y},to={x:x,y:y},this.animatedScroller.setCoordinates(from,to),this.animatedScroller.start())},pullHandled:function(){var that=this;that.refreshHint.removeClass(REFRESHCLASS),that.hintContainer.html(that.pullTemplate({})),that.yinertia.onEnd(),that.xinertia.onEnd(),that.userEvents.cancel()},destroy:function(){Widget.fn.destroy.call(this),this.userEvents&&this.userEvents.destroy()},_scale:function(scale){this.dimensions.rescale(scale),this.movable.scaleTo(scale)},_initPullToRefresh:function(){var that=this;that.dimensions.y.forceEnabled(),that.pullTemplate=kendo.template(that.options.pullTemplate),that.releaseTemplate=kendo.template(that.options.releaseTemplate),that.refreshTemplate=kendo.template(that.options.refreshTemplate),that.scrollElement.prepend('<span class="km-scroller-pull"><span class="km-icon"></span><span class="km-loading-left"></span><span class="km-loading-right"></span><span class="km-template">'+that.pullTemplate({})+"</span></span>"),that.refreshHint=that.scrollElement.children().first(),that.hintContainer=that.refreshHint.children(".km-template"),that.pane.y.bind("change",proxy(that._paneChange,that)),that.userEvents.bind("end",proxy(that._dragEnd,that))},_dragEnd:function(){var that=this;that.pulled&&(that.pulled=!1,that.refreshHint.removeClass(RELEASECLASS).addClass(REFRESHCLASS),that.hintContainer.html(that.refreshTemplate({})),that.yinertia.freeze(that.options.pullOffset/2),that.trigger("pull"))},_paneChange:function(){var that=this;that.movable.y/OUT_OF_BOUNDS_FRICTION>that.options.pullOffset?that.pulled||(that.pulled=!0,that.refreshHint.removeClass(REFRESHCLASS).addClass(RELEASECLASS),that.hintContainer.html(that.releaseTemplate({}))):that.pulled&&(that.pulled=!1,that.refreshHint.removeClass(RELEASECLASS),that.hintContainer.html(that.pullTemplate({})))},_initAxis:function(axis){var that=this,movable=that.movable,dimension=that.dimensions[axis],tapCapture=that.tapCapture,paneAxis=that.pane[axis],scrollBar=new ScrollBar({axis:axis,movable:movable,dimension:dimension,container:that.element});paneAxis.bind(CHANGE,function(){scrollBar.show()}),that[axis+"inertia"]=new DragInertia({axis:axis,paneAxis:paneAxis,movable:movable,tapCapture:tapCapture,userEvents:that.userEvents,dimension:dimension,elastic:that.options.elastic,friction:that.options.friction||FRICTION,velocityMultiplier:that.options.velocityMultiplier||VELOCITY_MULTIPLIER,end:function(){scrollBar.hide(),that.trigger("scrollEnd",{axis:axis,scrollTop:that.scrollTop,scrollLeft:that.scrollLeft})}})}});ui.plugin(Scroller)}(window.kendo.jQuery),function($,undefined){function dropCueOffsetTop(element){return element.position().top+3}var kendo=window.kendo,Widget=kendo.ui.Widget,proxy=$.proxy,isRtl=!1,NS=".kendoGroupable",CHANGE="change",indicatorTmpl=kendo.template('<div class="k-group-indicator" data-#=data.ns#field="${data.field}" data-#=data.ns#title="${data.title || ""}" data-#=data.ns#dir="${data.dir || "asc"}"><a href="\\#" class="k-link"><span class="k-icon k-si-arrow-${(data.dir || "asc") == "asc" ? "n" : "s"}">(sorted ${(data.dir || "asc") == "asc" ? "ascending": "descending"})</span>${data.title ? data.title: data.field}</a><a class="k-button k-button-icon k-button-bare"><span class="k-icon k-group-delete"></span></a></div>',{useWithBlock:!1}),hint=function(target){return $('<div class="k-header k-drag-clue" />').css({
width:target.width(),paddingLeft:target.css("paddingLeft"),paddingRight:target.css("paddingRight"),lineHeight:target.height()+"px",paddingTop:target.css("paddingTop"),paddingBottom:target.css("paddingBottom")}).html(target.attr(kendo.attr("title"))||target.attr(kendo.attr("field"))).prepend('<span class="k-icon k-drag-status k-denied" />')},dropCue=$('<div class="k-grouping-dropclue"/>'),nameSpecialCharRegExp=/("|\%|'|\[|\]|\$|\.|\,|\:|\;|\+|\*|\&|\!|\#|\(|\)|<|>|\=|\?|\@|\^|\{|\}|\~|\/|\||`)/g,Groupable=Widget.extend({init:function(element,options){var draggable,horizontalCuePosition,that=this,group=kendo.guid(),intializePositions=proxy(that._intializePositions,that),dropCuePositions=that._dropCuePositions=[];Widget.fn.init.call(that,element,options),isRtl=kendo.support.isRtl(element),horizontalCuePosition=isRtl?"right":"left",that.draggable=draggable=that.options.draggable||new kendo.ui.Draggable(that.element,{filter:that.options.draggableElements,hint:hint,group:group}),that.groupContainer=$(that.options.groupContainer,that.element).kendoDropTarget({group:draggable.options.group,dragenter:function(e){that._canDrag(e.draggable.currentTarget)&&(e.draggable.hint.find(".k-drag-status").removeClass("k-denied").addClass("k-add"),dropCue.css("top",dropCueOffsetTop(that.groupContainer)).css(horizontalCuePosition,0).appendTo(that.groupContainer))},dragleave:function(e){e.draggable.hint.find(".k-drag-status").removeClass("k-add").addClass("k-denied"),dropCue.remove()},drop:function(e){var position,targetElement=e.draggable.currentTarget,field=targetElement.attr(kendo.attr("field")),title=targetElement.attr(kendo.attr("title")),sourceIndicator=that.indicator(field),dropCuePositions=that._dropCuePositions,lastCuePosition=dropCuePositions[dropCuePositions.length-1];(targetElement.hasClass("k-group-indicator")||that._canDrag(targetElement))&&(lastCuePosition?(position=that._dropCuePosition(kendo.getOffset(dropCue).left+parseInt(lastCuePosition.element.css("marginLeft"),10)*(isRtl?-1:1)+parseInt(lastCuePosition.element.css("marginRight"),10)),position&&that._canDrop($(sourceIndicator),position.element,position.left)&&(position.before?position.element.before(sourceIndicator||that.buildIndicator(field,title)):position.element.after(sourceIndicator||that.buildIndicator(field,title)),that._change())):(that.groupContainer.append(that.buildIndicator(field,title)),that._change()))}}).kendoDraggable({filter:"div.k-group-indicator",hint:hint,group:draggable.options.group,dragcancel:proxy(that._dragCancel,that),dragstart:function(e){var element=e.currentTarget,marginLeft=parseInt(element.css("marginLeft"),10),elementPosition=element.position(),left=isRtl?elementPosition.left-marginLeft:elementPosition.left+element.outerWidth();intializePositions(),dropCue.css({top:dropCueOffsetTop(that.groupContainer),left:left}).appendTo(that.groupContainer),this.hint.find(".k-drag-status").removeClass("k-denied").addClass("k-add")},dragend:function(){that._dragEnd(this)},drag:proxy(that._drag,that)}).on("click"+NS,".k-button",function(e){e.preventDefault(),that._removeIndicator($(this).parent())}).on("click"+NS,".k-link",function(e){var current=$(this).parent(),newIndicator=that.buildIndicator(current.attr(kendo.attr("field")),current.attr(kendo.attr("title")),"asc"==current.attr(kendo.attr("dir"))?"desc":"asc");current.before(newIndicator).remove(),that._change(),e.preventDefault()}),draggable.bind(["dragend","dragcancel","dragstart","drag"],{dragend:function(){that._dragEnd(this)},dragcancel:proxy(that._dragCancel,that),dragstart:function(e){var element,marginRight,left;return that.options.allowDrag||that._canDrag(e.currentTarget)?(intializePositions(),void(dropCuePositions.length?(element=dropCuePositions[dropCuePositions.length-1].element,marginRight=parseInt(element.css("marginRight"),10),left=element.position().left+element.outerWidth()+marginRight):left=0)):void e.preventDefault()},drag:proxy(that._drag,that)}),that.dataSource=that.options.dataSource,that.dataSource&&that._refreshHandler?that.dataSource.unbind(CHANGE,that._refreshHandler):that._refreshHandler=proxy(that.refresh,that),that.dataSource&&(that.dataSource.bind("change",that._refreshHandler),that.refresh())},refresh:function(){var that=this,dataSource=that.dataSource;that.groupContainer&&that.groupContainer.empty().append($.map(dataSource.group()||[],function(item){var fieldName=item.field.replace(nameSpecialCharRegExp,"\\$1"),element=that.element.find(that.options.filter).filter("["+kendo.attr("field")+"="+fieldName+"]");return that.buildIndicator(item.field,element.attr(kendo.attr("title")),item.dir)}).join("")),that._invalidateGroupContainer()},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.groupContainer.off(NS),that.groupContainer.data("kendoDropTarget")&&that.groupContainer.data("kendoDropTarget").destroy(),that.groupContainer.data("kendoDraggable")&&that.groupContainer.data("kendoDraggable").destroy(),that.options.draggable||that.draggable.destroy(),that.dataSource&&that._refreshHandler&&(that.dataSource.unbind("change",that._refreshHandler),that._refreshHandler=null),that.groupContainer=that.element=that.draggable=null},options:{name:"Groupable",filter:"th",draggableElements:"th",messages:{empty:"Drag a column header and drop it here to group by that column"}},indicator:function(field){var indicators=$(".k-group-indicator",this.groupContainer);return $.grep(indicators,function(item){return $(item).attr(kendo.attr("field"))===field})[0]},buildIndicator:function(field,title,dir){return indicatorTmpl({field:field.replace(/"/g,"'"),dir:dir,title:title,ns:kendo.ns})},descriptors:function(){var aggregates,names,field,idx,length,that=this,indicators=$(".k-group-indicator",that.groupContainer);return aggregates=that.element.find(that.options.filter).map(function(){var cell=$(this),aggregate=cell.attr(kendo.attr("aggregates")),member=cell.attr(kendo.attr("field"));if(aggregate&&""!==aggregate)for(names=aggregate.split(","),aggregate=[],idx=0,length=names.length;idx<length;idx++)aggregate.push({field:member,aggregate:names[idx]});return aggregate}).toArray(),$.map(indicators,function(item){return item=$(item),field=item.attr(kendo.attr("field")),{field:field,dir:item.attr(kendo.attr("dir")),aggregates:aggregates||[]}})},_removeIndicator:function(indicator){var that=this;indicator.remove(),that._invalidateGroupContainer(),that._change()},_change:function(){var that=this;that.dataSource&&that.dataSource.group(that.descriptors())},_dropCuePosition:function(position){var dropCuePositions=this._dropCuePositions;if(dropCue.is(":visible")&&0!==dropCuePositions.length){position=Math.ceil(position);var lastCuePosition=dropCuePositions[dropCuePositions.length-1],left=lastCuePosition.left,right=lastCuePosition.right,marginLeft=parseInt(lastCuePosition.element.css("marginLeft"),10),marginRight=parseInt(lastCuePosition.element.css("marginRight"),10);return position>=right&&!isRtl||position<left&&isRtl?position={left:lastCuePosition.element.position().left+(isRtl?-marginLeft:lastCuePosition.element.outerWidth()+marginRight),element:lastCuePosition.element,before:!1}:(position=$.grep(dropCuePositions,function(item){return item.left<=position&&position<=item.right||isRtl&&position>item.right})[0],position&&(position={left:isRtl?position.element.position().left+position.element.outerWidth()+marginRight:position.element.position().left-marginLeft,element:position.element,before:!0})),position}},_drag:function(event){var position=this._dropCuePosition(event.x.location);position&&dropCue.css({left:position.left,right:"auto"})},_canDrag:function(element){var field=element.attr(kendo.attr("field"));return"false"!=element.attr(kendo.attr("groupable"))&&field&&(element.hasClass("k-group-indicator")||!this.indicator(field))},_canDrop:function(source,target,position){var next=source.next(),result=source[0]!==target[0]&&(!next[0]||target[0]!==next[0]||!isRtl&&position>next.position().left||isRtl&&position<next.position().left);return result},_dragEnd:function(draggable){var that=this,field=draggable.currentTarget.attr(kendo.attr("field")),sourceIndicator=that.indicator(field);draggable!==that.options.draggable&&!draggable.dropped&&sourceIndicator&&that._removeIndicator($(sourceIndicator)),that._dragCancel()},_dragCancel:function(){dropCue.remove(),this._dropCuePositions=[]},_intializePositions:function(){var left,that=this,indicators=$(".k-group-indicator",that.groupContainer);that._dropCuePositions=$.map(indicators,function(item){return item=$(item),left=kendo.getOffset(item).left,{left:parseInt(left,10),right:parseInt(left+item.outerWidth(),10),element:item}})},_invalidateGroupContainer:function(){var groupContainer=this.groupContainer;groupContainer&&groupContainer.is(":empty")&&groupContainer.html(this.options.messages.empty)}});kendo.ui.plugin(Groupable)}(window.kendo.jQuery),function($,undefined){function toggleHintClass(hint,denied){hint=$(hint),denied?hint.find(".k-drag-status").removeClass("k-add").addClass("k-denied"):hint.find(".k-drag-status").removeClass("k-denied").addClass("k-add")}var kendo=window.kendo,getOffset=kendo.getOffset,Widget=kendo.ui.Widget,CHANGE="change",KREORDERABLE="k-reorderable",Reorderable=Widget.extend({init:function(element,options){var draggable,that=this,group=kendo.guid()+"-reorderable";Widget.fn.init.call(that,element,options),element=that.element.addClass(KREORDERABLE),options=that.options,that.draggable=draggable=options.draggable||new kendo.ui.Draggable(element,{group:group,filter:options.filter,hint:options.hint}),that.reorderDropCue=$('<div class="k-reorder-cue"><div class="k-icon k-i-arrow-s"></div><div class="k-icon k-i-arrow-n"></div></div>'),element.find(draggable.options.filter).kendoDropTarget({group:draggable.options.group,dragenter:function(e){if(that._draggable){var offset,dropTarget=this.element,denied=!that._dropTargetAllowed(dropTarget)||that._isLastDraggable();if(toggleHintClass(e.draggable.hint,denied),!denied){offset=getOffset(dropTarget);var left=offset.left;options.inSameContainer&&!options.inSameContainer(dropTarget,that._draggable)?that._dropTarget=dropTarget:that._elements.index(dropTarget)>that._elements.index(that._draggable)&&(left+=dropTarget.outerWidth()),that.reorderDropCue.css({height:dropTarget.outerHeight(),top:offset.top,left:left}).appendTo(document.body)}}},dragleave:function(e){toggleHintClass(e.draggable.hint,!0),that.reorderDropCue.remove(),that._dropTarget=null},drop:function(){if(that._dropTarget=null,that._draggable){var dropTarget=this.element,draggable=that._draggable;that._dropTargetAllowed(dropTarget)&&!that._isLastDraggable()&&that.trigger(CHANGE,{element:that._draggable,oldIndex:that._elements.index(draggable),newIndex:that._elements.index(dropTarget),position:getOffset(that.reorderDropCue).left>getOffset(dropTarget).left?"after":"before"})}}}),draggable.bind(["dragcancel","dragend","dragstart","drag"],{dragcancel:function(){that.reorderDropCue.remove(),that._draggable=null,that._elements=null},dragend:function(){that.reorderDropCue.remove(),that._draggable=null,that._elements=null},dragstart:function(e){that._draggable=e.currentTarget,that._elements=that.element.find(that.draggable.options.filter)},drag:function(e){if(that._dropTarget&&!this.hint.find(".k-drag-status").hasClass("k-denied")){var dropStartOffset=getOffset(that._dropTarget).left,width=that._dropTarget.outerWidth();e.pageX>dropStartOffset+width/2?that.reorderDropCue.css({left:dropStartOffset+width}):that.reorderDropCue.css({left:dropStartOffset})}}})},options:{name:"Reorderable",filter:"*"},events:[CHANGE],_isLastDraggable:function(){var item,inSameContainer=this.options.inSameContainer,draggable=this._draggable[0],elements=this._elements.get(),found=!1;if(!inSameContainer)return!1;for(;!found&&elements.length>0;)item=elements.pop(),found=draggable!==item&&inSameContainer(draggable,item);return!found},_dropTargetAllowed:function(dropTarget){var inSameContainer=this.options.inSameContainer,dragOverContainers=this.options.dragOverContainers,draggable=this._draggable;return draggable[0]!==dropTarget[0]&&(!inSameContainer||!dragOverContainers||(!!inSameContainer(draggable,dropTarget)||dragOverContainers(this._elements.index(draggable))))},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.element.find(that.draggable.options.filter).each(function(){var item=$(this);item.data("kendoDropTarget")&&item.data("kendoDropTarget").destroy()}),that.draggable&&(that.draggable.destroy(),that.draggable.element=that.draggable=null),that.elements=that.reorderDropCue=that._elements=that._draggable=null}});kendo.ui.plugin(Reorderable)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget,proxy=$.proxy,isFunction=kendo.isFunction,extend=$.extend,HORIZONTAL="horizontal",VERTICAL="vertical",START="start",RESIZE="resize",RESIZEEND="resizeend",Resizable=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),that.orientation=that.options.orientation.toLowerCase()!=VERTICAL?HORIZONTAL:VERTICAL,that._positionMouse=that.orientation==HORIZONTAL?"x":"y",that._position=that.orientation==HORIZONTAL?"left":"top",that._sizingDom=that.orientation==HORIZONTAL?"outerWidth":"outerHeight",that.draggable=new ui.Draggable(element,{distance:0,filter:options.handle,drag:proxy(that._resize,that),dragcancel:proxy(that._cancel,that),dragstart:proxy(that._start,that),dragend:proxy(that._stop,that)}),that.userEvents=that.draggable.userEvents},events:[RESIZE,RESIZEEND,START],options:{name:"Resizable",orientation:HORIZONTAL},resize:function(){},_max:function(e){var that=this,hintSize=that.hint?that.hint[that._sizingDom]():0,size=that.options.max;return isFunction(size)?size(e):size!==undefined?that._initialElementPosition+size-hintSize:size},_min:function(e){var that=this,size=that.options.min;return isFunction(size)?size(e):size!==undefined?that._initialElementPosition+size:size},_start:function(e){var that=this,hint=that.options.hint,el=$(e.currentTarget);that._initialElementPosition=el.position()[that._position],that._initialMousePosition=e[that._positionMouse].startLocation,hint&&(that.hint=isFunction(hint)?$(hint(el)):hint,that.hint.css({position:"absolute"}).css(that._position,that._initialElementPosition).appendTo(that.element)),that.trigger(START,e),that._maxPosition=that._max(e),that._minPosition=that._min(e),$(document.body).css("cursor",el.css("cursor"))},_resize:function(e){var position,that=this,maxPosition=that._maxPosition,minPosition=that._minPosition,currentPosition=that._initialElementPosition+(e[that._positionMouse].location-that._initialMousePosition);position=minPosition!==undefined?Math.max(minPosition,currentPosition):currentPosition,that.position=position=maxPosition!==undefined?Math.min(maxPosition,position):position,that.hint&&that.hint.toggleClass(that.options.invalidClass||"",position==maxPosition||position==minPosition).css(that._position,position),that.resizing=!0,that.trigger(RESIZE,extend(e,{position:position}))},_stop:function(e){var that=this;that.hint&&that.hint.remove(),that.resizing=!1,that.trigger(RESIZEEND,extend(e,{position:that.position})),$(document.body).css("cursor","")},_cancel:function(e){var that=this;that.hint&&(that.position=undefined,that.hint.css(that._position,that._initialElementPosition),that._stop(e))},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.draggable&&that.draggable.destroy()},press:function(target){if(target){var position=target.position(),that=this;that.userEvents.press(position.left,position.top,target[0]),that.targetPosition=position,that.target=target}},move:function(delta){var that=this,orientation=that._position,position=that.targetPosition,current=that.position;current===undefined&&(current=position[orientation]),position[orientation]=current+delta,that.userEvents.move(position.left,position.top)},end:function(){this.userEvents.end(),this.target=this.position=undefined}});kendo.ui.plugin(Resizable)}(window.kendo.jQuery),function($,undefined){function containsOrEqualTo(parent,child){try{return $.contains(parent,child)||parent==child}catch(e){return!1}}function defaultHint(element){return element.clone()}function defaultPlaceholder(element){return element.clone().removeAttr("id").css("visibility","hidden")}var kendo=window.kendo,Widget=kendo.ui.Widget,START="start",BEFORE_MOVE="beforeMove",MOVE="move",END="end",CHANGE="change",CANCEL="cancel",ACTION_SORT="sort",ACTION_REMOVE="remove",ACTION_RECEIVE="receive",DEFAULT_FILTER=">*",MISSING_INDEX=-1,Sortable=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),that.options.placeholder||(that.options.placeholder=defaultPlaceholder),that.options.hint||(that.options.hint=defaultHint),that._draggable=that._createDraggable(),that.floating=!1},events:[START,BEFORE_MOVE,MOVE,END,CHANGE,CANCEL],options:{name:"Sortable",hint:null,placeholder:null,filter:DEFAULT_FILTER,holdToDrag:!1,disabled:null,container:null,connectWith:null,handler:null,cursorOffset:null,axis:null,ignore:null,cursor:"auto"},destroy:function(){this._draggable.destroy(),Widget.fn.destroy.call(this)},_createDraggable:function(){var that=this,element=that.element,options=that.options;return new kendo.ui.Draggable(element,{filter:options.filter,hint:kendo.isFunction(options.hint)?options.hint:$(options.hint),holdToDrag:options.holdToDrag,container:options.container?$(options.container):null,cursorOffset:options.cursorOffset,axis:options.axis,ignore:options.ignore,dragstart:$.proxy(that._dragstart,that),dragcancel:$.proxy(that._dragcancel,that),drag:$.proxy(that._drag,that),dragend:$.proxy(that._dragend,that)})},_dragstart:function(e){var draggedElement=this.draggedElement=e.currentTarget,target=e.target||kendo.elementUnderCursor(e),disabled=this.options.disabled,handler=this.options.handler,_placeholder=this.options.placeholder,placeholder=this.placeholder=$(kendo.isFunction(_placeholder)?_placeholder.call(this,draggedElement):_placeholder);disabled&&draggedElement.is(disabled)?e.preventDefault():handler&&!$(target).is(handler)?e.preventDefault():this.trigger(START,{item:draggedElement,draggableEvent:e})?e.preventDefault():(this.floating=this._isFloating(draggedElement),draggedElement.css("display","none"),draggedElement.before(placeholder),this._setCursor())},_dragcancel:function(e){this._cancel(),this.trigger(CANCEL,{item:this.draggedElement}),this._resetCursor()},_drag:function(e){var targetCenter,offsetDelta,direction,sibling,getSibling,draggedElement=this.draggedElement,target=this._findTarget(e),cursorOffset={left:e.x.location,top:e.y.location},axisDelta={x:e.x.delta,y:e.y.delta},axis=this.options.axis,eventData={item:draggedElement,list:this,draggableEvent:e};if("x"===axis||"y"===axis)return void this._movementByAxis(axis,cursorOffset,axisDelta[axis],eventData);if(target){if(targetCenter=this._getElementCenter(target.element),offsetDelta={left:Math.round(cursorOffset.left-targetCenter.left),top:Math.round(cursorOffset.top-targetCenter.top)},$.extend(eventData,{target:target.element}),target.appendToBottom)return void this._movePlaceholder(target,null,eventData);if(target.appendAfterHidden&&this._movePlaceholder(target,"next",eventData),this.floating?axisDelta.x<0&&offsetDelta.left<0?direction="prev":axisDelta.x>0&&offsetDelta.left>0&&(direction="next"):axisDelta.y<0&&offsetDelta.top<0?direction="prev":axisDelta.y>0&&offsetDelta.top>0&&(direction="next"),direction){for(getSibling="prev"===direction?jQuery.fn.prev:jQuery.fn.next,sibling=getSibling.call(target.element);sibling.length&&!sibling.is(":visible");)sibling=getSibling.call(sibling);sibling[0]!=this.placeholder[0]&&this._movePlaceholder(target,direction,eventData)}}},_dragend:function(e){var connectedList,isDefaultPrevented,eventData,connectedListEventData,placeholder=this.placeholder,draggedElement=this.draggedElement,draggedIndex=this.indexOf(draggedElement),placeholderIndex=this.indexOf(placeholder),connectWith=this.options.connectWith;return this._resetCursor(),eventData={action:ACTION_SORT,item:draggedElement,oldIndex:draggedIndex,newIndex:placeholderIndex,draggableEvent:e},placeholderIndex>=0?isDefaultPrevented=this.trigger(END,eventData):(connectedList=placeholder.parents(connectWith).getKendoSortable(),eventData.action=ACTION_REMOVE,connectedListEventData=$.extend({},eventData,{action:ACTION_RECEIVE,oldIndex:MISSING_INDEX,newIndex:connectedList.indexOf(placeholder)}),isDefaultPrevented=!(!this.trigger(END,eventData)&&!connectedList.trigger(END,connectedListEventData))),isDefaultPrevented||placeholderIndex===draggedIndex?void this._cancel():(placeholder.replaceWith(draggedElement),draggedElement.show(),this._draggable.dropped=!0,eventData={action:this.indexOf(draggedElement)!=MISSING_INDEX?ACTION_SORT:ACTION_REMOVE,item:draggedElement,oldIndex:draggedIndex,newIndex:this.indexOf(draggedElement),draggableEvent:e},this.trigger(CHANGE,eventData),void(connectedList&&(connectedListEventData=$.extend({},eventData,{action:ACTION_RECEIVE,oldIndex:MISSING_INDEX,newIndex:connectedList.indexOf(draggedElement)}),connectedList.trigger(CHANGE,connectedListEventData))))},_findTarget:function(e){var items,node,element=this._findElementUnderCursor(e),connectWith=this.options.connectWith;return $.contains(this.element[0],element)?(items=this.items(),node=items.filter(element)[0]||items.has(element)[0],node?{element:$(node),sortable:this}:null):this.element[0]==element&&this._isEmpty()?{element:this.element,sortable:this,appendToBottom:!0}:this.element[0]==element&&this._isLastHidden()?(node=this.items().eq(0),{element:node,sortable:this,appendAfterHidden:!0}):connectWith?this._searchConnectedTargets(element,e):void 0},_findElementUnderCursor:function(e){var elementUnderCursor=kendo.elementUnderCursor(e),draggable=e.sender;this.options.disabled,this.options.filter,this.items();return containsOrEqualTo(draggable.hint[0],elementUnderCursor)&&(draggable.hint.hide(),elementUnderCursor=kendo.elementUnderCursor(e),elementUnderCursor||(elementUnderCursor=kendo.elementUnderCursor(e)),draggable.hint.show()),elementUnderCursor},_searchConnectedTargets:function(element,e){for(var sortableInstance,items,node,connected=$(this.options.connectWith),i=0;i<connected.length;i++)if(sortableInstance=connected.eq(i).getKendoSortable(),$.contains(connected[i],element)){if(sortableInstance)return items=sortableInstance.items(),node=items.filter(element)[0]||items.has(element)[0],node?(sortableInstance.placeholder=this.placeholder,{element:$(node),sortable:sortableInstance}):null}else if(connected[i]==element){if(sortableInstance&&sortableInstance._isEmpty())return{element:connected.eq(i),sortable:sortableInstance,appendToBottom:!0};if(this._isCursorAfterLast(sortableInstance,e))return node=sortableInstance.items().last(),{element:node,sortable:sortableInstance}}},_isCursorAfterLast:function(sortable,e){var lastItemOffset,delta,lastItem=sortable.items().last(),cursorOffset={left:e.x.location,top:e.y.location};return lastItemOffset=kendo.getOffset(lastItem),lastItemOffset.top+=lastItem.outerHeight(),lastItemOffset.left+=lastItem.outerWidth(),delta=this.floating?lastItemOffset.left-cursorOffset.left:lastItemOffset.top-cursorOffset.top,delta<0},_movementByAxis:function(axis,cursorOffset,delta,eventData){var targetCenter,cursorPosition="x"===axis?cursorOffset.left:cursorOffset.top,target=delta<0?this.placeholder.prev():this.placeholder.next();target.length&&!target.is(":visible")&&(target=delta<0?target.prev():target.next()),$.extend(eventData,{target:target}),targetCenter=this._getElementCenter(target),targetCenter&&(targetCenter="x"===axis?targetCenter.left:targetCenter.top),target.length&&delta<0&&cursorPosition-targetCenter<0?this._movePlaceholder({element:target,sortable:this},"prev",eventData):target.length&&delta>0&&cursorPosition-targetCenter>0&&this._movePlaceholder({element:target,sortable:this},"next",eventData)},_movePlaceholder:function(target,direction,eventData){var placeholder=this.placeholder;target.sortable.trigger(BEFORE_MOVE,eventData)||(direction?"prev"===direction?target.element.before(placeholder):"next"===direction&&target.element.after(placeholder):target.element.append(placeholder),target.sortable.trigger(MOVE,eventData))},_setCursor:function(){var body,cursor=this.options.cursor;cursor&&"auto"!==cursor&&(body=$(document.body),this._originalCursorType=body.css("cursor"),body.css({cursor:cursor}),this._cursorStylesheet||(this._cursorStylesheet=$("<style>* { cursor: "+cursor+" !important; }</style>")),this._cursorStylesheet.appendTo(body))},_resetCursor:function(){this._originalCursorType&&($(document.body).css("cursor",this._originalCursorType),this._originalCursorType=null,this._cursorStylesheet.remove())},_getElementCenter:function(element){var center=element.length?kendo.getOffset(element):null;return center&&(center.top+=element.outerHeight()/2,center.left+=element.outerWidth()/2),center},_isFloating:function(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))},_cancel:function(){this.draggedElement.show(),this.placeholder.remove()},_items:function(){var items,filter=this.options.filter;return items=filter?this.element.find(filter):this.element.children()},indexOf:function(element){var items=this._items(),placeholder=this.placeholder,draggedElement=this.draggedElement;return placeholder&&element[0]==placeholder[0]?items.not(draggedElement).index(element):items.not(placeholder).index(element)},items:function(){var placeholder=this.placeholder,items=this._items();return placeholder&&(items=items.not(placeholder)),items},_isEmpty:function(){return!this.items().length},_isLastHidden:function(){return 1===this.items().length&&this.items().is(":hidden")}});kendo.ui.plugin(Sortable)}(window.kendo.jQuery),function($,undefined){function collision(element,position){var elementPosition=kendo.getOffset(element),right=position.left+position.width,bottom=position.top+position.height;return elementPosition.right=elementPosition.left+element.outerWidth(),elementPosition.bottom=elementPosition.top+element.outerHeight(),!(elementPosition.left>right||elementPosition.right<position.left||elementPosition.top>bottom||elementPosition.bottom<position.top)}var kendo=window.kendo,Widget=kendo.ui.Widget,proxy=$.proxy,abs=Math.abs,ARIASELECTED=(Array.prototype.shift,"aria-selected"),SELECTED="k-state-selected",ACTIVE="k-state-selecting",SELECTABLE="k-selectable",CHANGE="change",NS=".kendoSelectable",UNSELECTING="k-state-unselecting",INPUTSELECTOR="input,a,textarea,.k-multiselect-wrap,select",msie=kendo.support.browser.msie,supportEventDelegation=!1;!function($){!function(){$('<div class="parent"><span /></div>').on("click",">*",function(){supportEventDelegation=!0}).find("span").click().end().off()}()}($);var Selectable=Widget.extend({init:function(element,options){var multiple,that=this;Widget.fn.init.call(that,element,options),that._marquee=$("<div class='k-marquee'><div class='k-marquee-color'></div></div>"),that._lastActive=null,that.element.addClass(SELECTABLE),that.relatedTarget=that.options.relatedTarget,multiple=that.options.multiple,that.userEvents=new kendo.UserEvents(that.element,{global:!0,allowSelection:!0,filter:(supportEventDelegation?"":"."+SELECTABLE+" ")+that.options.filter,tap:proxy(that._tap,that)}),multiple&&that.userEvents.bind("start",proxy(that._start,that)).bind("move",proxy(that._move,that)).bind("end",proxy(that._end,that)).bind("select",proxy(that._select,that))},events:[CHANGE],options:{name:"Selectable",filter:">*",multiple:!1,relatedTarget:$.noop},_isElement:function(target){var idx,elements=this.element,length=elements.length,result=!1;for(target=target[0],idx=0;idx<length;idx++)if(elements[idx]===target){result=!0;break}return result},_tap:function(e){var selected,target=$(e.target),that=this,ctrlKey=e.event.ctrlKey||e.event.metaKey,multiple=that.options.multiple,shiftKey=multiple&&e.event.shiftKey,whichCode=e.event.which,buttonCode=e.event.button;!that._isElement(target.closest("."+SELECTABLE))||whichCode&&3==whichCode||buttonCode&&2==buttonCode||this._allowSelection(e.event.target)&&(selected=target.hasClass(SELECTED),multiple&&ctrlKey||that.clear(),target=target.add(that.relatedTarget(target)),shiftKey?that.selectRange(that._firstSelectee(),target):(selected&&ctrlKey?(that._unselect(target),that._notify(CHANGE)):that.value(target),that._lastActive=that._downTarget=target))},_start:function(e){var currentElement,that=this,target=$(e.target),selected=target.hasClass(SELECTED),ctrlKey=e.event.ctrlKey||e.event.metaKey;if(this._allowSelection(e.event.target)){if(that._downTarget=target,!that._isElement(target.closest("."+SELECTABLE)))return void that.userEvents.cancel();that.options.useAllItems?that._items=that.element.find(that.options.filter):(currentElement=target.closest(that.element),that._items=currentElement.find(that.options.filter)),that._marquee.appendTo(document.body).css({left:e.x.client+1,top:e.y.client+1,width:0,height:0}),ctrlKey||that.clear(),target=target.add(that.relatedTarget(target)),selected&&(that._selectElement(target,!0),ctrlKey&&target.addClass(UNSELECTING))}},_move:function(e){var that=this,position={left:e.x.startLocation>e.x.location?e.x.location:e.x.startLocation,top:e.y.startLocation>e.y.location?e.y.location:e.y.startLocation,width:abs(e.x.initialDelta),height:abs(e.y.initialDelta)};that._marquee.css(position),that._invalidateSelectables(position,e.event.ctrlKey||e.event.metaKey),e.preventDefault()},_end:function(){var that=this;that._marquee.remove(),that._unselect(that.element.find(that.options.filter+"."+UNSELECTING)).removeClass(UNSELECTING);var target=that.element.find(that.options.filter+"."+ACTIVE);target=target.add(that.relatedTarget(target)),that.value(target),that._lastActive=that._downTarget,that._items=null},_invalidateSelectables:function(position,ctrlKey){var idx,length,related,toSelect,target=this._downTarget[0],items=this._items;for(idx=0,length=items.length;idx<length;idx++)toSelect=items.eq(idx),related=toSelect.add(this.relatedTarget(toSelect)),collision(toSelect,position)?toSelect.hasClass(SELECTED)?ctrlKey&&target!==toSelect[0]&&related.removeClass(SELECTED).addClass(UNSELECTING):toSelect.hasClass(ACTIVE)||toSelect.hasClass(UNSELECTING)||related.addClass(ACTIVE):toSelect.hasClass(ACTIVE)?related.removeClass(ACTIVE):ctrlKey&&toSelect.hasClass(UNSELECTING)&&related.removeClass(UNSELECTING).addClass(SELECTED)},value:function(val){var that=this,selectElement=proxy(that._selectElement,that);return val?(val.each(function(){selectElement(this)}),void that._notify(CHANGE)):that.element.find(that.options.filter+"."+SELECTED)},_firstSelectee:function(){var selected,that=this;return null!==that._lastActive?that._lastActive:(selected=that.value(),selected.length>0?selected[0]:that.element.find(that.options.filter)[0])},_selectElement:function(element,preventNotify){var toSelect=$(element),isPrevented=!preventNotify&&this._notify("select",{element:element});toSelect.removeClass(ACTIVE),isPrevented||(toSelect.addClass(SELECTED),this.options.aria&&toSelect.attr(ARIASELECTED,!0))},_notify:function(name,args){return args=args||{},this.trigger(name,args)},_unselect:function(element){return element.removeClass(SELECTED),this.options.aria&&element.attr(ARIASELECTED,!1),element},_select:function(e){this._allowSelection(e.event.target)&&(!msie||msie&&!$(kendo._activeElement()).is(INPUTSELECTOR))&&e.preventDefault()},_allowSelection:function(target){return!$(target).is(INPUTSELECTOR)||(this.userEvents.cancel(),this._downTarget=null,!1)},clear:function(){var items=this.element.find(this.options.filter+"."+SELECTED);this._unselect(items)},selectRange:function(start,end){var idx,tmp,items,that=this;for(that.clear(),that.element.length>1&&(items=that.options.continuousItems()),items&&items.length||(items=that.element.find(that.options.filter)),start=$.inArray($(start)[0],items),end=$.inArray($(end)[0],items),
start>end&&(tmp=start,start=end,end=tmp),that.options.useAllItems||(end+=that.element.length-1),idx=start;idx<=end;idx++)that._selectElement(items[idx]);that._notify(CHANGE)},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.element.off(NS),that.userEvents.destroy(),that._marquee=that._lastActive=that.element=that.userEvents=null}});kendo.ui.plugin(Selectable)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,Widget=kendo.ui.Widget,proxy=$.proxy,keys=kendo.keys,CLICK="click",KBUTTON="k-button",KBUTTONICON="k-button-icon",KBUTTONICONTEXT="k-button-icontext",NS=".kendoButton",DISABLED="disabled",DISABLEDSTATE="k-state-disabled",FOCUSEDSTATE="k-state-focused",SELECTEDSTATE="k-state-selected",Button=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),element=that.wrapper=that.element,options=that.options,element.addClass(KBUTTON).attr("role","button"),options.enable=options.enable&&!element.attr(DISABLED),that.enable(options.enable),that._tabindex(),that._graphics(),element.on(CLICK+NS,proxy(that._click,that)).on("focus"+NS,proxy(that._focus,that)).on("blur"+NS,proxy(that._blur,that)).on("keydown"+NS,proxy(that._keydown,that)).on("keyup"+NS,proxy(that._keyup,that)),kendo.notify(that)},events:[CLICK],options:{name:"Button",icon:"",spriteCssClass:"",imageUrl:"",enable:!0},_isNativeButton:function(){return"button"==this.element.prop("tagName").toLowerCase()},_click:function(e){this.options.enable&&this.trigger(CLICK,{event:e})},_focus:function(){this.options.enable&&this.element.addClass(FOCUSEDSTATE)},_blur:function(){this.element.removeClass(FOCUSEDSTATE)},_keydown:function(e){var that=this;that._isNativeButton()||e.keyCode!=keys.ENTER&&e.keyCode!=keys.SPACEBAR||(e.keyCode==keys.SPACEBAR&&(e.preventDefault(),that.options.enable&&that.element.addClass(SELECTEDSTATE)),that._click(e))},_keyup:function(){this.element.removeClass(SELECTEDSTATE)},_graphics:function(){var span,img,isEmpty,that=this,element=that.element,options=that.options,icon=options.icon,spriteCssClass=options.spriteCssClass,imageUrl=options.imageUrl;(spriteCssClass||imageUrl||icon)&&(isEmpty=!0,element.contents().not("span.k-sprite").not("span.k-icon").not("img.k-image").each(function(idx,el){(1==el.nodeType||3==el.nodeType&&$.trim(el.nodeValue).length>0)&&(isEmpty=!1)}),isEmpty?element.addClass(KBUTTONICON):element.addClass(KBUTTONICONTEXT)),icon?(span=element.children("span.k-icon").first(),span[0]||(span=$('<span class="k-icon"></span>').prependTo(element)),span.addClass("k-i-"+icon)):spriteCssClass?(span=element.children("span.k-sprite").first(),span[0]||(span=$('<span class="k-sprite"></span>').prependTo(element)),span.addClass(spriteCssClass)):imageUrl&&(img=element.children("img.k-image").first(),img[0]||(img=$('<img alt="icon" class="k-image" />').prependTo(element)),img.attr("src",imageUrl))},enable:function(enable){var that=this,element=that.element;enable===undefined&&(enable=!0),enable=!!enable,that.options.enable=enable,element.toggleClass(DISABLEDSTATE,!enable).attr("aria-disabled",!enable).attr(DISABLED,!enable)}});kendo.ui.plugin(Button)}(window.kendo.jQuery),function($,undefined){function button(template,idx,text,numeric,title){return template({idx:idx,text:text,ns:kendo.ns,numeric:numeric,title:title||""})}function icon(className,text,wrapClassName){return iconTemplate({className:className.substring(1),text:text,wrapClassName:wrapClassName||""})}function update(element,selector,page,disabled){element.find(selector).parent().attr(kendo.attr("page"),page).attr("tabindex",-1).toggleClass("k-state-disabled",disabled)}function first(element,page){update(element,FIRST,1,page<=1)}function prev(element,page){update(element,PREV,Math.max(1,page-1),page<=1)}function next(element,page,totalPages){update(element,NEXT,Math.min(totalPages,page+1),page>=totalPages)}function last(element,page,totalPages){update(element,LAST,totalPages,page>=totalPages)}var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget,proxy=$.proxy,FIRST=".k-i-seek-w",LAST=".k-i-seek-e",PREV=".k-i-arrow-w",NEXT=".k-i-arrow-e",CHANGE="change",NS=".kendoPager",CLICK="click",KEYDOWN="keydown",DISABLED="disabled",iconTemplate=kendo.template('<a href="\\#" title="#=text#" class="k-link k-pager-nav #= wrapClassName #"><span class="k-icon #= className #">#=text#</span></a>'),Pager=Widget.extend({init:function(element,options){var page,totalPages,that=this;Widget.fn.init.call(that,element,options),options=that.options,that.dataSource=kendo.data.DataSource.create(options.dataSource),that.linkTemplate=kendo.template(that.options.linkTemplate),that.selectTemplate=kendo.template(that.options.selectTemplate),page=that.page(),totalPages=that.totalPages(),that._refreshHandler=proxy(that.refresh,that),that.dataSource.bind(CHANGE,that._refreshHandler),options.previousNext&&(that.element.find(FIRST).length||(that.element.append(icon(FIRST,options.messages.first,"k-pager-first")),first(that.element,page,totalPages)),that.element.find(PREV).length||(that.element.append(icon(PREV,options.messages.previous)),prev(that.element,page,totalPages))),options.numeric&&(that.list=that.element.find(".k-pager-numbers"),that.list.length||(that.list=$('<ul class="k-pager-numbers k-reset" />').appendTo(that.element))),options.input&&(that.element.find(".k-pager-input").length||that.element.append('<span class="k-pager-input k-label">'+options.messages.page+'<input class="k-textbox">'+kendo.format(options.messages.of,totalPages)+"</span>"),that.element.on(KEYDOWN+NS,".k-pager-input input",proxy(that._keydown,that))),options.previousNext&&(that.element.find(NEXT).length||(that.element.append(icon(NEXT,options.messages.next)),next(that.element,page,totalPages)),that.element.find(LAST).length||(that.element.append(icon(LAST,options.messages.last,"k-pager-last")),last(that.element,page,totalPages))),options.pageSizes&&(that.element.find(".k-pager-sizes").length||$('<span class="k-pager-sizes k-label"><select/>'+options.messages.itemsPerPage+"</span>").appendTo(that.element).find("select").html($.map($.isArray(options.pageSizes)?options.pageSizes:[5,10,20],function(page){return"<option>"+page+"</option>"}).join("")).end().appendTo(that.element),that.element.find(".k-pager-sizes select").val(that.pageSize()),kendo.ui.DropDownList&&that.element.find(".k-pager-sizes select").show().kendoDropDownList(),that.element.on(CHANGE+NS,".k-pager-sizes select",proxy(that._change,that))),options.refresh&&(that.element.find(".k-pager-refresh").length||that.element.append('<a href="#" class="k-pager-refresh k-link" title="'+options.messages.refresh+'"><span class="k-icon k-i-refresh">'+options.messages.refresh+"</span></a>"),that.element.on(CLICK+NS,".k-pager-refresh",proxy(that._refreshClick,that))),options.info&&(that.element.find(".k-pager-info").length||that.element.append('<span class="k-pager-info k-label" />')),that.element.on(CLICK+NS,"a",proxy(that._click,that)).addClass("k-pager-wrap k-widget"),options.autoBind&&that.refresh(),kendo.notify(that)},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.element.off(NS),that.dataSource.unbind(CHANGE,that._refreshHandler),that._refreshHandler=null,kendo.destroy(that.element),that.element=that.list=null},events:[CHANGE],options:{name:"Pager",selectTemplate:'<li><span class="k-state-selected">#=text#</span></li>',linkTemplate:'<li><a tabindex="-1" href="\\#" class="k-link" data-#=ns#page="#=idx#" #if (title !== "") {# title="#=title#" #}#>#=text#</a></li>',buttonCount:10,autoBind:!0,numeric:!0,info:!0,input:!1,previousNext:!0,pageSizes:!1,refresh:!1,messages:{display:"{0} - {1} of {2} items",empty:"No items to display",page:"Page",of:"of {0}",itemsPerPage:"items per page",first:"Go to the first page",previous:"Go to the previous page",next:"Go to the next page",last:"Go to the last page",refresh:"Refresh",morePages:"More pages"}},setDataSource:function(dataSource){var that=this;that.dataSource.unbind(CHANGE,that._refreshHandler),that.dataSource=that.options.dataSource=dataSource,dataSource.bind(CHANGE,that._refreshHandler),that.options.autoBind&&dataSource.fetch()},refresh:function(e){var idx,end,reminder,that=this,start=1,html="",page=that.page(),options=that.options,pageSize=that.pageSize(),total=that.dataSource.total(),totalPages=that.totalPages(),linkTemplate=that.linkTemplate,buttonCount=options.buttonCount;if(!e||"itemchange"!=e.action){if(options.numeric){for(page>buttonCount&&(reminder=page%buttonCount,start=0===reminder?page-buttonCount+1:page-reminder+1),end=Math.min(start+buttonCount-1,totalPages),start>1&&(html+=button(linkTemplate,start-1,"...",!1,options.messages.morePages)),idx=start;idx<=end;idx++)html+=button(idx==page?that.selectTemplate:linkTemplate,idx,idx,!0);end<totalPages&&(html+=button(linkTemplate,idx,"...",!1,options.messages.morePages)),""===html&&(html=that.selectTemplate({text:0})),that.list.html(html)}options.info&&(html=total>0?kendo.format(options.messages.display,(page-1)*pageSize+1,Math.min(page*pageSize,total),total):options.messages.empty,that.element.find(".k-pager-info").html(html)),options.input&&that.element.find(".k-pager-input").html(that.options.messages.page+'<input class="k-textbox">'+kendo.format(options.messages.of,totalPages)).find("input").val(page).attr(DISABLED,total<1).toggleClass("k-state-disabled",total<1),options.previousNext&&(first(that.element,page,totalPages),prev(that.element,page,totalPages),next(that.element,page,totalPages),last(that.element,page,totalPages)),options.pageSizes&&that.element.find(".k-pager-sizes select").val(pageSize).filter("["+kendo.attr("role")+"=dropdownlist]").kendoDropDownList("value",pageSize).kendoDropDownList("text",pageSize)}},_keydown:function(e){if(e.keyCode===kendo.keys.ENTER){var input=this.element.find(".k-pager-input").find("input"),page=parseInt(input.val(),10);(isNaN(page)||page<1||page>this.totalPages())&&(page=this.page()),input.val(page),this.page(page)}},_refreshClick:function(e){e.preventDefault(),this.dataSource.read()},_change:function(e){var pageSize=parseInt(e.currentTarget.value,10);isNaN(pageSize)||this.dataSource.pageSize(pageSize)},_click:function(e){var target=$(e.currentTarget);e.preventDefault(),target.is(".k-state-disabled")||this.page(target.attr(kendo.attr("page")))},totalPages:function(){return Math.ceil((this.dataSource.total()||0)/this.pageSize())},pageSize:function(){return this.dataSource.pageSize()||this.dataSource.total()},page:function(page){return page===undefined?this.dataSource.total()>0?this.dataSource.page():0:(this.dataSource.page(page),void this.trigger(CHANGE,{index:page}))}});ui.plugin(Pager)}(window.kendo.jQuery),function($,undefined){function contains(container,target){return container===target||$.contains(container,target)}var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget,support=kendo.support,getOffset=kendo.getOffset,activeElement=kendo._activeElement,OPEN="open",CLOSE="close",DEACTIVATE="deactivate",ACTIVATE="activate",CENTER="center",LEFT="left",RIGHT="right",TOP="top",BOTTOM="bottom",ABSOLUTE="absolute",HIDDEN="hidden",BODY="body",LOCATION="location",POSITION="position",VISIBLE="visible",EFFECTS="effects",ACTIVE="k-state-active",ACTIVEBORDER="k-state-border",ACTIVEBORDERREGEXP=/k-state-border-(\w+)/,ACTIVECHILDREN=".k-picker-wrap, .k-dropdown-wrap, .k-link",MOUSEDOWN="down",WINDOW=$(window),DOCUMENT_ELEMENT=$(document.documentElement),RESIZE_SCROLL="resize scroll",cssPrefix=support.transitions.css,TRANSFORM=cssPrefix+"transform",extend=$.extend,NS=".kendoPopup",styles=["font-size","font-family","font-stretch","font-style","font-weight","line-height"],Popup=Widget.extend({init:function(element,options){var parentPopup,that=this;options=options||{},options.isRtl&&(options.origin=options.origin||BOTTOM+" "+RIGHT,options.position=options.position||TOP+" "+RIGHT),Widget.fn.init.call(that,element,options),element=that.element,options=that.options,that.collisions=options.collision?options.collision.split(" "):[],1===that.collisions.length&&that.collisions.push(that.collisions[0]),parentPopup=$(that.options.anchor).closest(".k-popup,.k-group").filter(":not([class^=km-])"),options.appendTo=$($(options.appendTo)[0]||parentPopup[0]||BODY),that.element.hide().addClass("k-popup k-group k-reset").toggleClass("k-rtl",!!options.isRtl).css({position:ABSOLUTE}).appendTo(options.appendTo).on("mouseenter"+NS,function(){that._hovered=!0}).on("mouseleave"+NS,function(){that._hovered=!1}),that.wrapper=$(),options.animation===!1&&(options.animation={open:{effects:{}},close:{hide:!0,effects:{}}}),extend(options.animation.open,{complete:function(){that.wrapper.css({overflow:VISIBLE}),that.trigger(ACTIVATE)}}),extend(options.animation.close,{complete:function(){that.wrapper.hide();var direction,dirClass,location=that.wrapper.data(LOCATION),anchor=$(options.anchor);location&&that.wrapper.css(location),options.anchor!=BODY&&(direction=(anchor[0].className.match(ACTIVEBORDERREGEXP)||["","down"])[1],dirClass=ACTIVEBORDER+"-"+direction,anchor.removeClass(dirClass).children(ACTIVECHILDREN).removeClass(ACTIVE).removeClass(dirClass),element.removeClass(ACTIVEBORDER+"-"+kendo.directions[direction].reverse)),that._closing=!1,that.trigger(DEACTIVATE)}}),that._mousedownProxy=function(e){that._mousedown(e)},that._resizeProxy=function(e){that._resize(e)},options.toggleTarget&&$(options.toggleTarget).on(options.toggleEvent+NS,$.proxy(that.toggle,that))},events:[OPEN,ACTIVATE,CLOSE,DEACTIVATE],options:{name:"Popup",toggleEvent:"click",origin:BOTTOM+" "+LEFT,position:TOP+" "+LEFT,anchor:BODY,collision:"flip fit",viewport:window,copyAnchorStyles:!0,autosize:!1,modal:!1,animation:{open:{effects:"slideIn:down",transition:!0,duration:200},close:{duration:100,hide:!0}}},destroy:function(){var parent,that=this,options=that.options,element=that.element.off(NS);Widget.fn.destroy.call(that),options.toggleTarget&&$(options.toggleTarget).off(NS),options.modal||(DOCUMENT_ELEMENT.unbind(MOUSEDOWN,that._mousedownProxy),WINDOW.unbind(RESIZE_SCROLL,that._resizeProxy)),kendo.destroy(that.element.children()),element.removeData(),options.appendTo[0]===document.body&&(parent=element.parent(".k-animation-container"),parent[0]?parent.remove():element.remove())},open:function(x,y){var animation,wrapper,that=this,fixed={isFixed:!isNaN(parseInt(y,10)),x:x,y:y},element=that.element,options=that.options,direction="down",anchor=$(options.anchor),mobile=element[0]&&element.hasClass("km-widget");if(!that.visible()){if(options.copyAnchorStyles&&(mobile&&"font-size"==styles[0]&&styles.shift(),element.css(kendo.getComputedStyles(anchor[0],styles))),element.data("animating")||that.trigger(OPEN))return;if(options.modal||(DOCUMENT_ELEMENT.unbind(MOUSEDOWN,that._mousedownProxy).bind(MOUSEDOWN,that._mousedownProxy),support.mobileOS.ios||support.mobileOS.android||WINDOW.unbind(RESIZE_SCROLL,that._resizeProxy).bind(RESIZE_SCROLL,that._resizeProxy)),that.wrapper=wrapper=kendo.wrap(element,options.autosize).css({overflow:HIDDEN,display:"block",position:ABSOLUTE}),support.mobileOS.android&&wrapper.add(anchor).css(TRANSFORM,"translatez(0)"),wrapper.css(POSITION),$(options.appendTo)[0]==document.body&&wrapper.css(TOP,"-10000px"),animation=extend(!0,{},options.animation.open),that.flipped=that._position(fixed),animation.effects=kendo.parseEffects(animation.effects,that.flipped),direction=animation.effects.slideIn?animation.effects.slideIn.direction:direction,options.anchor!=BODY){var dirClass=ACTIVEBORDER+"-"+direction;element.addClass(ACTIVEBORDER+"-"+kendo.directions[direction].reverse),anchor.addClass(dirClass).children(ACTIVECHILDREN).addClass(ACTIVE).addClass(dirClass)}element.data(EFFECTS,animation.effects).kendoStop(!0).kendoAnimate(animation)}},toggle:function(){var that=this;that[that.visible()?CLOSE:OPEN]()},visible:function(){return this.element.is(":"+VISIBLE)},close:function(){var wrap,animation,openEffects,closeEffects,that=this,options=that.options;if(that.visible()){if(wrap=that.wrapper[0]?that.wrapper:kendo.wrap(that.element).hide(),that._closing||that.trigger(CLOSE))return;that.element.find(".k-popup").each(function(){var that=$(this),popup=that.data("kendoPopup");popup&&popup.close()}),DOCUMENT_ELEMENT.unbind(MOUSEDOWN,that._mousedownProxy),WINDOW.unbind(RESIZE_SCROLL,that._resizeProxy),animation=extend(!0,{},options.animation.close),openEffects=that.element.data(EFFECTS),closeEffects=animation.effects,!closeEffects&&!kendo.size(closeEffects)&&openEffects&&kendo.size(openEffects)&&(animation.effects=openEffects,animation.reverse=!0),that._closing=!0,that.element.kendoStop(!0),wrap.css({overflow:HIDDEN}),that.element.kendoAnimate(animation)}},_resize:function(e){var that=this;"resize"===e.type?(clearTimeout(that._resizeTimeout),that._resizeTimeout=setTimeout(function(){that._position(),that._resizeTimeout=null},50)):that._hovered||contains(that.element[0],activeElement())||that.close()},_mousedown:function(e){var that=this,container=that.element[0],options=that.options,anchor=$(options.anchor)[0],toggleTarget=options.toggleTarget,target=kendo.eventTarget(e),popup=$(target).closest(".k-popup"),mobile=popup.parent().parent(".km-shim").length;popup=popup[0],!mobile&&popup&&popup!==that.element[0]||"popover"!==$(e.target).closest("a").data("rel")&&(contains(container,target)||contains(anchor,target)||toggleTarget&&contains($(toggleTarget)[0],target)||that.close())},_fit:function(position,size,viewPortSize){var output=0;return position+size>viewPortSize&&(output=viewPortSize-(position+size)),position<0&&(output=-position),output},_flip:function(offset,size,anchorSize,viewPortSize,origin,position,boxSize){var output=0;return boxSize=boxSize||size,position!==origin&&position!==CENTER&&origin!==CENTER&&(offset+boxSize>viewPortSize&&(output+=-(anchorSize+size)),offset+output<0&&(output+=anchorSize+size)),output},_position:function(fixed){var siblingContainer,parents,parentZIndex,length,viewportWidth,viewportHeight,that=this,element=that.element.css(POSITION,""),wrapper=that.wrapper,options=that.options,viewport=$(options.viewport),viewportOffset=viewport.offset(),anchor=$(options.anchor),origins=options.origin.toLowerCase().split(" "),positions=options.position.toLowerCase().split(" "),collisions=that.collisions,zoomLevel=support.zoomLevel(),zIndex=10002,isWindow=!!(viewport[0]==window&&window.innerWidth&&zoomLevel<=1.02),idx=0;if(viewportWidth=isWindow?window.innerWidth:viewport.width(),viewportHeight=isWindow?window.innerHeight:viewport.height(),siblingContainer=anchor.parents().filter(wrapper.siblings()),siblingContainer[0])if(parentZIndex=Math.max(Number(siblingContainer.css("zIndex")),0))zIndex=parentZIndex+10;else for(parents=anchor.parentsUntil(siblingContainer),length=parents.length;idx<length;idx++)parentZIndex=Number($(parents[idx]).css("zIndex")),parentZIndex&&zIndex<parentZIndex&&(zIndex=parentZIndex+10);wrapper.css("zIndex",zIndex),fixed&&fixed.isFixed?wrapper.css({left:fixed.x,top:fixed.y}):wrapper.css(that._align(origins,positions));var pos=getOffset(wrapper,POSITION,anchor[0]===wrapper.offsetParent()[0]),offset=getOffset(wrapper),anchorParent=anchor.offsetParent().parent(".k-animation-container,.k-popup,.k-group");anchorParent.length&&(pos=getOffset(wrapper,POSITION,!0),offset=getOffset(wrapper)),viewport[0]===window?(offset.top-=window.pageYOffset||document.documentElement.scrollTop||0,offset.left-=window.pageXOffset||document.documentElement.scrollLeft||0):(offset.top-=viewportOffset.top,offset.left-=viewportOffset.left),that.wrapper.data(LOCATION)||wrapper.data(LOCATION,extend({},pos));var offsets=extend({},offset),location=extend({},pos);"fit"===collisions[0]&&(location.top+=that._fit(offsets.top,wrapper.outerHeight(),viewportHeight/zoomLevel)),"fit"===collisions[1]&&(location.left+=that._fit(offsets.left,wrapper.outerWidth(),viewportWidth/zoomLevel));var flipPos=extend({},location);return"flip"===collisions[0]&&(location.top+=that._flip(offsets.top,element.outerHeight(),anchor.outerHeight(),viewportHeight/zoomLevel,origins[0],positions[0],wrapper.outerHeight())),"flip"===collisions[1]&&(location.left+=that._flip(offsets.left,element.outerWidth(),anchor.outerWidth(),viewportWidth/zoomLevel,origins[1],positions[1],wrapper.outerWidth())),element.css(POSITION,ABSOLUTE),wrapper.css(location),location.left!=flipPos.left||location.top!=flipPos.top},_align:function(origin,position){var appendToOffset,that=this,element=that.wrapper,anchor=$(that.options.anchor),verticalOrigin=origin[0],horizontalOrigin=origin[1],verticalPosition=position[0],horizontalPosition=position[1],anchorOffset=getOffset(anchor),appendTo=$(that.options.appendTo),width=element.outerWidth(),height=element.outerHeight(),anchorWidth=anchor.outerWidth(),anchorHeight=anchor.outerHeight(),top=anchorOffset.top,left=anchorOffset.left,round=Math.round;return appendTo[0]!=document.body&&(appendToOffset=getOffset(appendTo),top-=appendToOffset.top,left-=appendToOffset.left),verticalOrigin===BOTTOM&&(top+=anchorHeight),verticalOrigin===CENTER&&(top+=round(anchorHeight/2)),verticalPosition===BOTTOM&&(top-=height),verticalPosition===CENTER&&(top-=round(height/2)),horizontalOrigin===RIGHT&&(left+=anchorWidth),horizontalOrigin===CENTER&&(left+=round(anchorWidth/2)),horizontalPosition===RIGHT&&(left-=width),horizontalPosition===CENTER&&(left-=round(width/2)),{top:top,left:left}}});ui.plugin(Popup)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,Widget=kendo.ui.Widget,proxy=$.proxy,extend=$.extend,setTimeout=window.setTimeout,CLICK="click",SHOW="show",HIDE="hide",KNOTIFICATION="k-notification",KICLOSE=".k-notification-wrap .k-i-close",INFO="info",SUCCESS="success",WARNING="warning",ERROR="error",TOP="top",LEFT="left",BOTTOM="bottom",RIGHT="right",UP="up",NS=".kendoNotification",WRAPPER='<div class="k-widget k-notification"></div>',TEMPLATE='<div class="k-notification-wrap"><span class="k-icon k-i-note">#=typeIcon#</span>#=content#<span class="k-icon k-i-close">Hide</span></div>',Notification=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),options=that.options,options.appendTo&&$(options.appendTo).is(element)||that.element.hide(),that._compileTemplates(options.templates),that._guid="_"+kendo.guid(),that._isRtl=kendo.support.isRtl(element),that._compileStacking(options.stacking,options.position.top),kendo.notify(that)},events:[SHOW,HIDE],options:{name:"Notification",position:{pinned:!0,top:null,left:null,bottom:20,right:20},stacking:"default",hideOnClick:!0,button:!1,allowHideAfter:0,autoHideAfter:5e3,appendTo:null,width:null,height:null,templates:[],animation:{open:{effects:"fade:in",duration:300},close:{effects:"fade:out",duration:600,hide:!0}}},_compileTemplates:function(templates){var that=this,kendoTemplate=kendo.template;that._compiled={},$.each(templates,function(key,value){that._compiled[value.type]=kendoTemplate(value.template||$("#"+value.templateId).html())}),that._defaultCompiled=kendoTemplate(TEMPLATE)},_getCompiled:function(type){var that=this,defaultCompiled=that._defaultCompiled;return type?that._compiled[type]||defaultCompiled:defaultCompiled},_compileStacking:function(stacking,top){var origin,position,that=this,paddings={paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0};switch(stacking){case"down":origin=BOTTOM+" "+LEFT,position=TOP+" "+LEFT,delete paddings.paddingBottom;break;case RIGHT:origin=TOP+" "+RIGHT,position=TOP+" "+LEFT,delete paddings.paddingRight;break;case LEFT:origin=TOP+" "+LEFT,position=TOP+" "+RIGHT,delete paddings.paddingLeft;break;case UP:origin=TOP+" "+LEFT,position=BOTTOM+" "+LEFT,delete paddings.paddingTop;break;default:null!==top?(origin=BOTTOM+" "+LEFT,position=TOP+" "+LEFT,delete paddings.paddingBottom):(origin=TOP+" "+LEFT,position=BOTTOM+" "+LEFT,delete paddings.paddingTop)}that._popupOrigin=origin,that._popupPosition=position,that._popupPaddings=paddings},_attachPopupEvents:function(options,popup){function attachClick(target){target.on(CLICK+NS,function(){popup.close()})}var closeIcon,allowHideAfter=options.allowHideAfter,attachDelay=!isNaN(allowHideAfter)&&allowHideAfter>0;options.hideOnClick?popup.bind("activate",function(e){attachDelay?setTimeout(function(){attachClick(popup.element)},allowHideAfter):attachClick(popup.element)}):options.button&&(closeIcon=popup.element.find(KICLOSE),attachDelay?setTimeout(function(){attachClick(closeIcon)},allowHideAfter):attachClick(closeIcon))},_showPopup:function(wrapper,options){var popup,openPopup,that=this,autoHideAfter=options.autoHideAfter,x=options.position.left,y=options.position.top;options.allowHideAfter;openPopup=$("."+that._guid).last(),popup=new kendo.ui.Popup(wrapper,{anchor:openPopup[0]?openPopup:document.body,origin:that._popupOrigin,position:that._popupPosition,animation:options.animation,modal:!0,collision:"",isRtl:that._isRtl,close:function(e){that.trigger(HIDE,{element:this.element})},deactivate:function(e){e.sender.element.off(NS),e.sender.element.find(KICLOSE).off(NS),e.sender.destroy()}}),that._attachPopupEvents(options,popup),openPopup[0]?popup.open():(null===x&&(x=$(window).width()-wrapper.width()-options.position.right),null===y&&(y=$(window).height()-wrapper.height()-options.position.bottom),popup.open(x,y)),popup.wrapper.addClass(that._guid).css(extend({margin:0},that._popupPaddings)),options.position.pinned?(popup.wrapper.css("position","fixed"),openPopup[0]&&that._togglePin(popup.wrapper,!0)):openPopup[0]||that._togglePin(popup.wrapper,!1),autoHideAfter>0&&setTimeout(function(){popup.close()},autoHideAfter)},_togglePin:function(wrapper,pin){var win=$(window),sign=pin?-1:1;wrapper.css({top:parseInt(wrapper.css(TOP),10)+sign*win.scrollTop(),left:parseInt(wrapper.css(LEFT),10)+sign*win.scrollLeft()})},_attachStaticEvents:function(options,wrapper){function attachClick(target){target.on(CLICK+NS,proxy(that._hideStatic,that,wrapper))}var that=this,allowHideAfter=options.allowHideAfter,attachDelay=!isNaN(allowHideAfter)&&allowHideAfter>0;options.hideOnClick?attachDelay?setTimeout(function(){attachClick(wrapper)},allowHideAfter):attachClick(wrapper):options.button&&(attachDelay?setTimeout(function(){attachClick(wrapper.find(KICLOSE))},allowHideAfter):attachClick(wrapper.find(KICLOSE)))},_showStatic:function(wrapper,options){var that=this,autoHideAfter=options.autoHideAfter,animation=options.animation,insertionMethod=options.stacking==UP||options.stacking==LEFT?"prependTo":"appendTo";wrapper.addClass(that._guid)[insertionMethod](options.appendTo).hide().kendoAnimate(animation.open),that._attachStaticEvents(options,wrapper),autoHideAfter>0&&setTimeout(function(){that._hideStatic(wrapper)},autoHideAfter)},_hideStatic:function(wrapper){wrapper.kendoAnimate(extend(this.options.animation.close,{complete:function(){wrapper.off(NS).find(KICLOSE).off(NS),wrapper.remove()}})),this.trigger(HIDE,{element:wrapper})},show:function(content,type){var args,defaultArgs,that=this,options=that.options,wrapper=$(WRAPPER);return type||(type=INFO),null!==content&&content!==undefined&&""!==content&&(kendo.isFunction(content)&&(content=content()),defaultArgs={typeIcon:type,content:""},args=$.isPlainObject(content)?extend(defaultArgs,content):extend(defaultArgs,{content:content}),wrapper.addClass(KNOTIFICATION+"-"+type).toggleClass(KNOTIFICATION+"-button",options.button).attr("data-role","alert").css({width:options.width,height:options.height}).append(that._getCompiled(type)(args)),$(options.appendTo)[0]?that._showStatic(wrapper,options):that._showPopup(wrapper,options),that.trigger(SHOW,{element:wrapper})),that},info:function(content){return this.show(content,INFO)},success:function(content){return this.show(content,SUCCESS)},warning:function(content){return this.show(content,WARNING)},error:function(content){return this.show(content,ERROR)},hide:function(){var that=this,openedNotifications=that.getNotifications();return that.options.appendTo?openedNotifications.each(function(idx,element){that._hideStatic($(element))}):openedNotifications.each(function(idx,element){var popup=$(element).data("kendoPopup");popup&&popup.close()}),that},getNotifications:function(){var that=this,guidElements=$("."+that._guid);return that.options.appendTo?guidElements:guidElements.children("."+KNOTIFICATION)},setOptions:function(newOptions){var options,that=this;Widget.fn.setOptions.call(that,newOptions),options=that.options,newOptions.templates!==undefined&&that._compileTemplates(options.templates),newOptions.stacking===undefined&&newOptions.position===undefined||that._compileStacking(options.stacking,options.position.top)},destroy:function(){Widget.fn.destroy.call(this),this.getNotifications().off(NS).find(KICLOSE).off(NS)}});kendo.ui.plugin(Notification)}(window.kendo.jQuery),function($,undefined){function restoreTitle(element){for(;element.length;)restoreTitleAttributeForElement(element),element=element.parent()}function restoreTitleAttributeForElement(element){var title=element.data(kendo.ns+"title");title&&(element.attr("title",title),element.removeData(kendo.ns+"title"))}function saveTitleAttributeForElement(element){var title=element.attr("title");title&&(element.data(kendo.ns+"title",title),element.attr("title",""))}function saveTitleAttributes(element){for(;element.length&&!element.is("body");)saveTitleAttributeForElement(element),element=element.parent()}var kendo=window.kendo,Widget=kendo.ui.Widget,Popup=kendo.ui.Popup,isFunction=kendo.isFunction,isPlainObject=$.isPlainObject,extend=$.extend,proxy=$.proxy,DOCUMENT=$(document),isLocalUrl=kendo.isLocalUrl,ARIAIDSUFFIX="_tt_active",DESCRIBEDBY="aria-describedby",SHOW="show",HIDE="hide",ERROR="error",CONTENTLOAD="contentLoad",REQUESTSTART="requestStart",KCONTENTFRAME="k-content-frame",TEMPLATE='<div role="tooltip" class="k-widget k-tooltip#if (!autoHide) {# k-tooltip-closable#}#">#if (!autoHide) {# <div class="k-tooltip-button"><a href="\\#" class="k-icon k-i-close">close</a></div> #}#<div class="k-tooltip-content"></div>#if (callout){ #<div class="k-callout k-callout-#=dir#"></div>#}#</div>',IFRAMETEMPLATE=kendo.template("<iframe frameborder='0' class='"+KCONTENTFRAME+"' src='#= content.url #'>This page requires frames in order to show content</iframe>"),NS=".kendoTooltip",POSITIONS={bottom:{origin:"bottom center",position:"top center"},top:{origin:"top center",position:"bottom center"},left:{origin:"center left",position:"center right",collision:"fit flip"},right:{origin:"center right",position:"center left",collision:"fit flip"},center:{position:"center center",origin:"center center"}},REVERSE={top:"bottom",bottom:"top",left:"right",right:"left",center:"center"},DIRCLASSES={bottom:"n",top:"s",left:"e",right:"w",center:"n"},DIMENSIONS={horizontal:{offset:"top",size:"outerHeight"},vertical:{offset:"left",size:"outerWidth"}},DEFAULTCONTENT=function(e){return e.target.data(kendo.ns+"title")},Tooltip=Widget.extend({init:function(element,options){var axis,that=this;Widget.fn.init.call(that,element,options),axis=that.options.position.match(/left|right/)?"horizontal":"vertical",that.dimensions=DIMENSIONS[axis],that._documentKeyDownHandler=proxy(that._documentKeyDown,that),that.element.on(that.options.showOn+NS,that.options.filter,proxy(that._showOn,that)).on("mouseenter"+NS,that.options.filter,proxy(that._mouseenter,that)),this.options.autoHide&&that.element.on("mouseleave"+NS,that.options.filter,proxy(that._mouseleave,that))},options:{name:"Tooltip",filter:"",content:DEFAULTCONTENT,showAfter:100,callout:!0,position:"bottom",showOn:"mouseenter",autoHide:!0,width:null,height:null,animation:{open:{effects:"fade:in",duration:0},close:{effects:"fade:out",duration:40,hide:!0}}},events:[SHOW,HIDE,CONTENTLOAD,ERROR,REQUESTSTART],_mouseenter:function(e){saveTitleAttributes($(e.currentTarget))},_showOn:function(e){var that=this,currentTarget=$(e.currentTarget);that.options.showOn&&that.options.showOn.match(/click|focus/)?that._show(currentTarget):(clearTimeout(that.timeout),that.timeout=setTimeout(function(){that._show(currentTarget)},that.options.showAfter));
},_appendContent:function(target){var iframe,that=this,contentOptions=that.options.content,element=that.content,showIframe=that.options.iframe;isPlainObject(contentOptions)&&contentOptions.url?("iframe"in that.options||(showIframe=!isLocalUrl(contentOptions.url)),that.trigger(REQUESTSTART,{options:contentOptions,target:target}),showIframe?(element.hide(),iframe=element.find("."+KCONTENTFRAME)[0],iframe?iframe.src=contentOptions.url||iframe.src:element.html(IFRAMETEMPLATE({content:contentOptions})),element.find("."+KCONTENTFRAME).off("load"+NS).on("load"+NS,function(){that.trigger(CONTENTLOAD),element.show()})):(element.empty(),kendo.ui.progress(element,!0),that._ajaxRequest(contentOptions))):contentOptions&&isFunction(contentOptions)?(contentOptions=contentOptions({sender:this,target:target}),that.content.html(contentOptions||"")):that.content.html(contentOptions)},_ajaxRequest:function(options){var that=this;jQuery.ajax(extend({type:"GET",dataType:"html",cache:!1,error:function(xhr,status){kendo.ui.progress(that.content,!1),that.trigger(ERROR,{status:status,xhr:xhr})},success:proxy(function(data){kendo.ui.progress(that.content,!1),that.content.html(data),that.trigger(CONTENTLOAD)},that)},options))},_documentKeyDown:function(e){e.keyCode===kendo.keys.ESC&&this.hide()},refresh:function(){var that=this,popup=that.popup;popup&&popup.options.anchor&&that._appendContent(popup.options.anchor)},hide:function(){this.popup&&this.popup.close()},show:function(target){target=target||this.element,saveTitleAttributes(target),this._show(target)},_show:function(target){var that=this,current=that.target();that.popup||that._initPopup(),current&&current[0]!=target[0]&&(that.popup.close(),that.popup.element.kendoStop(!0,!0)),current&&current[0]==target[0]||(that._appendContent(target),that.popup.options.anchor=target),that.popup.one("deactivate",function(){restoreTitle(target),target.removeAttr(DESCRIBEDBY),this.element.removeAttr("id").attr("aria-hidden",!0),DOCUMENT.off("keydown"+NS,that._documentKeyDownHandler)}),that.popup.open()},_initPopup:function(){var that=this,options=that.options,wrapper=$(kendo.template(TEMPLATE)({callout:options.callout&&"center"!==options.position,dir:DIRCLASSES[options.position],autoHide:options.autoHide}));that.popup=new Popup(wrapper,extend({activate:function(){var anchor=this.options.anchor,ariaId=anchor[0].id||that.element[0].id;ariaId&&(anchor.attr(DESCRIBEDBY,ariaId+ARIAIDSUFFIX),this.element.attr("id",ariaId+ARIAIDSUFFIX)),options.callout&&that._positionCallout(),this.element.removeAttr("aria-hidden"),DOCUMENT.on("keydown"+NS,that._documentKeyDownHandler),that.trigger(SHOW)},close:function(){that.trigger(HIDE)},copyAnchorStyles:!1,animation:options.animation},POSITIONS[options.position])),wrapper.css({width:options.width,height:options.height}),that.content=wrapper.find(".k-tooltip-content"),that.arrow=wrapper.find(".k-callout"),options.autoHide?wrapper.on("mouseleave"+NS,proxy(that._mouseleave,that)):wrapper.on("click"+NS,".k-tooltip-button",proxy(that._closeButtonClick,that))},_closeButtonClick:function(e){e.preventDefault(),this.hide()},_mouseleave:function(e){if(this.popup){var element=$(e.currentTarget),offset=element.offset(),pageX=e.pageX,pageY=e.pageY;if(offset.right=offset.left+element.outerWidth(),offset.bottom=offset.top+element.outerHeight(),pageX>offset.left&&pageX<offset.right&&pageY>offset.top&&pageY<offset.bottom)return;this.popup.close()}else restoreTitle($(e.currentTarget));clearTimeout(this.timeout)},_positionCallout:function(){var that=this,position=that.options.position,dimensions=that.dimensions,offset=dimensions.offset,popup=that.popup,anchor=popup.options.anchor,anchorOffset=$(anchor).offset(),arrowBorder=parseInt(that.arrow.css("border-top-width"),10),elementOffset=$(popup.element).offset(),cssClass=DIRCLASSES[popup.flipped?REVERSE[position]:position],offsetAmount=anchorOffset[offset]-elementOffset[offset]+$(anchor)[dimensions.size]()/2-arrowBorder;that.arrow.removeClass("k-callout-n k-callout-s k-callout-w k-callout-e").addClass("k-callout-"+cssClass).css(offset,offsetAmount)},target:function(){return this.popup?this.popup.options.anchor:null},destroy:function(){var popup=this.popup;popup&&(popup.element.off(NS),popup.destroy()),this.element.off(NS),DOCUMENT.off("keydown"+NS,this._documentKeyDownHandler),Widget.fn.destroy.call(this)}});kendo.ui.plugin(Tooltip)}(window.kendo.jQuery),function($,undefined){function removeFiltersForField(expression,field){expression.filters&&(expression.filters=$.grep(expression.filters,function(filter){return removeFiltersForField(filter,field),filter.filters?filter.filters.length:filter.field!=field}))}var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget,keys=kendo.keys,support=kendo.support,htmlEncode=kendo.htmlEncode,activeElement=kendo._activeElement,ID="id",LI="li",CHANGE="change",FOCUSED="k-state-focused",HOVER="k-state-hover",LOADING="k-loading",OPEN="open",CLOSE="close",SELECT="select",SELECTED="selected",PROGRESS="progress",REQUESTEND="requestEnd",WIDTH="width",extend=$.extend,proxy=$.proxy,browser=support.browser,isIE8=browser.msie&&browser.version<9,quotRegExp=/"/g,alternativeNames={ComboBox:"DropDownList",DropDownList:"ComboBox"},List=Widget.extend({init:function(element,options){var id,that=this,ns=that.ns;Widget.fn.init.call(that,element,options),element=that.element,that._isSelect=element.is(SELECT),that._template(),that.ul=$('<ul unselectable="on" class="k-list k-reset"/>').css({overflow:support.kineticScrollNeeded?"":"auto"}).on("mouseenter"+ns,LI,function(){$(this).addClass(HOVER)}).on("mouseleave"+ns,LI,function(){$(this).removeClass(HOVER)}).on("click"+ns,LI,proxy(that._click,that)).attr({tabIndex:-1,role:"listbox","aria-hidden":!0}),that.list=$("<div class='k-list-container'/>").append(that.ul).on("mousedown"+ns,function(e){e.preventDefault()}),id=element.attr(ID),id&&(that.list.attr(ID,id+"-list"),that.ul.attr(ID,id+"_listbox"),that._optionID=id+"_option_selected"),that._header(),that._accessors(),that._initValue()},options:{valuePrimitive:!1,headerTemplate:""},setOptions:function(options){Widget.fn.setOptions.call(this,options),options&&options.enable!==undefined&&(options.enabled=options.enable)},focus:function(){this._focused.focus()},readonly:function(readonly){this._editable({readonly:readonly===undefined||readonly,disable:!1})},enable:function(enable){this._editable({readonly:!1,disable:!(enable=enable===undefined||enable)})},_filterSource:function(filter){var that=this,options=that.options,dataSource=that.dataSource,expression=dataSource.filter()||{};removeFiltersForField(expression,options.dataTextField),filter&&(expression=expression.filters||[],expression.push(filter)),dataSource.filter(expression)},_header:function(){var header,template=this.options.headerTemplate;$.isFunction(template)&&(template=template({})),template&&(this.list.prepend(template),header=this.ul.prev(),this.header=header[0]?header:null)},_initValue:function(){var that=this,value=that.options.value;null!==value?that.element.val(value):(value=that._accessor(),that.options.value=value),that._old=value},_ignoreCase:function(){var field,that=this,model=that.dataSource.reader.model;model&&model.fields&&(field=model.fields[that.options.dataTextField],field&&field.type&&"string"!==field.type&&(that.options.ignoreCase=!1))},items:function(){return this.ul[0].children},current:function(candidate){var that=this,id=that._optionID;return candidate===undefined?that._current:(that._current&&(that._current.removeClass(FOCUSED).removeAttr("aria-selected").removeAttr(ID),that._focused.removeAttr("aria-activedescendant")),candidate&&(candidate.addClass(FOCUSED),that._scroll(candidate),id&&(candidate.attr("id",id),that._focused.attr("aria-activedescendant",id))),that._current=candidate,void 0)},destroy:function(){var that=this,ns=that.ns;Widget.fn.destroy.call(that),that._unbindDataSource(),that.ul.off(ns),that.list.off(ns),that._touchScroller&&that._touchScroller.destroy(),that.popup.destroy(),that._form&&that._form.off("reset",that._resetHandler)},dataItem:function(index){var that=this;return index===undefined&&(index=that.selectedIndex),that._data()[index]},_accessors:function(){var that=this,element=that.element,options=that.options,getter=kendo.getter,textField=element.attr(kendo.attr("text-field")),valueField=element.attr(kendo.attr("value-field"));textField&&(options.dataTextField=textField),valueField&&(options.dataValueField=valueField),that._text=getter(options.dataTextField),that._value=getter(options.dataValueField)},_aria:function(id){var that=this,options=that.options,element=that._focused;options.suggest!==undefined&&element.attr("aria-autocomplete",options.suggest?"both":"list"),id=id?id+" "+that.ul[0].id:that.ul[0].id,element.attr("aria-owns",id),that.ul.attr("aria-live",options.filter&&"none"!==options.filter?"polite":"off")},_blur:function(){var that=this;that._change(),that.close()},_change:function(){var trigger,that=this,index=that.selectedIndex,optionValue=that.options.value,value=that.value();that._isSelect&&!that._bound&&optionValue&&(value=optionValue),value!==that._old?trigger=!0:index!==undefined&&index!==that._oldIndex&&(trigger=!0),trigger&&(that._old=value,that._oldIndex=index,that.trigger(CHANGE),that.element.trigger(CHANGE))},_click:function(e){e.isDefaultPrevented()||this._accept($(e.currentTarget))},_data:function(){return this.dataSource.view()},_enable:function(){var that=this,options=that.options,disabled=that.element.is("[disabled]");options.enable!==undefined&&(options.enabled=options.enable),!options.enabled||disabled?that.enable(!1):that.readonly(that.element.is("[readonly]"))},_focus:function(li){var that=this,userTriggered=!0;return that.popup.visible()&&li&&that.trigger(SELECT,{item:li})?void that.close():(that._select(li),that._triggerCascade(userTriggered),void that._blur())},_index:function(value){var idx,length,that=this,data=that._data();for(idx=0,length=data.length;idx<length;idx++)if(that._dataValue(data[idx])==value)return idx;return-1},_dataValue:function(dataItem){var value=this._value(dataItem);return value===undefined&&(value=this._text(dataItem)),value},_height:function(length){if(length){var popups,that=this,list=that.list,visible=that.popup.visible(),height=that.options.height,header=that.header;popups=list.add(list.parent(".k-animation-container")).show(),height=that.ul[0].scrollHeight>height?height:"auto",popups.height(height),header&&that.ul.height("auto"==height?height:list.height()-header.height()),visible||popups.hide()}},_adjustListWidth:function(){var computedStyle,computedWidth,list=this.list,width=list[0].style.width,wrapper=this.wrapper;if(list.data(WIDTH)||!width)return computedStyle=window.getComputedStyle?window.getComputedStyle(wrapper[0],null):0,computedWidth=computedStyle?parseFloat(computedStyle.width):wrapper.outerWidth(),computedStyle&&(browser.mozilla||browser.msie)&&(computedWidth+=parseFloat(computedStyle.paddingLeft)+parseFloat(computedStyle.paddingRight)+parseFloat(computedStyle.borderLeftWidth)+parseFloat(computedStyle.borderRightWidth)),width="border-box"!==list.css("box-sizing")?computedWidth-(list.outerWidth()-list.width()):computedWidth,list.css({fontFamily:wrapper.css("font-family"),width:width}).data(WIDTH,width),!0},_popup:function(){var that=this,list=that.list,focused=that._focused,options=that.options,wrapper=that.wrapper;that.popup=new ui.Popup(list,extend({},options.popup,{anchor:wrapper,open:function(e){that._adjustListWidth(),that.trigger(OPEN)?e.preventDefault():(focused.attr("aria-expanded",!0),that.ul.attr("aria-hidden",!1))},close:function(e){that.trigger(CLOSE)?e.preventDefault():(focused.attr("aria-expanded",!1),that.ul.attr("aria-hidden",!0))},animation:options.animation,isRtl:support.isRtl(wrapper)})),that.popup.one(OPEN,function(){that._height(that._data().length)}),that._touchScroller=kendo.touchScroller(that.popup.element)},_makeUnselectable:function(){isIE8&&this.list.find("*").attr("unselectable","on")},_toggleHover:function(e){$(e.currentTarget).toggleClass(HOVER,"mouseenter"===e.type)},_toggle:function(open,preventFocus){var that=this,touchEnabled=support.touch&&support.MSPointers&&support.pointers;open=open!==undefined?open:!that.popup.visible(),preventFocus||touchEnabled||that._focused[0]===activeElement()||that._focused.focus(),that[open?OPEN:CLOSE]()},_scroll:function(item){if(item){item[0]&&(item=item[0]);var yDimension,headerHeight,ul=this.ul[0],itemOffsetTop=item.offsetTop,itemOffsetHeight=item.offsetHeight,ulScrollTop=ul.scrollTop,ulOffsetHeight=ul.clientHeight,bottomDistance=itemOffsetTop+itemOffsetHeight,touchScroller=this._touchScroller;touchScroller?(yDimension=touchScroller.dimensions.y,yDimension.enabled&&itemOffsetTop>yDimension.size&&(itemOffsetTop=itemOffsetTop-yDimension.size+itemOffsetHeight+4,touchScroller.scrollTo(0,-itemOffsetTop))):(headerHeight=this.header?this.header.outerHeight():0,ul.scrollTop=ulScrollTop>itemOffsetTop?itemOffsetTop-headerHeight:bottomDistance>ulScrollTop+ulOffsetHeight?bottomDistance-ulOffsetHeight-headerHeight:ulScrollTop)}},_template:function(){var that=this,options=that.options,template=options.template,hasDataSource=options.dataSource;that._isSelect&&that.element[0].length&&(hasDataSource||(options.dataTextField=options.dataTextField||"text",options.dataValueField=options.dataValueField||"value")),template?(template=kendo.template(template),that.template=function(data){return'<li tabindex="-1" role="option" unselectable="on" class="k-item">'+template(data)+"</li>"}):that.template=kendo.template('<li tabindex="-1" role="option" unselectable="on" class="k-item">${'+kendo.expr(options.dataTextField,"data")+"}</li>",{useWithBlock:!1})},_triggerCascade:function(userTriggered){var that=this,value=that.value();(!that._bound&&value||that._old!==value)&&that.trigger("cascade",{userTriggered:userTriggered})},_unbindDataSource:function(){var that=this;that.dataSource.unbind(CHANGE,that._refreshHandler).unbind(PROGRESS,that._progressHandler).unbind(REQUESTEND,that._requestEndHandler).unbind("error",that._errorHandler)}});extend(List,{inArray:function(node,parentNode){var idx,length,siblings=parentNode.children;if(!node||node.parentNode!==parentNode)return-1;for(idx=0,length=siblings.length;idx<length;idx++)if(node===siblings[idx])return idx;return-1}}),kendo.ui.List=List,ui.Select=List.extend({init:function(element,options){List.fn.init.call(this,element,options),this._initial=this.element.val()},setDataSource:function(dataSource){this.options.dataSource=dataSource,this._dataSource(),this._bound=!1,this.options.autoBind&&this.dataSource.fetch()},close:function(){this.popup.close()},select:function(li){var that=this;return li===undefined?that.selectedIndex:(that._select(li),that._triggerCascade(),that._old=that._accessor(),that._oldIndex=that.selectedIndex,void 0)},_accessor:function(value,idx){var option,element=this.element[0],isSelect=this._isSelect,selectedIndex=element.selectedIndex;return value===undefined?(isSelect?selectedIndex>-1&&(option=element.options[selectedIndex],option&&(value=option.value)):value=element.value,value):void(isSelect?(selectedIndex>-1&&element.options[selectedIndex].removeAttribute(SELECTED),element.selectedIndex=idx,option=element.options[idx],option&&option.setAttribute(SELECTED,SELECTED)):element.value=value)},_hideBusy:function(){var that=this;clearTimeout(that._busy),that._arrow.removeClass(LOADING),that._focused.attr("aria-busy",!1),that._busy=null},_showBusy:function(){var that=this;that._request=!0,that._busy||(that._busy=setTimeout(function(){that._focused.attr("aria-busy",!0),that._arrow.addClass(LOADING)},100))},_requestEnd:function(){this._request=!1},_dataSource:function(){var idx,that=this,element=that.element,options=that.options,dataSource=options.dataSource||{};dataSource=$.isArray(dataSource)?{data:dataSource}:dataSource,that._isSelect&&(idx=element[0].selectedIndex,idx>-1&&(options.index=idx),dataSource.select=element,dataSource.fields=[{field:options.dataTextField},{field:options.dataValueField}]),that.dataSource&&that._refreshHandler?that._unbindDataSource():(that._refreshHandler=proxy(that.refresh,that),that._progressHandler=proxy(that._showBusy,that),that._requestEndHandler=proxy(that._requestEnd,that),that._errorHandler=proxy(that._hideBusy,that)),that.dataSource=kendo.data.DataSource.create(dataSource).bind(CHANGE,that._refreshHandler).bind(PROGRESS,that._progressHandler).bind(REQUESTEND,that._requestEndHandler).bind("error",that._errorHandler)},_get:function(li){var idx,length,that=this,data=that._data();if("function"==typeof li)for(idx=0,length=data.length;idx<length;idx++)if(li(data[idx])){li=idx;break}if("number"==typeof li){if(li<0)return $();li=$(that.ul[0].children[li])}return li&&li.nodeType&&(li=$(li)),li},_move:function(e){var firstChild,pressed,that=this,key=e.keyCode,ul=that.ul[0],methodName=that.popup.visible()?"_select":"_accept",current=that._current,down=key===keys.DOWN;if(key===keys.UP||down){if(e.altKey)that.toggle(down);else{if(firstChild=ul.firstChild,!firstChild&&!that._accessor()&&"filter"!==that._state)return that._fetch||(that.dataSource.one(CHANGE,function(){that._move(e),that._fetch=!1}),that._fetch=!0,that._filterSource()),e.preventDefault(),!0;down?(!current||that.selectedIndex===-1&&!that.value()&&current[0]===firstChild?current=firstChild:(current=current[0].nextSibling,current||firstChild!==ul.lastChild||(current=firstChild)),that[methodName](current)):(current=current?current[0].previousSibling:ul.lastChild,current||firstChild!==ul.lastChild||(current=firstChild),that[methodName](current))}e.preventDefault(),pressed=!0}else key===keys.ENTER||key===keys.TAB?(that.popup.visible()&&e.preventDefault(),that.popup.visible()||current&&current.hasClass("k-state-selected")||(current=null),that._accept(current),pressed=!0):key===keys.ESC&&(that.popup.visible()&&e.preventDefault(),that.close(),pressed=!0);return pressed},_selectItem:function(){var useOptionIndex,value,that=this,notBound=that._bound===undefined,options=that.options;useOptionIndex=that._isSelect&&!that._initial&&!options.value&&options.index&&!that._bound,useOptionIndex||(value=that._selectedValue||notBound&&options.value||that._accessor()),value?that.value(value):notBound&&that.select(options.index)},_fetchItems:function(value){var that=this,hasItems=that.ul[0].firstChild;return!!that._request||(that._bound||that._fetch||hasItems?void 0:that.options.cascadeFrom?!hasItems:(that.dataSource.one(CHANGE,function(){that._old=undefined,that.value(value),that._fetch=!1}),that._fetch=!0,that.dataSource.fetch(),!0))},_options:function(data,optionLabel){var option,dataItem,dataText,dataValue,that=this,element=that.element,length=data.length,options="",idx=0;for(optionLabel&&(idx=1,options=optionLabel);idx<length;idx++)option="<option",dataItem=data[idx],dataText=that._text(dataItem),dataValue=that._value(dataItem),dataValue!==undefined&&(dataValue+="",dataValue.indexOf('"')!==-1&&(dataValue=dataValue.replace(quotRegExp,"&quot;")),option+=' value="'+dataValue+'"'),option+=">",dataText!==undefined&&(option+=htmlEncode(dataText)),option+="</option>",options+=option;element.html(options)},_reset:function(){var that=this,element=that.element,formId=element.attr("form"),form=formId?$("#"+formId):element.closest("form");form[0]&&(that._resetHandler=function(){setTimeout(function(){that.value(that._initial)})},that._form=form.on("reset",that._resetHandler))},_cascade:function(){var parent,parentElement,select,valueField,change,that=this,options=that.options,cascade=options.cascadeFrom;if(cascade){if(that._selectedValue=options.value||that._accessor(),parentElement=$("#"+cascade),parent=parentElement.data("kendo"+options.name),parent||(parent=parentElement.data("kendo"+alternativeNames[options.name])),!parent)return;options.autoBind=!1,valueField=options.cascadeFromField||parent.options.dataValueField,change=function(){that.dataSource.unbind(CHANGE,change);var value=that._selectedValue||that.value();that._userTriggered?that._clearSelection(parent,!0):value?(that.value(value),that.dataSource.view()[0]&&that.selectedIndex!==-1||that._clearSelection(parent,!0)):that.select(options.index),that.enable(),that._triggerCascade(that._userTriggered),that._userTriggered=!1},select=function(){var expressions,filters,dataItem=parent.dataItem(),filterValue=dataItem?parent._value(dataItem):null;if(filterValue||0===filterValue){expressions=that.dataSource.filter()||{},removeFiltersForField(expressions,valueField),filters=expressions.filters||[],filters.push({field:valueField,operator:"eq",value:filterValue});var handler=function(){that.unbind("dataBound",handler),change.apply(that,arguments)};that.first("dataBound",handler),that.dataSource.filter(filters)}else that.enable(!1),that._clearSelection(parent),that._triggerCascade(that._userTriggered),that._userTriggered=!1},parent.first("cascade",function(e){that._userTriggered=e.userTriggered,select()}),parent._bound?select():parent.value()||that.enable(!1)}}})}(window.kendo.jQuery),function($,undefined){function title(date,min,max,modular){var end,start=date.getFullYear(),minYear=min.getFullYear(),maxYear=max.getFullYear();return start-=start%modular,end=start+(modular-1),start<minYear&&(start=minYear),end>maxYear&&(end=maxYear),start+"-"+end}function view(options){for(var data,idx=0,min=options.min,max=options.max,start=options.start,setter=options.setter,build=options.build,length=options.cells||12,cellsPerRow=options.perRow||4,content=options.content||cellTemplate,empty=options.empty||emptyCellTemplate,html=options.html||'<table tabindex="0" role="grid" class="k-content k-meta-view" cellspacing="0"><tbody><tr role="row">';idx<length;idx++)idx>0&&idx%cellsPerRow===0&&(html+='</tr><tr role="row">'),data=build(start,idx),html+=isInRange(start,min,max)?content(data):empty(data),setter(start,1);return html+"</tr></tbody></table>"}function compare(date1,date2,modifier){var year1=date1.getFullYear(),start=date2.getFullYear(),end=start,result=0;return modifier&&(start-=start%modifier,end=start-start%modifier+modifier-1),year1>end?result=1:year1<start&&(result=-1),result}function getToday(){var today=new DATE;return new DATE(today.getFullYear(),today.getMonth(),today.getDate())}function restrictValue(value,min,max){var today=getToday();return value&&(today=new DATE((+value))),min>today?today=new DATE((+min)):max<today&&(today=new DATE((+max))),today}function isInRange(date,min,max){return+date>=+min&&+date<=+max}function shiftArray(array,idx){return array.slice(idx).concat(array.slice(0,idx))}function setDate(date,value,multiplier){value=value instanceof DATE?value.getFullYear():date.getFullYear()+multiplier*value,date.setFullYear(value)}function mousetoggle(e){$(this).toggleClass(HOVER,MOUSEENTER.indexOf(e.type)>-1||e.type==FOCUS)}function prevent(e){e.preventDefault()}function getCalendarInfo(culture){return getCulture(culture).calendars.standard}function normalize(options){var start=views[options.start],depth=views[options.depth],culture=getCulture(options.culture);options.format=extractFormat(options.format||culture.calendars.standard.patterns.d),isNaN(start)&&(start=0,options.start=MONTH),(depth===undefined||depth>start)&&(options.depth=MONTH),options.dates||(options.dates=[])}function makeUnselectable(element){isIE8&&element.find("*").attr("unselectable","on")}function inArray(date,dates){for(var i=0,length=dates.length;i<length;i++)if(date===+dates[i])return!0;return!1}function isEqualDatePart(value1,value2){return!!value1&&(value1.getFullYear()===value2.getFullYear()&&value1.getMonth()===value2.getMonth()&&value1.getDate()===value2.getDate())}function isEqualMonth(value1,value2){return!!value1&&(value1.getFullYear()===value2.getFullYear()&&value1.getMonth()===value2.getMonth())}var kendo=window.kendo,support=kendo.support,ui=kendo.ui,Widget=ui.Widget,keys=kendo.keys,parse=kendo.parseDate,adjustDST=kendo.date.adjustDST,extractFormat=kendo._extractFormat,template=kendo.template,getCulture=kendo.getCulture,transitions=kendo.support.transitions,transitionOrigin=transitions?transitions.css+"transform-origin":"",cellTemplate=template('<td#=data.cssClass# role="gridcell"><a tabindex="-1" class="k-link" href="\\#" data-#=data.ns#value="#=data.dateString#">#=data.value#</a></td>',{useWithBlock:!1}),emptyCellTemplate=template('<td role="gridcell">&nbsp;</td>',{useWithBlock:!1}),browser=kendo.support.browser,isIE8=browser.msie&&browser.version<9,ns=".kendoCalendar",CLICK="click"+ns,KEYDOWN_NS="keydown"+ns,ID="id",MIN="min",LEFT="left",SLIDE="slideIn",MONTH="month",CENTURY="century",CHANGE="change",NAVIGATE="navigate",VALUE="value",HOVER="k-state-hover",DISABLED="k-state-disabled",FOCUSED="k-state-focused",OTHERMONTH="k-other-month",OTHERMONTHCLASS=' class="'+OTHERMONTH+'"',TODAY="k-nav-today",CELLSELECTOR="td:has(.k-link)",BLUR="blur"+ns,FOCUS="focus",FOCUS_WITH_NS=FOCUS+ns,MOUSEENTER=support.touch?"touchstart":"mouseenter",MOUSEENTER_WITH_NS=support.touch?"touchstart"+ns:"mouseenter"+ns,MOUSELEAVE=support.touch?"touchend"+ns+" touchmove"+ns:"mouseleave"+ns,MS_PER_MINUTE=6e4,MS_PER_DAY=864e5,PREVARROW="_prevArrow",NEXTARROW="_nextArrow",ARIA_DISABLED="aria-disabled",ARIA_SELECTED="aria-selected",proxy=$.proxy,extend=$.extend,DATE=Date,views={month:0,year:1,decade:2,century:3},Calendar=Widget.extend({init:function(element,options){var value,id,that=this;Widget.fn.init.call(that,element,options),element=that.wrapper=that.element,options=that.options,options.url=window.unescape(options.url),that._templates(),that._header(),that._footer(that.footer),id=element.addClass("k-widget k-calendar").on(MOUSEENTER_WITH_NS+" "+MOUSELEAVE,CELLSELECTOR,mousetoggle).on(KEYDOWN_NS,"table.k-content",proxy(that._move,that)).on(CLICK,CELLSELECTOR,function(e){var link=e.currentTarget.firstChild;link.href.indexOf("#")!=-1&&e.preventDefault(),that._click($(link))}).on("mouseup"+ns,"table.k-content, .k-footer",function(){that._focusView(that.options.focusOnNav!==!1)}).attr(ID),id&&(that._cellID=id+"_cell_selected"),normalize(options),value=parse(options.value,options.format,options.culture),that._index=views[options.start],that._current=new DATE((+restrictValue(value,options.min,options.max))),that._addClassProxy=function(){that._active=!0,that._cell.addClass(FOCUSED)},that._removeClassProxy=function(){that._active=!1,that._cell.removeClass(FOCUSED)},that.value(value),kendo.notify(that)},options:{name:"Calendar",value:null,min:new DATE(1900,0,1),max:new DATE(2099,11,31),dates:[],url:"",culture:"",footer:"",format:"",month:{},start:MONTH,depth:MONTH,animation:{horizontal:{effects:SLIDE,reverse:!0,duration:500,divisor:2},vertical:{effects:"zoomIn",duration:400}}},events:[CHANGE,NAVIGATE],setOptions:function(options){var that=this;normalize(options),options.dates[0]||(options.dates=that.options.dates),Widget.fn.setOptions.call(that,options),that._templates(),that._footer(that.footer),that._index=views[that.options.start],that.navigate()},destroy:function(){var that=this,today=that._today;that.element.off(ns),that._title.off(ns),that[PREVARROW].off(ns),that[NEXTARROW].off(ns),kendo.destroy(that._table),today&&kendo.destroy(today.off(ns)),Widget.fn.destroy.call(that)},current:function(){return this._current},view:function(){return this._view},focus:function(table){table=table||this._table,this._bindTable(table),table.focus()},min:function(value){return this._option(MIN,value)},max:function(value){return this._option("max",value)},navigateToPast:function(){this._navigate(PREVARROW,-1)},navigateToFuture:function(){this._navigate(NEXTARROW,1)},navigateUp:function(){var that=this,index=that._index;that._title.hasClass(DISABLED)||that.navigate(that._current,++index)},navigateDown:function(value){var that=this,index=that._index,depth=that.options.depth;if(value)return index===views[depth]?void(+that._value!=+value&&(that.value(value),that.trigger(CHANGE))):void that.navigate(value,--index)},navigate:function(value,view){view=isNaN(view)?views[view]:view;var to,currentView,compare,disabled,that=this,options=that.options,culture=options.culture,min=options.min,max=options.max,title=that._title,from=that._table,old=that._oldTable,selectedValue=that._value,currentValue=that._current,future=value&&+value>+currentValue,vertical=view!==undefined&&view!==that._index;value||(value=currentValue),that._current=value=new DATE((+restrictValue(value,min,max))),view===undefined?view=that._index:that._index=view,that._view=currentView=calendar.views[view],compare=currentView.compare,disabled=view===views[CENTURY],title.toggleClass(DISABLED,disabled).attr(ARIA_DISABLED,disabled),disabled=compare(value,min)<1,that[PREVARROW].toggleClass(DISABLED,disabled).attr(ARIA_DISABLED,disabled),disabled=compare(value,max)>-1,that[NEXTARROW].toggleClass(DISABLED,disabled).attr(ARIA_DISABLED,disabled),from&&old&&old.data("animating")&&(old.kendoStop(!0,!0),from.kendoStop(!0,!0)),that._oldTable=from,from&&!that._changeView||(title.html(currentView.title(value,min,max,culture)),that._table=to=$(currentView.content(extend({min:min,max:max,date:value,url:options.url,dates:options.dates,format:options.format,culture:culture},that[currentView.name]))),makeUnselectable(to),that._animate({from:from,to:to,vertical:vertical,future:future}),that._focus(value),that.trigger(NAVIGATE)),view===views[options.depth]&&selectedValue&&that._class("k-state-selected",currentView.toDateString(selectedValue)),that._class(FOCUSED,currentView.toDateString(value)),!from&&that._cell&&that._cell.removeClass(FOCUSED),that._changeView=!0},value:function(value){var that=this,view=that._view,options=that.options,old=that._view,min=options.min,max=options.max;return value===undefined?that._value:(value=parse(value,options.format,options.culture),null!==value&&(value=new DATE((+value)),isInRange(value,min,max)||(value=null)),that._value=value,void(old&&null===value&&that._cell?that._cell.removeClass("k-state-selected"):(that._changeView=!value||view&&0!==view.compare(value,that._current),that.navigate(value))))},_move:function(e){var value,prevent,method,temp,that=this,options=that.options,key=e.keyCode,view=that._view,index=that._index,currentValue=new DATE((+that._current)),isRtl=kendo.support.isRtl(that.wrapper);return e.target===that._table[0]&&(that._active=!0),e.ctrlKey?key==keys.RIGHT&&!isRtl||key==keys.LEFT&&isRtl?(that.navigateToFuture(),prevent=!0):key==keys.LEFT&&!isRtl||key==keys.RIGHT&&isRtl?(that.navigateToPast(),prevent=!0):key==keys.UP?(that.navigateUp(),prevent=!0):key==keys.DOWN&&(that._click($(that._cell[0].firstChild)),prevent=!0):(key==keys.RIGHT&&!isRtl||key==keys.LEFT&&isRtl?(value=1,prevent=!0):key==keys.LEFT&&!isRtl||key==keys.RIGHT&&isRtl?(value=-1,prevent=!0):key==keys.UP?(value=0===index?-7:-4,prevent=!0):key==keys.DOWN?(value=0===index?7:4,prevent=!0):key==keys.ENTER?(that._click($(that._cell[0].firstChild)),prevent=!0):key==keys.HOME||key==keys.END?(method=key==keys.HOME?"first":"last",temp=view[method](currentValue),currentValue=new DATE(temp.getFullYear(),temp.getMonth(),temp.getDate(),currentValue.getHours(),currentValue.getMinutes(),currentValue.getSeconds(),currentValue.getMilliseconds()),prevent=!0):key==keys.PAGEUP?(prevent=!0,that.navigateToPast()):key==keys.PAGEDOWN&&(prevent=!0,that.navigateToFuture()),(value||method)&&(method||view.setDate(currentValue,value),that._focus(restrictValue(currentValue,options.min,options.max)))),prevent&&e.preventDefault(),that._current},_animate:function(options){var that=this,from=options.from,to=options.to,active=that._active;from?from.parent().data("animating")?(from.parent().kendoStop(!0,!0).remove(),from.remove(),to.insertAfter(that.element[0].firstChild),that._focusView(active)):from.is(":visible")&&that.options.animation!==!1?that[options.vertical?"_vertical":"_horizontal"](from,to,options.future):(to.insertAfter(from),from.remove(),that._focusView(active)):(to.insertAfter(that.element[0].firstChild),that._bindTable(to))},_horizontal:function(from,to,future){
var that=this,active=that._active,horizontal=that.options.animation.horizontal,effects=horizontal.effects,viewWidth=from.outerWidth();effects&&effects.indexOf(SLIDE)!=-1&&(from.add(to).css({width:viewWidth}),from.wrap("<div/>"),that._focusView(active,from),from.parent().css({position:"relative",width:2*viewWidth,"float":LEFT,"margin-left":future?0:-viewWidth}),to[future?"insertAfter":"insertBefore"](from),extend(horizontal,{effects:SLIDE+":"+(future?"right":LEFT),complete:function(){from.remove(),to.unwrap(),that._focusView(active),that._oldTable=undefined}}),from.parent().kendoStop(!0,!0).kendoAnimate(horizontal))},_vertical:function(from,to){var cell,position,that=this,vertical=that.options.animation.vertical,effects=vertical.effects,active=that._active;effects&&effects.indexOf("zoom")!=-1&&(to.css({position:"absolute",top:from.prev().outerHeight(),left:0}).insertBefore(from),transitionOrigin&&(cell=that._cellByDate(that._view.toDateString(that._current)),position=cell.position(),position=position.left+parseInt(cell.width()/2,10)+"px "+(position.top+parseInt(cell.height()/2,10)+"px"),to.css(transitionOrigin,position)),from.kendoStop(!0,!0).kendoAnimate({effects:"fadeOut",duration:600,complete:function(){from.remove(),to.css({position:"static",top:0,left:0}),that._focusView(active),that._oldTable=undefined}}),to.kendoStop(!0,!0).kendoAnimate(vertical))},_cellByDate:function(value){return this._table.find("td:not(."+OTHERMONTH+")").filter(function(){return $(this.firstChild).attr(kendo.attr(VALUE))===value})},_class:function(className,value){var that=this,id=that._cellID,cell=that._cell;cell&&cell.removeAttr(ARIA_SELECTED).removeAttr("aria-label").removeAttr(ID),cell=that._table.find("td:not(."+OTHERMONTH+")").removeClass(className).filter(function(){return $(this.firstChild).attr(kendo.attr(VALUE))===value}).attr(ARIA_SELECTED,!0),className!==FOCUSED||that._active||that.options.focusOnNav===!1||(className=""),cell.addClass(className),cell[0]&&(that._cell=cell),id&&(cell.attr(ID,id),that._table.removeAttr("aria-activedescendant").attr("aria-activedescendant",id))},_bindTable:function(table){table.on(FOCUS_WITH_NS,this._addClassProxy).on(BLUR,this._removeClassProxy)},_click:function(link){var that=this,options=that.options,currentValue=new Date((+that._current)),value=link.attr(kendo.attr(VALUE)).split("/");value=new DATE(value[0],value[1],value[2]),adjustDST(value,0),that._view.setDate(currentValue,value),that.navigateDown(restrictValue(currentValue,options.min,options.max))},_focus:function(value){var that=this,view=that._view;0!==view.compare(value,that._current)?that.navigate(value):(that._current=value,that._class(FOCUSED,view.toDateString(value)))},_focusView:function(active,table){active&&this.focus(table)},_footer:function(template){var that=this,today=getToday(),element=that.element,footer=element.find(".k-footer");return template?(footer[0]||(footer=$('<div class="k-footer"><a href="#" class="k-link k-nav-today"></a></div>').appendTo(element)),that._today=footer.show().find(".k-link").html(template(today)).attr("title",kendo.toString(today,"D",that.options.culture)),void that._toggle()):(that._toggle(!1),void footer.hide())},_header:function(){var links,that=this,element=that.element;element.find(".k-header")[0]||element.html('<div class="k-header"><a href="#" role="button" class="k-link k-nav-prev"><span class="k-icon k-i-arrow-w"></span></a><a href="#" role="button" aria-live="assertive" aria-atomic="true" class="k-link k-nav-fast"></a><a href="#" role="button" class="k-link k-nav-next"><span class="k-icon k-i-arrow-e"></span></a></div>'),links=element.find(".k-link").on(MOUSEENTER_WITH_NS+" "+MOUSELEAVE+" "+FOCUS_WITH_NS+" "+BLUR,mousetoggle).click(!1),that._title=links.eq(1).on(CLICK,function(){that._active=that.options.focusOnNav!==!1,that.navigateUp()}),that[PREVARROW]=links.eq(0).on(CLICK,function(){that._active=that.options.focusOnNav!==!1,that.navigateToPast()}),that[NEXTARROW]=links.eq(2).on(CLICK,function(){that._active=that.options.focusOnNav!==!1,that.navigateToFuture()})},_navigate:function(arrow,modifier){var that=this,index=that._index+1,currentValue=new DATE((+that._current));arrow=that[arrow],arrow.hasClass(DISABLED)||(index>3?currentValue.setFullYear(currentValue.getFullYear()+100*modifier):calendar.views[index].setDate(currentValue,modifier),that.navigate(currentValue))},_option:function(option,value){var isBigger,that=this,options=that.options,currentValue=that._value||that._current;return value===undefined?options[option]:(value=parse(value,options.format,options.culture),void(value&&(options[option]=new DATE((+value)),isBigger=option===MIN?value>currentValue:currentValue>value,(isBigger||isEqualMonth(currentValue,value))&&(isBigger&&(that._value=null),that._changeView=!0),that._changeView||(that._changeView=!(!options.month.content&&!options.month.empty)),that.navigate(that._value),that._toggle())))},_toggle:function(toggle){var that=this,options=that.options,link=that._today;toggle===undefined&&(toggle=isInRange(getToday(),options.min,options.max)),link&&(link.off(CLICK),toggle?link.addClass(TODAY).removeClass(DISABLED).on(CLICK,proxy(that._todayClick,that)):link.removeClass(TODAY).addClass(DISABLED).on(CLICK,prevent))},_todayClick:function(e){var that=this,depth=views[that.options.depth],today=getToday();e.preventDefault(),0===that._view.compare(that._current,today)&&that._index==depth&&(that._changeView=!1),that._value=today,that.navigate(today,depth),that.trigger(CHANGE)},_templates:function(){var that=this,options=that.options,footer=options.footer,month=options.month,content=month.content,empty=month.empty;that.month={content:template('<td#=data.cssClass# role="gridcell"><a tabindex="-1" class="k-link#=data.linkClass#" href="#=data.url#" '+kendo.attr("value")+'="#=data.dateString#" title="#=data.title#">'+(content||"#=data.value#")+"</a></td>",{useWithBlock:!!content}),empty:template('<td role="gridcell">'+(empty||"&nbsp;")+"</td>",{useWithBlock:!!empty})},that.footer=footer!==!1?template(footer||'#= kendo.toString(data,"D","'+options.culture+'") #',{useWithBlock:!1}):null}});ui.plugin(Calendar);var calendar={firstDayOfMonth:function(date){return new DATE(date.getFullYear(),date.getMonth(),1)},firstVisibleDay:function(date,calendarInfo){calendarInfo=calendarInfo||kendo.culture().calendar;for(var firstDay=calendarInfo.firstDay,firstVisibleDay=new DATE(date.getFullYear(),date.getMonth(),0,date.getHours(),date.getMinutes(),date.getSeconds(),date.getMilliseconds());firstVisibleDay.getDay()!=firstDay;)calendar.setTime(firstVisibleDay,-1*MS_PER_DAY);return firstVisibleDay},setTime:function(date,time){var tzOffsetBefore=date.getTimezoneOffset(),resultDATE=new DATE(date.getTime()+time),tzOffsetDiff=resultDATE.getTimezoneOffset()-tzOffsetBefore;date.setTime(resultDATE.getTime()+tzOffsetDiff*MS_PER_MINUTE)},views:[{name:MONTH,title:function(date,min,max,culture){return getCalendarInfo(culture).months.names[date.getMonth()]+" "+date.getFullYear()},content:function(options){for(var that=this,idx=0,min=options.min,max=options.max,date=options.date,dates=options.dates,format=options.format,culture=options.culture,navigateUrl=options.url,hasUrl=navigateUrl&&dates[0],currentCalendar=getCalendarInfo(culture),firstDayIdx=currentCalendar.firstDay,days=currentCalendar.days,names=shiftArray(days.names,firstDayIdx),shortNames=shiftArray(days.namesShort,firstDayIdx),start=calendar.firstVisibleDay(date,currentCalendar),firstDayOfMonth=that.first(date),lastDayOfMonth=that.last(date),toDateString=that.toDateString,today=new DATE,html='<table tabindex="0" role="grid" class="k-content" cellspacing="0"><thead><tr role="row">';idx<7;idx++)html+='<th scope="col" title="'+names[idx]+'">'+shortNames[idx]+"</th>";return today=new DATE(today.getFullYear(),today.getMonth(),today.getDate()),adjustDST(today,0),today=+today,view({cells:42,perRow:7,html:html+='</tr></thead><tbody><tr role="row">',start:new DATE(start.getFullYear(),start.getMonth(),start.getDate()),min:new DATE(min.getFullYear(),min.getMonth(),min.getDate()),max:new DATE(max.getFullYear(),max.getMonth(),max.getDate()),content:options.content,empty:options.empty,setter:that.setDate,build:function(date){var cssClass=[],day=date.getDay(),linkClass="",url="#";return(date<firstDayOfMonth||date>lastDayOfMonth)&&cssClass.push(OTHERMONTH),+date===today&&cssClass.push("k-today"),0!==day&&6!==day||cssClass.push("k-weekend"),hasUrl&&inArray(+date,dates)&&(url=navigateUrl.replace("{0}",kendo.toString(date,format,culture)),linkClass=" k-action-link"),{date:date,dates:dates,ns:kendo.ns,title:kendo.toString(date,"D",culture),value:date.getDate(),dateString:toDateString(date),cssClass:cssClass[0]?' class="'+cssClass.join(" ")+'"':"",linkClass:linkClass,url:url}}})},first:function(date){return calendar.firstDayOfMonth(date)},last:function(date){var last=new DATE(date.getFullYear(),date.getMonth()+1,0),first=calendar.firstDayOfMonth(date),timeOffset=Math.abs(last.getTimezoneOffset()-first.getTimezoneOffset());return timeOffset&&last.setHours(first.getHours()+timeOffset/60),last},compare:function(date1,date2){var result,month1=date1.getMonth(),year1=date1.getFullYear(),month2=date2.getMonth(),year2=date2.getFullYear();return result=year1>year2?1:year1<year2?-1:month1==month2?0:month1>month2?1:-1},setDate:function(date,value){var hours=date.getHours();value instanceof DATE?date.setFullYear(value.getFullYear(),value.getMonth(),value.getDate()):calendar.setTime(date,value*MS_PER_DAY),adjustDST(date,hours)},toDateString:function(date){return date.getFullYear()+"/"+date.getMonth()+"/"+date.getDate()}},{name:"year",title:function(date){return date.getFullYear()},content:function(options){var namesAbbr=getCalendarInfo(options.culture).months.namesAbbr,toDateString=this.toDateString,min=options.min,max=options.max;return view({min:new DATE(min.getFullYear(),min.getMonth(),1),max:new DATE(max.getFullYear(),max.getMonth(),1),start:new DATE(options.date.getFullYear(),0,1),setter:this.setDate,build:function(date){return{value:namesAbbr[date.getMonth()],ns:kendo.ns,dateString:toDateString(date),cssClass:""}}})},first:function(date){return new DATE(date.getFullYear(),0,date.getDate())},last:function(date){return new DATE(date.getFullYear(),11,date.getDate())},compare:function(date1,date2){return compare(date1,date2)},setDate:function(date,value){var month,hours=date.getHours();value instanceof DATE?(month=value.getMonth(),date.setFullYear(value.getFullYear(),month,date.getDate()),month!==date.getMonth()&&date.setDate(0)):(month=date.getMonth()+value,date.setMonth(month),month>11&&(month-=12),month>0&&date.getMonth()!=month&&date.setDate(0)),adjustDST(date,hours)},toDateString:function(date){return date.getFullYear()+"/"+date.getMonth()+"/1"}},{name:"decade",title:function(date,min,max){return title(date,min,max,10)},content:function(options){var year=options.date.getFullYear(),toDateString=this.toDateString;return view({start:new DATE(year-year%10-1,0,1),min:new DATE(options.min.getFullYear(),0,1),max:new DATE(options.max.getFullYear(),0,1),setter:this.setDate,build:function(date,idx){return{value:date.getFullYear(),ns:kendo.ns,dateString:toDateString(date),cssClass:0===idx||11==idx?OTHERMONTHCLASS:""}}})},first:function(date){var year=date.getFullYear();return new DATE(year-year%10,date.getMonth(),date.getDate())},last:function(date){var year=date.getFullYear();return new DATE(year-year%10+9,date.getMonth(),date.getDate())},compare:function(date1,date2){return compare(date1,date2,10)},setDate:function(date,value){setDate(date,value,1)},toDateString:function(date){return date.getFullYear()+"/0/1"}},{name:CENTURY,title:function(date,min,max){return title(date,min,max,100)},content:function(options){var year=options.date.getFullYear(),min=options.min.getFullYear(),max=options.max.getFullYear(),toDateString=this.toDateString,minYear=min,maxYear=max;return minYear-=minYear%10,maxYear-=maxYear%10,maxYear-minYear<10&&(maxYear=minYear+9),view({start:new DATE(year-year%100-10,0,1),min:new DATE(minYear,0,1),max:new DATE(maxYear,0,1),setter:this.setDate,build:function(date,idx){var start=date.getFullYear(),end=start+9;return start<min&&(start=min),end>max&&(end=max),{ns:kendo.ns,value:start+" - "+end,dateString:toDateString(date),cssClass:0===idx||11==idx?OTHERMONTHCLASS:""}}})},first:function(date){var year=date.getFullYear();return new DATE(year-year%100,date.getMonth(),date.getDate())},last:function(date){var year=date.getFullYear();return new DATE(year-year%100+99,date.getMonth(),date.getDate())},compare:function(date1,date2){return compare(date1,date2,100)},setDate:function(date,value){setDate(date,value,10)},toDateString:function(date){var year=date.getFullYear();return year-year%10+"/0/1"}}]};calendar.isEqualDatePart=isEqualDatePart,calendar.makeUnselectable=makeUnselectable,calendar.restrictValue=restrictValue,calendar.isInRange=isInRange,calendar.normalize=normalize,calendar.viewsEnum=views,kendo.calendar=calendar}(window.kendo.jQuery),function($,undefined){function normalize(options){var parseFormats=options.parseFormats,format=options.format;calendar.normalize(options),parseFormats=$.isArray(parseFormats)?parseFormats:[parseFormats],$.inArray(format,parseFormats)===-1&&parseFormats.splice(0,0,options.format),options.parseFormats=parseFormats}function preventDefault(e){e.preventDefault()}var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget,parse=kendo.parseDate,keys=kendo.keys,template=kendo.template,activeElement=kendo._activeElement,DIV="<div />",SPAN="<span />",ns=".kendoDatePicker",CLICK="click"+ns,OPEN="open",CLOSE="close",CHANGE="change",DISABLED="disabled",READONLY="readonly",DEFAULT="k-state-default",FOCUSED="k-state-focused",SELECTED="k-state-selected",STATEDISABLED="k-state-disabled",HOVER="k-state-hover",HOVEREVENTS="mouseenter"+ns+" mouseleave"+ns,MOUSEDOWN="mousedown"+ns,ID="id",MIN="min",MAX="max",MONTH="month",ARIA_DISABLED="aria-disabled",ARIA_EXPANDED="aria-expanded",ARIA_HIDDEN="aria-hidden",ARIA_READONLY="aria-readonly",calendar=kendo.calendar,isInRange=calendar.isInRange,restrictValue=calendar.restrictValue,isEqualDatePart=calendar.isEqualDatePart,extend=$.extend,proxy=$.proxy,DATE=Date,DateView=function(options){var id,that=this,body=document.body,div=$(DIV).attr(ARIA_HIDDEN,"true").addClass("k-calendar-container").appendTo(body);that.options=options=options||{},id=options.id,id&&(id+="_dateview",div.attr(ID,id),that._dateViewID=id),that.popup=new ui.Popup(div,extend(options.popup,options,{name:"Popup",isRtl:kendo.support.isRtl(options.anchor)})),that.div=div,that.value(options.value)};DateView.prototype={_calendar:function(){var div,that=this,calendar=that.calendar,options=that.options;calendar||(div=$(DIV).attr(ID,kendo.guid()).appendTo(that.popup.element).on(MOUSEDOWN,preventDefault).on(CLICK,"td:has(.k-link)",proxy(that._click,that)),that.calendar=calendar=new ui.Calendar(div),that._setOptions(options),kendo.calendar.makeUnselectable(calendar.element),calendar.navigate(that._value||that._current,options.start),that.value(that._value))},_setOptions:function(options){this.calendar.setOptions({focusOnNav:!1,change:options.change,culture:options.culture,dates:options.dates,depth:options.depth,footer:options.footer,format:options.format,max:options.max,min:options.min,month:options.month,start:options.start})},setOptions:function(options){var old=this.options;this.options=extend(old,options,{change:old.change,close:old.close,open:old.open}),this.calendar&&this._setOptions(this.options)},destroy:function(){this.popup.destroy()},open:function(){var that=this;that._calendar(),that.popup.open()},close:function(){this.popup.close()},min:function(value){this._option(MIN,value)},max:function(value){this._option(MAX,value)},toggle:function(){var that=this;that[that.popup.visible()?CLOSE:OPEN]()},move:function(e){var that=this,key=e.keyCode,calendar=that.calendar,selectIsClicked=e.ctrlKey&&key==keys.DOWN||key==keys.ENTER;if(key==keys.ESC)return void that.close();if(e.altKey)return void(key==keys.DOWN?(that.open(),e.preventDefault()):key==keys.UP&&(that.close(),e.preventDefault()));if(that.popup.visible())return selectIsClicked&&calendar._cell.hasClass(SELECTED)?(that.close(),void e.preventDefault()):void(that._current=calendar._move(e))},current:function(date){this._current=date,this.calendar._focus(date)},value:function(value){var that=this,calendar=that.calendar,options=that.options;that._value=value,that._current=new DATE((+restrictValue(value,options.min,options.max))),calendar&&calendar.value(value)},_click:function(e){e.currentTarget.className.indexOf(SELECTED)!==-1&&this.close()},_option:function(option,value){var that=this,calendar=that.calendar;that.options[option]=value,calendar&&calendar[option](value)}},DateView.normalize=normalize,kendo.DateView=DateView;var DatePicker=Widget.extend({init:function(element,options){var disabled,div,that=this;Widget.fn.init.call(that,element,options),element=that.element,options=that.options,options.min=parse(element.attr("min"))||parse(options.min),options.max=parse(element.attr("max"))||parse(options.max),normalize(options),that._wrapper(),that.dateView=new DateView(extend({},options,{id:element.attr(ID),anchor:that.wrapper,change:function(){that._change(this.value()),that.close()},close:function(e){that.trigger(CLOSE)?e.preventDefault():(element.attr(ARIA_EXPANDED,!1),div.attr(ARIA_HIDDEN,!0))},open:function(e){var date,options=that.options;that.trigger(OPEN)?e.preventDefault():(that.element.val()!==that._oldText&&(date=parse(element.val(),options.parseFormats,options.culture),that.dateView[date?"current":"value"](date)),element.attr(ARIA_EXPANDED,!0),div.attr(ARIA_HIDDEN,!1),that._updateARIA(date))}})),div=that.dateView.div,that._icon();try{element[0].setAttribute("type","text")}catch(e){element[0].type="text"}element.addClass("k-input").attr({role:"combobox","aria-expanded":!1,"aria-owns":that.dateView._dateViewID}),that._reset(),that._template(),disabled=element.is("[disabled]"),disabled?that.enable(!1):that.readonly(element.is("[readonly]")),that._old=that._update(options.value||that.element.val()),that._oldText=element.val(),kendo.notify(that)},events:[OPEN,CLOSE,CHANGE],options:{name:"DatePicker",value:null,footer:"",format:"",culture:"",parseFormats:[],min:new Date(1900,0,1),max:new Date(2099,11,31),start:MONTH,depth:MONTH,animation:{},month:{},dates:[],ARIATemplate:'Current focused date is #=kendo.toString(data.current, "D")#'},setOptions:function(options){var that=this,value=that._value;Widget.fn.setOptions.call(that,options),options=that.options,options.min=parse(options.min),options.max=parse(options.max),normalize(options),that.dateView.setOptions(options),value&&(that.element.val(kendo.toString(value,options.format,options.culture)),that._updateARIA(value))},_editable:function(options){var that=this,icon=that._dateIcon.off(ns),element=that.element.off(ns),wrapper=that._inputWrapper.off(ns),readonly=options.readonly,disable=options.disable;readonly||disable?(wrapper.addClass(disable?STATEDISABLED:DEFAULT).removeClass(disable?DEFAULT:STATEDISABLED),element.attr(DISABLED,disable).attr(READONLY,readonly).attr(ARIA_DISABLED,disable).attr(ARIA_READONLY,readonly)):(wrapper.addClass(DEFAULT).removeClass(STATEDISABLED).on(HOVEREVENTS,that._toggleHover),element.removeAttr(DISABLED).removeAttr(READONLY).attr(ARIA_DISABLED,!1).attr(ARIA_READONLY,!1).on("keydown"+ns,proxy(that._keydown,that)).on("blur"+ns,proxy(that._blur,that)).on("focus"+ns,function(){that._inputWrapper.addClass(FOCUSED)}),icon.on(CLICK,proxy(that._click,that)).on(MOUSEDOWN,preventDefault))},readonly:function(readonly){this._editable({readonly:readonly===undefined||readonly,disable:!1})},enable:function(enable){this._editable({readonly:!1,disable:!(enable=enable===undefined||enable)})},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.dateView.destroy(),that.element.off(ns),that._dateIcon.off(ns),that._inputWrapper.off(ns),that._form&&that._form.off("reset",that._resetHandler)},open:function(){this.dateView.open()},close:function(){this.dateView.close()},min:function(value){return this._option(MIN,value)},max:function(value){return this._option(MAX,value)},value:function(value){var that=this;return value===undefined?that._value:(that._old=that._update(value),null===that._old&&that.element.val(""),void(that._oldText=that.element.val()))},_toggleHover:function(e){$(e.currentTarget).toggleClass(HOVER,"mouseenter"===e.type)},_blur:function(){var that=this,value=that.element.val();that.close(),value!==that._oldText&&that._change(value),that._inputWrapper.removeClass(FOCUSED)},_click:function(){var that=this,element=that.element;that.dateView.toggle(),kendo.support.touch||element[0]===activeElement()||element.focus()},_change:function(value){var that=this;value=that._update(value),+that._old!=+value&&(that._old=value,that._oldText=that.element.val(),that.trigger(CHANGE),that.element.trigger(CHANGE))},_keydown:function(e){var that=this,dateView=that.dateView,value=that.element.val();dateView.popup.visible()||e.keyCode!=keys.ENTER||value===that._oldText?(dateView.move(e),that._updateARIA(dateView._current)):that._change(value)},_icon:function(){var icon,that=this,element=that.element;icon=element.next("span.k-select"),icon[0]||(icon=$('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span></span>').insertAfter(element)),that._dateIcon=icon.attr({role:"button","aria-controls":that.dateView._dateViewID})},_option:function(option,value){var that=this,options=that.options;return value===undefined?options[option]:(value=parse(value,options.parseFormats,options.culture),void(value&&(options[option]=new DATE((+value)),that.dateView[option](value))))},_update:function(value){var formattedValue,that=this,options=that.options,min=options.min,max=options.max,current=that._value,date=parse(value,options.parseFormats,options.culture),isSameType=null===date&&null===current||date instanceof Date&&current instanceof Date;return+date===+current&&isSameType?(formattedValue=kendo.toString(date,options.format,options.culture),formattedValue!==value&&that.element.val(null===date?value:formattedValue),date):(null!==date&&isEqualDatePart(date,min)?date=restrictValue(date,min,max):isInRange(date,min,max)||(date=null),that._value=date,that.dateView.value(date),that.element.val(date?kendo.toString(date,options.format,options.culture):value),that._updateARIA(date),date)},_wrapper:function(){var wrapper,that=this,element=that.element;wrapper=element.parents(".k-datepicker"),wrapper[0]||(wrapper=element.wrap(SPAN).parent().addClass("k-picker-wrap k-state-default"),wrapper=wrapper.wrap(SPAN).parent()),wrapper[0].style.cssText=element[0].style.cssText,element.css({width:"100%",height:element[0].style.height}),that.wrapper=wrapper.addClass("k-widget k-datepicker k-header").addClass(element[0].className),that._inputWrapper=$(wrapper[0].firstChild)},_reset:function(){var that=this,element=that.element,formId=element.attr("form"),form=formId?$("#"+formId):element.closest("form");form[0]&&(that._resetHandler=function(){that.value(element[0].defaultValue)},that._form=form.on("reset",that._resetHandler))},_template:function(){this._ariaTemplate=template(this.options.ARIATemplate)},_updateARIA:function(date){var cell,that=this,calendar=that.dateView.calendar;that.element.removeAttr("aria-activedescendant"),calendar&&(cell=calendar._cell,cell.attr("aria-label",that._ariaTemplate({current:date||calendar.current()})),that.element.attr("aria-activedescendant",cell.attr("id")))}});ui.plugin(DatePicker)}(window.kendo.jQuery),function($,undefined){function indexOfWordAtCaret(caretIdx,text,separator){return separator?text.substring(0,caretIdx).split(separator).length-1:0}function wordAtCaret(caretIdx,text,separator){return text.split(separator)[indexOfWordAtCaret(caretIdx,text,separator)]}function replaceWordAtCaret(caretIdx,text,word,separator){var words=text.split(separator);return words.splice(indexOfWordAtCaret(caretIdx,text,separator),1,word),separator&&""!==words[words.length-1]&&words.push(""),words.join(separator)}var kendo=window.kendo,support=kendo.support,caret=kendo.caret,activeElement=kendo._activeElement,placeholderSupported=support.placeholder,ui=kendo.ui,List=ui.List,keys=kendo.keys,DataSource=kendo.data.DataSource,ARIA_DISABLED="aria-disabled",ARIA_READONLY="aria-readonly",DEFAULT="k-state-default",DISABLED="disabled",READONLY="readonly",FOCUSED="k-state-focused",SELECTED="k-state-selected",STATEDISABLED="k-state-disabled",HOVER="k-state-hover",ns=".kendoAutoComplete",HOVEREVENTS="mouseenter"+ns+" mouseleave"+ns,proxy=$.proxy,AutoComplete=List.extend({init:function(element,options){var wrapper,that=this;that.ns=ns,options=$.isArray(options)?{dataSource:options}:options,List.fn.init.call(that,element,options),element=that.element,options=that.options,options.placeholder=options.placeholder||element.attr("placeholder"),placeholderSupported&&element.attr("placeholder",options.placeholder),that._wrapper(),that._loader(),that._dataSource(),that._ignoreCase(),element[0].type="text",wrapper=that.wrapper,that._popup(),element.addClass("k-input").on("keydown"+ns,proxy(that._keydown,that)).on("paste"+ns,proxy(that._search,that)).on("focus"+ns,function(){that._prev=that._accessor(),that._placeholder(!1),wrapper.addClass(FOCUSED)}).on("blur"+ns,function(){that._change(),that._placeholder(),wrapper.removeClass(FOCUSED)}).attr({autocomplete:"off",role:"textbox","aria-haspopup":!0}),that._enable(),that._old=that._accessor(),element[0].id&&element.attr("aria-owns",that.ul[0].id),that._aria(),that._placeholder(),kendo.notify(that)},options:{name:"AutoComplete",enabled:!0,suggest:!1,template:"",dataTextField:"",minLength:1,delay:200,height:200,filter:"startswith",ignoreCase:!0,highlightFirst:!1,separator:null,placeholder:"",animation:{},value:null},_dataSource:function(){var that=this;that.dataSource&&that._refreshHandler?that._unbindDataSource():(that._refreshHandler=proxy(that.refresh,that),that._progressHandler=proxy(that._showBusy,that)),that.dataSource=DataSource.create(that.options.dataSource).bind("change",that._refreshHandler).bind("progress",that._progressHandler)},setDataSource:function(dataSource){this.options.dataSource=dataSource,this._dataSource()},events:["open","close","change","select","dataBinding","dataBound"],setOptions:function(options){List.fn.setOptions.call(this,options),this._template(),this._accessors(),this._aria()},_editable:function(options){var that=this,element=that.element,wrapper=that.wrapper.off(ns),readonly=options.readonly,disable=options.disable;readonly||disable?(wrapper.addClass(disable?STATEDISABLED:DEFAULT).removeClass(disable?DEFAULT:STATEDISABLED),element.attr(DISABLED,disable).attr(READONLY,readonly).attr(ARIA_DISABLED,disable).attr(ARIA_READONLY,readonly)):(wrapper.addClass(DEFAULT).removeClass(STATEDISABLED).on(HOVEREVENTS,that._toggleHover),element.removeAttr(DISABLED).removeAttr(READONLY).attr(ARIA_DISABLED,!1).attr(ARIA_READONLY,!1))},close:function(){var that=this,current=that._current;current&&current.removeClass(SELECTED),that.current(null),that.popup.close()},destroy:function(){var that=this;that.element.off(ns),that.wrapper.off(ns),List.fn.destroy.call(that)},refresh:function(){var action,that=this,ul=that.ul[0],popup=that.popup,options=that.options,data=that._data(),length=data.length;that.trigger("dataBinding"),ul.innerHTML=kendo.render(that.template,data),that._height(length),popup.visible()&&popup._position(),length&&(options.highlightFirst&&that.current($(ul.firstChild)),options.suggest&&that.suggest($(ul.firstChild))),that._open&&(that._open=!1,action=length?"open":"close",that._typing&&that.element[0]!==activeElement()&&(action="close"),popup[action](),that._typing=undefined),that._touchScroller&&that._touchScroller.reset(),that._makeUnselectable(),that._hideBusy(),that.trigger("dataBound")},select:function(li){this._select(li)},search:function(word){var length,that=this,options=that.options,ignoreCase=options.ignoreCase,separator=options.separator;word=word||that._accessor(),that._current=null,clearTimeout(that._typing),separator&&(word=wordAtCaret(caret(that.element)[0],word,separator)),length=word.length,length?length>=that.options.minLength&&(that._open=!0,that._filterSource({value:ignoreCase?word.toLowerCase():word,operator:options.filter,field:options.dataTextField,ignoreCase:ignoreCase})):that.popup.close()},suggest:function(word){var idx,that=this,key=that._last,value=that._accessor(),element=that.element[0],caretIdx=caret(element)[0],separator=that.options.separator,words=value.split(separator),wordIndex=indexOfWordAtCaret(caretIdx,value,separator),selectionEnd=caretIdx;return key==keys.BACKSPACE||key==keys.DELETE?void(that._last=undefined):(word=word||"","string"!=typeof word&&(idx=List.inArray(word[0],that.ul[0]),word=idx>-1?that._text(that._data()[idx]):""),caretIdx<=0&&(caretIdx=value.toLowerCase().indexOf(word.toLowerCase())+1),idx=value.substring(0,caretIdx).lastIndexOf(separator),idx=idx>-1?caretIdx-(idx+separator.length):caretIdx,value=words[wordIndex].substring(0,idx),word&&(idx=word.toLowerCase().indexOf(value.toLowerCase()),idx>-1&&(word=word.substring(idx+value.length),selectionEnd=caretIdx+word.length,value+=word),separator&&""!==words[words.length-1]&&words.push("")),words[wordIndex]=value,that._accessor(words.join(separator||"")),void(element===activeElement()&&caret(element,caretIdx,selectionEnd)))},value:function(value){return value===undefined?this._accessor():(this._accessor(value),void(this._old=value))},_accessor:function(value){var that=this,element=that.element[0];return value===undefined?(value=element.value,element.className.indexOf("k-readonly")>-1&&value===that.options.placeholder?"":value):(element.value=null===value?"":value,void that._placeholder())},_accept:function(li){var element=this.element;this._focus(li),caret(element,element.val().length)},_keydown:function(e){var that=this,ul=that.ul[0],key=e.keyCode,current=that._current,visible=that.popup.visible();that._last=key,key===keys.DOWN?(visible&&that._move(current?current.next():$(ul.firstChild)),e.preventDefault()):key===keys.UP?(visible&&that._move(current?current.prev():$(ul.lastChild)),e.preventDefault()):key===keys.ENTER||key===keys.TAB?(key===keys.ENTER&&that.popup.visible()&&e.preventDefault(),that._accept(current)):key===keys.ESC?(that.popup.visible()&&e.preventDefault(),that.close()):that._search()},_move:function(li){var that=this;li=li[0]?li:null,that.current(li),that.options.suggest&&that.suggest(li)},_hideBusy:function(){var that=this;clearTimeout(that._busy),that._loading.hide(),that.element.attr("aria-busy",!1),that._busy=null},_showBusy:function(){var that=this;that._busy||(that._busy=setTimeout(function(){that.element.attr("aria-busy",!0),that._loading.show()},100))},_placeholder:function(show){if(!placeholderSupported){var value,that=this,element=that.element,placeholder=that.options.placeholder;if(placeholder){if(value=element.val(),show===undefined&&(show=!value),show||(placeholder=value!==placeholder?value:""),value===that._old&&!show)return;element.toggleClass("k-readonly",show).val(placeholder),placeholder||element[0]!==document.activeElement||caret(element[0],0,0)}}},_search:function(){var that=this;clearTimeout(that._typing),that._typing=setTimeout(function(){that._prev!==that._accessor()&&(that._prev=that._accessor(),that.search())},that.options.delay)},_select:function(li){var text,idx,that=this,separator=that.options.separator,data=that._data();li=$(li),li[0]&&!li.hasClass(SELECTED)&&(idx=List.inArray(li[0],that.ul[0]),idx>-1&&(data=data[idx],text=that._text(data),separator&&(text=replaceWordAtCaret(caret(that.element)[0],that._accessor(),text,separator)),that._accessor(text),that._prev=that._accessor(),that.current(li.addClass(SELECTED))))},_loader:function(){this._loading=$('<span class="k-icon k-loading" style="display:none"></span>').insertAfter(this.element);
},_toggleHover:function(e){$(e.currentTarget).toggleClass(HOVER,"mouseenter"===e.type)},_wrapper:function(){var wrapper,that=this,element=that.element,DOMelement=element[0];wrapper=element.parent(),wrapper.is("span.k-widget")||(wrapper=element.wrap("<span />").parent()),wrapper.attr("tabindex",-1),wrapper.attr("role","presentation"),wrapper[0].style.cssText=DOMelement.style.cssText,element.css({width:"100%",height:DOMelement.style.height}),that._focused=that.element,that.wrapper=wrapper.addClass("k-widget k-autocomplete k-header").addClass(DOMelement.className)}});ui.plugin(AutoComplete)}(window.kendo.jQuery),function($,undefined){function assign(instance,fields,value){for(var field,idx=0,lastIndex=fields.length-1;idx<lastIndex;++idx)field=fields[idx],field in instance||(instance[field]={}),instance=instance[field];instance[fields[lastIndex]]=value}var kendo=window.kendo,ui=kendo.ui,Select=ui.Select,os=kendo.support.mobileOS,ns=".kendoDropDownList",DISABLED="disabled",READONLY="readonly",CHANGE="change",FOCUSED="k-state-focused",DEFAULT="k-state-default",STATEDISABLED="k-state-disabled",ARIA_DISABLED="aria-disabled",ARIA_READONLY="aria-readonly",SELECTED="k-state-selected",HOVEREVENTS="mouseenter"+ns+" mouseleave"+ns,TABINDEX="tabindex",proxy=$.proxy,DropDownList=Select.extend({init:function(element,options){var optionLabel,useOptionLabel,text,that=this,index=options&&options.index;that.ns=ns,options=$.isArray(options)?{dataSource:options}:options,Select.fn.init.call(that,element,options),that._focusHandler=function(){that.wrapper.focus()},options=that.options,element=that.element.on("focus"+ns,that._focusHandler),this._inputTemplate(),that._reset(),that._word="",that._wrapper(),that._tabindex(),that.wrapper.data(TABINDEX,that.wrapper.attr(TABINDEX)),that._aria(),that._span(),that._popup(),that._mobile(),that._dataSource(),that._ignoreCase(),that._enable(),that._oldIndex=that.selectedIndex=-1,that._cascade(),index!==undefined&&(options.index=index),options.autoBind?that.dataSource.fetch():that.selectedIndex===-1&&(text=options.text||"",text||(optionLabel=options.optionLabel,useOptionLabel=optionLabel&&0===options.index,that._isSelect?text=useOptionLabel?optionLabel:element.children(":selected").text():!element[0].value&&useOptionLabel&&(text=optionLabel)),that._textAccessor(text)),kendo.notify(that)},options:{name:"DropDownList",enabled:!0,autoBind:!0,index:0,text:null,value:null,template:"",valueTemplate:"",delay:500,height:200,dataTextField:"",dataValueField:"",optionLabel:"",cascadeFrom:"",cascadeFromField:"",ignoreCase:!0,animation:{}},events:["open","close",CHANGE,"select","dataBinding","dataBound","cascade"],setOptions:function(options){Select.fn.setOptions.call(this,options),this._template(),this._inputTemplate(),this._accessors(),this._aria()},destroy:function(){var that=this;that.wrapper.off(ns),that.element.off(ns),that._inputWrapper.off(ns),Select.fn.destroy.call(that)},open:function(){var that=this;that.ul[0].firstChild?(that.popup.open(),that._scroll(that._current)):(that._open=!0,that._request||that.dataSource.fetch())},toggle:function(toggle){this._toggle(toggle,!0)},refresh:function(){var selectedIndex,that=this,data=that._data(),length=data.length,optionLabel=that.options.optionLabel,element=that.element[0];that.trigger("dataBinding"),that._current&&that.current(null),that.ul[0].innerHTML=kendo.render(that.template,data),that._height(length),that.popup.visible()&&that.popup._position(),that._isSelect&&(selectedIndex=element.selectedIndex,optionLabel&&length&&(optionLabel='<option value="">'+that._optionLabelText(optionLabel)+"</option>"),that._options(data,optionLabel),element.selectedIndex=selectedIndex===-1?0:selectedIndex),that._open&&(that._open=!1,that.toggle(!!length)),that._hideBusy(),that._makeUnselectable(),that._fetch||(length?that._selectItem():that._textAccessor()!==optionLabel&&(that.element.val(""),that._textAccessor(""))),that._bound=!!length,that.trigger("dataBound")},search:function(word){if(word){var that=this,ignoreCase=that.options.ignoreCase;ignoreCase&&(word=word.toLowerCase()),that._select(function(dataItem){var text=that._text(dataItem);if(text!==undefined)return text+="",ignoreCase&&(text=text.toLowerCase()),0===text.indexOf(word)})}},text:function(text){var dataItem,loweredText,that=this,ignoreCase=that.options.ignoreCase;return text=null===text?"":text,text===undefined?that._textAccessor():("string"==typeof text&&(loweredText=ignoreCase?text.toLowerCase():text,dataItem=that._select(function(data){return data=that._text(data),ignoreCase&&(data=(data+"").toLowerCase()),data===loweredText}),dataItem&&(text=dataItem)),void that._textAccessor(text))},value:function(value){var idx,hasValue,that=this;return value===undefined?that._accessor():(null!==value&&(value=value.toString()),that._selectedValue=value,hasValue=value||that.options.optionLabel&&!that.element[0].disabled&&""===value,hasValue&&that._fetchItems(value)||(idx=that._index(value),that.select(idx>-1?idx:0)),void 0)},_editable:function(options){var that=this,element=that.element,disable=options.disable,readonly=options.readonly,wrapper=that.wrapper.off(ns),dropDownWrapper=that._inputWrapper.off(HOVEREVENTS),focusin=function(){dropDownWrapper.addClass(FOCUSED),that._blured=!1},focusout=function(){if(!that._blured){that._triggerCascade();var isIFrame=window.self!==window.top;kendo.support.mobileOS.ios&&isIFrame?that._change():that._blur(),dropDownWrapper.removeClass(FOCUSED),that._blured=!0,element.blur()}};readonly||disable?(disable?(wrapper.removeAttr(TABINDEX),dropDownWrapper.addClass(STATEDISABLED).removeClass(DEFAULT)):(dropDownWrapper.addClass(DEFAULT).removeClass(STATEDISABLED),wrapper.on("focusin"+ns,focusin).on("focusout"+ns,focusout)),element.attr(DISABLED,disable).attr(READONLY,readonly),wrapper.attr(ARIA_DISABLED,disable).attr(ARIA_READONLY,readonly)):(element.removeAttr(DISABLED).removeAttr(READONLY),dropDownWrapper.addClass(DEFAULT).removeClass(STATEDISABLED).on(HOVEREVENTS,that._toggleHover),wrapper.attr(TABINDEX,wrapper.data(TABINDEX)).attr(ARIA_DISABLED,!1).attr(ARIA_READONLY,!1).on("click"+ns,function(e){that._blured=!1,e.preventDefault(),that._toggle()}).on("keydown"+ns,proxy(that._keydown,that)).on("keypress"+ns,proxy(that._keypress,that)).on("focusin"+ns,focusin).on("focusout"+ns,focusout))},_accept:function(li){this._focus(li)},_optionLabelText:function(){var options=this.options,dataTextField=options.dataTextField,optionLabel=options.optionLabel;return optionLabel&&dataTextField&&"object"==typeof optionLabel?this._text(optionLabel):optionLabel},_data:function(){var that=this,options=that.options,optionLabel=options.optionLabel,textField=options.dataTextField,valueField=options.dataValueField,data=that.dataSource.view(),length=data.length,first=optionLabel,idx=0;if(optionLabel&&length){for("object"==typeof optionLabel?first=optionLabel:textField&&(first={},textField=textField.split("."),valueField=valueField.split("."),assign(first,valueField,""),assign(first,textField,optionLabel)),first=new kendo.data.ObservableArray([first]);idx<length;idx++)first.push(data[idx]);data=first}return data},_selectItem:function(){Select.fn._selectItem.call(this),this.current()||this.select(0)},_keydown:function(e){var that=this,key=e.keyCode,keys=kendo.keys,ul=that.ul[0];key===keys.LEFT?key=keys.UP:key===keys.RIGHT&&(key=keys.DOWN),e.keyCode=key,that._move(e),key===keys.HOME?(e.preventDefault(),that._select(ul.firstChild)):key===keys.END&&(e.preventDefault(),that._select(ul.lastChild))},_selectNext:function(word,index){for(var text,that=this,startIndex=index,data=that._data(),length=data.length,ignoreCase=that.options.ignoreCase,action=function(text,index){if(text+="",ignoreCase&&(text=text.toLowerCase()),0===text.indexOf(word))return that._select(index),that._triggerEvents(),!0};index<length;index++)if(text=that._text(data[index]),text&&action(text,index))return!0;if(startIndex>0&&startIndex<length)for(index=0;index<=startIndex;index++)if(text=that._text(data[index]),text&&action(text,index))return!0;return!1},_keypress:function(e){if(0!==e.which&&e.keyCode!==kendo.keys.ENTER){var that=this,character=String.fromCharCode(e.charCode||e.keyCode),index=that.selectedIndex,word=that._word;that.options.ignoreCase&&(character=character.toLowerCase())," "===character&&e.preventDefault(),that._last===character&&word.length<=1&&index>-1&&(word||(word=character),that._selectNext(word,index+1))||(that._word=word+character,that._last=character,that._search())}},_popup:function(){Select.fn._popup.call(this),this.popup.one("open",proxy(function(){var popup=this.popup;popup.wrapper=kendo.wrap(popup.element),popup.element.closest(".km-root")[0]&&(popup.wrapper.addClass("km-popup km-widget"),this.wrapper.addClass("km-widget"))},this))},_search:function(){var that=this,dataSource=that.dataSource,index=that.selectedIndex,word=that._word;return clearTimeout(that._typing),that._typing=setTimeout(function(){that._word=""},that.options.delay),index===-1&&(index=0),that.ul[0].firstChild?(that._selectNext(word,index),void that._triggerEvents()):void dataSource.one(CHANGE,function(){dataSource.data()[0]&&index>-1&&that._selectNext(word,index)}).fetch()},_select:function(li){var value,idx,that=this,current=that._current,data=null;return li=that._get(li),li&&li[0]&&!li.hasClass(SELECTED)&&(current&&current.removeClass(SELECTED),idx=ui.List.inArray(li[0],that.ul[0]),idx>-1&&(data=that._data()[idx],value=that._value(data),that.selectedIndex=idx,that._textAccessor(data),that._accessor(value!==undefined?value:that._text(data),idx),that._selectedValue=that._accessor(),that.current(li.addClass(SELECTED)),that._optionID&&that._current.attr("aria-selected",!0))),data},_triggerEvents:function(){this.popup.visible()||(this._triggerCascade(),this._change())},_mobile:function(){var that=this,popup=that.popup,root=popup.element.parents(".km-root").eq(0);root.length&&os&&(popup.options.animation.open.effects=os.android||os.meego?"fadeIn":os.ios||os.wp?"slideIn:up":popup.options.animation.open.effects)},_span:function(){var span,that=this,wrapper=that.wrapper,SELECTOR="span.k-input";span=wrapper.find(SELECTOR),span[0]||(wrapper.append('<span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input">&nbsp;</span><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(that.element),span=wrapper.find(SELECTOR)),that.span=span,that._inputWrapper=$(wrapper[0].firstChild),that._arrow=wrapper.find(".k-icon").mousedown(function(e){e.preventDefault()})},_wrapper:function(){var wrapper,that=this,element=that.element,DOMelement=element[0];wrapper=element.parent(),wrapper.is("span.k-widget")||(wrapper=element.wrap("<span />").parent(),wrapper[0].style.cssText=DOMelement.style.cssText),element.hide(),that._focused=that.wrapper=wrapper.addClass("k-widget k-dropdown k-header").addClass(DOMelement.className).css("display","").attr({unselectable:"on",role:"listbox","aria-haspopup":!0,"aria-expanded":!1})},_clearSelection:function(){var that=this,optionLabel=that.options.optionLabel;return that.options.value="",that._selectedValue="",that.dataSource.view()[0]&&(optionLabel||that._userTriggered)?void that.select(0):(that.selectedIndex=-1,that.element.val(""),void that._textAccessor(that.options.optionLabel))},_inputTemplate:function(){var that=this,template=that.options.valueTemplate;template=template?kendo.template(template):$.proxy(kendo.template("#:this._text(data)#",{useWithBlock:!1}),that),that.valueTemplate=template},_textAccessor:function(text){var dataItem=this.dataItem(),options=this.options,span=this.span;return text===undefined?span.text():($.isPlainObject(text)||text instanceof kendo.data.ObservableObject?dataItem=text:dataItem&&this._text(dataItem)===text||(options.dataTextField?(dataItem={},assign(dataItem,options.dataTextField.split("."),text),assign(dataItem,options.dataValueField.split("."),this._accessor())):dataItem=text),void span.html(this.valueTemplate(dataItem)))}});ui.plugin(DropDownList)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,ui=kendo.ui,List=ui.List,Select=ui.Select,caret=kendo.caret,support=kendo.support,placeholderSupported=support.placeholder,activeElement=kendo._activeElement,keys=kendo.keys,ns=".kendoComboBox",CLICK="click"+ns,MOUSEDOWN="mousedown"+ns,DISABLED="disabled",READONLY="readonly",CHANGE="change",DEFAULT="k-state-default",FOCUSED="k-state-focused",STATEDISABLED="k-state-disabled",ARIA_DISABLED="aria-disabled",ARIA_READONLY="aria-readonly",STATE_SELECTED="k-state-selected",STATE_FILTER="filter",STATE_ACCEPT="accept",STATE_REBIND="rebind",HOVEREVENTS="mouseenter"+ns+" mouseleave"+ns,NULL=null,proxy=$.proxy,ComboBox=Select.extend({init:function(element,options){var text,that=this;that.ns=ns,options=$.isArray(options)?{dataSource:options}:options,Select.fn.init.call(that,element,options),that._focusHandler=function(){that.input.focus()},options=that.options,element=that.element.on("focus"+ns,that._focusHandler),options.placeholder=options.placeholder||element.attr("placeholder"),that._reset(),that._wrapper(),that._input(),that._tabindex(that.input),that._popup(),that._dataSource(),that._ignoreCase(),that._enable(),that._oldIndex=that.selectedIndex=-1,that._cascade(),that._aria(),options.autoBind?that._filterSource():(text=options.text,!text&&that._isSelect&&(text=element.children(":selected").text()),text&&(that.input.val(text),that._prev=text)),text||that._placeholder(),kendo.notify(that)},options:{name:"ComboBox",enabled:!0,index:-1,text:null,value:null,autoBind:!0,delay:200,dataTextField:"",dataValueField:"",minLength:0,height:200,highlightFirst:!0,template:"",filter:"none",placeholder:"",suggest:!1,cascadeFrom:"",cascadeFromField:"",ignoreCase:!0,animation:{}},events:["open","close",CHANGE,"select","dataBinding","dataBound","cascade"],setOptions:function(options){Select.fn.setOptions.call(this,options),this._template(),this._accessors(),this._aria()},current:function(li){var that=this,current=that._current;return li===undefined?current:(current&&current.removeClass(STATE_SELECTED),void Select.fn.current.call(that,li))},destroy:function(){var that=this;that.input.off(ns),that.element.off(ns),that._inputWrapper.off(ns),Select.fn.destroy.call(that)},_editable:function(options){var that=this,disable=options.disable,readonly=options.readonly,wrapper=that._inputWrapper.off(ns),input=that.element.add(that.input.off(ns)),arrow=that._arrow.parent().off(CLICK+" "+MOUSEDOWN);readonly||disable?(wrapper.addClass(disable?STATEDISABLED:DEFAULT).removeClass(disable?DEFAULT:STATEDISABLED),input.attr(DISABLED,disable).attr(READONLY,readonly).attr(ARIA_DISABLED,disable).attr(ARIA_READONLY,readonly)):(wrapper.addClass(DEFAULT).removeClass(STATEDISABLED).on(HOVEREVENTS,that._toggleHover),input.removeAttr(DISABLED).removeAttr(READONLY).attr(ARIA_DISABLED,!1).attr(ARIA_READONLY,!1),arrow.on(CLICK,function(){that._toggle()}).on(MOUSEDOWN,function(e){e.preventDefault()}),that.input.on("keydown"+ns,proxy(that._keydown,that)).on("focus"+ns,function(){wrapper.addClass(FOCUSED),that._placeholder(!1)}).on("blur"+ns,function(){wrapper.removeClass(FOCUSED),clearTimeout(that._typing),that._typing=null,that.options.text!==that.input.val()&&that.text(that.text()),that._placeholder(),that._blur(),that.element.blur()}))},open:function(){var that=this,serverFiltering=that.dataSource.options.serverFiltering;that.popup.visible()||(!that.ul[0].firstChild||that._state===STATE_ACCEPT&&!serverFiltering?(that._open=!0,that._state=STATE_REBIND,that._filterSource()):(that.popup.open(),that._scroll(that._current)))},refresh:function(){var hasChild,custom,that=this,ul=that.ul[0],options=that.options,state=that._state,data=that._data(),length=data.length,keepState=!0;that.trigger("dataBinding"),ul.innerHTML=kendo.render(that.template,data),that._height(length),that.popup.visible()&&that.popup._position(),that._isSelect&&(hasChild=that.element[0].children[0],state===STATE_REBIND&&(that._state=""),custom=that._option,that._option=undefined,that._options(data),custom&&custom[0].selected?that._custom(custom.val(),keepState):that._bound||hasChild||that._custom("",keepState)),length&&(options.highlightFirst&&that.current($(ul.firstChild)),options.suggest&&that.input.val()&&that._request!==undefined&&that.suggest($(ul.firstChild))),state===STATE_FILTER||that._fetch||that._selectItem(),that._open&&(that._open=!1,that._typing&&that.input[0]!==activeElement()?that.popup.close():that.toggle(!!length),that._typing=null),that._touchScroller&&that._touchScroller.reset(),that._makeUnselectable(),that._hideBusy(),that._bound=!0,that.trigger("dataBound")},search:function(word){word="string"==typeof word?word:this.text();var that=this,length=word.length,options=that.options,ignoreCase=options.ignoreCase,filter=options.filter,field=options.dataTextField;clearTimeout(that._typing),length>=options.minLength&&(that._state=STATE_FILTER,"none"===filter?that._filter(word):(that._open=!0,that._filterSource({value:ignoreCase?word.toLowerCase():word,field:field,operator:filter,ignoreCase:ignoreCase})))},suggest:function(word){var idx,that=this,element=that.input[0],value=that.text(),caretIdx=caret(element)[0],key=that._last;return key==keys.BACKSPACE||key==keys.DELETE?void(that._last=undefined):(word=word||"","string"!=typeof word&&(idx=List.inArray(word[0],that.ul[0]),word=idx>-1?that._text(that.dataSource.view()[idx]):""),caretIdx<=0&&(caretIdx=value.toLowerCase().indexOf(word.toLowerCase())+1),word?(idx=word.toLowerCase().indexOf(value.toLowerCase()),idx>-1&&(value+=word.substring(idx+value.length))):value=value.substring(0,caretIdx),void(value.length===caretIdx&&word||(element.value=value,element===activeElement()&&caret(element,caretIdx,value.length))))},text:function(text){text=null===text?"":text;var dataItem,value,that=this,input=that.input[0],ignoreCase=that.options.ignoreCase,loweredText=text;return text===undefined?input.value:(dataItem=that.dataItem(),dataItem&&that._text(dataItem)===text&&(value=that._value(dataItem),null===value?value="":value+="",value===that._old)?void that._triggerCascade():(ignoreCase&&(loweredText=loweredText.toLowerCase()),that._select(function(data){return data=that._text(data),ignoreCase&&(data=(data+"").toLowerCase()),data===loweredText}),that.selectedIndex<0&&(that._custom(text),input.value=text),that._prev=input.value,void that._triggerCascade()))},toggle:function(toggle){this._toggle(toggle,!0)},value:function(value){var idx,that=this,options=that.options;return value===undefined?that._accessor():(null!==value&&(value=value.toString()),that._selectedValue=value,!that._open&&value&&that._fetchItems(value)||(idx=that._index(value),idx>-1?that.select(idx):(that.current(NULL),that._custom(value),options.value===value&&options.text===that.input.val()||(that.text(value),that._placeholder())),that._old=that._accessor(),that._oldIndex=that.selectedIndex),void 0)},_accept:function(li){var that=this;li?that._focus(li):(that.text(that.text()),that._change())},_custom:function(value,keepState){var that=this,element=that.element,custom=that._option;that._state!==STATE_FILTER||keepState||(that._state=STATE_ACCEPT),that._isSelect?(custom||(custom=that._option=$("<option/>"),element.append(custom)),custom.text(value),custom[0].selected=!0):element.val(value),that._selectedValue=value},_filter:function(word){var that=this,options=that.options,dataSource=that.dataSource,ignoreCase=options.ignoreCase,predicate=function(dataItem){var text=that._text(dataItem);if(text!==undefined)return text+="",(""===text||""!==word)&&(ignoreCase&&(text=text.toLowerCase()),0===text.indexOf(word))};return ignoreCase&&(word=word.toLowerCase()),that.ul[0].firstChild?(that._highlight(predicate)!==-1&&(options.suggest&&that._current&&that.suggest(that._current),that.open()),void that._hideBusy()):void dataSource.one(CHANGE,function(){dataSource.data()[0]&&that.search(word)}).fetch()},_highlight:function(li){var idx,that=this;return li===undefined||null===li?-1:(li=that._get(li),idx=List.inArray(li[0],that.ul[0]),idx==-1&&(that.options.highlightFirst&&!that.text()?(li=that.ul[0].firstChild,li&&(li=$(li))):li=NULL),that.current(li),idx)},_input:function(){var input,that=this,element=that.element.removeClass("k-input")[0],accessKey=element.accessKey,wrapper=that.wrapper,SELECTOR="input.k-input",name=element.name||"";name&&(name='name="'+name+'_input" '),input=wrapper.find(SELECTOR),input[0]||(wrapper.append('<span tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default"><input '+name+'class="k-input" type="text" autocomplete="off"/><span tabindex="-1" unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(that.element),input=wrapper.find(SELECTOR)),input[0].style.cssText=element.style.cssText,element.maxLength>-1&&(input[0].maxLength=element.maxLength),input.addClass(element.className).val(this.options.text||element.value).css({width:"100%",height:element.style.height}).attr({role:"combobox","aria-expanded":!1}).show(),placeholderSupported&&input.attr("placeholder",that.options.placeholder),accessKey&&(element.accessKey="",input[0].accessKey=accessKey),that._focused=that.input=input,that._inputWrapper=$(wrapper[0].firstChild),that._arrow=wrapper.find(".k-icon").attr({role:"button",tabIndex:-1}),element.id&&that._arrow.attr("aria-controls",that.ul[0].id)},_keydown:function(e){var that=this,key=e.keyCode;that._last=key,clearTimeout(that._typing),that._typing=null,key==keys.TAB||that._move(e)||that._search()},_placeholder:function(show){if(!placeholderSupported){var value,that=this,input=that.input,placeholder=that.options.placeholder;if(placeholder){if(value=that.value(),show===undefined&&(show=!value),input.toggleClass("k-readonly",show),!show){if(value)return;placeholder=""}input.val(placeholder),placeholder||input[0]!==activeElement()||caret(input[0],0,0)}}},_search:function(){var that=this;that._typing=setTimeout(function(){var value=that.text();that._prev!==value&&(that._prev=value,that.search(value)),that._typing=null},that.options.delay)},_select:function(li){var text,value,that=this,data=that._data(),idx=that._highlight(li);that.selectedIndex=idx,idx!==-1&&(that._state===STATE_FILTER&&(that._state=STATE_ACCEPT),that._current.addClass(STATE_SELECTED),data=data[idx],text=that._text(data),value=that._value(data),that._prev=that.input[0].value=text,that._accessor(value!==undefined?value:text,idx),that._selectedValue=that._accessor(),that._placeholder(),that._optionID&&that._current.attr("aria-selected",!0))},_wrapper:function(){var that=this,element=that.element,wrapper=element.parent();wrapper.is("span.k-widget")||(wrapper=element.hide().wrap("<span />").parent(),wrapper[0].style.cssText=element[0].style.cssText),that.wrapper=wrapper.addClass("k-widget k-combobox k-header").addClass(element[0].className).css("display","")},_clearSelection:function(parent,isFiltered){var that=this,hasValue=parent._selectedValue||parent.value(),custom=hasValue&&parent.selectedIndex===-1;(isFiltered||!hasValue||custom)&&(that.value(""),that.options.value="")}});ui.plugin(ComboBox)}(window.kendo.jQuery),function($,undefined){function compare(a,b){var length;if(null===a&&null!==b||null!==a&&null===b)return!1;if(length=a.length,length!==b.length)return!1;for(;length--;)if(a[length]!==b[length])return!1;return!0}function first(ul){var item=ul.firstChild;return item&&"none"===item.style.display&&(item=sibling(item,NEXT)),item?$(item):item}function last(ul){var item=ul.lastChild;return item&&"none"===item.style.display&&(item=sibling(item,PREV)),item?$(item):item}function sibling(item,direction){return item=item[direction],item&&"none"===item.style.display&&(item=sibling(item,direction)),item}var kendo=window.kendo,ui=kendo.ui,List=ui.List,keys=kendo.keys,activeElement=kendo._activeElement,ObservableArray=kendo.data.ObservableArray,proxy=$.proxy,ID="id",LI="li",ACCEPT="accept",FILTER="filter",OPEN="open",CLOSE="close",CHANGE="change",PROGRESS="progress",SELECT="select",NEXT="nextSibling",PREV="previousSibling",HIDE=' style="display:none"',ARIA_DISABLED="aria-disabled",ARIA_READONLY="aria-readonly",FOCUSEDCLASS="k-state-focused",HIDDENCLASS="k-loading-hidden",HOVERCLASS="k-state-hover",STATEDISABLED="k-state-disabled",DISABLED="disabled",READONLY="readonly",ns=".kendoMultiSelect",CLICK="click"+ns,KEYDOWN="keydown"+ns,MOUSEENTER="mouseenter"+ns,MOUSELEAVE="mouseleave"+ns,HOVEREVENTS=MOUSEENTER+" "+MOUSELEAVE,quotRegExp=/"/g,isArray=$.isArray,styles=["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","text-transform","line-height"],MultiSelect=List.extend({init:function(element,options){var id,data,that=this;that.ns=ns,List.fn.init.call(that,element,options),that._wrapper(),that._tagList(),that._input(),that._textContainer(),that._loader(),that._tabindex(that.input),element=that.element.attr("multiple","multiple").hide(),options=that.options,data=options.value,options.placeholder||(options.placeholder=element.data("placeholder")),id=element.attr(ID),id&&(that._tagID=id+"_tag_active",id+="_taglist",that.tagList.attr(ID,id)),that._aria(id),that._dataSource(),that._ignoreCase(),that._popup(),that._values=[],that._dataItems=[],that._reset(),that._enable(),that._placeholder(),options.autoBind?that.dataSource.fetch():data&&(isArray(data)||(data=[data]),!$.isPlainObject(data[0])&&options.dataValueField||(that._retrieveData=!0,that.dataSource.data(data),that.value(that._initialValues))),kendo.notify(that)},options:{name:"MultiSelect",enabled:!0,autoBind:!0,autoClose:!0,highlightFirst:!0,dataTextField:"",dataValueField:"",filter:"startswith",ignoreCase:!0,minLength:0,delay:100,value:null,maxSelectedItems:null,itemTemplate:"",tagTemplate:"",placeholder:"",height:200,animation:{}},events:[OPEN,CLOSE,CHANGE,SELECT,"dataBinding","dataBound"],setDataSource:function(dataSource){this.options.dataSource=dataSource,this._dataSource(),this.options.autoBind&&this.dataSource.fetch()},setOptions:function(options){List.fn.setOptions.call(this,options),this._template(),this._accessors(),this._aria(this.tagList.attr(ID))},current:function(candidate){return this.currentTag(null),List.fn.current.call(this,candidate)},currentTag:function(candidate){var that=this;return candidate===undefined?that._currentTag:(that._currentTag&&(that._currentTag.removeClass(FOCUSEDCLASS).removeAttr(ID),that.input.removeAttr("aria-activedescendant")),candidate&&(candidate.addClass(FOCUSEDCLASS).attr(ID,that._tagID),that.input.attr("aria-activedescendant",that._tagID)),that._currentTag=candidate,void 0)},dataItems:function(){return this._dataItems},destroy:function(){var that=this,ns=that.ns;that.wrapper.off(ns),that.tagList.off(ns),that.input.off(ns),List.fn.destroy.call(that)},_editable:function(options){var that=this,disable=options.disable,readonly=options.readonly,wrapper=that.wrapper.off(ns),tagList=that.tagList.off(ns),input=that.element.add(that.input.off(ns));readonly||disable?(disable?wrapper.addClass(STATEDISABLED):wrapper.removeClass(STATEDISABLED),input.attr(DISABLED,disable).attr(READONLY,readonly).attr(ARIA_DISABLED,disable).attr(ARIA_READONLY,readonly)):(wrapper.removeClass(STATEDISABLED).on(HOVEREVENTS,that._toggleHover).on("mousedown"+ns,function(e){var notInput="input"!==e.target.nodeName.toLowerCase();notInput&&e.preventDefault(),e.target.className.indexOf("k-delete")===-1&&(that.input[0]!==activeElement()&&notInput&&that.input.focus(),0===that.options.minLength&&that.open())}),that.input.on(KEYDOWN,proxy(that._keydown,that)).on("paste"+ns,proxy(that._search,that)).on("focus"+ns,function(){that._placeholder(!1),wrapper.addClass(FOCUSEDCLASS)}).on("blur"+ns,function(){clearTimeout(that._typing),wrapper.removeClass(FOCUSEDCLASS),that._placeholder(!that._dataItems[0],!0),that.close(),that._state===FILTER&&(that._state=ACCEPT),that.element.blur()}),input.removeAttr(DISABLED).removeAttr(READONLY).attr(ARIA_DISABLED,!1).attr(ARIA_READONLY,!1),tagList.on(MOUSEENTER,LI,function(){$(this).addClass(HOVERCLASS)}).on(MOUSELEAVE,LI,function(){$(this).removeClass(HOVERCLASS)}).on(CLICK,".k-delete",function(e){that._unselect($(e.target).closest(LI)),that._change(),that.close()}))},_close:function(){var that=this;that.options.autoClose||!that._visibleItems?that.close():(that.current(that.options.highlightFirst?first(that.ul[0]):null),that.popup._position())},close:function(){this.popup.close(),this.current(null)},open:function(){var that=this;that._request&&(that._retrieveData=!1),!that.ul[0].firstChild||that._state===ACCEPT||that._retrieveData?(that._state="",that._open=!0,that._retrieveData=!1,that._filterSource()):that._visibleItems&&that._allowSelection()&&(that.popup.open(),that.current(that.options.highlightFirst?first(that.ul[0]):null))},toggle:function(toggle){toggle=toggle!==undefined?toggle:!this.popup.visible(),this[toggle?OPEN:CLOSE]()},refresh:function(){var length,that=this,li=null;that.trigger("dataBinding"),length=that._render(that.dataSource.view()),that._height(length),that._setInitialValues&&(that._setInitialValues=!1,that.value(that._initialValues)),that._open&&(that._open=!1,that.toggle(length)),that.popup.visible()&&(that.popup._position(),that.options.highlightFirst&&(li=first(that.ul[0]))),that.current(li),that._touchScroller&&that._touchScroller.reset(),that._makeUnselectable(),that._hideBusy(),that.trigger("dataBound")},search:function(word){var that=this,options=that.options,ignoreCase=options.ignoreCase,filter=options.filter,field=options.dataTextField,inputValue=that.input.val();options.placeholder===inputValue&&(inputValue=""),clearTimeout(that._typing),word="string"==typeof word?word:inputValue,word.length>=options.minLength&&(that._state=FILTER,that._open=!0,that._filterSource({value:ignoreCase?word.toLowerCase():word,field:field,operator:filter,ignoreCase:ignoreCase}))},value:function(value){var dataItemIndex,that=this,tags=$(that.tagList[0].children),length=tags.length,idx=0;if(value===undefined)return that._values;if(!that._fetchItems(value)){for(;idx<length;idx++)that._unselect(tags.eq(idx));if(null!==value){for(value=isArray(value)||value instanceof ObservableArray?value:[value],idx=0,length=value.length;idx<length;idx++)dataItemIndex=that._index(value[idx]),dataItemIndex>-1&&that._select(dataItemIndex);that._old=that._values.slice()}}},_dataSource:function(){var that=this,element=that.element,options=that.options,dataSource=options.dataSource||{};dataSource=isArray(dataSource)?{data:dataSource}:dataSource,dataSource.select=element,dataSource.fields=[{field:options.dataTextField},{field:options.dataValueField}],that.dataSource&&that._refreshHandler?that._unbindDataSource():(that._refreshHandler=proxy(that.refresh,that),that._progressHandler=proxy(that._showBusy,that)),that.dataSource=kendo.data.DataSource.create(dataSource).bind(CHANGE,that._refreshHandler).bind(PROGRESS,that._progressHandler)},_fetchItems:function(value){var that=this,isEmptyArray=$.isArray(value)&&0===value.length;if(!isEmptyArray&&value)return that._fetch||that.ul[0].firstChild?void 0:(that.dataSource.one(CHANGE,function(){that.value(value),that._fetch=!1}),that._fetch=!0,that.dataSource.fetch(),!0)},_reset:function(){var that=this,element=that.element,formId=element.attr("form"),form=formId?$("#"+formId):element.closest("form");form[0]&&(that._resetHandler=function(){setTimeout(function(){that.value(that._initialValues)})},that._form=form.on("reset",that._resetHandler))},_initValue:function(){var that=this,value=that.options.value||that.element.val();null===value?value=[]:(isArray(value)||(value=[value]),value=that._mapValues(value)),that._old=that._initialValues=value,that._setInitialValues=value[0]!==undefined},_mapValues:function(values){var that=this;return values&&$.isPlainObject(values[0])&&(values=$.map(values,function(dataItem){return that._value(dataItem)})),values},_change:function(){
var that=this,value=that.value();compare(value,that._old)||(that._old=value.slice(),that.trigger(CHANGE),that.element.trigger(CHANGE))},_click:function(e){var that=this,li=$(e.currentTarget);if(!e.isDefaultPrevented()){if(that.trigger(SELECT,{item:li}))return void that._close();that._select(li),that._change(),that._close()}},_item:function(item,direction){return item=item[direction](),item[0]&&!item.is(":visible")&&(item=this._item(item,direction)),item},_keydown:function(e){var that=this,key=e.keyCode,tag=that._currentTag,current=that._current,hasValue=that.input.val(),isRtl=kendo.support.isRtl(that.wrapper),visible=that.popup.visible();if(key===keys.DOWN){if(e.preventDefault(),!visible)return void that.open();current=current?sibling(current[0],NEXT):first(that.ul[0]),current&&that.current($(current))}else if(key===keys.UP)visible&&(current=current?sibling(current[0],PREV):last(that.ul[0]),that.current($(current)),that._current[0]||that.close()),e.preventDefault();else if(key===keys.LEFT&&!isRtl||key===keys.RIGHT&&isRtl)hasValue||(tag=tag?tag.prev():$(that.tagList[0].lastChild),tag[0]&&that.currentTag(tag));else if(key===keys.RIGHT&&!isRtl||key===keys.LEFT&&isRtl)!hasValue&&tag&&(tag=tag.next(),that.currentTag(tag[0]?tag:null));else if(key===keys.ENTER&&visible){if(current){if(that.trigger(SELECT,{item:current}))return void that._close();that._select(current)}that._change(),that._close(),e.preventDefault()}else key===keys.ESC?(visible?e.preventDefault():that.currentTag(null),that.close()):key===keys.HOME?visible?that.current(first(that.ul[0])):hasValue||(tag=that.tagList[0].firstChild,tag&&that.currentTag($(tag))):key===keys.END?visible?that.current(last(that.ul[0])):hasValue||(tag=that.tagList[0].lastChild,tag&&that.currentTag($(tag))):key!==keys.DELETE&&key!==keys.BACKSPACE||hasValue?(clearTimeout(that._typing),setTimeout(function(){that._scale()}),that._search()):(key!==keys.BACKSPACE||tag||(tag=$(that.tagList[0].lastChild)),tag&&tag[0]&&(that._unselect(tag),that._change(),that._close()))},_hideBusy:function(){var that=this;clearTimeout(that._busy),that.input.attr("aria-busy",!1),that._loading.addClass(HIDDENCLASS),that._request=!1,that._busy=null},_showBusy:function(){var that=this;that._request=!0,that._busy||(that._busy=setTimeout(function(){that.input.attr("aria-busy",!0),that._loading.removeClass(HIDDENCLASS)},100))},_placeholder:function(show,skipCaret){var that=this,input=that.input,active=activeElement();show===undefined&&(show=!1,input[0]!==active&&(show=!that._dataItems[0])),that._prev="",input.toggleClass("k-readonly",show).val(show?that.options.placeholder:""),input[0]!==active||skipCaret||kendo.caret(input[0],0,0),that._scale()},_scale:function(){var textWidth,that=this,wrapper=that.wrapper,wrapperWidth=wrapper.width(),span=that._span.text(that.input.val());wrapper.is(":visible")?textWidth=span.width()+25:(span.appendTo(document.documentElement),wrapperWidth=textWidth=span.width()+25,span.appendTo(wrapper)),that.input.width(textWidth>wrapperWidth?wrapperWidth:textWidth)},_option:function(dataItem,selected){var option="<option",dataText=this._text(dataItem),dataValue=this._value(dataItem);return dataValue!==undefined&&(dataValue+="",dataValue.indexOf('"')!==-1&&(dataValue=dataValue.replace(quotRegExp,"&quot;")),option+=' value="'+dataValue+'"'),selected&&(option+=' selected="selected"'),option+=">",dataText!==undefined&&(option+=kendo.htmlEncode(dataText)),option+="</option>"},_render:function(data){for(var dataItem,selected,that=this,length=data.length,template=that.itemTemplate,values=that._dataItems.slice(0),visibleItems=0,idx=0,options="",html="";idx<length;idx++)dataItem=data[idx],selected=that._selected(values,dataItem),html+=template(dataItem,idx,selected),options+=that._option(dataItem,selected),selected||(visibleItems+=1);if(length=values.length)for(idx=0;idx<length;idx++)options+=that._option(values[idx],!0);return that.ul[0].innerHTML=html,that.element.html(options),that._visibleItems=visibleItems,visibleItems},_selected:function(values,dataItem){var dataValue,that=this,textAccessor=that._text,valueAccessor=that._value,value=valueAccessor(dataItem),length=values.length,selected=!1,idx=0;for(value===undefined&&(value=textAccessor(dataItem));idx<length;idx++)if(dataItem=values[idx],dataValue=valueAccessor(dataItem),dataValue===undefined&&(dataValue=textAccessor(dataItem)),dataValue!==undefined&&dataValue===value){selected=!0;break}return selected&&values.splice(idx,1),selected},_search:function(){var that=this;that._typing=setTimeout(function(){var value=that.input.val();that._prev!==value&&(that._prev=value,that.search(value))},that.options.delay)},_allowSelection:function(){var max=this.options.maxSelectedItems;return null===max||max>this._values.length},_select:function(li){var dataItem,idx,that=this,values=that._values;that._allowSelection()&&(isNaN(li)?idx=li.hide().data("idx"):(idx=li,that.ul[0].children[idx].style.display="none"),that.element[0].children[idx].selected=!0,dataItem=that.dataSource.view()[idx],that.tagList.append(that.tagTemplate(dataItem)),that._dataItems.push(dataItem),values.push(that._dataValue(dataItem)),that._visibleItems-=1,that.currentTag(null),that._placeholder(),that._height(that._visibleItems),that._state===FILTER&&(that._state=ACCEPT))},_unselect:function(tag){var dataItem,value,options,option,length,that=this,index=tag.index();if(tag.remove(),that.currentTag(null),that._values.splice(index,1),dataItem=that._dataItems.splice(index,1)[0],value=that._dataValue(dataItem),index=that._index(value),index!==-1)$(that.ul[0].children[index]).show(),that.element[0].children[index].selected=!1,that._visibleItems+=1,that._height(that._visibleItems);else for(index=that.dataSource.view().length,options=that.element[0].children,length=options.length;index<length;index++)if(option=options[index],option.value==value){option.selected=!1;break}that._placeholder()},_template:function(){var textTemplate,that=this,options=that.options,itemTemplate=options.itemTemplate,tagTemplate=options.tagTemplate,hasDataSource=options.dataSource;that.element[0].length&&!hasDataSource&&(options.dataTextField=options.dataTextField||"text",options.dataValueField=options.dataValueField||"value"),textTemplate=kendo.template("#:"+kendo.expr(options.dataTextField,"data")+"#",{useWithBlock:!1}),itemTemplate=itemTemplate?kendo.template(itemTemplate):textTemplate,tagTemplate=tagTemplate?kendo.template(tagTemplate):textTemplate,that.itemTemplate=function(data,idx,hide){return'<li tabindex="-1" role="option" data-idx="'+idx+'" unselectable="on" class="k-item"'+(hide?HIDE:"")+">"+itemTemplate(data)+"</li>"},that.tagTemplate=function(data){return'<li class="k-button" unselectable="on"><span unselectable="on">'+tagTemplate(data)+'</span><span unselectable="on" class="k-icon k-delete">delete</span></li>'}},_input:function(){var that=this,accessKey=that.element[0].accessKey,input=that._innerWrapper.children("input.k-input");input[0]||(input=$('<input class="k-input" style="width: 25px" />').appendTo(that._innerWrapper)),that.element.removeAttr("accesskey"),that._focused=that.input=input.attr({accesskey:accessKey,role:"listbox","aria-expanded":!1})},_tagList:function(){var that=this,tagList=that._innerWrapper.children("ul");tagList[0]||(tagList=$('<ul role="listbox" unselectable="on" class="k-reset"/>').appendTo(that._innerWrapper)),that.tagList=tagList},_loader:function(){this._loading=$('<span class="k-icon k-loading '+HIDDENCLASS+'"></span>').insertAfter(this.input)},_textContainer:function(){var computedStyles=kendo.getComputedStyles(this.input[0],styles);computedStyles.position="absolute",computedStyles.visibility="hidden",computedStyles.top=-3333,computedStyles.left=-3333,this._span=$("<span/>").css(computedStyles).appendTo(this.wrapper)},_wrapper:function(){var that=this,element=that.element,wrapper=element.parent("span.k-multiselect");wrapper[0]||(wrapper=element.wrap('<div class="k-widget k-multiselect k-header" unselectable="on" />').parent(),wrapper[0].style.cssText=element[0].style.cssText,$('<div class="k-multiselect-wrap k-floatwrap" unselectable="on" />').insertBefore(element)),that.wrapper=wrapper.addClass(element[0].className).css("display",""),that._innerWrapper=$(wrapper[0].firstChild)}});ui.plugin(MultiSelect)}(window.kendo.jQuery),function($,undefined){function createWrapper(options,element,isHorizontal){var orientationCssClass=isHorizontal?" k-slider-horizontal":" k-slider-vertical",style=options.style?options.style:element.attr("style"),cssClasses=element.attr("class")?" "+element.attr("class"):"",tickPlacementCssClass="";return"bottomRight"==options.tickPlacement?tickPlacementCssClass=" k-slider-bottomright":"topLeft"==options.tickPlacement&&(tickPlacementCssClass=" k-slider-topleft"),style=style?" style='"+style+"'":"","<div class='k-widget k-slider"+orientationCssClass+cssClasses+"'"+style+"><div class='k-slider-wrap"+(options.showButtons?" k-slider-buttons":"")+tickPlacementCssClass+"'></div></div>"}function createButton(options,type,isHorizontal){var buttonCssClass="";return buttonCssClass="increase"==type?isHorizontal?"k-i-arrow-e":"k-i-arrow-n":isHorizontal?"k-i-arrow-w":"k-i-arrow-s","<a class='k-button k-button-"+type+"'><span class='k-icon "+buttonCssClass+"' title='"+options[type+"ButtonTitle"]+"'>"+options[type+"ButtonTitle"]+"</span></a>"}function createSliderItems(options,distance){var i,result="<ul class='k-reset k-slider-items'>",count=math.floor(round(distance/options.smallStep))+1;for(i=0;i<count;i++)result+="<li class='k-tick' role='presentation'>&nbsp;</li>";return result+="</ul>"}function createTrack(options,element){var dragHandleCount=element.is("input")?1:2,firstDragHandleTitle=2==dragHandleCount?options.leftDragHandleTitle:options.dragHandleTitle;return"<div class='k-slider-track'><div class='k-slider-selection'><!-- --></div><a href='#' class='k-draghandle' title='"+firstDragHandleTitle+"' role='slider' aria-valuemin='"+options.min+"' aria-valuemax='"+options.max+"' aria-valuenow='"+(dragHandleCount>1?options.selectionStart||options.min:options.value||options.min)+"'>Drag</a>"+(dragHandleCount>1?"<a href='#' class='k-draghandle' title='"+options.rightDragHandleTitle+"'role='slider' aria-valuemin='"+options.min+"' aria-valuemax='"+options.max+"' aria-valuenow='"+(options.selectionEnd||options.max)+"'>Drag</a>":"")+"</div>"}function step(stepValue){return function(value){return value+stepValue}}function setValue(value){return function(){return value}}function formatValue(value){return(value+"").replace(".",kendo.cultures.current.numberFormat["."])}function round(value){value=parseFloat(value,10);var power=math.pow(10,PRECISION||0);return math.round(value*power)/power}function parseAttr(element,name){var value=parse(element.getAttribute(name));return null===value&&(value=undefined),value}function defined(value){return typeof value!==UNDEFINED}var kendo=window.kendo,Widget=kendo.ui.Widget,Draggable=kendo.ui.Draggable,extend=$.extend,format=kendo.format,parse=kendo.parseFloat,proxy=$.proxy,isArray=$.isArray,math=Math,support=kendo.support,pointers=support.pointers,msPointers=support.msPointers,CHANGE="change",SLIDE="slide",NS=".slider",MOUSE_DOWN="touchstart"+NS+" mousedown"+NS,TRACK_MOUSE_DOWN=pointers?"pointerdown"+NS:msPointers?"MSPointerDown"+NS:MOUSE_DOWN,MOUSE_UP="touchend"+NS+" mouseup"+NS,TRACK_MOUSE_UP=pointers?"pointerup":msPointers?"MSPointerUp"+NS:MOUSE_UP,MOVE_SELECTION="moveSelection",KEY_DOWN="keydown"+NS,CLICK="click"+NS,MOUSE_OVER="mouseover"+NS,FOCUS="focus"+NS,BLUR="blur"+NS,DRAG_HANDLE=".k-draghandle",TRACK_SELECTOR=".k-slider-track",TICK_SELECTOR=".k-tick",STATE_SELECTED="k-state-selected",STATE_FOCUSED="k-state-focused",STATE_DEFAULT="k-state-default",STATE_DISABLED="k-state-disabled",PRECISION=3,DISABLED="disabled",UNDEFINED="undefined",TABINDEX="tabindex",getTouches=kendo.getTouches,SliderBase=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),options=that.options,that._distance=options.max-options.min,that._isHorizontal="horizontal"==options.orientation,that._isRtl=that._isHorizontal&&kendo.support.isRtl(element),that._position=that._isHorizontal?"left":"bottom",that._sizeFn=that._isHorizontal?"width":"height",that._outerSize=that._isHorizontal?"outerWidth":"outerHeight",options.tooltip.format=options.tooltip.enabled?options.tooltip.format||"{0}":"{0}",that._createHtml(),that.wrapper=that.element.closest(".k-slider"),that._trackDiv=that.wrapper.find(TRACK_SELECTOR),that._setTrackDivWidth(),that._maxSelection=that._trackDiv[that._sizeFn](),that._sliderItemsInit(),that._tabindex(that.wrapper.find(DRAG_HANDLE)),that[options.enabled?"enable":"disable"]();var rtlDirectionSign=kendo.support.isRtl(that.wrapper)?-1:1;that._keyMap={37:step(-1*rtlDirectionSign*options.smallStep),40:step(-options.smallStep),39:step(1*rtlDirectionSign*options.smallStep),38:step(+options.smallStep),35:setValue(options.max),36:setValue(options.min),33:step(+options.largeStep),34:step(-options.largeStep)},kendo.notify(that)},events:[CHANGE,SLIDE],options:{enabled:!0,min:0,max:10,smallStep:1,largeStep:5,orientation:"horizontal",tickPlacement:"both",tooltip:{enabled:!0,format:"{0}"}},_resize:function(){this._setTrackDivWidth(),this.wrapper.find(".k-slider-items").remove(),this._maxSelection=this._trackDiv[this._sizeFn](),this._sliderItemsInit(),this._refresh()},_sliderItemsInit:function(){var that=this,options=that.options,sizeBetweenTicks=that._maxSelection/((options.max-options.min)/options.smallStep),pixelWidths=that._calculateItemsWidth(math.floor(that._distance/options.smallStep));"none"!=options.tickPlacement&&sizeBetweenTicks>=2&&(that._trackDiv.before(createSliderItems(options,that._distance)),that._setItemsWidth(pixelWidths),that._setItemsTitle()),that._calculateSteps(pixelWidths),"none"!=options.tickPlacement&&sizeBetweenTicks>=2&&options.largeStep>=options.smallStep&&that._setItemsLargeTick()},getSize:function(){return kendo.dimensions(this.wrapper)},_setTrackDivWidth:function(){var that=this,trackDivPosition=2*parseFloat(that._trackDiv.css(that._isRtl?"right":that._position),10);that._trackDiv[that._sizeFn](that.wrapper[that._sizeFn]()-2-trackDivPosition)},_setItemsWidth:function(pixelWidths){var i,that=this,options=that.options,first=0,last=pixelWidths.length-1,items=that.wrapper.find(TICK_SELECTOR),paddingTop=0,bordersWidth=2,count=items.length,selection=0;for(i=0;i<count-2;i++)$(items[i+1])[that._sizeFn](pixelWidths[i]);if(that._isHorizontal?($(items[first]).addClass("k-first")[that._sizeFn](pixelWidths[last-1]),$(items[last]).addClass("k-last")[that._sizeFn](pixelWidths[last])):($(items[last]).addClass("k-first")[that._sizeFn](pixelWidths[last]),$(items[first]).addClass("k-last")[that._sizeFn](pixelWidths[last-1])),that._distance%options.smallStep!==0&&!that._isHorizontal){for(i=0;i<pixelWidths.length;i++)selection+=pixelWidths[i];paddingTop=that._maxSelection-selection,paddingTop+=parseFloat(that._trackDiv.css(that._position),10)+bordersWidth,that.wrapper.find(".k-slider-items").css("padding-top",paddingTop)}},_setItemsTitle:function(){for(var that=this,options=that.options,items=that.wrapper.find(TICK_SELECTOR),titleNumber=options.min,count=items.length,i=that._isHorizontal&&!that._isRtl?0:count-1,limit=that._isHorizontal&&!that._isRtl?count:-1,increment=that._isHorizontal&&!that._isRtl?1:-1;i-limit!==0;i+=increment)$(items[i]).attr("title",format(options.tooltip.format,round(titleNumber))),titleNumber+=options.smallStep},_setItemsLargeTick:function(){var item,value,that=this,options=that.options,items=that.wrapper.find(TICK_SELECTOR),i=0;if(1e3*options.largeStep%(1e3*options.smallStep)===0||that._distance/options.largeStep>=3)for(that._isHorizontal||that._isRtl||(items=$.makeArray(items).reverse()),i=0;i<items.length;i++)item=$(items[i]),value=that._values[i],value%options.smallStep===0&&value%options.largeStep===0&&(item.addClass("k-tick-large").html("<span class='k-label'>"+item.attr("title")+"</span>"),0!==i&&i!==items.length-1&&item.css("line-height",item[that._sizeFn]()+"px"))},_calculateItemsWidth:function(itemsCount){var itemWidth,pixelWidths,i,that=this,options=that.options,trackDivSize=parseFloat(that._trackDiv.css(that._sizeFn))+1,pixelStep=trackDivSize/that._distance;for(that._distance/options.smallStep-math.floor(that._distance/options.smallStep)>0&&(trackDivSize-=that._distance%options.smallStep*pixelStep),itemWidth=trackDivSize/itemsCount,pixelWidths=[],i=0;i<itemsCount-1;i++)pixelWidths[i]=itemWidth;return pixelWidths[itemsCount-1]=pixelWidths[itemsCount]=itemWidth/2,that._roundWidths(pixelWidths)},_roundWidths:function(pixelWidthsArray){var i,balance=0,count=pixelWidthsArray.length;for(i=0;i<count;i++)balance+=pixelWidthsArray[i]-math.floor(pixelWidthsArray[i]),pixelWidthsArray[i]=math.floor(pixelWidthsArray[i]);return balance=math.round(balance),this._addAdditionalSize(balance,pixelWidthsArray)},_addAdditionalSize:function(additionalSize,pixelWidthsArray){if(0===additionalSize)return pixelWidthsArray;var i,step=parseFloat(pixelWidthsArray.length-1)/parseFloat(1==additionalSize?additionalSize:additionalSize-1);for(i=0;i<additionalSize;i++)pixelWidthsArray[parseInt(math.round(step*i),10)]+=1;return pixelWidthsArray},_calculateSteps:function(pixelWidths){var lastItem,that=this,options=that.options,val=options.min,selection=0,itemsCount=math.ceil(that._distance/options.smallStep),i=1;if(itemsCount+=that._distance/options.smallStep%1===0?1:0,pixelWidths.splice(0,0,2*pixelWidths[itemsCount-2]),pixelWidths.splice(itemsCount-1,1,2*pixelWidths.pop()),that._pixelSteps=[selection],that._values=[val],0!==itemsCount){for(;i<itemsCount;)selection+=(pixelWidths[i-1]+pixelWidths[i])/2,that._pixelSteps[i]=selection,that._values[i]=val+=options.smallStep,i++;lastItem=that._distance%options.smallStep===0?itemsCount-1:itemsCount,that._pixelSteps[lastItem]=that._maxSelection,that._values[lastItem]=options.max,that._isRtl&&(that._pixelSteps.reverse(),that._values.reverse())}},_getValueFromPosition:function(mousePosition,dragableArea){var i,that=this,options=that.options,step=math.max(options.smallStep*(that._maxSelection/that._distance),0),position=0,halfStep=step/2;if(that._isHorizontal?(position=mousePosition-dragableArea.startPoint,that._isRtl&&(position=that._maxSelection-position)):position=dragableArea.startPoint-mousePosition,that._maxSelection-(parseInt(that._maxSelection%step,10)-3)/2<position)return options.max;for(i=0;i<that._pixelSteps.length;i++)if(math.abs(that._pixelSteps[i]-position)-1<=halfStep)return round(that._values[i])},_getFormattedValue:function(val,drag){var tooltipTemplate,selectionStart,selectionEnd,that=this,html="",tooltip=that.options.tooltip;return isArray(val)?(selectionStart=val[0],selectionEnd=val[1]):drag&&drag.type&&(selectionStart=drag.selectionStart,selectionEnd=drag.selectionEnd),drag&&(tooltipTemplate=drag.tooltipTemplate),!tooltipTemplate&&tooltip.template&&(tooltipTemplate=kendo.template(tooltip.template)),isArray(val)||drag&&drag.type?tooltipTemplate?html=tooltipTemplate({selectionStart:selectionStart,selectionEnd:selectionEnd}):(selectionStart=format(tooltip.format,selectionStart),selectionEnd=format(tooltip.format,selectionEnd),html=selectionStart+" - "+selectionEnd):(drag&&(drag.val=val),html=tooltipTemplate?tooltipTemplate({value:val}):format(tooltip.format,val)),html},_getDraggableArea:function(){var that=this,offset=kendo.getOffset(that._trackDiv);return{startPoint:that._isHorizontal?offset.left:offset.top+that._maxSelection,endPoint:that._isHorizontal?offset.left+that._maxSelection:offset.top}},_createHtml:function(){var that=this,element=that.element,options=that.options,inputs=element.find("input");2==inputs.length?(inputs.eq(0).val(options.selectionStart),inputs.eq(1).val(options.selectionEnd)):element.val(options.value),element.wrap(createWrapper(options,element,that._isHorizontal)).hide(),options.showButtons&&element.before(createButton(options,"increase",that._isHorizontal)).before(createButton(options,"decrease",that._isHorizontal)),element.before(createTrack(options,element))},_focus:function(e){var that=this,target=e.target,val=that.value(),drag=that._drag;drag||(target==that.wrapper.find(DRAG_HANDLE).eq(0)[0]?(drag=that._firstHandleDrag,that._activeHandle=0):(drag=that._lastHandleDrag,that._activeHandle=1),val=val[that._activeHandle]),$(target).addClass(STATE_FOCUSED+" "+STATE_SELECTED),drag&&(that._activeHandleDrag=drag,drag.selectionStart=that.options.selectionStart,drag.selectionEnd=that.options.selectionEnd,drag._updateTooltip(val))},_focusWithMouse:function(target){target=$(target);var that=this,idx=target.is(DRAG_HANDLE)?target.index():0;window.setTimeout(function(){that.wrapper.find(DRAG_HANDLE)[2==idx?1:0].focus()},1),that._setTooltipTimeout()},_blur:function(e){var that=this,drag=that._activeHandleDrag;$(e.target).removeClass(STATE_FOCUSED+" "+STATE_SELECTED),drag&&(drag._removeTooltip(),delete that._activeHandleDrag,delete that._activeHandle)},_setTooltipTimeout:function(){var that=this;that._tooltipTimeout=window.setTimeout(function(){var drag=that._drag||that._activeHandleDrag;drag&&drag._removeTooltip()},300)},_clearTooltipTimeout:function(){var that=this;window.clearTimeout(this._tooltipTimeout);var drag=that._drag||that._activeHandleDrag;drag&&drag.tooltipDiv&&drag.tooltipDiv.stop(!0,!1).css("opacity",1)}}),Slider=SliderBase.extend({init:function(element,options){var dragHandle,that=this;element.type="text",options=extend({},{value:parseAttr(element,"value"),min:parseAttr(element,"min"),max:parseAttr(element,"max"),smallStep:parseAttr(element,"step")},options),element=$(element),options&&options.enabled===undefined&&(options.enabled=!element.is("[disabled]")),SliderBase.fn.init.call(that,element,options),options=that.options,defined(options.value)&&null!==options.value||(options.value=options.min,element.val(options.min)),options.value=math.max(math.min(options.value,options.max),options.min),dragHandle=that.wrapper.find(DRAG_HANDLE),new Slider.Selection(dragHandle,that,options),that._drag=new Slider.Drag(dragHandle,"",that,options)},options:{name:"Slider",showButtons:!0,increaseButtonTitle:"Increase",decreaseButtonTitle:"Decrease",dragHandleTitle:"drag",tooltip:{format:"{0:#,#.##}"},value:null},enable:function(enable){var clickHandler,move,that=this,options=that.options;if(that.disable(),enable!==!1){if(that.wrapper.removeClass(STATE_DISABLED).addClass(STATE_DEFAULT),that.wrapper.find("input").removeAttr(DISABLED),clickHandler=function(e){var touch=getTouches(e)[0];if(touch){var mousePosition=that._isHorizontal?touch.location.pageX:touch.location.pageY,dragableArea=that._getDraggableArea(),target=$(e.target);if(target.hasClass("k-draghandle"))return void target.addClass(STATE_FOCUSED+" "+STATE_SELECTED);that._update(that._getValueFromPosition(mousePosition,dragableArea)),that._focusWithMouse(e.target),that._drag.dragstart(e),e.preventDefault()}},that.wrapper.find(TICK_SELECTOR+", "+TRACK_SELECTOR).on(TRACK_MOUSE_DOWN,clickHandler).end().on(TRACK_MOUSE_DOWN,function(){$(document.documentElement).one("selectstart",kendo.preventDefault)}).on(TRACK_MOUSE_UP,function(){that._drag._end()}),that.wrapper.find(DRAG_HANDLE).attr(TABINDEX,0).on(MOUSE_UP,function(){that._setTooltipTimeout()}).on(CLICK,function(e){that._focusWithMouse(e.target),e.preventDefault()}).on(FOCUS,proxy(that._focus,that)).on(BLUR,proxy(that._blur,that)),move=proxy(function(sign){var newVal=that._nextValueByIndex(that._valueIndex+1*sign);that._setValueInRange(newVal),that._drag._updateTooltip(newVal)},that),options.showButtons){var mouseDownHandler=proxy(function(e,sign){this._clearTooltipTimeout(),(1===e.which||support.touch&&0===e.which)&&(move(sign),this.timeout=setTimeout(proxy(function(){this.timer=setInterval(function(){move(sign)},60)},this),200))},that);that.wrapper.find(".k-button").on(MOUSE_UP,proxy(function(e){this._clearTimer(),that._focusWithMouse(e.target)},that)).on(MOUSE_OVER,function(e){$(e.currentTarget).addClass("k-state-hover")}).on("mouseout"+NS,proxy(function(e){$(e.currentTarget).removeClass("k-state-hover"),this._clearTimer()},that)).eq(0).on(MOUSE_DOWN,proxy(function(e){mouseDownHandler(e,1)},that)).click(!1).end().eq(1).on(MOUSE_DOWN,proxy(function(e){mouseDownHandler(e,-1)},that)).click(kendo.preventDefault)}that.wrapper.find(DRAG_HANDLE).off(KEY_DOWN,!1).on(KEY_DOWN,proxy(this._keydown,that)),options.enabled=!0}},disable:function(){var that=this;that.wrapper.removeClass(STATE_DEFAULT).addClass(STATE_DISABLED),$(that.element).prop(DISABLED,DISABLED),that.wrapper.find(".k-button").off(MOUSE_DOWN).on(MOUSE_DOWN,kendo.preventDefault).off(MOUSE_UP).on(MOUSE_UP,kendo.preventDefault).off("mouseleave"+NS).on("mouseleave"+NS,kendo.preventDefault).off(MOUSE_OVER).on(MOUSE_OVER,kendo.preventDefault),that.wrapper.find(TICK_SELECTOR+", "+TRACK_SELECTOR).off(TRACK_MOUSE_DOWN).off(TRACK_MOUSE_UP),that.wrapper.find(DRAG_HANDLE).attr(TABINDEX,-1).off(MOUSE_UP).off(KEY_DOWN).off(CLICK).off(FOCUS).off(BLUR),that.options.enabled=!1},_update:function(val){var that=this,change=that.value()!=val;that.value(val),change&&that.trigger(CHANGE,{value:that.options.value})},value:function(value){var that=this,options=that.options;return value=round(value),isNaN(value)?options.value:void(value>=options.min&&value<=options.max&&options.value!=value&&(that.element.prop("value",formatValue(value)),options.value=value,that._refreshAriaAttr(value),that._refresh()))},_refresh:function(){this.trigger(MOVE_SELECTION,{value:this.options.value})},_refreshAriaAttr:function(value){var formattedValue,that=this,drag=that._drag;formattedValue=drag&&drag._tooltipDiv?drag._tooltipDiv.text():that._getFormattedValue(value,null),this.wrapper.find(DRAG_HANDLE).attr("aria-valuenow",value).attr("aria-valuetext",formattedValue)},_clearTimer:function(){clearTimeout(this.timeout),clearInterval(this.timer)},_keydown:function(e){var that=this;e.keyCode in that._keyMap&&(that._clearTooltipTimeout(),that._setValueInRange(that._keyMap[e.keyCode](that.options.value)),that._drag._updateTooltip(that.value()),e.preventDefault())},_setValueInRange:function(val){var that=this,options=that.options;return val=round(val),isNaN(val)?void that._update(options.min):(val=math.max(math.min(val,options.max),options.min),void that._update(val))},_nextValueByIndex:function(index){var count=this._values.length;return this._isRtl&&(index=count-1-index),this._values[math.max(0,math.min(index,count-1))]},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.wrapper.off(NS).find(".k-button").off(NS).end().find(DRAG_HANDLE).off(NS).end().find(TICK_SELECTOR+", "+TRACK_SELECTOR).off(NS).end(),that._drag.draggable.destroy(),that._drag._removeTooltip(!0)}});Slider.Selection=function(dragHandle,that,options){function moveSelection(val){var selectionValue=val-options.min,index=that._valueIndex=math.ceil(round(selectionValue/options.smallStep)),selection=parseInt(that._pixelSteps[index],10),selectionDiv=that._trackDiv.find(".k-slider-selection"),halfDragHanndle=parseInt(dragHandle[that._outerSize]()/2,10),rtlCorrection=that._isRtl?2:0;selectionDiv[that._sizeFn](that._isRtl?that._maxSelection-selection:selection),dragHandle.css(that._position,selection-halfDragHanndle-rtlCorrection)}moveSelection(options.value),that.bind([CHANGE,SLIDE,MOVE_SELECTION],function(e){moveSelection(parseFloat(e.value,10))})},Slider.Drag=function(element,type,owner,options){var that=this;that.owner=owner,that.options=options,that.element=element,that.type=type,that.draggable=new Draggable(element,{distance:0,dragstart:proxy(that._dragstart,that),drag:proxy(that.drag,that),dragend:proxy(that.dragend,that),dragcancel:proxy(that.dragcancel,that)}),element.click(!1)},Slider.Drag.prototype={dragstart:function(e){this.owner._activeDragHandle=this,this.draggable.userEvents.cancel(),this.draggable.userEvents._start(e)},_dragstart:function(e){var that=this,owner=that.owner,options=that.options;return options.enabled?(this.owner._activeDragHandle=this,owner.element.off(MOUSE_OVER),that.element.addClass(STATE_FOCUSED+" "+STATE_SELECTED),$(document.documentElement).css("cursor","pointer"),that.dragableArea=owner._getDraggableArea(),that.step=math.max(options.smallStep*(owner._maxSelection/owner._distance),0),that.type?(that.selectionStart=options.selectionStart,that.selectionEnd=options.selectionEnd,owner._setZIndex(that.type)):that.oldVal=that.val=options.value,that._removeTooltip(!0),void that._createTooltip()):void e.preventDefault()},_createTooltip:function(){var tooltipTemplate,colloutCssClass,that=this,owner=that.owner,tooltip=that.options.tooltip,html="",wnd=$(window);tooltip.enabled&&(tooltip.template&&(tooltipTemplate=that.tooltipTemplate=kendo.template(tooltip.template)),$(".k-slider-tooltip").remove(),that.tooltipDiv=$("<div class='k-widget k-tooltip k-slider-tooltip'><!-- --></div>").appendTo(document.body),html=owner._getFormattedValue(that.val||owner.value(),that),that.type||(colloutCssClass="k-callout-"+(owner._isHorizontal?"s":"e"),that.tooltipInnerDiv="<div class='k-callout "+colloutCssClass+"'><!-- --></div>",html+=that.tooltipInnerDiv),that.tooltipDiv.html(html),that._scrollOffset={top:wnd.scrollTop(),left:wnd.scrollLeft()},that.moveTooltip())},drag:function(e){var slideParams,that=this,owner=that.owner,x=e.x.location,y=e.y.location,startPoint=that.dragableArea.startPoint,endPoint=that.dragableArea.endPoint;e.preventDefault(),owner._isHorizontal?owner._isRtl?that.val=that.constrainValue(x,startPoint,endPoint,x<endPoint):that.val=that.constrainValue(x,startPoint,endPoint,x>=endPoint):that.val=that.constrainValue(y,endPoint,startPoint,y<=endPoint),that.oldVal!=that.val&&(that.oldVal=that.val,that.type?("firstHandle"==that.type?that.val<that.selectionEnd?that.selectionStart=that.val:that.selectionStart=that.selectionEnd=that.val:that.val>that.selectionStart?that.selectionEnd=that.val:that.selectionStart=that.selectionEnd=that.val,slideParams={values:[that.selectionStart,that.selectionEnd],value:[that.selectionStart,that.selectionEnd]}):slideParams={value:that.val},owner.trigger(SLIDE,slideParams)),that._updateTooltip(that.val)},_updateTooltip:function(val){var that=this,options=that.options,tooltip=options.tooltip,html="";tooltip.enabled&&(that.tooltipDiv||that._createTooltip(),html=that.owner._getFormattedValue(round(val),that),that.type||(html+=that.tooltipInnerDiv),that.tooltipDiv.html(html),that.moveTooltip())},dragcancel:function(){return this.owner._refresh(),$(document.documentElement).css("cursor",""),this._end()},dragend:function(){var that=this,owner=that.owner;return $(document.documentElement).css("cursor",""),that.type?owner._update(that.selectionStart,that.selectionEnd):(owner._update(that.val),that.draggable.userEvents._disposeAll()),that._end()},_end:function(){var that=this,owner=that.owner;return owner._focusWithMouse(that.element),owner.element.on(MOUSE_OVER),!1},_removeTooltip:function(noAnimation){var that=this,owner=that.owner;that.tooltipDiv&&owner.options.tooltip.enabled&&owner.options.enabled&&(noAnimation?(that.tooltipDiv.remove(),that.tooltipDiv=null):that.tooltipDiv.fadeOut("slow",function(){$(this).remove(),that.tooltipDiv=null}))},moveTooltip:function(){var dragHandles,sdhOffset,diff,anchorSize,that=this,owner=that.owner,top=0,left=0,element=that.element,offset=kendo.getOffset(element),margin=8,viewport=$(window),callout=that.tooltipDiv.find(".k-callout"),width=that.tooltipDiv.outerWidth(),height=that.tooltipDiv.outerHeight();that.type?(dragHandles=owner.wrapper.find(DRAG_HANDLE),offset=kendo.getOffset(dragHandles.eq(0)),sdhOffset=kendo.getOffset(dragHandles.eq(1)),owner._isHorizontal?(top=sdhOffset.top,left=offset.left+(sdhOffset.left-offset.left)/2):(top=offset.top+(sdhOffset.top-offset.top)/2,left=sdhOffset.left),anchorSize=dragHandles.eq(0).outerWidth()+2*margin):(top=offset.top,left=offset.left,anchorSize=element.outerWidth()+2*margin),owner._isHorizontal?(left-=parseInt((width-element[owner._outerSize]())/2,10),
top-=height+callout.height()+margin):(top-=parseInt((height-element[owner._outerSize]())/2,10),left-=width+callout.width()+margin),owner._isHorizontal?(diff=that._flip(top,height,anchorSize,viewport.outerHeight()+that._scrollOffset.top),top+=diff,left+=that._fit(left,width,viewport.outerWidth()+that._scrollOffset.left)):(diff=that._flip(left,width,anchorSize,viewport.outerWidth()+that._scrollOffset.left),top+=that._fit(top,height,viewport.outerHeight()+that._scrollOffset.top),left+=diff),diff>0&&callout&&(callout.removeClass(),callout.addClass("k-callout k-callout-"+(owner._isHorizontal?"n":"w"))),that.tooltipDiv.css({top:top,left:left})},_fit:function(position,size,viewPortEnd){var output=0;return position+size>viewPortEnd&&(output=viewPortEnd-(position+size)),position<0&&(output=-position),output},_flip:function(offset,size,anchorSize,viewPortEnd){var output=0;return offset+size>viewPortEnd&&(output+=-(anchorSize+size)),offset+output<0&&(output+=anchorSize+size),output},constrainValue:function(position,min,max,maxOverflow){var that=this,val=0;return val=min<position&&position<max?that.owner._getValueFromPosition(position,that.dragableArea):maxOverflow?that.options.max:that.options.min}},kendo.ui.plugin(Slider);var RangeSlider=SliderBase.extend({init:function(element,options){var that=this,inputs=$(element).find("input"),firstInput=inputs.eq(0)[0],secondInput=inputs.eq(1)[0];firstInput.type="text",secondInput.type="text",options=extend({},{selectionStart:parseAttr(firstInput,"value"),min:parseAttr(firstInput,"min"),max:parseAttr(firstInput,"max"),smallStep:parseAttr(firstInput,"step")},{selectionEnd:parseAttr(secondInput,"value"),min:parseAttr(secondInput,"min"),max:parseAttr(secondInput,"max"),smallStep:parseAttr(secondInput,"step")},options),options&&options.enabled===undefined&&(options.enabled=!inputs.is("[disabled]")),SliderBase.fn.init.call(that,element,options),options=that.options,defined(options.selectionStart)&&null!==options.selectionStart||(options.selectionStart=options.min,inputs.eq(0).val(options.min)),defined(options.selectionEnd)&&null!==options.selectionEnd||(options.selectionEnd=options.max,inputs.eq(1).val(options.max));var dragHandles=that.wrapper.find(DRAG_HANDLE);new RangeSlider.Selection(dragHandles,that,options),that._firstHandleDrag=new Slider.Drag(dragHandles.eq(0),"firstHandle",that,options),that._lastHandleDrag=new Slider.Drag(dragHandles.eq(1),"lastHandle",that,options)},options:{name:"RangeSlider",leftDragHandleTitle:"drag",rightDragHandleTitle:"drag",tooltip:{format:"{0:#,#.##}"},selectionStart:null,selectionEnd:null},enable:function(enable){var clickHandler,that=this,options=that.options;that.disable(),enable!==!1&&(that.wrapper.removeClass(STATE_DISABLED).addClass(STATE_DEFAULT),that.wrapper.find("input").removeAttr(DISABLED),clickHandler=function(e){var touch=getTouches(e)[0];if(touch){var from,to,drag,mousePosition=that._isHorizontal?touch.location.pageX:touch.location.pageY,dragableArea=that._getDraggableArea(),val=that._getValueFromPosition(mousePosition,dragableArea),target=$(e.target);if(target.hasClass("k-draghandle"))return void target.addClass(STATE_FOCUSED+" "+STATE_SELECTED);val<options.selectionStart?(from=val,to=options.selectionEnd,drag=that._firstHandleDrag):val>that.selectionEnd?(from=options.selectionStart,to=val,drag=that._lastHandleDrag):val-options.selectionStart<=options.selectionEnd-val?(from=val,to=options.selectionEnd,drag=that._firstHandleDrag):(from=options.selectionStart,to=val,drag=that._lastHandleDrag),drag.dragstart(e),that._setValueInRange(from,to),that._focusWithMouse(drag.element)}},that.wrapper.find(TICK_SELECTOR+", "+TRACK_SELECTOR).on(TRACK_MOUSE_DOWN,clickHandler).end().on(TRACK_MOUSE_DOWN,function(){$(document.documentElement).one("selectstart",kendo.preventDefault)}).on(TRACK_MOUSE_UP,function(){that._activeDragHandle&&that._activeDragHandle._end()}),that.wrapper.find(DRAG_HANDLE).attr(TABINDEX,0).on(MOUSE_UP,function(){that._setTooltipTimeout()}).on(CLICK,function(e){that._focusWithMouse(e.target),e.preventDefault()}).on(FOCUS,proxy(that._focus,that)).on(BLUR,proxy(that._blur,that)),that.wrapper.find(DRAG_HANDLE).off(KEY_DOWN,kendo.preventDefault).eq(0).on(KEY_DOWN,proxy(function(e){this._keydown(e,"firstHandle")},that)).end().eq(1).on(KEY_DOWN,proxy(function(e){this._keydown(e,"lastHandle")},that)),that.options.enabled=!0)},disable:function(){var that=this;that.wrapper.removeClass(STATE_DEFAULT).addClass(STATE_DISABLED),that.wrapper.find("input").prop(DISABLED,DISABLED),that.wrapper.find(TICK_SELECTOR+", "+TRACK_SELECTOR).off(TRACK_MOUSE_DOWN).off(TRACK_MOUSE_UP),that.wrapper.find(DRAG_HANDLE).attr(TABINDEX,-1).off(MOUSE_UP).off(KEY_DOWN).off(CLICK).off(FOCUS).off(BLUR),that.options.enabled=!1},_keydown:function(e,handle){var dragSelectionStart,dragSelectionEnd,activeHandleDrag,that=this,selectionStartValue=that.options.selectionStart,selectionEndValue=that.options.selectionEnd;e.keyCode in that._keyMap&&(that._clearTooltipTimeout(),"firstHandle"==handle?(activeHandleDrag=that._activeHandleDrag=that._firstHandleDrag,selectionStartValue=that._keyMap[e.keyCode](selectionStartValue),selectionStartValue>selectionEndValue&&(selectionEndValue=selectionStartValue)):(activeHandleDrag=that._activeHandleDrag=that._lastHandleDrag,selectionEndValue=that._keyMap[e.keyCode](selectionEndValue),selectionStartValue>selectionEndValue&&(selectionStartValue=selectionEndValue)),that._setValueInRange(selectionStartValue,selectionEndValue),dragSelectionStart=Math.max(selectionStartValue,that.options.selectionStart),dragSelectionEnd=Math.min(selectionEndValue,that.options.selectionEnd),activeHandleDrag.selectionEnd=Math.max(dragSelectionEnd,that.options.selectionStart),activeHandleDrag.selectionStart=Math.min(dragSelectionStart,that.options.selectionEnd),activeHandleDrag._updateTooltip(that.value()[that._activeHandle]),e.preventDefault())},_update:function(selectionStart,selectionEnd){var that=this,values=that.value(),change=values[0]!=selectionStart||values[1]!=selectionEnd;that.value([selectionStart,selectionEnd]),change&&that.trigger(CHANGE,{values:[selectionStart,selectionEnd],value:[selectionStart,selectionEnd]})},value:function(value){return value&&value.length?this._value(value[0],value[1]):this._value()},_value:function(start,end){var that=this,options=that.options,selectionStart=options.selectionStart,selectionEnd=options.selectionEnd;return isNaN(start)&&isNaN(end)?[selectionStart,selectionEnd]:(start=round(start),end=round(end),void(start>=options.min&&start<=options.max&&end>=options.min&&end<=options.max&&start<=end&&(selectionStart==start&&selectionEnd==end||(that.element.find("input").eq(0).prop("value",formatValue(start)).end().eq(1).prop("value",formatValue(end)),options.selectionStart=start,options.selectionEnd=end,that._refresh(),that._refreshAriaAttr(start,end)))))},values:function(start,end){return isArray(start)?this._value(start[0],start[1]):this._value(start,end)},_refresh:function(){var that=this,options=that.options;that.trigger(MOVE_SELECTION,{values:[options.selectionStart,options.selectionEnd],value:[options.selectionStart,options.selectionEnd]}),options.selectionStart==options.max&&options.selectionEnd==options.max&&that._setZIndex("firstHandle")},_refreshAriaAttr:function(start,end){var formattedValue,that=this,dragHandles=that.wrapper.find(DRAG_HANDLE),drag=that._activeHandleDrag;formattedValue=that._getFormattedValue([start,end],drag),dragHandles.eq(0).attr("aria-valuenow",start),dragHandles.eq(1).attr("aria-valuenow",end),dragHandles.attr("aria-valuetext",formattedValue)},_setValueInRange:function(selectionStart,selectionEnd){var options=this.options;selectionStart=math.max(math.min(selectionStart,options.max),options.min),selectionEnd=math.max(math.min(selectionEnd,options.max),options.min),selectionStart==options.max&&selectionEnd==options.max&&this._setZIndex("firstHandle"),this._update(math.min(selectionStart,selectionEnd),math.max(selectionStart,selectionEnd))},_setZIndex:function(type){this.wrapper.find(DRAG_HANDLE).each(function(index){$(this).css("z-index","firstHandle"==type?1-index:index)})},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.wrapper.off(NS).find(TICK_SELECTOR+", "+TRACK_SELECTOR).off(NS).end().find(DRAG_HANDLE).off(NS),that._firstHandleDrag.draggable.destroy(),that._lastHandleDrag.draggable.destroy()}});RangeSlider.Selection=function(dragHandles,that,options){function moveSelection(value){value=value||[];var selectionStartValue=value[0]-options.min,selectionEndValue=value[1]-options.min,selectionStartIndex=math.ceil(round(selectionStartValue/options.smallStep)),selectionEndIndex=math.ceil(round(selectionEndValue/options.smallStep)),selectionStart=that._pixelSteps[selectionStartIndex],selectionEnd=that._pixelSteps[selectionEndIndex],halfHandle=parseInt(dragHandles.eq(0)[that._outerSize]()/2,10),rtlCorrection=that._isRtl?2:0;dragHandles.eq(0).css(that._position,selectionStart-halfHandle-rtlCorrection).end().eq(1).css(that._position,selectionEnd-halfHandle-rtlCorrection),makeSelection(selectionStart,selectionEnd)}function makeSelection(selectionStart,selectionEnd){var selection,selectionPosition,selectionDiv=that._trackDiv.find(".k-slider-selection");selection=math.abs(selectionStart-selectionEnd),selectionDiv[that._sizeFn](selection),that._isRtl?(selectionPosition=math.max(selectionStart,selectionEnd),selectionDiv.css("right",that._maxSelection-selectionPosition-1)):(selectionPosition=math.min(selectionStart,selectionEnd),selectionDiv.css(that._position,selectionPosition-1))}moveSelection(that.value()),that.bind([CHANGE,SLIDE,MOVE_SELECTION],function(e){moveSelection(e.values)})},kendo.ui.plugin(RangeSlider)}(window.kendo.jQuery),function($,parseInt,undefined){function triggerEvent(self,type,color){color=parse(color),color&&!color.equals(self.color())&&("change"==type&&(self._value=color),color=1!=color.a?color.toCssRgba():color.toCss(),self.trigger(type,{value:color}))}function hex(n,width,pad){for(pad||(pad="0"),n=n.toString(16);width>n.length;)n="0"+n;return n}function fixed(n){return parseFloat((+n).toFixed(3))}function parse(color,nothrow){if(null==color||"transparent"==color)return null;if(color instanceof Color)return color;var m=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(color);if(m)return new _Bytes(parseInt(m[1],16),parseInt(m[2],16),parseInt(m[3],16),1);if(m=/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(color))return new _Bytes(parseInt(m[1]+m[1],16),parseInt(m[2]+m[2],16),parseInt(m[3]+m[3],16),1);if(m=/^rgb\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/.exec(color))return new _Bytes(parseInt(m[1],10),parseInt(m[2],10),parseInt(m[3],10),1);if(m=/^rgba\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9.]+)\s*\)/.exec(color))return new _Bytes(parseInt(m[1],10),parseInt(m[2],10),parseInt(m[3],10),parseFloat(m[4]));if(m=/^rgb\(\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*\)/.exec(color))return new _RGB(parseFloat(m[1])/100,parseFloat(m[2])/100,parseFloat(m[3])/100,1);if(m=/^rgba\(\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9]*\.?[0-9]+)%\s*,\s*([0-9.]+)\s*\)/.exec(color))return new _RGB(parseFloat(m[1])/100,parseFloat(m[2])/100,parseFloat(m[3])/100,parseFloat(m[4]));if(!nothrow)throw new Error("Cannot parse color: "+color);return undefined}function relative(array,element,delta){array=Array.prototype.slice.call(array);var n=array.length,pos=array.indexOf(element);return pos<0?delta<0?array[n-1]:array[0]:(pos+=delta,pos<0?pos+=n:pos%=n,array[pos])}function preventDefault(ev){ev.preventDefault()}function bind(callback,obj){return function(){return callback.apply(obj,arguments)}}var kendo=window.kendo,Class=kendo.Class,ui=kendo.ui,Widget=ui.Widget,KEYS=kendo.keys,BACKGROUNDCOLOR="background-color",ITEMSELECTEDCLASS="k-state-selected",SIMPLEPALETTE="000000,7f7f7f,880015,ed1c24,ff7f27,fff200,22b14c,00a2e8,3f48cc,a349a4,ffffff,c3c3c3,b97a57,ffaec9,ffc90e,efe4b0,b5e61d,99d9ea,7092be,c8bfe7",WEBPALETTE="FFFFFF,FFCCFF,FF99FF,FF66FF,FF33FF,FF00FF,CCFFFF,CCCCFF,CC99FF,CC66FF,CC33FF,CC00FF,99FFFF,99CCFF,9999FF,9966FF,9933FF,9900FF,FFFFCC,FFCCCC,FF99CC,FF66CC,FF33CC,FF00CC,CCFFCC,CCCCCC,CC99CC,CC66CC,CC33CC,CC00CC,99FFCC,99CCCC,9999CC,9966CC,9933CC,9900CC,FFFF99,FFCC99,FF9999,FF6699,FF3399,FF0099,CCFF99,CCCC99,CC9999,CC6699,CC3399,CC0099,99FF99,99CC99,999999,996699,993399,990099,FFFF66,FFCC66,FF9966,FF6666,FF3366,FF0066,CCFF66,CCCC66,CC9966,CC6666,CC3366,CC0066,99FF66,99CC66,999966,996666,993366,990066,FFFF33,FFCC33,FF9933,FF6633,FF3333,FF0033,CCFF33,CCCC33,CC9933,CC6633,CC3333,CC0033,99FF33,99CC33,999933,996633,993333,990033,FFFF00,FFCC00,FF9900,FF6600,FF3300,FF0000,CCFF00,CCCC00,CC9900,CC6600,CC3300,CC0000,99FF00,99CC00,999900,996600,993300,990000,66FFFF,66CCFF,6699FF,6666FF,6633FF,6600FF,33FFFF,33CCFF,3399FF,3366FF,3333FF,3300FF,00FFFF,00CCFF,0099FF,0066FF,0033FF,0000FF,66FFCC,66CCCC,6699CC,6666CC,6633CC,6600CC,33FFCC,33CCCC,3399CC,3366CC,3333CC,3300CC,00FFCC,00CCCC,0099CC,0066CC,0033CC,0000CC,66FF99,66CC99,669999,666699,663399,660099,33FF99,33CC99,339999,336699,333399,330099,00FF99,00CC99,009999,006699,003399,000099,66FF66,66CC66,669966,666666,663366,660066,33FF66,33CC66,339966,336666,333366,330066,00FF66,00CC66,009966,006666,003366,000066,66FF33,66CC33,669933,666633,663333,660033,33FF33,33CC33,339933,336633,333333,330033,00FF33,00CC33,009933,006633,003333,000033,66FF00,66CC00,669900,666600,663300,660000,33FF00,33CC00,339900,336600,333300,330000,00FF00,00CC00,009900,006600,003300,000000",APPLY_CANCEL={apply:"Apply",cancel:"Cancel"},NS=".kendoColorTools",CLICK_NS="click"+NS,KEYDOWN_NS="keydown"+NS,browser=kendo.support.browser,isIE8=browser.msie&&browser.version<9,ColorSelector=Widget.extend({init:function(element,options){var ariaId,that=this;Widget.fn.init.call(that,element,options),element=that.element,options=that.options,that._value=options.value=parse(options.value),that._tabIndex=element.attr("tabIndex")||0,ariaId=that._ariaId=options.ariaId,ariaId&&element.attr("aria-labelledby",ariaId),options._standalone&&(that._triggerSelect=that._triggerChange)},options:{name:"ColorSelector",value:null,_standalone:!0},events:["change","select","cancel"],color:function(value){return value!==undefined&&(this._value=parse(value),this._updateUI(this._value)),this._value},value:function(color){return color=this.color(color),color&&(color=this.options.opacity?color.toCssRgba():color.toCss()),color||null},enable:function(enable){0===arguments.length&&(enable=!0),$(".k-disabled-overlay",this.wrapper).remove(),enable||this.wrapper.append("<div class='k-disabled-overlay'></div>"),this._onEnable(enable)},_select:function(color,nohooks){var prev=this._value;color=this.color(color),nohooks||(color.equals(prev)?this._standalone||this.trigger("cancel"):this.trigger("change",{value:this.value()}),this.element.trigger("change"))},_triggerSelect:function(color){triggerEvent(this,"select",color)},_triggerChange:function(color){triggerEvent(this,"change",color)},destroy:function(){this.element&&this.element.off(NS),this.wrapper&&this.wrapper.off(NS).find("*").off(NS),this.wrapper=null,Widget.fn.destroy.call(this)},_updateUI:$.noop,_selectOnHide:function(){return null},_cancel:function(){this.trigger("cancel")}}),ColorPalette=ColorSelector.extend({init:function(element,options){var that=this;ColorSelector.fn.init.call(that,element,options),element=that.wrapper=that.element,options=that.options;var colors=options.palette;"websafe"==colors?(colors=WEBPALETTE,options.columns=18):"basic"==colors&&(colors=SIMPLEPALETTE),"string"==typeof colors&&(colors=colors.split(",")),$.isArray(colors)&&(colors=$.map(colors,function(x){return parse(x)})),that._selectedID=(options.ariaId||kendo.guid())+"_selected",element.addClass("k-widget k-colorpalette").attr("role","grid").attr("aria-readonly","true").append($(that._template({colors:colors,columns:options.columns,tileSize:options.tileSize,value:that._value,id:options.ariaId}))).on(CLICK_NS,".k-item",function(ev){that._select($(ev.currentTarget).css(BACKGROUNDCOLOR))}).attr("tabIndex",that._tabIndex).on(KEYDOWN_NS,bind(that._keydown,that));var width,height,tileSize=options.tileSize;if(tileSize){if(/number|string/.test(typeof tileSize))width=height=parseFloat(tileSize);else{if("object"!=typeof tileSize)throw new Error("Unsupported value for the 'tileSize' argument");width=parseFloat(tileSize.width),height=parseFloat(tileSize.height)}element.find(".k-item").css({width:width,height:height})}},focus:function(){this.wrapper.focus()},options:{name:"ColorPalette",columns:10,tileSize:null,palette:"basic"},_onEnable:function(enable){enable?this.wrapper.attr("tabIndex",this._tabIndex):this.wrapper.removeAttr("tabIndex")},_keydown:function(e){var selected,wrapper=this.wrapper,items=wrapper.find(".k-item"),current=items.filter("."+ITEMSELECTEDCLASS).get(0),keyCode=e.keyCode;if(keyCode==KEYS.LEFT?selected=relative(items,current,-1):keyCode==KEYS.RIGHT?selected=relative(items,current,1):keyCode==KEYS.DOWN?selected=relative(items,current,this.options.columns):keyCode==KEYS.UP?selected=relative(items,current,-this.options.columns):keyCode==KEYS.ENTER?(preventDefault(e),current&&this._select($(current).css(BACKGROUNDCOLOR))):keyCode==KEYS.ESC&&this._cancel(),selected){preventDefault(e),this._current(selected);try{var color=parse(selected.css(BACKGROUNDCOLOR));this._triggerSelect(color)}catch(ex){}}},_current:function(item){this.wrapper.find("."+ITEMSELECTEDCLASS).removeClass(ITEMSELECTEDCLASS).attr("aria-selected",!1).removeAttr("id"),$(item).addClass(ITEMSELECTEDCLASS).attr("aria-selected",!0).attr("id",this._selectedID),this.element.removeAttr("aria-activedescendant").attr("aria-activedescendant",this._selectedID)},_updateUI:function(color){var item=null;this.wrapper.find(".k-item").each(function(){var c=parse($(this).css(BACKGROUNDCOLOR));if(c&&c.equals(color))return item=this,!1}),this._current(item)},_template:kendo.template('<table class="k-palette k-reset" role="presentation"><tr role="row"># for (var i = 0; i < colors.length; ++i) { ## var selected = colors[i].equals(value); ## if (i && i % columns == 0) { # </tr><tr role="row"> # } #<td role="gridcell" unselectable="on" style="background-color:#= colors[i].toCss() #"#= selected ? " aria-selected=true" : "" # #=(id && i === 0) ? "id=\\""+id+"\\" " : "" # class="k-item#= selected ? " '+ITEMSELECTEDCLASS+'" : "" #" aria-label="#= colors[i].toCss() #"></td># } #</tr></table>')}),FlatColorPicker=ColorSelector.extend({init:function(element,options){var that=this;ColorSelector.fn.init.call(that,element,options),options=that.options,element=that.element,that.wrapper=element.addClass("k-widget k-flatcolorpicker").append(that._template(options)),that._hueElements=$(".k-hsv-rectangle, .k-transparency-slider .k-slider-track",element),that._selectedColor=$(".k-selected-color-display",element),that._colorAsText=$("input.k-color-value",element),that._sliders(),that._hsvArea(),that._updateUI(that._value||new _RGB(1,0,0,1)),element.find("input.k-color-value").on(KEYDOWN_NS,function(ev){var input=this;if(ev.keyCode==KEYS.ENTER)try{var color=parse(input.value),val=that.color();that._select(color,color.equals(val))}catch(ex){$(input).addClass("k-state-error")}else that.options.autoupdate&&setTimeout(function(){var color=parse(input.value,!0);color&&that._updateUI(color,!0)},10)}).end().on(CLICK_NS,".k-controls button.apply",function(){that._select(that._getHSV())}).on(CLICK_NS,".k-controls button.cancel",function(){that._updateUI(that.color()),that._cancel()}),isIE8&&that._applyIEFilter()},destroy:function(){this._hueSlider.destroy(),this._opacitySlider&&this._opacitySlider.destroy(),this._hueSlider=this._opacitySlider=this._hsvRect=this._hsvHandle=this._hueElements=this._selectedColor=this._colorAsText=null,ColorSelector.fn.destroy.call(this)},options:{name:"FlatColorPicker",opacity:!1,buttons:!1,input:!0,preview:!0,autoupdate:!0,messages:APPLY_CANCEL},_applyIEFilter:function(){var track=this.element.find(".k-hue-slider .k-slider-track")[0],url=track.currentStyle.backgroundImage;url=url.replace(/^url\([\'\"]?|[\'\"]?\)$/g,""),track.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+url+"', sizingMethod='scale')"},_sliders:function(){function hueChange(e){that._updateUI(that._getHSV(e.value,null,null,null))}function opacityChange(e){that._updateUI(that._getHSV(null,null,null,e.value/100))}var that=this,element=that.element;that._hueSlider=element.find(".k-hue-slider").kendoSlider({min:0,max:359,tickPlacement:"none",showButtons:!1,slide:hueChange,change:hueChange}).data("kendoSlider"),that._opacitySlider=element.find(".k-transparency-slider").kendoSlider({min:0,max:100,tickPlacement:"none",showButtons:!1,slide:opacityChange,change:opacityChange}).data("kendoSlider")},_hsvArea:function(){function update(x,y){var offset=this.offset,dx=x-offset.left,dy=y-offset.top,rw=this.width,rh=this.height;dx=dx<0?0:dx>rw?rw:dx,dy=dy<0?0:dy>rh?rh:dy,that._svChange(dx/rw,1-dy/rh)}var that=this,element=that.element,hsvRect=element.find(".k-hsv-rectangle"),hsvHandle=hsvRect.find(".k-draghandle").attr("tabIndex",0).on(KEYDOWN_NS,bind(that._keydown,that));that._hsvEvents=new kendo.UserEvents(hsvRect,{global:!0,press:function(e){this.offset=kendo.getOffset(hsvRect),this.width=hsvRect.width(),this.height=hsvRect.height(),hsvHandle.focus(),update.call(this,e.x.location,e.y.location)},start:function(){hsvRect.addClass("k-dragging"),hsvHandle.focus()},move:function(e){e.preventDefault(),update.call(this,e.x.location,e.y.location)},end:function(){hsvRect.removeClass("k-dragging")}}),that._hsvRect=hsvRect,that._hsvHandle=hsvHandle},_onEnable:function(enable){this._hueSlider.enable(enable),this._opacitySlider&&this._opacitySlider.enable(enable),this.wrapper.find("input").attr("disabled",!enable);var handle=this._hsvRect.find(".k-draghandle");enable?handle.attr("tabIndex",this._tabIndex):handle.removeAttr("tabIndex")},_keydown:function(ev){function move(prop,d){var c=that._getHSV();c[prop]+=d*(ev.shiftKey?.01:.05),c[prop]<0&&(c[prop]=0),c[prop]>1&&(c[prop]=1),that._updateUI(c),preventDefault(ev)}function hue(d){var c=that._getHSV();c.h+=d*(ev.shiftKey?1:5),c.h<0&&(c.h=0),c.h>359&&(c.h=359),that._updateUI(c),preventDefault(ev)}var that=this;switch(ev.keyCode){case KEYS.LEFT:ev.ctrlKey?hue(-1):move("s",-1);break;case KEYS.RIGHT:ev.ctrlKey?hue(1):move("s",1);break;case KEYS.UP:move(ev.ctrlKey&&that._opacitySlider?"a":"v",1);break;case KEYS.DOWN:move(ev.ctrlKey&&that._opacitySlider?"a":"v",-1);break;case KEYS.ENTER:that._select(that._getHSV());break;case KEYS.F2:that.wrapper.find("input.k-color-value").focus().select();break;case KEYS.ESC:that._cancel()}},focus:function(){this._hsvHandle.focus()},_getHSV:function(h,s,v,a){var rect=this._hsvRect,width=rect.width(),height=rect.height(),handlePosition=this._hsvHandle.position();return null==h&&(h=this._hueSlider.value()),null==s&&(s=handlePosition.left/width),null==v&&(v=1-handlePosition.top/height),null==a&&(a=this._opacitySlider?this._opacitySlider.value()/100:1),new _HSV(h,s,v,a)},_svChange:function(s,v){var color=this._getHSV(null,s,v,null);this._updateUI(color)},_updateUI:function(color,dontChangeInput){var that=this,rect=that._hsvRect;color&&(this._colorAsText.removeClass("k-state-error"),that._selectedColor.css(BACKGROUNDCOLOR,color.toDisplay()),dontChangeInput||that._colorAsText.val(that._opacitySlider?color.toCssRgba():color.toCss()),that._triggerSelect(color),color=color.toHSV(),that._hsvHandle.css({left:color.s*rect.width()+"px",top:(1-color.v)*rect.height()+"px"}),that._hueElements.css(BACKGROUNDCOLOR,new _HSV(color.h,1,1,1).toCss()),that._hueSlider.value(color.h),that._opacitySlider&&that._opacitySlider.value(100*color.a))},_selectOnHide:function(){return this.options.buttons?null:this._getHSV()},_template:kendo.template('# if (preview) { #<div class="k-selected-color"><div class="k-selected-color-display"><input class="k-color-value" #= !data.input ? \'style="visibility: hidden;"\' : "" #></div></div># } #<div class="k-hsv-rectangle"><div class="k-hsv-gradient"></div><div class="k-draghandle"></div></div><input class="k-hue-slider" /># if (opacity) { #<input class="k-transparency-slider" /># } ## if (buttons) { #<div unselectable="on" class="k-controls"><button class="k-button k-primary apply">#: messages.apply #</button> <button class="k-button cancel">#: messages.cancel #</button></div># } #')}),Color=Class.extend({toHSV:function(){return this},toRGB:function(){return this},toHex:function(){return this.toBytes().toHex()},toBytes:function(){return this},toCss:function(){return"#"+this.toHex()},toCssRgba:function(){var rgb=this.toBytes();return"rgba("+rgb.r+", "+rgb.g+", "+rgb.b+", "+fixed(this.a)+")"},toDisplay:function(){return isIE8?this.toCss():this.toCssRgba()},equals:function(c){return c===this||null!==c&&this.toCssRgba()==parse(c).toCssRgba()},diff:function(c2){if(null==c2)return NaN;var c1=this.toBytes();return c2=c2.toBytes(),Math.sqrt(Math.pow(.3*(c1.r-c2.r),2)+Math.pow(.59*(c1.g-c2.g),2)+Math.pow(.11*(c1.b-c2.b),2))},clone:function(){var c=this.toBytes();return c===this&&(c=new _Bytes(c.r,c.g,c.b,c.a)),c}}),_RGB=Color.extend({init:function(r,g,b,a){this.r=r,this.g=g,this.b=b,this.a=a},toHSV:function(){var min,max,delta,h,s,v,r=this.r,g=this.g,b=this.b;return min=Math.min(r,g,b),max=Math.max(r,g,b),v=max,delta=max-min,0===delta?new _HSV(0,0,v,this.a):(0!==max?(s=delta/max,h=r==max?(g-b)/delta:g==max?2+(b-r)/delta:4+(r-g)/delta,h*=60,h<0&&(h+=360)):(s=0,h=-1),new _HSV(h,s,v,this.a))},toBytes:function(){return new _Bytes(255*this.r,255*this.g,255*this.b,this.a)}}),_Bytes=_RGB.extend({init:function(r,g,b,a){this.r=Math.round(r),this.g=Math.round(g),this.b=Math.round(b),this.a=a},toRGB:function(){return new _RGB(this.r/255,this.g/255,this.b/255,this.a)},toHSV:function(){return this.toRGB().toHSV()},toHex:function(){return hex(this.r,2)+hex(this.g,2)+hex(this.b,2)},toBytes:function(){return this}}),_HSV=Color.extend({init:function(h,s,v,a){this.h=h,this.s=s,this.v=v,this.a=a},toRGB:function(){var i,r,g,b,f,p,q,t,h=this.h,s=this.s,v=this.v;if(0===s)r=g=b=v;else switch(h/=60,i=Math.floor(h),f=h-i,p=v*(1-s),q=v*(1-s*f),t=v*(1-s*(1-f)),i){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;default:r=v,g=p,b=q}return new _RGB(r,g,b,this.a)},toBytes:function(){return this.toRGB().toBytes()}}),ColorPicker=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),options=that.options,element=that.element;var value=element.attr("value")||element.val();value=value?parse(value,!0):parse(options.value,!0),that._value=options.value=value;var content=that.wrapper=$(that._template(options));element.hide().after(content),element.is("input")&&element.appendTo(content),that._tabIndex=element.attr("tabIndex")||0,that.enable(!element.attr("disabled"));var accesskey=element.attr("accesskey");accesskey&&(element.attr("accesskey",null),content.attr("accesskey",accesskey)),that.bind("activate",function(ev){ev.isDefaultPrevented()||that.toggle()}),that._updateUI(value)},destroy:function(){this.wrapper.off(NS).find("*").off(NS),this._popup&&(this._selector.destroy(),this._popup.destroy()),this._selector=this._popup=this.wrapper=null,Widget.fn.destroy.call(this)},enable:function(enable){var that=this,wrapper=that.wrapper,innerWrapper=wrapper.children(".k-picker-wrap"),icon=innerWrapper.find(".k-select");0===arguments.length&&(enable=!0),that.element.attr("disabled",!enable),wrapper.attr("aria-disabled",!enable),icon.off(NS).on("mousedown"+NS,preventDefault),wrapper.addClass("k-state-disabled").removeAttr("tabIndex").add("*",wrapper).off(NS),enable&&wrapper.removeClass("k-state-disabled").attr("tabIndex",that._tabIndex).on("mouseenter"+NS,function(){innerWrapper.addClass("k-state-hover")}).on("mouseleave"+NS,function(){innerWrapper.removeClass("k-state-hover")}).on("focus"+NS,function(){innerWrapper.addClass("k-state-focused")}).on("blur"+NS,function(){innerWrapper.removeClass("k-state-focused")}).on(KEYDOWN_NS,bind(that._keydown,that)).on(CLICK_NS,".k-icon",bind(that.toggle,that)).on(CLICK_NS,that.options.toolIcon?".k-tool-icon":".k-selected-color",function(){that.trigger("activate")})},_template:kendo.template('<span role="textbox" aria-haspopup="true" class="k-widget k-colorpicker k-header"><span class="k-picker-wrap k-state-default"># if (toolIcon) { #<span class="k-tool-icon #= toolIcon #"><span class="k-selected-color"></span></span># } else { #<span class="k-selected-color"></span># } #<span class="k-select" unselectable="on"><span class="k-icon k-i-arrow-s" unselectable="on"></span></span></span></span>'),options:{name:"ColorPicker",palette:null,columns:10,toolIcon:null,value:null,messages:APPLY_CANCEL,opacity:!1,buttons:!0,preview:!0,ARIATemplate:'Current selected color is #=data || ""#'},events:["activate","change","select","open","close"],open:function(){this._getPopup().open()},close:function(){this._getPopup().close()},toggle:function(){this._getPopup().toggle()},color:ColorSelector.fn.color,value:ColorSelector.fn.value,_select:ColorSelector.fn._select,_triggerSelect:ColorSelector.fn._triggerSelect,_isInputTypeColor:function(){var el=this.element[0];return/^input$/i.test(el.tagName)&&/^color$/i.test(el.type)},_updateUI:function(value){var formattedValue="";value&&(formattedValue=this._isInputTypeColor()||1==value.a?value.toCss():value.toCssRgba(),this.element.val(formattedValue)),this._ariaTemplate||(this._ariaTemplate=kendo.template(this.options.ARIATemplate)),this.wrapper.attr("aria-label",this._ariaTemplate(formattedValue)),this._triggerSelect(value),this.wrapper.find(".k-selected-color").css(BACKGROUNDCOLOR,value?value.toDisplay():"transparent")},_keydown:function(ev){var key=ev.keyCode;this._getPopup().visible()?(key==KEYS.ESC?this._selector._cancel():this._selector._keydown(ev),preventDefault(ev)):key!=KEYS.ENTER&&key!=KEYS.DOWN||(this.open(),preventDefault(ev))},_getPopup:function(){var that=this,popup=that._popup;if(!popup){var selectorType,options=that.options;selectorType=options.palette?ColorPalette:FlatColorPicker,options._standalone=!1,delete options.select,delete options.change,delete options.cancel;var id=kendo.guid(),selector=that._selector=new selectorType($('<div id="'+id+'"/>').appendTo(document.body),options);that.wrapper.attr("aria-owns",id),that._popup=popup=selector.wrapper.kendoPopup({anchor:that.wrapper}).data("kendoPopup"),selector.bind({select:function(ev){that._updateUI(parse(ev.value))},change:function(){that._select(selector.color()),that.close()},cancel:function(){that.close()}}),popup.bind({close:function(ev){if(that.trigger("close"))return void ev.preventDefault();that.wrapper.children(".k-picker-wrap").removeClass("k-state-focused");var color=selector._selectOnHide();color?that._select(color):(that.wrapper.focus(),that._updateUI(that.color()))},open:function(ev){that.trigger("open")?ev.preventDefault():that.wrapper.children(".k-picker-wrap").addClass("k-state-focused")},activate:function(){selector._select(that.color(),!0),selector.focus(),that.wrapper.children(".k-picker-wrap").addClass("k-state-focused")}})}return popup}});ui.plugin(ColorPalette),ui.plugin(FlatColorPicker),ui.plugin(ColorPicker),kendo.parseColor=parse,kendo.Color={fromBytes:function(r,g,b,a){return new _Bytes(r,g,b,null!=a?a:1)},fromRGB:function(r,g,b,a){return new _RGB(r,g,b,null!=a?a:1)},fromHSV:function(h,s,v,a){return new _HSV(h,s,v,null!=a?a:1)}}}(jQuery,parseInt),function($,undefined){function buttonHtml(className,text){return'<span unselectable="on" class="k-link"><span unselectable="on" class="k-icon k-i-arrow-'+className+'" title="'+text+'">'+text+"</span></span>"}var kendo=window.kendo,caret=kendo.caret,keys=kendo.keys,ui=kendo.ui,Widget=ui.Widget,activeElement=kendo._activeElement,extractFormat=kendo._extractFormat,parse=kendo.parseFloat,placeholderSupported=kendo.support.placeholder,getCulture=kendo.getCulture,round=kendo._round,CHANGE="change",DISABLED="disabled",READONLY="readonly",INPUT="k-input",SPIN="spin",ns=".kendoNumericTextBox",TOUCHEND="touchend",MOUSELEAVE="mouseleave"+ns,HOVEREVENTS="mouseenter"+ns+" "+MOUSELEAVE,DEFAULT="k-state-default",FOCUSED="k-state-focused",HOVER="k-state-hover",FOCUS="focus",POINT=".",SELECTED="k-state-selected",STATEDISABLED="k-state-disabled",ARIA_DISABLED="aria-disabled",ARIA_READONLY="aria-readonly",INTEGER_REGEXP=/^(-)?(\d*)$/,NULL=null,proxy=$.proxy,NumericTextBox=Widget.extend({
init:function(element,options){var min,max,step,value,disabled,that=this,isStep=options&&options.step!==undefined;Widget.fn.init.call(that,element,options),options=that.options,element=that.element.on("blur"+ns,proxy(that._focusout,that)).attr("role","spinbutton"),options.placeholder=options.placeholder||element.attr("placeholder"),that._reset(),that._wrapper(),that._arrows(),that._input(),kendo.support.mobileOS?that._text.on(TOUCHEND+ns+" "+FOCUS+ns,function(e){that._toggleText(!1),e.type===FOCUS&&element.focus()}):that._text.on(FOCUS+ns,proxy(that._click,that)),min=that.min(element.attr("min")),max=that.max(element.attr("max")),step=that._parse(element.attr("step")),options.min===NULL&&min!==NULL&&(options.min=min),options.max===NULL&&max!==NULL&&(options.max=max),isStep||step===NULL||(options.step=step),element.attr("aria-valuemin",options.min).attr("aria-valuemax",options.max),options.format=extractFormat(options.format),value=options.value,that.value(value!==NULL?value:element.val()),disabled=element.is("[disabled]"),disabled?that.enable(!1):that.readonly(element.is("[readonly]")),kendo.notify(that)},options:{name:"NumericTextBox",decimals:NULL,min:NULL,max:NULL,value:NULL,step:1,culture:"",format:"n",spinners:!0,placeholder:"",upArrowText:"Increase value",downArrowText:"Decrease value"},events:[CHANGE,SPIN],_editable:function(options){var that=this,element=that.element,disable=options.disable,readonly=options.readonly,text=that._text.add(element),wrapper=that._inputWrapper.off(HOVEREVENTS);that._toggleText(!0),that._upArrowEventHandler.unbind("press"),that._downArrowEventHandler.unbind("press"),element.off("keydown"+ns).off("keypress"+ns).off("paste"+ns),readonly||disable?(wrapper.addClass(disable?STATEDISABLED:DEFAULT).removeClass(disable?DEFAULT:STATEDISABLED),text.attr(DISABLED,disable).attr(READONLY,readonly).attr(ARIA_DISABLED,disable).attr(ARIA_READONLY,readonly)):(wrapper.addClass(DEFAULT).removeClass(STATEDISABLED).on(HOVEREVENTS,that._toggleHover),text.removeAttr(DISABLED).removeAttr(READONLY).attr(ARIA_DISABLED,!1).attr(ARIA_READONLY,!1),that._upArrowEventHandler.bind("press",function(e){e.preventDefault(),that._spin(1),that._upArrow.addClass(SELECTED)}),that._downArrowEventHandler.bind("press",function(e){e.preventDefault(),that._spin(-1),that._downArrow.addClass(SELECTED)}),that.element.on("keydown"+ns,proxy(that._keydown,that)).on("keypress"+ns,proxy(that._keypress,that)).on("paste"+ns,proxy(that._paste,that)))},readonly:function(readonly){this._editable({readonly:readonly===undefined||readonly,disable:!1})},enable:function(enable){this._editable({readonly:!1,disable:!(enable=enable===undefined||enable)})},destroy:function(){var that=this;that.element.add(that._text).add(that._upArrow).add(that._downArrow).add(that._inputWrapper).off(ns),that._upArrowEventHandler.destroy(),that._downArrowEventHandler.destroy(),that._form&&that._form.off("reset",that._resetHandler),Widget.fn.destroy.call(that)},min:function(value){return this._option("min",value)},max:function(value){return this._option("max",value)},step:function(value){return this._option("step",value)},value:function(value){var adjusted,that=this;return value===undefined?that._value:(value=that._parse(value),adjusted=that._adjust(value),void(value===adjusted&&(that._update(value),that._old=that._value)))},focus:function(){this._focusin()},_adjust:function(value){var that=this,options=that.options,min=options.min,max=options.max;return value===NULL?value:(min!==NULL&&value<min?value=min:max!==NULL&&value>max&&(value=max),value)},_arrows:function(){var arrows,that=this,_release=function(){clearTimeout(that._spinning),arrows.removeClass(SELECTED)},options=that.options,spinners=options.spinners,element=that.element;arrows=element.siblings(".k-icon"),arrows[0]||(arrows=$(buttonHtml("n",options.upArrowText)+buttonHtml("s",options.downArrowText)).insertAfter(element),arrows.wrapAll('<span class="k-select"/>')),spinners||(arrows.parent().toggle(spinners),that._inputWrapper.addClass("k-expand-padding")),that._upArrow=arrows.eq(0),that._upArrowEventHandler=new kendo.UserEvents(that._upArrow,{release:_release}),that._downArrow=arrows.eq(1),that._downArrowEventHandler=new kendo.UserEvents(that._downArrow,{release:_release})},_blur:function(){var that=this;that._toggleText(!0),that._change(that.element.val())},_click:function(e){var that=this;clearTimeout(that._focusing),that._focusing=setTimeout(function(){var result,groupRegExp,extractRegExp,input=e.target,idx=caret(input)[0],value=input.value.substring(0,idx),format=that._format(that.options.format),group=format[","],caretPosition=0;group&&(groupRegExp=new RegExp("\\"+group,"g"),extractRegExp=new RegExp("([\\d\\"+group+"]+)(\\"+format[POINT]+")?(\\d+)?")),extractRegExp&&(result=extractRegExp.exec(value)),result&&(caretPosition=result[0].replace(groupRegExp,"").length,value.indexOf("(")!=-1&&that._value<0&&caretPosition++),that._focusin(),caret(that.element[0],caretPosition)})},_change:function(value){var that=this;that._update(value),value=that._value,that._old!=value&&(that._old=value,that.trigger(CHANGE),that.element.trigger(CHANGE))},_culture:function(culture){return culture||getCulture(this.options.culture)},_focusin:function(){var that=this;that._inputWrapper.addClass(FOCUSED),that._toggleText(!1),that.element[0].focus()},_focusout:function(){var that=this;clearTimeout(that._focusing),that._inputWrapper.removeClass(FOCUSED).removeClass(HOVER),that._blur()},_format:function(format,culture){var numberFormat=this._culture(culture).numberFormat;return format=format.toLowerCase(),format.indexOf("c")>-1?numberFormat=numberFormat.currency:format.indexOf("p")>-1&&(numberFormat=numberFormat.percent),numberFormat},_input:function(){var text,that=this,CLASSNAME="k-formatted-value",element=that.element.addClass(INPUT).show()[0],accessKey=element.accessKey,wrapper=that.wrapper;text=wrapper.find(POINT+CLASSNAME),text[0]||(text=$('<input type="text"/>').insertBefore(element).addClass(CLASSNAME));try{element.setAttribute("type","text")}catch(e){element.type="text"}text[0].tabIndex=element.tabIndex,text[0].style.cssText=element.style.cssText,text.prop("placeholder",that.options.placeholder),accessKey&&(text.attr("accesskey",accessKey),element.accessKey=""),that._text=text.addClass(element.className)},_keydown:function(e){var that=this,key=e.keyCode;that._key=key,key==keys.DOWN?that._step(-1):key==keys.UP?that._step(1):key==keys.ENTER&&that._change(that.element.val())},_keypress:function(e){if(0!==e.which&&!e.ctrlKey&&e.keyCode!==keys.BACKSPACE&&e.keyCode!==keys.ENTER){var isValid,that=this,min=that.options.min,element=that.element,selection=caret(element),selectionStart=selection[0],selectionEnd=selection[1],character=String.fromCharCode(e.which),numberFormat=that._format(that.options.format),isNumPadDecimal=that._key===keys.NUMPAD_DOT,value=element.val();isNumPadDecimal&&(character=numberFormat[POINT]),value=value.substring(0,selectionStart)+character+value.substring(selectionEnd),isValid=that._numericRegex(numberFormat).test(value),isValid&&isNumPadDecimal?(element.val(value),caret(element,selectionStart+character.length),e.preventDefault()):(null!==min&&min>=0&&"-"===value.charAt(0)||!isValid)&&e.preventDefault(),that._key=0}},_numericRegex:function(numberFormat){var that=this,separator=numberFormat[POINT],precision=that.options.decimals;return separator===POINT&&(separator="\\"+separator),precision===NULL&&(precision=numberFormat.decimals),0===precision?INTEGER_REGEXP:(that._separator!==separator&&(that._separator=separator,that._floatRegExp=new RegExp("^(-)?(((\\d+("+separator+"\\d*)?)|("+separator+"\\d*)))?$")),that._floatRegExp)},_paste:function(e){var that=this,element=e.target,value=element.value;setTimeout(function(){that._parse(element.value)===NULL&&that._update(value)})},_option:function(option,value){var that=this,options=that.options;return value===undefined?options[option]:(value=that._parse(value),void((value||"step"!==option)&&(options[option]=value,that.element.attr("aria-value"+option,value).attr(option,value))))},_spin:function(step,timeout){var that=this;timeout=timeout||500,clearTimeout(that._spinning),that._spinning=setTimeout(function(){that._spin(step,50)},timeout),that._step(step)},_step:function(step){var that=this,element=that.element,value=that._parse(element.val())||0;activeElement()!=element[0]&&that._focusin(),value+=that.options.step*step,that._update(that._adjust(value)),that.trigger(SPIN)},_toggleHover:function(e){$(e.currentTarget).toggleClass(HOVER,"mouseenter"===e.type)},_toggleText:function(toggle){var that=this;that._text.toggle(toggle),that.element.toggle(!toggle)},_parse:function(value,culture){return parse(value,this._culture(culture),this.options.format)},_update:function(value){var isNotNull,that=this,options=that.options,format=options.format,decimals=options.decimals,culture=that._culture(),numberFormat=that._format(format,culture);decimals===NULL&&(decimals=numberFormat.decimals),value=that._parse(value,culture),isNotNull=value!==NULL,isNotNull&&(value=parseFloat(round(value,decimals))),that._value=value=that._adjust(value),that._placeholder(kendo.toString(value,format,culture)),isNotNull?(value=value.toString(),value.indexOf("e")!==-1&&(value=round(+value,decimals)),value=value.replace(POINT,numberFormat[POINT])):value="",that.element.val(value).attr("aria-valuenow",value)},_placeholder:function(value){this._text.val(value),placeholderSupported||value||this._text.val(this.options.placeholder)},_wrapper:function(){var wrapper,that=this,element=that.element,DOMElement=element[0];wrapper=element.parents(".k-numerictextbox"),wrapper.is("span.k-numerictextbox")||(wrapper=element.hide().wrap('<span class="k-numeric-wrap k-state-default" />').parent(),wrapper=wrapper.wrap("<span/>").parent()),wrapper[0].style.cssText=DOMElement.style.cssText,DOMElement.style.width="",that.wrapper=wrapper.addClass("k-widget k-numerictextbox").addClass(DOMElement.className).css("display",""),that._inputWrapper=$(wrapper[0].firstChild)},_reset:function(){var that=this,element=that.element,formId=element.attr("form"),form=formId?$("#"+formId):element.closest("form");form[0]&&(that._resetHandler=function(){setTimeout(function(){that.value(element[0].value)})},that._form=form.on("reset",that._resetHandler))}});ui.plugin(NumericTextBox)}(window.kendo.jQuery),function($,undefined){function removeFiltersForField(expression,field){expression.filters&&(expression.filters=$.grep(expression.filters,function(filter){return removeFiltersForField(filter,field),filter.filters?filter.filters.length:filter.field!=field}))}function convertItems(items){var idx,length,item,value,text,result;if(items&&items.length)for(result=[],idx=0,length=items.length;idx<length;idx++)item=items[idx],text=item.text||item.value||item,value=null==item.value?item.text||item:item.value,result[idx]={text:text,value:value};return result}function clearFilter(filters,field){return $.grep(filters,function(expr){return expr.filters?(expr.filters=$.grep(expr.filters,function(nested){return nested.field!=field}),expr.filters.length):expr.field!=field})}var kendo=window.kendo,ui=kendo.ui,proxy=$.proxy,POPUP="kendoPopup",INIT="init",NS=".kendoFilterMenu",EQ="Is equal to",NEQ="Is not equal to",roles={number:"numerictextbox",date:"datepicker"},mobileRoles={string:"text",number:"number",date:"date"},isFunction=kendo.isFunction,Widget=ui.Widget,booleanTemplate='<div><div class="k-filter-help-text">#=messages.info#</div><label><input type="radio" data-#=ns#bind="checked: filters[0].value" value="true" name="filters[0].value"/>#=messages.isTrue#</label><label><input type="radio" data-#=ns#bind="checked: filters[0].value" value="false" name="filters[0].value"/>#=messages.isFalse#</label><div><button type="submit" class="k-button">#=messages.filter#</button><button type="reset" class="k-button">#=messages.clear#</button></div></div>',defaultTemplate='<div><div class="k-filter-help-text">#=messages.info#</div><select data-#=ns#bind="value: filters[0].operator" data-#=ns#role="dropdownlist">#for(var op in operators){#<option value="#=op#">#=operators[op]#</option>#}#</select>#if(values){#<select data-#=ns#bind="value:filters[0].value" data-#=ns#text-field="text" data-#=ns#value-field="value" data-#=ns#source=\'#=kendo.stringify(values).replace(/\'/g,"&\\#39;")#\' data-#=ns#role="dropdownlist" data-#=ns#option-label="#=messages.selectValue#"></select>#}else{#<input data-#=ns#bind="value:filters[0].value" class="k-textbox" type="text" #=role ? "data-" + ns + "role=\'" + role + "\'" : ""# />#}##if(extra){#<select class="k-filter-and" data-#=ns#bind="value: logic" data-#=ns#role="dropdownlist"><option value="and">#=messages.and#</option><option value="or">#=messages.or#</option></select><select data-#=ns#bind="value: filters[1].operator" data-#=ns#role="dropdownlist">#for(var op in operators){#<option value="#=op#">#=operators[op]#</option>#}#</select>#if(values){#<select data-#=ns#bind="value:filters[1].value" data-#=ns#text-field="text" data-#=ns#value-field="value" data-#=ns#source=\'#=kendo.stringify(values).replace(/\'/g,"&\\#39;")#\' data-#=ns#role="dropdownlist" data-#=ns#option-label="#=messages.selectValue#"></select>#}else{#<input data-#=ns#bind="value: filters[1].value" class="k-textbox" type="text" #=role ? "data-" + ns + "role=\'" + role + "\'" : ""#/>#}##}#<div><button type="submit" class="k-button k-primary">#=messages.filter#</button><button type="reset" class="k-button">#=messages.clear#</button></div></div>',defaultMobileTemplate='<div data-#=ns#role="view" data-#=ns#init-widgets="false" class="k-grid-filter-menu"><div data-#=ns#role="header" class="k-header"><button class="k-button k-cancel">#=messages.cancel#</button>#=field#<button type="submit" class="k-button k-submit">#=messages.filter#</button></div><form class="k-filter-menu k-mobile-list"><ul class="k-filter-help-text"><li><span class="k-link">#=messages.info#</span><ul><li class="k-item"><label class="k-label">#=messages.operator#<select data-#=ns#bind="value: filters[0].operator">#for(var op in operators){#<option value="#=op#">#=operators[op]#</option>#}#</select></label></li><li class="k-item"><label class="k-label">#=messages.value##if(values){#<select data-#=ns#bind="value:filters[0].value"><option value="">#=messages.selectValue#</option>#for(var val in values){#<option value="#=values[val].value#">#=values[val].text#</option>#}#</select>#}else{#<input data-#=ns#bind="value:filters[0].value" class="k-textbox" type="#=inputType#" #=useRole ? "data-" + ns + "role=\'" + role + "\'" : ""# />#}#</label></li>#if(extra){#</ul><ul class="k-filter-help-text"><li><span class="k-link"></span><li class="k-item"><label class="k-label"><input type="radio" name="logic" class="k-check" data-#=ns#bind="checked: logic" value="and" />#=messages.and#</label></li><li class="k-item"><label class="k-label"><input type="radio" name="logic" class="k-check" data-#=ns#bind="checked: logic" value="or" />#=messages.or#</label></li></ul><ul class="k-filter-help-text"><li><span class="k-link"></span><li class="k-item"><label class="k-label">#=messages.operator#<select data-#=ns#bind="value: filters[1].operator">#for(var op in operators){#<option value="#=op#">#=operators[op]#</option>#}#</select></label></li><li class="k-item"><label class="k-label">#=messages.value##if(values){#<select data-#=ns#bind="value:filters[1].value"><option value="">#=messages.selectValue#</option>#for(var val in values){#<option value="#=values[val].value#">#=values[val].text#</option>#}#</select>#}else{#<input data-#=ns#bind="value:filters[1].value" class="k-textbox" type="#=inputType#" #=useRole ? "data-" + ns + "role=\'" + role + "\'" : ""# />#}#</label></li>#}#</ul></li><li class="k-button-container"><button type="reset" class="k-button">#=messages.clear#</button></li></ul></div></form></div>',booleanMobileTemplate='<div data-#=ns#role="view" data-#=ns#init-widgets="false" class="k-grid-filter-menu"><div data-#=ns#role="header" class="k-header"><button class="k-button k-cancel">#=messages.cancel#</button>#=field#<button type="submit" class="k-button k-submit">#=messages.filter#</button></div><form class="k-filter-menu k-mobile-list"><ul class="k-filter-help-text"><li><span class="k-link">#=messages.info#</span><ul><li class="k-item"><label class="k-label"><input class="k-check" type="radio" data-#=ns#bind="checked: filters[0].value" value="true" name="filters[0].value"/>#=messages.isTrue#</label></li><li class="k-item"><label class="k-label"><input class="k-check" type="radio" data-#=ns#bind="checked: filters[0].value" value="false" name="filters[0].value"/>#=messages.isFalse#</label></li></ul></li><li class="k-button-container"><button type="reset" class="k-button">#=messages.clear#</button></li></ul></form></div>',FilterMenu=Widget.extend({init:function(element,options){var operators,initial,link,field,that=this,type="string";Widget.fn.init.call(that,element,options),operators=that.operators=options.operators||{},element=that.element,options=that.options,options.appendToElement||(link=element.addClass("k-with-icon k-filterable").find(".k-grid-filter"),link[0]||(link=element.prepend('<a class="k-grid-filter" href="#"><span class="k-icon k-filter"/></a>').find(".k-grid-filter")),link.attr("tabindex",-1).on("click"+NS,proxy(that._click,that))),that.link=link||$(),that.dataSource=options.dataSource,that.field=options.field||element.attr(kendo.attr("field")),that.model=that.dataSource.reader.model,that._parse=function(value){return value+""},that.model&&that.model.fields&&(field=that.model.fields[that.field],field&&(type=field.type||"string",field.parse&&(that._parse=proxy(field.parse,field)))),options.values&&(type="enums"),that.type=type,operators=operators[type]||options.operators[type];for(initial in operators)break;that._defaultFilter=function(){return{field:that.field,operator:initial||"eq",value:""}},that._refreshHandler=proxy(that.refresh,that),that.dataSource.bind("change",that._refreshHandler),options.appendToElement?that._init():that.refresh()},_init:function(){var role,that=this,ui=that.options.ui,setUI=isFunction(ui);that.pane=that.options.pane,that.pane&&(that._isMobile=!0),setUI||(role=ui||roles[that.type]),that._isMobile?that._createMobileForm(role):that._createForm(role),that.form.on("submit"+NS,proxy(that._submit,that)).on("reset"+NS,proxy(that._reset,that)),setUI&&that.form.find(".k-textbox").removeClass("k-textbox").each(function(){ui($(this))}),that.form.find("["+kendo.attr("role")+"=numerictextbox]").removeClass("k-textbox").end().find("["+kendo.attr("role")+"=datetimepicker]").removeClass("k-textbox").end().find("["+kendo.attr("role")+"=timepicker]").removeClass("k-textbox").end().find("["+kendo.attr("role")+"=datepicker]").removeClass("k-textbox"),that.refresh(),that.trigger(INIT,{field:that.field,container:that.form})},_createForm:function(role){var that=this,options=that.options,operators=that.operators||{},type=that.type;operators=operators[type]||options.operators[type],that.form=$('<form class="k-filter-menu"/>').html(kendo.template("boolean"===type?booleanTemplate:defaultTemplate)({field:that.field,format:options.format,ns:kendo.ns,messages:options.messages,extra:options.extra,operators:operators,type:type,role:role,values:convertItems(options.values)})),options.appendToElement?(that.element.append(that.form),that.popup=that.element.closest(".k-popup").data(POPUP)):that.popup=that.form[POPUP]({anchor:that.link,open:proxy(that._open,that),activate:proxy(that._activate,that),close:function(){that.options.closeCallback&&that.options.closeCallback(that.element)}}).data(POPUP),that.form.on("keydown"+NS,proxy(that._keydown,that))},_createMobileForm:function(role){var that=this,options=that.options,operators=that.operators||{},type=that.type;operators=operators[type]||options.operators[type],that.form=$("<div />").html(kendo.template("boolean"===type?booleanMobileTemplate:defaultMobileTemplate)({field:that.field,format:options.format,ns:kendo.ns,messages:options.messages,extra:options.extra,operators:operators,type:type,role:role,useRole:!kendo.support.input.date&&"date"===type||"number"===type,inputType:mobileRoles[type],values:convertItems(options.values)})),that.view=that.pane.append(that.form.html()),that.form=that.view.element.find("form"),that.view.element.on("click",".k-submit",function(e){that.form.submit(),e.preventDefault()}).on("click",".k-cancel",function(e){that._closeForm(),e.preventDefault()})},refresh:function(){var that=this,expression=that.dataSource.filter()||{filters:[],logic:"and"};that.filterModel=kendo.observable({logic:"and",filters:[that._defaultFilter(),that._defaultFilter()]}),that.form&&kendo.bind(that.form.children().first(),that.filterModel),that._bind(expression)?that.link.addClass("k-state-active"):that.link.removeClass("k-state-active")},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.form&&(kendo.unbind(that.form),kendo.destroy(that.form),that.form.unbind(NS),that.popup&&(that.popup.destroy(),that.popup=null),that.form=null),that.view&&(that.view.purge(),that.view=null),that.link.unbind(NS),that._refreshHandler&&(that.dataSource.unbind("change",that._refreshHandler),that.dataSource=null),that.element=that.link=that._refreshHandler=that.filterModel=null},_bind:function(expression){var idx,length,currentFilter,filter,that=this,filters=expression.filters,found=!1,current=0,filterModel=that.filterModel;for(idx=0,length=filters.length;idx<length;idx++)filter=filters[idx],filter.field==that.field?(filterModel.set("logic",expression.logic),currentFilter=filterModel.filters[current],currentFilter||(filterModel.filters.push({field:that.field}),currentFilter=filterModel.filters[current]),currentFilter.set("value",that._parse(filter.value)),currentFilter.set("operator",filter.operator),current++,found=!0):filter.filters&&(found=found||that._bind(filter));return found},_merge:function(expression){var filter,idx,length,that=this,logic=expression.logic||"and",filters=expression.filters,result=that.dataSource.filter()||{filters:[],logic:"and"};for(removeFiltersForField(result,that.field),filters=$.grep(filters,function(filter){return""!==filter.value&&null!=filter.value}),idx=0,length=filters.length;idx<length;idx++)filter=filters[idx],filter.value=that._parse(filter.value);return filters.length&&(result.filters.length?(expression.filters=filters,"and"!==result.logic&&(result.filters=[{logic:result.logic,filters:result.filters}],result.logic="and"),filters.length>1?result.filters.push(expression):result.filters.push(filters[0])):(result.filters=filters,result.logic=logic)),result},filter:function(expression){expression=this._merge(expression),expression.filters.length&&this.dataSource.filter(expression)},clear:function(){var that=this,expression=that.dataSource.filter()||{filters:[]};expression.filters=$.grep(expression.filters,function(filter){return filter.filters?(filter.filters=clearFilter(filter.filters,that.field),filter.filters.length):filter.field!=that.field}),expression.filters.length||(expression=null),that.dataSource.filter(expression)},_submit:function(e){e.preventDefault(),e.stopPropagation(),this.filter(this.filterModel.toJSON()),this._closeForm()},_reset:function(){this.clear(),this._closeForm()},_closeForm:function(){this._isMobile?this.pane.navigate("",this.options.animations.right):this.popup.close()},_click:function(e){e.preventDefault(),e.stopPropagation(),this.popup||this.pane||this._init(),this._isMobile?this.pane.navigate(this.view,this.options.animations.left):this.popup.toggle()},_open:function(){var popup;$(".k-filter-menu").not(this.form).each(function(){popup=$(this).data(POPUP),popup&&popup.close()})},_activate:function(){this.form.find(":kendoFocusable:first").focus()},_keydown:function(e){e.keyCode==kendo.keys.ESC&&this.popup.close()},events:[INIT],options:{name:"FilterMenu",extra:!0,appendToElement:!1,type:"string",operators:{string:{eq:EQ,neq:NEQ,startswith:"Starts with",contains:"Contains",doesnotcontain:"Does not contain",endswith:"Ends with"},number:{eq:EQ,neq:NEQ,gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"},date:{eq:EQ,neq:NEQ,gte:"Is after or equal to",gt:"Is after",lte:"Is before or equal to",lt:"Is before"},enums:{eq:EQ,neq:NEQ}},messages:{info:"Show items with value that:",isTrue:"is true",isFalse:"is false",filter:"Filter",clear:"Clear",and:"And",or:"Or",selectValue:"-Select value-",operator:"Operator",value:"Value",cancel:"Cancel"},animations:{left:"slide",right:"slide:right"}}});ui.plugin(FilterMenu)}(window.kendo.jQuery),function($,undefined){function getEffectDirection(direction,root){return direction=direction.split(" ")[!root+0]||direction,direction.replace("top","up").replace("bottom","down")}function parseDirection(direction,root,isRtl){direction=direction.split(" ")[!root+0]||direction;var output={origin:["bottom",isRtl?"right":"left"],position:["top",isRtl?"right":"left"]},horizontal=/left|right/.test(direction);return horizontal?(output.origin=["top",direction],output.position[1]=kendo.directions[direction].reverse):(output.origin[0]=direction,output.position[0]=kendo.directions[direction].reverse),output.origin=output.origin.join(" "),output.position=output.position.join(" "),output}function contains(parent,child){try{return $.contains(parent,child)}catch(e){return!1}}function updateItemClasses(item){item=$(item),item.addClass("k-item").children(IMG).addClass(IMAGE),item.children("a").addClass(LINK).children(IMG).addClass(IMAGE),item.filter(":not([disabled])").addClass(DEFAULTSTATE),item.filter(".k-separator:empty").append("&nbsp;"),item.filter("li[disabled]").addClass(DISABLEDSTATE).removeAttr("disabled").attr("aria-disabled",!0),item.filter("[role]").length||item.attr("role","menuitem"),item.children("."+LINK).length||item.contents().filter(function(){return!(this.nodeName.match(excludedNodesRegExp)||3==this.nodeType&&!$.trim(this.nodeValue))}).wrapAll("<span class='"+LINK+"'/>"),updateArrow(item),updateFirstLast(item)}function updateArrow(item){item=$(item),item.find("> .k-link > [class*=k-i-arrow]:not(.k-sprite)").remove(),item.filter(":has(.k-group)").children(".k-link:not(:has([class*=k-i-arrow]:not(.k-sprite)))").each(function(){var item=$(this),parent=item.parent().parent();item.append("<span class='k-icon "+(parent.hasClass(MENU+"-horizontal")?"k-i-arrow-s":"k-i-arrow-e")+"'/>")})}function updateFirstLast(item){item=$(item),item.filter(".k-first:not(:first-child)").removeClass(FIRST),item.filter(".k-last:not(:last-child)").removeClass(LAST),item.filter(":first-child").addClass(FIRST),item.filter(":last-child").addClass(LAST)}var kendo=window.kendo,ui=kendo.ui,activeElement=kendo._activeElement,touch=kendo.support.touch&&kendo.support.mobileOS,MOUSEDOWN="mousedown",CLICK="click",extend=$.extend,proxy=$.proxy,each=$.each,template=kendo.template,keys=kendo.keys,Widget=ui.Widget,excludedNodesRegExp=/^(ul|a|div)$/i,NS=".kendoMenu",IMG="img",OPEN="open",MENU="k-menu",LINK="k-link",LAST="k-last",CLOSE="close",TIMER="timer",FIRST="k-first",IMAGE="k-image",SELECT="select",ZINDEX="zIndex",ACTIVATE="activate",DEACTIVATE="deactivate",POINTERDOWN="touchstart"+NS+" MSPointerDown"+NS+" pointerdown"+NS,pointers=kendo.support.pointers,msPointers=kendo.support.msPointers,MOUSEENTER=pointers?"pointerover":msPointers?"MSPointerOver":"mouseenter",MOUSELEAVE=pointers?"pointerout":msPointers?"MSPointerOut":"mouseleave",mobile=touch||msPointers||pointers,KENDOPOPUP="kendoPopup",DEFAULTSTATE="k-state-default",HOVERSTATE="k-state-hover",FOCUSEDSTATE="k-state-focused",DISABLEDSTATE="k-state-disabled",groupSelector=".k-group",popupSelector=groupSelector+",.k-animation-container",allItemsSelector=":not(.k-list) > .k-item",disabledSelector=".k-item.k-state-disabled",itemSelector=".k-item:not(.k-state-disabled)",linkSelector=".k-item:not(.k-state-disabled) > .k-link",exclusionSelector=":not(.k-item.k-separator)",nextSelector=exclusionSelector+":eq(0)",lastSelector=exclusionSelector+":last",templateSelector="div:not(.k-animation-container,.k-list-container)",templates={content:template("<div class='k-content k-group' tabindex='-1'>#= content(item) #</div>"),group:template("<ul class='#= groupCssClass(group) #'#= groupAttributes(group) # role='menu' aria-hidden='true'>#= renderItems(data) #</ul>"),itemWrapper:template("<#= tag(item) # class='#= textClass(item) #'#= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) ##= arrow(data) #</#= tag(item) #>"),item:template("<li class='#= wrapperCssClass(group, item) #' role='menuitem' #=item.items ? \"aria-haspopup='true'\": \"\"##=item.enabled === false ? \"aria-disabled='true'\" : ''#>#= itemWrapper(data) ## if (item.items) { ##= subGroup({ items: item.items, menu: menu, group: { expanded: item.expanded } }) ## } else if (item.content || item.contentUrl) { ##= renderContent(data) ## } #</li>"),image:template("<img class='k-image' alt='' src='#= imageUrl #' />"),arrow:template("<span class='#= arrowClass(item, group) #'></span>"),sprite:template("<span class='k-sprite #= spriteCssClass #'></span>"),empty:template("")},rendering={wrapperCssClass:function(group,item){var result="k-item",index=item.index;return result+=item.enabled===!1?" k-state-disabled":" k-state-default",group.firstLevel&&0===index&&(result+=" k-first"),index==group.length-1&&(result+=" k-last"),item.cssClass&&(result+=" "+item.cssClass),result},textClass:function(){return LINK},textAttributes:function(item){return item.url?" href='"+item.url+"'":""},arrowClass:function(item,group){var result="k-icon";return result+=group.horizontal?" k-i-arrow-s":" k-i-arrow-e"},text:function(item){return item.encoded===!1?item.text:kendo.htmlEncode(item.text)},tag:function(item){return item.url?"a":"span"},groupAttributes:function(group){return group.expanded!==!0?" style='display:none'":""},groupCssClass:function(){return"k-group"},content:function(item){return item.content?item.content:"&nbsp;"}},Menu=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),element=that.wrapper=that.element,options=that.options,that._initData(options),that._updateClasses(),that._animations(options),that.nextItemZIndex=100,that._tabindex(),that._focusProxy=proxy(that._focusHandler,that),element.on(POINTERDOWN,that._focusProxy).on(CLICK+NS,disabledSelector,!1).on(CLICK+NS,itemSelector,proxy(that._click,that)).on("keydown"+NS,proxy(that._keydown,that)).on("focus"+NS,proxy(that._focus,that)).on("focus"+NS,".k-content",proxy(that._focus,that)).on(POINTERDOWN+" "+MOUSEDOWN+NS,".k-content",proxy(that._preventClose,that)).on("blur"+NS,proxy(that._removeHoverItem,that)).on("blur"+NS,"[tabindex]",proxy(that._checkActiveElement,that)).on(MOUSEENTER+NS,itemSelector,proxy(that._mouseenter,that)).on(MOUSELEAVE+NS,itemSelector,proxy(that._mouseleave,that)).on(MOUSEENTER+NS+" "+MOUSELEAVE+NS+" "+MOUSEDOWN+NS+" "+CLICK+NS,linkSelector,proxy(that._toggleHover,that)),options.openOnClick&&(that.clicked=!1,that._documentClickHandler=proxy(that._documentClick,that),$(document).click(that._documentClickHandler)),element.attr("role","menubar"),element[0].id&&(that._ariaId=kendo.format("{0}_mn_active",element[0].id)),kendo.notify(that)},events:[OPEN,CLOSE,ACTIVATE,DEACTIVATE,SELECT],options:{name:"Menu",animation:{open:{duration:200},close:{duration:100}},orientation:"horizontal",direction:"default",openOnClick:!1,closeOnClick:!0,hoverDelay:100,popupCollision:undefined},_initData:function(options){var that=this;options.dataSource&&(that.element.empty(),that.append(options.dataSource,that.element))},setOptions:function(options){var animation=this.options.animation;this._animations(options),options.animation=extend(!0,animation,options.animation),"dataSource"in options&&this._initData(options),Widget.fn.setOptions.call(this,options)},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.element.off(NS),that._documentClickHandler&&$(document).unbind("click",that._documentClickHandler),
kendo.destroy(that.element)},enable:function(element,enable){return this._toggleDisabled(element,enable!==!1),this},disable:function(element){return this._toggleDisabled(element,!1),this},append:function(item,referenceItem){referenceItem=this.element.find(referenceItem);var inserted=this._insert(item,referenceItem,referenceItem.length?referenceItem.find("> .k-group, > .k-animation-container > .k-group"):null);return each(inserted.items,function(){inserted.group.append(this),updateArrow(this)}),updateArrow(referenceItem),updateFirstLast(inserted.group.find(".k-first, .k-last").add(inserted.items)),this},insertBefore:function(item,referenceItem){referenceItem=this.element.find(referenceItem);var inserted=this._insert(item,referenceItem,referenceItem.parent());return each(inserted.items,function(){referenceItem.before(this),updateArrow(this),updateFirstLast(this)}),updateFirstLast(referenceItem),this},insertAfter:function(item,referenceItem){referenceItem=this.element.find(referenceItem);var inserted=this._insert(item,referenceItem,referenceItem.parent());return each(inserted.items,function(){referenceItem.after(this),updateArrow(this),updateFirstLast(this)}),updateFirstLast(referenceItem),this},_insert:function(item,referenceItem,parent){var items,groups,that=this;referenceItem&&referenceItem.length||(parent=that.element);var plain=$.isPlainObject(item),groupData={firstLevel:parent.hasClass(MENU),horizontal:parent.hasClass(MENU+"-horizontal"),expanded:!0,length:parent.children().length};return referenceItem&&!parent.length&&(parent=$(Menu.renderGroup({group:groupData})).appendTo(referenceItem)),plain||$.isArray(item)?items=$($.map(plain?[item]:item,function(value,idx){return"string"==typeof value?$(value).get():$(Menu.renderItem({group:groupData,item:extend(value,{index:idx})})).get()})):(items="string"==typeof item&&"<"!=item[0]?that.element.find(item):$(item),groups=items.find("> ul").addClass("k-group").attr("role","menu"),items=items.filter("li"),items.add(groups.find("> li")).each(function(){updateItemClasses(this)})),{items:items,group:parent}},remove:function(element){element=this.element.find(element);var that=this,parent=element.parentsUntil(that.element,allItemsSelector),group=element.parent("ul:not(.k-menu)");if(element.remove(),group&&!group.children(allItemsSelector).length){var container=group.parent(".k-animation-container");container.length?container.remove():group.remove()}return parent.length&&(parent=parent.eq(0),updateArrow(parent),updateFirstLast(parent)),that},open:function(element){var that=this,options=that.options,horizontal="horizontal"==options.orientation,direction=options.direction,isRtl=kendo.support.isRtl(that.wrapper);return element=that.element.find(element),/^(top|bottom|default)$/.test(direction)&&(direction=isRtl?horizontal?(direction+" left").replace("default","bottom"):"left":horizontal?(direction+" right").replace("default","bottom"):"right"),element.siblings().find(">.k-popup:visible,>.k-animation-container>.k-popup:visible").each(function(){var popup=$(this).data("kendoPopup");popup&&popup.close()}),element.each(function(){var li=$(this);clearTimeout(li.data(TIMER)),li.data(TIMER,setTimeout(function(){var popup,ul=li.find(".k-group:first:hidden");if(ul[0]&&that.trigger(OPEN,{item:li[0]})===!1){if(!ul.find(".k-group")[0]&&ul.children(".k-item").length>1){var windowHeight=$(window).height(),setScrolling=function(){ul.css({maxHeight:windowHeight-(ul.outerHeight()-ul.height())-kendo.getShadows(ul).bottom,overflow:"auto"})};kendo.support.browser.msie&&kendo.support.browser.version<=7?setTimeout(setScrolling,0):setScrolling()}else ul.css({maxHeight:"",overflow:""});li.data(ZINDEX,li.css(ZINDEX)),li.css(ZINDEX,that.nextItemZIndex++),popup=ul.data(KENDOPOPUP);var root=li.parent().hasClass(MENU),parentHorizontal=root&&horizontal,directions=parseDirection(direction,root,isRtl),effects=options.animation.open.effects,openEffects=effects!==undefined?effects:"slideIn:"+getEffectDirection(direction,root);popup?(popup=ul.data(KENDOPOPUP),popup.options.origin=directions.origin,popup.options.position=directions.position,popup.options.animation.open.effects=openEffects):popup=ul.kendoPopup({activate:function(){that.trigger(ACTIVATE,{item:this.wrapper.parent()})},deactivate:function(){that.trigger(DEACTIVATE,{item:this.wrapper.parent()})},origin:directions.origin,position:directions.position,collision:options.popupCollision!==undefined?options.popupCollision:parentHorizontal?"fit":"fit flip",anchor:li,appendTo:li,animation:{open:extend(!0,{effects:openEffects},options.animation.open),close:options.animation.close},close:function(e){var li=e.sender.wrapper.parent();that.trigger(CLOSE,{item:li[0]})?e.preventDefault():(li.css(ZINDEX,li.data(ZINDEX)),li.removeData(ZINDEX),mobile&&(li.removeClass(HOVERSTATE),that._removeHoverItem()))}}).data(KENDOPOPUP),ul.removeAttr("aria-hidden"),popup.open()}},that.options.hoverDelay))}),that},close:function(items,dontClearClose){var that=this,element=that.element;return items=element.find(items),items.length||(items=element.find(">.k-item")),items.each(function(){var li=$(this);!dontClearClose&&that._isRootItem(li)&&(that.clicked=!1),clearTimeout(li.data(TIMER)),li.data(TIMER,setTimeout(function(){var popup=li.find(".k-group:not(.k-list-container):not(.k-calendar-container):first:visible").data(KENDOPOPUP);popup&&(popup.close(),popup.element.attr("aria-hidden",!0))},that.options.hoverDelay))}),that},_toggleDisabled:function(items,enable){this.element.find(items).each(function(){$(this).toggleClass(DEFAULTSTATE,enable).toggleClass(DISABLEDSTATE,!enable).attr("aria-disabled",!enable)})},_toggleHover:function(e){var target=$(kendo.eventTarget(e)||e.target).closest(allItemsSelector),isEnter=e.type==MOUSEENTER||MOUSEDOWN.indexOf(e.type)!==-1;target.parents("li."+DISABLEDSTATE).length||target.toggleClass(HOVERSTATE,isEnter||"mousedown"==e.type||"click"==e.type),this._removeHoverItem()},_preventClose:function(){this.options.closeOnClick||(this._closurePrevented=!0)},_checkActiveElement:function(e){var that=this,hoverItem=$(e?e.currentTarget:this._hoverItem()),target=that._findRootParent(hoverItem)[0];this._closurePrevented||setTimeout(function(){document.hasFocus()&&(contains(target,kendo._activeElement())||!e||contains(target,e.currentTarget))||that.close(target)},0),this._closurePrevented=!1},_removeHoverItem:function(){var oldHoverItem=this._hoverItem();oldHoverItem&&oldHoverItem.hasClass(FOCUSEDSTATE)&&(oldHoverItem.removeClass(FOCUSEDSTATE),this._oldHoverItem=null)},_updateClasses:function(){var items,element=this.element;element.addClass("k-widget k-reset k-header "+MENU).addClass(MENU+"-"+this.options.orientation),element.find("li > ul").addClass("k-group").attr("role","menu").attr("aria-hidden",element.is(":visible")).end().find("li > div").addClass("k-content").attr("tabindex","-1"),items=element.find("> li,.k-group > li"),items.each(function(){updateItemClasses(this)})},_mouseenter:function(e){var that=this,element=$(e.currentTarget),hasChildren=element.children(".k-animation-container").length||element.children(groupSelector).length;e.delegateTarget==element.parents(".k-menu")[0]&&(that.options.openOnClick&&!that.clicked||touch||!contains(e.currentTarget,e.relatedTarget)&&hasChildren&&that.open(element),(that.options.openOnClick&&that.clicked||mobile)&&element.siblings().each(proxy(function(_,sibling){that.close(sibling,!0)},that)))},_mouseleave:function(e){var that=this,element=$(e.currentTarget),hasChildren=element.children(".k-animation-container").length||element.children(groupSelector).length;return element.parentsUntil(".k-animation-container",".k-list-container,.k-calendar-container")[0]?void e.stopImmediatePropagation():void(that.options.openOnClick||touch||(pointers||msPointers)&&e.originalEvent.pointerType==e.originalEvent.MSPOINTER_TYPE_TOUCH||contains(e.currentTarget,e.relatedTarget||e.target)||!hasChildren||contains(e.currentTarget,kendo._activeElement())||that.close(element))},_click:function(e){var openHandle,childGroup,childGroupVisible,that=this,options=that.options,target=$(kendo.eventTarget(e)),nodeName=target[0]?target[0].nodeName.toUpperCase():"",formNode="INPUT"==nodeName||"SELECT"==nodeName||"BUTTON"==nodeName||"LABEL"==nodeName,link=target.closest("."+LINK),element=target.closest(allItemsSelector),href=link.attr("href"),targetHref=target.attr("href"),sampleHref=$("<a href='#' />").attr("href"),isLink=!!href&&href!==sampleHref,isTargetLink=!!targetHref&&targetHref!==sampleHref;if(options.openOnClick||!element.children(templateSelector)[0]){if(element.hasClass(DISABLEDSTATE))return void e.preventDefault();if(e.handled||!that.trigger(SELECT,{item:element[0]})||formNode||e.preventDefault(),e.handled=!0,childGroup=element.children(popupSelector),childGroupVisible=childGroup.is(":visible"),options.closeOnClick&&!isLink&&(!childGroup.length||options.openOnClick&&childGroupVisible))return element.removeClass(HOVERSTATE).css("height"),that._oldHoverItem=that._findRootParent(element),that.close(link.parentsUntil(that.element,allItemsSelector)),that.clicked=!1,void("MSPointerUp".indexOf(e.type)!=-1&&e.preventDefault());isLink&&e.enterKey&&link[0].click(),(element.parent().hasClass(MENU)&&options.openOnClick||kendo.support.touch)&&(isLink||formNode||isTargetLink||e.preventDefault(),that.clicked=!0,openHandle=childGroup.is(":visible")?CLOSE:OPEN,(options.closeOnClick||openHandle!=CLOSE)&&that[openHandle](element))}},_documentClick:function(e){contains(this.element[0],e.target)||(this.clicked=!1)},_focus:function(e){var that=this,target=e.target,hoverItem=that._hoverItem(),active=activeElement();return target==that.wrapper[0]||$(target).is(":kendoFocusable")?void(active===e.currentTarget&&(hoverItem.length?that._moveHover([],hoverItem):that._oldHoverItem||that._moveHover([],that.wrapper.children().first()))):(e.stopPropagation(),$(target).closest(".k-content").closest(".k-group").closest(".k-item").addClass(FOCUSEDSTATE),void that.wrapper.focus())},_keydown:function(e){var target,belongsToVertical,hasChildren,that=this,key=e.keyCode,hoverItem=that._oldHoverItem,isRtl=kendo.support.isRtl(that.wrapper);if(e.target==e.currentTarget||key==keys.ESC){if(hoverItem||(hoverItem=that._oldHoverItem=that._hoverItem()),belongsToVertical=that._itemBelongsToVertival(hoverItem),hasChildren=that._itemHasChildren(hoverItem),key==keys.RIGHT)target=that[isRtl?"_itemLeft":"_itemRight"](hoverItem,belongsToVertical,hasChildren);else if(key==keys.LEFT)target=that[isRtl?"_itemRight":"_itemLeft"](hoverItem,belongsToVertical,hasChildren);else if(key==keys.DOWN)target=that._itemDown(hoverItem,belongsToVertical,hasChildren);else if(key==keys.UP)target=that._itemUp(hoverItem,belongsToVertical,hasChildren);else if(key==keys.ESC)target=that._itemEsc(hoverItem,belongsToVertical);else if(key==keys.ENTER||key==keys.SPACEBAR)target=hoverItem.children(".k-link"),target.length>0&&(that._click({target:target[0],preventDefault:function(){},enterKey:!0}),that._moveHover(hoverItem,that._findRootParent(hoverItem)));else if(key==keys.TAB)return target=that._findRootParent(hoverItem),that._moveHover(hoverItem,target),void that._checkActiveElement();target&&target[0]&&(e.preventDefault(),e.stopPropagation())}},_hoverItem:function(){return this.wrapper.find(".k-item.k-state-hover,.k-item.k-state-focused").filter(":visible")},_itemBelongsToVertival:function(item){var menuIsVertical=this.wrapper.hasClass("k-menu-vertical");return item.length?item.parent().hasClass("k-group")||menuIsVertical:menuIsVertical},_itemHasChildren:function(item){return!!item.length&&item.children("ul.k-group, div.k-animation-container").length>0},_moveHover:function(item,nextItem){var that=this,id=that._ariaId;item.length&&nextItem.length&&item.removeClass(FOCUSEDSTATE),nextItem.length&&(nextItem[0].id&&(id=nextItem[0].id),nextItem.addClass(FOCUSEDSTATE),that._oldHoverItem=nextItem,id&&(that.element.removeAttr("aria-activedescendant"),$("#"+id).removeAttr("id"),nextItem.attr("id",id),that.element.attr("aria-activedescendant",id)))},_findRootParent:function(item){return item.parent().hasClass("k-menu")?item:item.parentsUntil(".k-menu","li.k-item").last()},_isRootItem:function(item){return item.parent().hasClass("k-menu")},_itemRight:function(item,belongsToVertical,hasChildren){var nextItem,parentItem,that=this;if(!item.hasClass(DISABLEDSTATE))return belongsToVertical?hasChildren?(that.open(item),nextItem=item.find(".k-group").children().first()):"horizontal"==that.options.orientation&&(parentItem=that._findRootParent(item),that.close(parentItem),nextItem=parentItem.nextAll(nextSelector)):(nextItem=item.nextAll(nextSelector),nextItem.length||(nextItem=item.prevAll(lastSelector))),nextItem&&!nextItem.length?nextItem=that.wrapper.children(".k-item").first():nextItem||(nextItem=[]),that._moveHover(item,nextItem),nextItem},_itemLeft:function(item,belongsToVertical){var nextItem,that=this;return belongsToVertical?(nextItem=item.parent().closest(".k-item"),that.close(nextItem),that._isRootItem(nextItem)&&"horizontal"==that.options.orientation&&(nextItem=nextItem.prevAll(nextSelector))):(nextItem=item.prevAll(nextSelector),nextItem.length||(nextItem=item.nextAll(lastSelector))),nextItem.length||(nextItem=that.wrapper.children(".k-item").last()),that._moveHover(item,nextItem),nextItem},_itemDown:function(item,belongsToVertical,hasChildren){var nextItem,that=this;if(belongsToVertical)nextItem=item.nextAll(nextSelector);else{if(!hasChildren||item.hasClass(DISABLEDSTATE))return;that.open(item),nextItem=item.find(".k-group").children().first()}return!nextItem.length&&item.length?nextItem=item.parent().children().first():item.length||(nextItem=that.wrapper.children(".k-item").first()),that._moveHover(item,nextItem),nextItem},_itemUp:function(item,belongsToVertical){var nextItem,that=this;if(belongsToVertical)return nextItem=item.prevAll(nextSelector),!nextItem.length&&item.length?nextItem=item.parent().children().last():item.length||(nextItem=that.wrapper.children(".k-item").last()),that._moveHover(item,nextItem),nextItem},_itemEsc:function(item,belongsToVertical){var nextItem,that=this;return belongsToVertical?(nextItem=item.parent().closest(".k-item"),that.close(nextItem),that._moveHover(item,nextItem),nextItem):item},_focusHandler:function(e){var that=this,item=$(kendo.eventTarget(e)).closest(allItemsSelector);setTimeout(function(){that._moveHover([],item),item.children(".k-content")[0]&&item.parent().closest(".k-item").removeClass(FOCUSEDSTATE)},200)},_animations:function(options){options&&"animation"in options&&!options.animation&&(options.animation={open:{effects:{}},close:{hide:!0,effects:{}}})}});extend(Menu,{renderItem:function(options){options=extend({menu:{},group:{}},options);var empty=templates.empty,item=options.item;return templates.item(extend(options,{image:item.imageUrl?templates.image:empty,sprite:item.spriteCssClass?templates.sprite:empty,itemWrapper:templates.itemWrapper,renderContent:Menu.renderContent,arrow:item.items||item.content?templates.arrow:empty,subGroup:Menu.renderGroup},rendering))},renderGroup:function(options){return templates.group(extend({renderItems:function(options){for(var html="",i=0,items=options.items,len=items?items.length:0,group=extend({length:len},options.group);i<len;i++)html+=Menu.renderItem(extend(options,{group:group,item:extend({index:i},items[i])}));return html}},options,rendering))},renderContent:function(options){return templates.content(extend(options,rendering))}}),kendo.ui.plugin(Menu)}(window.kendo.jQuery),function($,undefined){function trim(text){return $.trim(text).replace(/&nbsp;/gi,"")}function toHash(arr,key){var idx,len,current,result={};for(idx=0,len=arr.length;idx<len;idx++)current=arr[idx],result[current[key]]=current;return result}var kendo=window.kendo,ui=kendo.ui,proxy=$.proxy,extend=$.extend,grep=$.grep,map=$.map,inArray=$.inArray,ACTIVE="k-state-selected",ASC="asc",DESC="desc",CHANGE="change",INIT="init",SELECT="select",POPUP="kendoPopup",FILTERMENU="kendoFilterMenu",MENU="kendoMenu",NS=".kendoColumnMenu",Widget=ui.Widget,ColumnMenu=Widget.extend({init:function(element,options){var link,that=this;Widget.fn.init.call(that,element,options),element=that.element,options=that.options,that.owner=options.owner,that.dataSource=options.dataSource,that.field=element.attr(kendo.attr("field")),link=element.find(".k-header-column-menu"),link[0]||(link=element.addClass("k-with-icon").prepend('<a class="k-header-column-menu" href="#"><span class="k-icon k-i-arrowhead-s"/></a>').find(".k-header-column-menu")),that.link=link.attr("tabindex",-1).on("click"+NS,proxy(that._click,that)),that.wrapper=$('<div class="k-column-menu"/>')},_init:function(){var that=this;that.pane=that.options.pane,that.pane&&(that._isMobile=!0),that._isMobile?that._createMobileMenu():that._createMenu(),that._sort(),that._columns(),that._filter(),that._lockColumns(),that.trigger(INIT,{field:that.field,container:that.wrapper})},events:[INIT],options:{name:"ColumnMenu",messages:{sortAscending:"Sort Ascending",sortDescending:"Sort Descending",filter:"Filter",columns:"Columns",done:"Done",settings:"Column Settings",lock:"Lock",unlock:"Unlock"},filter:"",columns:!0,sortable:!0,filterable:!0,animations:{left:"slide"}},_createMenu:function(){var that=this,options=that.options;that.wrapper.html(kendo.template(template)({ns:kendo.ns,messages:options.messages,sortable:options.sortable,filterable:options.filterable,columns:that._ownerColumns(),showColumns:options.columns,lockedColumns:options.lockedColumns})),that.popup=that.wrapper[POPUP]({anchor:that.link,open:proxy(that._open,that),activate:proxy(that._activate,that),close:function(){that.options.closeCallback&&that.options.closeCallback(that.element)}}).data(POPUP),that.menu=that.wrapper.children()[MENU]({orientation:"vertical",closeOnClick:!1}).data(MENU)},_createMobileMenu:function(){var that=this,options=that.options,html=kendo.template(mobileTemplate)({ns:kendo.ns,field:that.field,messages:options.messages,sortable:options.sortable,filterable:options.filterable,columns:that._ownerColumns(),showColumns:options.columns,lockedColumns:options.lockedColumns});that.view=that.pane.append(html),that.wrapper=that.view.element.find(".k-column-menu"),that.menu=new MobileMenu(that.wrapper.children(),{pane:that.pane}),that.view.element.on("click",".k-done",function(e){that.close(),e.preventDefault()}),that.options.lockedColumns&&that.view.bind("show",function(){that._updateLockedColumns()})},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.filterMenu&&that.filterMenu.destroy(),that._refreshHandler&&that.dataSource.unbind(CHANGE,that._refreshHandler),that.options.columns&&that.owner&&(that.owner.unbind("columnShow",that._updateColumnsMenuHandler),that.owner.unbind("columnHide",that._updateColumnsMenuHandler)),that.menu&&(that.menu.element.off(NS),that.menu.destroy()),that.wrapper.off(NS),that.popup&&that.popup.destroy(),that.view&&that.view.purge(),that.link.off(NS),that.owner=null,that.wrapper=null,that.element=null},close:function(){this.menu.close(),this.popup&&(this.popup.close(),this.popup.element.off("keydown"+NS))},_click:function(e){e.preventDefault(),e.stopPropagation();var options=this.options;options.filter&&this.element.is(!options.filter)||(this.popup||this.pane||this._init(),this._isMobile?this.pane.navigate(this.view,this.options.animations.left):this.popup.toggle())},_open:function(){var that=this;$(".k-column-menu").not(that.wrapper).each(function(){$(this).data(POPUP).close()}),that.popup.element.on("keydown"+NS,function(e){e.keyCode==kendo.keys.ESC&&that.close()}),that.options.lockedColumns&&that._updateLockedColumns()},_activate:function(){this.menu.element.focus()},_ownerColumns:function(){var columns=this.owner.columns,menuColumns=grep(columns,function(col){var result=!0,title=trim(col.title||"");return col.menu!==!1&&(col.field||title.length)||(result=!1),result});return map(menuColumns,function(col){return{originalField:col.field,field:col.field||col.title,title:col.title||col.field,hidden:col.hidden,index:inArray(col,columns),locked:!!col.locked}})},_sort:function(){var that=this;that.options.sortable&&(that.refresh(),that._refreshHandler=proxy(that.refresh,that),that.dataSource.bind(CHANGE,that._refreshHandler),that.menu.bind(SELECT,function(e){var dir,item=$(e.item);item.hasClass("k-sort-asc")?dir=ASC:item.hasClass("k-sort-desc")&&(dir=DESC),dir&&(item.parent().find(".k-sort-"+(dir==ASC?DESC:ASC)).removeClass(ACTIVE),that._sortDataSource(item,dir),that.close())}))},_sortDataSource:function(item,dir){var idx,length,that=this,sortable=that.options.sortable,dataSource=that.dataSource,sort=dataSource.sort()||[];if(item.hasClass(ACTIVE)&&sortable&&sortable.allowUnsort!==!1?(item.removeClass(ACTIVE),dir=undefined):item.addClass(ACTIVE),sortable===!0||"single"===sortable.mode)sort=[{field:that.field,dir:dir}];else{for(idx=0,length=sort.length;idx<length;idx++)if(sort[idx].field===that.field){sort.splice(idx,1);break}sort.push({field:that.field,dir:dir})}dataSource.sort(sort)},_columns:function(){var that=this;that.options.columns&&(that._updateColumnsMenu(),that._updateColumnsMenuHandler=proxy(that._updateColumnsMenu,that),that.owner.bind(["columnHide","columnShow"],that._updateColumnsMenuHandler),that.menu.bind(SELECT,function(e){var input,index,column,field,item=$(e.item),columns=that.owner.columns;that._isMobile&&e.preventDefault(),item.parent().closest("li.k-columns-item")[0]&&(input=item.find(":checkbox"),input.attr("disabled")||(field=input.attr(kendo.attr("field")),column=grep(columns,function(column){return column.field==field||column.title==field})[0],index=inArray(column,columns),column.hidden===!0?that.owner.showColumn(index):that.owner.hideColumn(index)))}))},_updateColumnsMenu:function(){var idx,length,current,checked,locked,fieldAttr=kendo.attr("field"),lockedAttr=kendo.attr("locked"),visible=grep(this._ownerColumns(),function(field){return!field.hidden}),visibleDataFields=grep(visible,function(field){return field.originalField}),lockedCount=grep(visibleDataFields,function(col){return col.locked===!0}).length,nonLockedCount=grep(visibleDataFields,function(col){return col.locked!==!0}).length;visible=map(visible,function(col){return col.field});var checkboxes=this.wrapper.find(".k-columns-item input["+fieldAttr+"]").prop("disabled",!1).prop("checked",!1);for(idx=0,length=checkboxes.length;idx<length;idx++)current=checkboxes.eq(idx),locked="true"===current.attr(lockedAttr),checked=!1,inArray(current.attr(fieldAttr),visible)>-1&&(checked=!0,current.prop("checked",checked)),checked&&(1==lockedCount&&locked&&current.prop("disabled",!0),1!=nonLockedCount||locked||current.prop("disabled",!0))},_updateColumnsLockedState:function(){var idx,length,current,column,fieldAttr=kendo.attr("field"),lockedAttr=kendo.attr("locked"),columns=toHash(this._ownerColumns(),"field"),checkboxes=this.wrapper.find(".k-columns-item input[type=checkbox]");for(idx=0,length=checkboxes.length;idx<length;idx++)current=checkboxes.eq(idx),column=columns[current.attr(fieldAttr)],column&&current.attr(lockedAttr,column.locked);this._updateColumnsMenu()},_filter:function(){var that=this,options=that.options;options.filterable!==!1&&(that.filterMenu=that.wrapper.find(".k-filterable")[FILTERMENU](extend(!0,{},{appendToElement:!0,dataSource:options.dataSource,values:options.values,field:that.field},options.filterable)).data(FILTERMENU),that._isMobile&&that.menu.bind(SELECT,function(e){var item=$(e.item);item.hasClass("k-filter-item")&&that.pane.navigate(that.filterMenu.view,that.options.animations.left)}))},_lockColumns:function(){var that=this;that.menu.bind(SELECT,function(e){var item=$(e.item);item.hasClass("k-lock")?(that.owner.lockColumn(that.field),that.close()):item.hasClass("k-unlock")&&(that.owner.unlockColumn(that.field),that.close())})},_updateLockedColumns:function(){var field=this.field,columns=this.owner.columns,column=grep(columns,function(column){return column.field==field||column.title==field})[0],locked=column.locked===!0,length=grep(columns,function(column){return!column.hidden&&(column.locked&&locked||!column.locked&&!locked)}).length,lockItem=this.wrapper.find(".k-lock").removeClass("k-state-disabled"),unlockItem=this.wrapper.find(".k-unlock").removeClass("k-state-disabled");(locked||1==length)&&lockItem.addClass("k-state-disabled"),locked&&1!=length||unlockItem.addClass("k-state-disabled"),this._updateColumnsLockedState()},refresh:function(){var descriptor,idx,length,that=this,sort=that.options.dataSource.sort()||[],field=that.field;for(that.wrapper.find(".k-sort-asc, .k-sort-desc").removeClass(ACTIVE),idx=0,length=sort.length;idx<length;idx++)descriptor=sort[idx],field==descriptor.field&&that.wrapper.find(".k-sort-"+descriptor.dir).addClass(ACTIVE)}}),template='<ul>#if(sortable){#<li class="k-item k-sort-asc"><span class="k-link"><span class="k-sprite k-i-sort-asc"></span>${messages.sortAscending}</span></li><li class="k-item k-sort-desc"><span class="k-link"><span class="k-sprite k-i-sort-desc"></span>${messages.sortDescending}</span></li>#if(showColumns || filterable){#<li class="k-separator"></li>#}##}##if(showColumns){#<li class="k-item k-columns-item"><span class="k-link"><span class="k-sprite k-i-columns"></span>${messages.columns}</span><ul>#for (var idx = 0; idx < columns.length; idx++) {#<li><input type="checkbox" data-#=ns#field="#=columns[idx].field.replace(/"/g,"&\\#34;")#" data-#=ns#index="#=columns[idx].index#" data-#=ns#locked="#=columns[idx].locked#"/>#=columns[idx].title#</li>#}#</ul></li>#if(filterable || lockedColumns){#<li class="k-separator"></li>#}##}##if(filterable){#<li class="k-item k-filter-item"><span class="k-link"><span class="k-sprite k-filter"></span>${messages.filter}</span><ul><li><div class="k-filterable"></div></li></ul></li>#if(lockedColumns){#<li class="k-separator"></li>#}##}##if(lockedColumns){#<li class="k-item k-lock"><span class="k-link"><span class="k-sprite k-i-lock"></span>${messages.lock}</span></li><li class="k-item k-unlock"><span class="k-link"><span class="k-sprite k-i-unlock"></span>${messages.unlock}</span></li>#}#</ul>',mobileTemplate='<div data-#=ns#role="view" data-#=ns#init-widgets="false" class="k-grid-column-menu"><div data-#=ns#role="header" class="k-header">${messages.settings}<button class="k-button k-done">#=messages.done#</button></div><div class="k-column-menu k-mobile-list"><ul><li><span class="k-link">${field}</span><ul>#if(sortable){#<li class="k-item k-sort-asc"><span class="k-link"><span class="k-sprite k-i-sort-asc"></span>${messages.sortAscending}</span></li><li class="k-item k-sort-desc"><span class="k-link"><span class="k-sprite k-i-sort-desc"></span>${messages.sortDescending}</span></li>#}##if(lockedColumns){#<li class="k-item k-lock"><span class="k-link"><span class="k-sprite k-i-lock"></span>${messages.lock}</span></li><li class="k-item k-unlock"><span class="k-link"><span class="k-sprite k-i-unlock"></span>${messages.unlock}</span></li>#}##if(filterable){#<li class="k-item k-filter-item"><span class="k-link k-filterable"><span class="k-sprite k-filter"></span>${messages.filter}</span></li>#}#</ul></li>#if(showColumns){#<li class="k-columns-item"><span class="k-link">${messages.columns}</span><ul>#for (var idx = 0; idx < columns.length; idx++) {#<li class="k-item"><label class="k-label"><input type="checkbox" class="k-check" data-#=ns#field="#=columns[idx].field.replace(/"/g,"&\\#34;")#" data-#=ns#index="#=columns[idx].index#" data-#=ns#locked="#=columns[idx].locked#"/>#=columns[idx].title#</label></li>#}#</ul></li>#}#</ul></div></div>',MobileMenu=Widget.extend({init:function(element,options){Widget.fn.init.call(this,element,options),this.element.on("click"+NS,"li:not(.k-separator):not(.k-state-disabled)","_click")},events:[SELECT],_click:function(e){e.preventDefault(),this.trigger(SELECT,{item:e.currentTarget})},close:function(){this.options.pane.navigate("")},destroy:function(){Widget.fn.destroy.call(this),this.element.off(NS)}});ui.plugin(ColumnMenu)}(window.kendo.jQuery),function($,undefined){function fieldType(field){return field=null!=field?field:"",field.type||$.type(field)||"string"}function convertToValueBinding(container){container.find(":input:not(:button, ["+kendo.attr("role")+"=upload], ["+kendo.attr("skip")+"], [type=file]), select").each(function(){var bindAttr=kendo.attr("bind"),binding=this.getAttribute(bindAttr)||"",bindingName="checkbox"===this.type||"radio"===this.type?"checked:":"value:",fieldName=this.name;binding.indexOf(bindingName)===-1&&fieldName&&(binding+=(binding.length?",":"")+bindingName+fieldName,$(this).attr(bindAttr,binding))})}function createAttributes(options){var ruleName,rule,field=(options.model.fields||options.model)[options.field],type=fieldType(field),validation=field?field.validation:{},DATATYPE=kendo.attr("type"),BINDING=kendo.attr("bind"),attr={name:options.field};for(ruleName in validation)rule=validation[ruleName],inArray(ruleName,specialRules)>=0?attr[DATATYPE]=ruleName:isFunction(rule)||(attr[ruleName]=isPlainObject(rule)?rule.value||ruleName:rule),attr[kendo.attr(ruleName+"-msg")]=rule.message;return inArray(type,specialRules)>=0&&(attr[DATATYPE]=type),attr[BINDING]=("boolean"===type?"checked:":"value:")+options.field,attr}function convertItems(items){var idx,length,item,value,text,result;if(items&&items.length)for(result=[],idx=0,length=items.length;idx<length;idx++)item=items[idx],text=item.text||item.value||item,value=null==item.value?item.text||item:item.value,result[idx]={text:text,value:value};return result}function addValidationRules(modelField,rules){var rule,descriptor,validation=modelField?modelField.validation||{}:{};for(rule in validation)descriptor=validation[rule],isPlainObject(descriptor)&&descriptor.value&&(descriptor=descriptor.value),isFunction(descriptor)&&(rules[rule]=descriptor)}var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget,extend=$.extend,oldIE=kendo.support.browser.msie&&kendo.support.browser.version<9,isFunction=kendo.isFunction,isPlainObject=$.isPlainObject,inArray=$.inArray,nameSpecialCharRegExp=/("|\%|'|\[|\]|\$|\.|\,|\:|\;|\+|\*|\&|\!|\#|\(|\)|<|>|\=|\?|\@|\^|\{|\}|\~|\/|\||`)/g,ERRORTEMPLATE='<div class="k-widget k-tooltip k-tooltip-validation" style="margin:0.5em"><span class="k-icon k-warning"> </span>#=message#<div class="k-callout k-callout-n"></div></div>',CHANGE="change",specialRules=["url","email","number","date","boolean"],editors={number:function(container,options){var attr=createAttributes(options);$('<input type="text"/>').attr(attr).appendTo(container).kendoNumericTextBox({format:options.format}),$("<span "+kendo.attr("for")+'="'+options.field+'" class="k-invalid-msg"/>').hide().appendTo(container)},date:function(container,options){var attr=createAttributes(options),format=options.format;format&&(format=kendo._extractFormat(format)),attr[kendo.attr("format")]=format,$('<input type="text"/>').attr(attr).appendTo(container).kendoDatePicker({format:options.format}),$("<span "+kendo.attr("for")+'="'+options.field+'" class="k-invalid-msg"/>').hide().appendTo(container)},string:function(container,options){var attr=createAttributes(options);$('<input type="text" class="k-input k-textbox"/>').attr(attr).appendTo(container)},"boolean":function(container,options){var attr=createAttributes(options);$('<input type="checkbox" />').attr(attr).appendTo(container)},values:function(container,options){var attr=createAttributes(options);$("<select "+kendo.attr("text-field")+'="text"'+kendo.attr("value-field")+'="value"'+kendo.attr("source")+"='"+kendo.stringify(convertItems(options.values)).replace(/\'/g,"&apos;")+"'"+kendo.attr("role")+'="dropdownlist"/>').attr(attr).appendTo(container),$("<span "+kendo.attr("for")+'="'+options.field+'" class="k-invalid-msg"/>').hide().appendTo(container)}},Editable=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),that._validateProxy=$.proxy(that._validate,that),that.refresh();
},events:[CHANGE],options:{name:"Editable",editors:editors,clearContainer:!0,errorTemplate:ERRORTEMPLATE},editor:function(field,modelField){var that=this,editors=that.options.editors,isObject=isPlainObject(field),fieldName=isObject?field.field:field,model=that.options.model||{},isValuesEditor=isObject&&field.values,type=isValuesEditor?"values":fieldType(modelField),isCustomEditor=isObject&&field.editor,editor=isCustomEditor?field.editor:editors[type],container=that.element.find("["+kendo.attr("container-for")+"="+fieldName.replace(nameSpecialCharRegExp,"\\$1")+"]");editor=editor?editor:editors.string,isCustomEditor&&"string"==typeof field.editor&&(editor=function(container){container.append(field.editor)}),container=container.length?container:that.element,editor(container,extend(!0,{},isObject?field:{field:fieldName},{model:model}))},_validate:function(e){var input,that=this,value=e.value,preventChangeTrigger=that._validationEventInProgress,values={},bindAttribute=kendo.attr("bind"),fieldName=e.field.replace(nameSpecialCharRegExp,"\\$1"),checkedBinding="checked:"+fieldName,valueBinding="value:"+fieldName;values[e.field]=e.value,input=$(":input["+bindAttribute+'*="'+valueBinding+'"],:input['+bindAttribute+'*="'+checkedBinding+'"]',that.element).filter("["+kendo.attr("validate")+"!='false']"),input.length>1&&(input=input.filter(function(){var element=$(this),bindings=element.attr(bindAttribute).split(","),matchesBinding=inArray(valueBinding,bindings)>=0||inArray(checkedBinding,bindings)>=0;return matchesBinding&&(!element.is(":radio")||element.val()==value)}));try{that._validationEventInProgress=!0,(!that.validatable.validateInput(input)||!preventChangeTrigger&&that.trigger(CHANGE,{values:values}))&&e.preventDefault()}finally{that._validationEventInProgress=!1}},end:function(){return this.validatable.validate()},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.options.model.unbind("set",that._validateProxy),kendo.unbind(that.element),that.validatable&&that.validatable.destroy(),kendo.destroy(that.element),that.element.removeData("kendoValidator")},refresh:function(){var idx,length,field,isObject,fieldName,modelField,modelFields,that=this,fields=that.options.fields||[],container=that.options.clearContainer?that.element.empty():that.element,model=that.options.model||{},rules={};for($.isArray(fields)||(fields=[fields]),idx=0,length=fields.length;idx<length;idx++)field=fields[idx],isObject=isPlainObject(field),fieldName=isObject?field.field:field,modelField=(model.fields||model)[fieldName],addValidationRules(modelField,rules),that.editor(field,modelField);if(!length){modelFields=model.fields||model;for(fieldName in modelFields)addValidationRules(modelFields[fieldName],rules)}convertToValueBinding(container),kendo.bind(container,that.options.model),that.options.model.unbind("set",that._validateProxy),that.options.model.bind("set",that._validateProxy),that.validatable=new kendo.ui.Validator(container,{validateOnBlur:!1,errorTemplate:that.options.errorTemplate||undefined,rules:rules});var focusable=container.find(":kendoFocusable").eq(0).focus();oldIE&&focusable.focus()}});ui.plugin(Editable)}(window.kendo.jQuery),function($,undefined){function defined(x){return"undefined"!=typeof x}function constrain(value,low,high){return Math.max(Math.min(parseInt(value,10),high===1/0?high:parseInt(high,10)),parseInt(low,10))}function sizingAction(actionId,callback){return function(){var that=this,wrapper=that.wrapper,style=wrapper[0].style,options=that.options;if(!options.isMaximized&&!options.isMinimized)return that.restoreOptions={width:style.width,height:style.height},wrapper.children(KWINDOWRESIZEHANDLES).hide().end().children(KWINDOWTITLEBAR).find(MINIMIZE_MAXIMIZE).parent().hide().eq(0).before(templates.action({name:"Restore"})),callback.call(that),"maximize"==actionId?that.wrapper.children(KWINDOWTITLEBAR).find(PIN_UNPIN).parent().hide():that.wrapper.children(KWINDOWTITLEBAR).find(PIN_UNPIN).parent().show(),that}}function executableScript(){return!this.type||this.type.toLowerCase().indexOf("script")>=0}function WindowResizing(wnd){var that=this;that.owner=wnd,that._draggable=new Draggable(wnd.wrapper,{filter:KWINDOWRESIZEHANDLES,group:wnd.wrapper.id+"-resizing",dragstart:proxy(that.dragstart,that),drag:proxy(that.drag,that),dragend:proxy(that.dragend,that)}),that._draggable.userEvents.bind("press",proxy(that.addOverlay,that)),that._draggable.userEvents.bind("release",proxy(that.removeOverlay,that))}function WindowDragging(wnd,dragHandle){var that=this;that.owner=wnd,that._draggable=new Draggable(wnd.wrapper,{filter:dragHandle,group:wnd.wrapper.id+"-moving",dragstart:proxy(that.dragstart,that),drag:proxy(that.drag,that),dragend:proxy(that.dragend,that),dragcancel:proxy(that.dragcancel,that)}),that._draggable.userEvents.stopPropagation=!1}var templates,kendo=window.kendo,Widget=kendo.ui.Widget,Draggable=kendo.ui.Draggable,isPlainObject=$.isPlainObject,activeElement=kendo._activeElement,proxy=$.proxy,extend=$.extend,each=$.each,template=kendo.template,BODY="body",NS=".kendoWindow",KWINDOW=".k-window",KWINDOWTITLE=".k-window-title",KWINDOWTITLEBAR=KWINDOWTITLE+"bar",KWINDOWCONTENT=".k-window-content",KWINDOWRESIZEHANDLES=".k-resize-handle",KOVERLAY=".k-overlay",KCONTENTFRAME="k-content-frame",LOADING="k-loading",KHOVERSTATE="k-state-hover",KFOCUSEDSTATE="k-state-focused",MAXIMIZEDSTATE="k-window-maximized",VISIBLE=":visible",HIDDEN="hidden",CURSOR="cursor",OPEN="open",ACTIVATE="activate",DEACTIVATE="deactivate",CLOSE="close",REFRESH="refresh",RESIZE="resize",DRAGSTART="dragstart",DRAGEND="dragend",ERROR="error",OVERFLOW="overflow",ZINDEX="zIndex",MINIMIZE_MAXIMIZE=".k-window-actions .k-i-minimize,.k-window-actions .k-i-maximize",KPIN=".k-i-pin",KUNPIN=".k-i-unpin",PIN_UNPIN=KPIN+","+KUNPIN,TITLEBAR_BUTTONS=".k-window-titlebar .k-window-action",REFRESHICON=".k-window-titlebar .k-i-refresh",isLocalUrl=kendo.isLocalUrl,Window=Widget.extend({init:function(element,options){var wrapper,visibility,display,position,content,windowContent,id,that=this,offset={},isVisible=!1,suppressActions=options&&options.actions&&!options.actions.length;Widget.fn.init.call(that,element,options),options=that.options,position=options.position,element=that.element,content=options.content,suppressActions&&(options.actions=[]),that.appendTo=$(options.appendTo),that._animations(),content&&!isPlainObject(content)&&(content=options.content={url:content}),element.find("script").filter(executableScript).remove(),element.parent().is(that.appendTo)||position.top!==undefined&&position.left!==undefined||(element.is(VISIBLE)?(offset=element.offset(),isVisible=!0):(visibility=element.css("visibility"),display=element.css("display"),element.css({visibility:HIDDEN,display:""}),offset=element.offset(),element.css({visibility:visibility,display:display})),position.top===undefined&&(position.top=offset.top),position.left===undefined&&(position.left=offset.left)),defined(options.visible)&&null!==options.visible||(options.visible=element.is(VISIBLE)),wrapper=that.wrapper=element.closest(KWINDOW),element.is(".k-content")&&wrapper[0]||(element.addClass("k-window-content k-content"),that._createWindow(element,options),wrapper=that.wrapper=element.closest(KWINDOW),that._dimensions()),that._position(),options.pinned&&that.pin(!0),content&&that.refresh(content),options.visible&&that.toFront(),windowContent=wrapper.children(KWINDOWCONTENT),that._tabindex(windowContent),options.visible&&options.modal&&that._overlay(wrapper.is(VISIBLE)).css({opacity:.5}),wrapper.on("mouseenter"+NS,TITLEBAR_BUTTONS,proxy(that._buttonEnter,that)).on("mouseleave"+NS,TITLEBAR_BUTTONS,proxy(that._buttonLeave,that)).on("click"+NS,"> "+TITLEBAR_BUTTONS,proxy(that._windowActionHandler,that)),windowContent.on("keydown"+NS,proxy(that._keydown,that)).on("focus"+NS,proxy(that._focus,that)).on("blur"+NS,proxy(that._blur,that)),this._resizable(),this._draggable(),id=element.attr("id"),id&&(id+="_wnd_title",wrapper.children(KWINDOWTITLEBAR).children(KWINDOWTITLE).attr("id",id),windowContent.attr({role:"dialog","aria-labelledby":id})),wrapper.add(wrapper.children(".k-resize-handle,"+KWINDOWTITLEBAR)).on("mousedown"+NS,proxy(that.toFront,that)),that.touchScroller=kendo.touchScroller(element),that._resizeHandler=proxy(that._onDocumentResize,that),$(window).on("resize",that._resizeHandler),options.visible&&(that.trigger(OPEN),that.trigger(ACTIVATE)),kendo.notify(that)},_buttonEnter:function(e){$(e.currentTarget).addClass(KHOVERSTATE)},_buttonLeave:function(e){$(e.currentTarget).removeClass(KHOVERSTATE)},_focus:function(){this.wrapper.addClass(KFOCUSEDSTATE)},_blur:function(){this.wrapper.removeClass(KFOCUSEDSTATE)},_dimensions:function(){var wrapper=this.wrapper,options=this.options,width=options.width,height=options.height,maxHeight=options.maxHeight,dimensions=["minWidth","minHeight","maxWidth","maxHeight"];this.title(options.title);for(var i=0;i<dimensions.length;i++){var value=options[dimensions[i]];value&&value!=1/0&&wrapper.css(dimensions[i],value)}maxHeight&&maxHeight!=1/0&&this.element.css("maxHeight",maxHeight),width&&(width.toString().indexOf("%")>0?wrapper.width(width):wrapper.width(constrain(width,options.minWidth,options.maxWidth))),height&&(height.toString().indexOf("%")>0?wrapper.height(height):wrapper.height(constrain(height,options.minHeight,options.maxHeight))),options.visible||wrapper.hide()},_position:function(){var wrapper=this.wrapper,position=this.options.position;0===position.top&&(position.top=position.top.toString()),0===position.left&&(position.left=position.left.toString()),wrapper.css({top:position.top||"",left:position.left||""})},_animations:function(){var options=this.options;options.animation===!1&&(options.animation={open:{effects:{}},close:{hide:!0,effects:{}}})},_resize:function(){kendo.resize(this.element.children())},_resizable:function(){var resizable=this.options.resizable,wrapper=this.wrapper;this.resizing&&(wrapper.off("dblclick"+NS).children(KWINDOWRESIZEHANDLES).remove(),this.resizing.destroy(),this.resizing=null),resizable&&(wrapper.on("dblclick"+NS,KWINDOWTITLEBAR,proxy(function(e){$(e.target).closest(".k-window-action").length||this.toggleMaximization()},this)),each("n e s w se sw ne nw".split(" "),function(index,handler){wrapper.append(templates.resizeHandle(handler))}),this.resizing=new WindowResizing(this)),wrapper=null},_draggable:function(){var draggable=this.options.draggable;this.dragging&&(this.dragging.destroy(),this.dragging=null),draggable&&(this.dragging=new WindowDragging(this,draggable.dragHandle||KWINDOWTITLEBAR))},setOptions:function(options){Widget.fn.setOptions.call(this,options),this._animations(),this._dimensions(),this._position(),this._resizable(),this._draggable()},events:[OPEN,ACTIVATE,DEACTIVATE,CLOSE,REFRESH,RESIZE,DRAGSTART,DRAGEND,ERROR],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],autoFocus:!0,modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:1/0,maxHeight:1/0,pinned:!1,position:{},content:null,visible:null,height:null,width:null,appendTo:"body"},_closable:function(){return $.inArray("close",$.map(this.options.actions,function(x){return x.toLowerCase()}))>-1},_keydown:function(e){var offset,handled,newWidth,newHeight,w,h,that=this,options=that.options,keys=kendo.keys,keyCode=e.keyCode,wrapper=that.wrapper,distance=10,isMaximized=that.options.isMaximized;e.target!=e.currentTarget||that._closing||(keyCode==keys.ESC&&that._closable()&&that._close(!1),!options.draggable||e.ctrlKey||isMaximized||(offset=kendo.getOffset(wrapper),keyCode==keys.UP?handled=wrapper.css("top",offset.top-distance):keyCode==keys.DOWN?handled=wrapper.css("top",offset.top+distance):keyCode==keys.LEFT?handled=wrapper.css("left",offset.left-distance):keyCode==keys.RIGHT&&(handled=wrapper.css("left",offset.left+distance))),options.resizable&&e.ctrlKey&&!isMaximized&&(keyCode==keys.UP?(handled=!0,newHeight=wrapper.height()-distance):keyCode==keys.DOWN&&(handled=!0,newHeight=wrapper.height()+distance),keyCode==keys.LEFT?(handled=!0,newWidth=wrapper.width()-distance):keyCode==keys.RIGHT&&(handled=!0,newWidth=wrapper.width()+distance),handled&&(w=constrain(newWidth,options.minWidth,options.maxWidth),h=constrain(newHeight,options.minHeight,options.maxHeight),isNaN(w)||(wrapper.width(w),that.options.width=w+"px"),isNaN(h)||(wrapper.height(h),that.options.height=h+"px"),that.resize())),handled&&e.preventDefault())},_overlay:function(visible){var overlay=this.appendTo.children(KOVERLAY),wrapper=this.wrapper;return overlay.length||(overlay=$("<div class='k-overlay' />")),overlay.insertBefore(wrapper[0]).toggle(visible).css(ZINDEX,parseInt(wrapper.css(ZINDEX),10)-1),overlay},_actionForIcon:function(icon){var iconClass=/\bk-i-\w+\b/.exec(icon[0].className)[0];return{"k-i-close":"_close","k-i-maximize":"maximize","k-i-minimize":"minimize","k-i-restore":"restore","k-i-refresh":"refresh","k-i-pin":"pin","k-i-unpin":"unpin"}[iconClass]},_windowActionHandler:function(e){if(!this._closing){var icon=$(e.target).closest(".k-window-action").find(".k-icon"),action=this._actionForIcon(icon);return action?(e.preventDefault(),this[action](),!1):void 0}},_modals:function(){var that=this,zStack=$(KWINDOW).filter(function(){var dom=$(this),object=that._object(dom),options=object&&object.options;return options&&options.modal&&options.visible&&dom.is(VISIBLE)}).sort(function(a,b){return+$(a).css("zIndex")-+$(b).css("zIndex")});return that=null,zStack},_object:function(element){var content=element.children(KWINDOWCONTENT);return content.data("kendoWindow")||content.data("kendo"+this.options.name)},center:function(){var newTop,newLeft,that=this,position=that.options.position,wrapper=that.wrapper,documentWindow=$(window),scrollTop=0,scrollLeft=0;return that.options.isMaximized?that:(that.options.pinned||(scrollTop=documentWindow.scrollTop(),scrollLeft=documentWindow.scrollLeft()),newLeft=scrollLeft+Math.max(0,(documentWindow.width()-wrapper.width())/2),newTop=scrollTop+Math.max(0,(documentWindow.height()-wrapper.height()-parseInt(wrapper.css("paddingTop"),10))/2),wrapper.css({left:newLeft,top:newTop}),position.top=newTop,position.left=newLeft,that)},title:function(text){var that=this,wrapper=that.wrapper,options=that.options,titleBar=wrapper.children(KWINDOWTITLEBAR),title=titleBar.children(KWINDOWTITLE),titleBarHeight=titleBar.outerHeight();return arguments.length?(text===!1?(wrapper.addClass("k-window-titleless"),titleBar.remove()):(titleBar.length||wrapper.prepend(templates.titlebar(extend(templates,options))),wrapper.css("padding-top",titleBarHeight),titleBar.css("margin-top",-titleBarHeight)),title.text(text),that.options.title=text,that):title.text()},content:function(html){var content=this.wrapper.children(KWINDOWCONTENT),scrollContainer=content.children(".km-scroll-container");return content=scrollContainer[0]?scrollContainer:content,defined(html)?(kendo.destroy(this.element.children()),content.empty().html(html),this):content.html()},open:function(){var overlay,that=this,wrapper=that.wrapper,options=that.options,showOptions=options.animation.open,contentElement=wrapper.children(KWINDOWCONTENT);if(!that.trigger(OPEN)){if(that._closing&&wrapper.kendoStop(!0,!0),that._closing=!1,that.toFront(),options.autoFocus&&that.element.focus(),options.visible=!0,options.modal){if(overlay=that._overlay(!1),overlay.kendoStop(!0,!0),showOptions.duration&&kendo.effects.Fade){var overlayFx=kendo.fx(overlay).fadeIn();overlayFx.duration(showOptions.duration||0),overlayFx.endValue(.5),overlayFx.play()}else overlay.css("opacity",.5);overlay.show()}wrapper.is(VISIBLE)||(contentElement.css(OVERFLOW,HIDDEN),wrapper.show().kendoStop().kendoAnimate({effects:showOptions.effects,duration:showOptions.duration,complete:proxy(this._activate,this)}))}return options.isMaximized&&(that._documentScrollTop=$(document).scrollTop(),$("html, body").css(OVERFLOW,HIDDEN)),that},_activate:function(){this.options.autoFocus&&this.element.focus(),this.trigger(ACTIVATE),this.wrapper.children(KWINDOWCONTENT).css(OVERFLOW,"")},_removeOverlay:function(suppressAnimation){var modals=this._modals(),options=this.options,hideOverlay=options.modal&&!modals.length,overlay=options.modal?this._overlay(!0):$(undefined),hideOptions=options.animation.close;if(hideOverlay)if(!suppressAnimation&&hideOptions.duration&&kendo.effects.Fade){var overlayFx=kendo.fx(overlay).fadeOut();overlayFx.duration(hideOptions.duration||0),overlayFx.startValue(.5),overlayFx.play()}else this._overlay(!1).remove();else modals.length&&this._object(modals.last())._overlay(!0)},_close:function(systemTriggered){var that=this,wrapper=that.wrapper,options=that.options,showOptions=options.animation.open,hideOptions=options.animation.close;wrapper.is(VISIBLE)&&!that.trigger(CLOSE,{userTriggered:!systemTriggered})&&(that._closing=!0,options.visible=!1,$(KWINDOW).each(function(i,element){var contentElement=$(element).children(KWINDOWCONTENT);element!=wrapper&&contentElement.find("> ."+KCONTENTFRAME).length>0&&contentElement.children(KOVERLAY).remove()}),this._removeOverlay(),wrapper.kendoStop().kendoAnimate({effects:hideOptions.effects||showOptions.effects,reverse:hideOptions.reverse===!0,duration:hideOptions.duration,complete:proxy(this._deactivate,this)})),that.options.isMaximized&&($("html, body").css(OVERFLOW,""),that._documentScrollTop&&that._documentScrollTop>0&&$(document).scrollTop(that._documentScrollTop))},_deactivate:function(){this.wrapper.hide().css("opacity",""),this.trigger(DEACTIVATE);var lastModal=this._object(this._modals().last());lastModal&&lastModal.toFront()},close:function(){return this._close(!0),this},_actionable:function(element){return $(element).is(TITLEBAR_BUTTONS+","+TITLEBAR_BUTTONS+" .k-icon,:input,a")},_shouldFocus:function(target){var active=activeElement(),element=this.element;return this.options.autoFocus&&!$(active).is(element)&&!this._actionable(target)&&(!element.find(active).length||!element.find(target).length)},toFront:function(e){var that=this,wrapper=that.wrapper,currentWindow=wrapper[0],zIndex=+wrapper.css(ZINDEX),originalZIndex=zIndex,target=e&&e.target||null;if($(KWINDOW).each(function(i,element){var windowObject=$(element),zIndexNew=windowObject.css(ZINDEX),contentElement=windowObject.children(KWINDOWCONTENT);isNaN(zIndexNew)||(zIndex=Math.max(+zIndexNew,zIndex)),element!=currentWindow&&contentElement.find("> ."+KCONTENTFRAME).length>0&&contentElement.append(templates.overlay)}),(!wrapper[0].style.zIndex||originalZIndex<zIndex)&&wrapper.css(ZINDEX,zIndex+2),that.element.find("> .k-overlay").remove(),that._shouldFocus(target)){that.element.focus();var scrollTop=$(window).scrollTop(),windowTop=parseInt(wrapper.position().top,10);windowTop>0&&windowTop<scrollTop&&(scrollTop>0?$(window).scrollTop(windowTop):wrapper.css("top",scrollTop))}return wrapper=null,that},toggleMaximization:function(){return this._closing?this:this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var that=this,options=that.options,minHeight=options.minHeight,restoreOptions=that.restoreOptions;return options.isMaximized||options.isMinimized?(minHeight&&minHeight!=1/0&&that.wrapper.css("min-height",minHeight),that.wrapper.css({position:options.pinned?"fixed":"absolute",left:restoreOptions.left,top:restoreOptions.top,width:restoreOptions.width,height:restoreOptions.height}).removeClass(MAXIMIZEDSTATE).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-i-restore").parent().remove().end().end().find(MINIMIZE_MAXIMIZE).parent().show().end().end().find(PIN_UNPIN).parent().show(),that.options.width=restoreOptions.width,that.options.height=restoreOptions.height,$("html, body").css(OVERFLOW,""),this._documentScrollTop&&this._documentScrollTop>0&&$(document).scrollTop(this._documentScrollTop),options.isMaximized=options.isMinimized=!1,that.resize(),that):that},maximize:sizingAction("maximize",function(){var that=this,wrapper=that.wrapper,position=wrapper.position();extend(that.restoreOptions,{left:position.left,top:position.top}),wrapper.css({left:0,top:0,position:"fixed"}).addClass(MAXIMIZEDSTATE),this._documentScrollTop=$(document).scrollTop(),$("html, body").css(OVERFLOW,HIDDEN),that.options.isMaximized=!0,that._onDocumentResize()}),minimize:sizingAction("minimize",function(){var that=this;that.wrapper.css({height:"",minHeight:""}),that.element.hide(),that.options.isMinimized=!0}),pin:function(force){var that=this,win=$(window),wrapper=that.wrapper,top=parseInt(wrapper.css("top"),10),left=parseInt(wrapper.css("left"),10);(force||!that.options.pinned&&!that.options.isMaximized)&&(wrapper.css({position:"fixed",top:top-win.scrollTop(),left:left-win.scrollLeft()}),wrapper.children(KWINDOWTITLEBAR).find(KPIN).addClass("k-i-unpin").removeClass("k-i-pin"),that.options.pinned=!0)},unpin:function(){var that=this,win=$(window),wrapper=that.wrapper,top=parseInt(wrapper.css("top"),10),left=parseInt(wrapper.css("left"),10);that.options.pinned&&!that.options.isMaximized&&(wrapper.css({position:"",top:top+win.scrollTop(),left:left+win.scrollLeft()}),wrapper.children(KWINDOWTITLEBAR).find(KUNPIN).addClass("k-i-pin").removeClass("k-i-unpin"),that.options.pinned=!1)},_onDocumentResize:function(){var w,h,that=this,wrapper=that.wrapper,wnd=$(window);that.options.isMaximized&&(w=wnd.width(),h=wnd.height()-parseInt(wrapper.css("padding-top"),10),wrapper.css({width:w,height:h}),that.options.width=w,that.options.height=h,that.resize())},refresh:function(options){var iframe,showIframe,url,that=this,initOptions=that.options,element=$(that.element);return isPlainObject(options)||(options={url:options}),options=extend({},initOptions.content,options),showIframe=defined(initOptions.iframe)?initOptions.iframe:options.iframe,url=options.url,url?(defined(showIframe)||(showIframe=!isLocalUrl(url)),showIframe?(iframe=element.find("."+KCONTENTFRAME)[0],iframe?iframe.src=url||iframe.src:element.html(templates.contentFrame(extend({},initOptions,{content:options}))),element.find("."+KCONTENTFRAME).unbind("load"+NS).on("load"+NS,proxy(this._triggerRefresh,this))):that._ajaxRequest(options)):(options.template&&that.content(template(options.template)({})),that.trigger(REFRESH)),element.toggleClass("k-window-iframecontent",showIframe),that},_triggerRefresh:function(){this.trigger(REFRESH)},_ajaxComplete:function(){clearTimeout(this._loadingIconTimeout),this.wrapper.find(REFRESHICON).removeClass(LOADING)},_ajaxError:function(xhr,status){this.trigger(ERROR,{status:status,xhr:xhr})},_ajaxSuccess:function(contentTemplate){return function(data){contentTemplate&&(data=template(contentTemplate)(data||{})),this.content(data),this.element.prop("scrollTop",0),this.trigger(REFRESH)}},_showLoading:function(){this.wrapper.find(REFRESHICON).addClass(LOADING)},_ajaxRequest:function(options){this._loadingIconTimeout=setTimeout(proxy(this._showLoading,this),100),$.ajax(extend({type:"GET",dataType:"html",cache:!1,error:proxy(this._ajaxError,this),complete:proxy(this._ajaxComplete,this),success:proxy(this._ajaxSuccess(options.template),this)},options))},destroy:function(){this.resizing&&this.resizing.destroy(),this.dragging&&this.dragging.destroy(),this.wrapper.off(NS).children(KWINDOWCONTENT).off(NS).end().find(".k-resize-handle,.k-window-titlebar").off(NS),$(window).off("resize",this._resizeHandler),clearTimeout(this._loadingIconTimeout),Widget.fn.destroy.call(this),this.unbind(undefined),kendo.destroy(this.wrapper),this._removeOverlay(!0),this.wrapper.empty().remove(),this.wrapper=this.appendTo=this.element=$()},_createWindow:function(){var iframeSrcAttributes,wrapper,contentHtml=this.element,options=this.options,isRtl=kendo.support.isRtl(contentHtml);options.scrollable===!1&&contentHtml.attr("style","overflow:hidden;"),wrapper=$(templates.wrapper(options)),options.title!==!1&&wrapper.append(templates.titlebar(extend(templates,options))),iframeSrcAttributes=contentHtml.find("iframe:not(.k-content)").map(function(){var src=this.getAttribute("src");return this.src="",src}),wrapper.toggleClass("k-rtl",isRtl).appendTo(this.appendTo).append(contentHtml).find("iframe:not(.k-content)").each(function(index){this.src=iframeSrcAttributes[index]}),wrapper.find(".k-window-title").css(isRtl?"left":"right",wrapper.find(".k-window-actions").outerWidth()+10),contentHtml.show(),contentHtml.find("[data-role=editor]").each(function(){var editor=$(this).data("kendoEditor");editor&&editor.refresh()}),wrapper=contentHtml=null}});templates={wrapper:template("<div class='k-widget k-window' />"),action:template("<a role='button' href='\\#' class='k-window-action k-link'><span role='presentation' class='k-icon k-i-#= name.toLowerCase() #'>#= name #</span></a>"),titlebar:template("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions'># for (var i = 0; i < actions.length; i++) { ##= action({ name: actions[i] }) ## } #</div></div>"),overlay:"<div class='k-overlay' />",contentFrame:template("<iframe frameborder='0' title='#= title #' class='"+KCONTENTFRAME+"' src='#= content.url #'>This page requires frames in order to show content</iframe>"),resizeHandle:template("<div class='k-resize-handle k-resize-#= data #'></div>")},WindowResizing.prototype={addOverlay:function(){this.owner.wrapper.append(templates.overlay)},removeOverlay:function(){this.owner.wrapper.find(KOVERLAY).remove()},dragstart:function(e){var that=this,wnd=that.owner,wrapper=wnd.wrapper;that.elementPadding=parseInt(wnd.wrapper.css("padding-top"),10),that.initialCursorPosition=kendo.getOffset(wrapper,"position"),that.resizeDirection=e.currentTarget.prop("className").replace("k-resize-handle k-resize-",""),that.initialSize={width:wrapper.width(),height:wrapper.height()},that.containerOffset=kendo.getOffset(wnd.appendTo),wrapper.children(KWINDOWRESIZEHANDLES).not(e.currentTarget).hide(),$(BODY).css(CURSOR,e.currentTarget.css(CURSOR))},drag:function(e){var newWidth,newHeight,windowBottom,windowRight,that=this,wnd=that.owner,wrapper=wnd.wrapper,options=wnd.options,direction=that.resizeDirection,containerOffset=that.containerOffset,initialPosition=that.initialCursorPosition,initialSize=that.initialSize,x=Math.max(e.x.location,containerOffset.left),y=Math.max(e.y.location,containerOffset.top);direction.indexOf("e")>=0?(newWidth=x-initialPosition.left,wrapper.width(constrain(newWidth,options.minWidth,options.maxWidth))):direction.indexOf("w")>=0&&(windowRight=initialPosition.left+initialSize.width,newWidth=constrain(windowRight-x,options.minWidth,options.maxWidth),wrapper.css({left:windowRight-newWidth-containerOffset.left,width:newWidth})),direction.indexOf("s")>=0?(newHeight=y-initialPosition.top-that.elementPadding,wrapper.height(constrain(newHeight,options.minHeight,options.maxHeight))):direction.indexOf("n")>=0&&(windowBottom=initialPosition.top+initialSize.height,newHeight=constrain(windowBottom-y,options.minHeight,options.maxHeight),wrapper.css({top:windowBottom-newHeight-containerOffset.top,height:newHeight})),newWidth&&(wnd.options.width=newWidth+"px"),newHeight&&(wnd.options.height=newHeight+"px"),wnd.resize()},dragend:function(e){var that=this,wnd=that.owner,wrapper=wnd.wrapper;return wrapper.children(KWINDOWRESIZEHANDLES).not(e.currentTarget).show(),$(BODY).css(CURSOR,""),wnd.touchScroller&&wnd.touchScroller.reset(),27==e.keyCode&&wrapper.css(that.initialCursorPosition).css(that.initialSize),!1},destroy:function(){this._draggable&&this._draggable.destroy(),this._draggable=this.owner=null}},WindowDragging.prototype={dragstart:function(e){var wnd=this.owner,element=wnd.element,actions=element.find(".k-window-actions"),containerOffset=kendo.getOffset(wnd.appendTo);wnd.trigger(DRAGSTART),wnd.initialWindowPosition=kendo.getOffset(wnd.wrapper,"position"),wnd.startPosition={left:e.x.client-wnd.initialWindowPosition.left,top:e.y.client-wnd.initialWindowPosition.top},actions.length>0?wnd.minLeftPosition=actions.outerWidth()+parseInt(actions.css("right"),10)-element.outerWidth():wnd.minLeftPosition=20-element.outerWidth(),wnd.minLeftPosition-=containerOffset.left,wnd.minTopPosition=-containerOffset.top,wnd.wrapper.append(templates.overlay).children(KWINDOWRESIZEHANDLES).hide(),$(BODY).css(CURSOR,e.currentTarget.css(CURSOR))},drag:function(e){var wnd=this.owner,position=wnd.options.position,newTop=Math.max(e.y.client-wnd.startPosition.top,wnd.minTopPosition),newLeft=Math.max(e.x.client-wnd.startPosition.left,wnd.minLeftPosition),coordinates={left:newLeft,top:newTop};$(wnd.wrapper).css(coordinates),position.top=newTop,position.left=newLeft},_finishDrag:function(){var wnd=this.owner;wnd.wrapper.children(KWINDOWRESIZEHANDLES).toggle(!wnd.options.isMinimized).end().find(KOVERLAY).remove(),$(BODY).css(CURSOR,"")},dragcancel:function(e){this._finishDrag(),e.currentTarget.closest(KWINDOW).css(this.owner.initialWindowPosition)},dragend:function(){return this._finishDrag(),this.owner.trigger(DRAGEND),!1},destroy:function(){this._draggable&&this._draggable.destroy(),this._draggable=this.owner=null}},kendo.ui.plugin(Window)}(window.kendo.jQuery),function($,undefined){function initPopOvers(element){var idx,length,popovers=element.find(roleSelector("popover")),roles=ui.roles;for(idx=0,length=popovers.length;idx<length;idx++)kendo.initWidget(popovers[idx],{},roles)}function preventScrollIfNotInput(e){kendo.triggeredByInput(e)||e.preventDefault()}function initWidgets(collection){collection.each(function(){kendo.initWidget($(this),{},ui.roles)})}var kendo=window.kendo,mobile=kendo.mobile,ui=mobile.ui,attr=kendo.attr,Widget=(kendo.Class,ui.Widget),ViewClone=kendo.ViewClone,INIT="init",UI_OVERLAY='<div style="height: 100%; width: 100%; position: absolute; top: 0; left: 0; z-index: 20000; display: none" />',BEFORE_SHOW="beforeShow",SHOW="show",AFTER_SHOW="afterShow",BEFORE_HIDE="beforeHide",HIDE="hide",DESTROY="destroy",attrValue=kendo.attrValue,roleSelector=kendo.roleSelector,View=Widget.extend({init:function(element,options){Widget.fn.init.call(this,element,options),this.params={},$.extend(this,options),this.transition=this.transition||this.defaultTransition,this._id(),this._layout(),this._overlay(),this._scroller(),this._model()},events:[INIT,BEFORE_SHOW,SHOW,AFTER_SHOW,BEFORE_HIDE,HIDE,DESTROY],options:{name:"View",title:"",reload:!1,transition:"",defaultTransition:"",useNativeScrolling:!1,stretch:!1,zoom:!1,model:null,initWidgets:!0},enable:function(enable){"undefined"==typeof enable&&(enable=!0),enable?this.overlay.hide():this.overlay.show()},destroy:function(){this.layout&&this.layout.detach(this),this.trigger(DESTROY),Widget.fn.destroy.call(this),this.scroller&&this.scroller.destroy(),kendo.destroy(this.element)},purge:function(){this.destroy(),this.element.remove()},triggerBeforeShow:function(){return!this.trigger(BEFORE_SHOW,{view:this})},showStart:function(){var that=this;that.element.css("display",""),that.inited||(that.inited=!0,that.trigger(INIT,{view:that})),that.layout&&that.layout.attach(that),that._padIfNativeScrolling(),that.trigger(SHOW,{view:that}),kendo.resize(that.element)},showEnd:function(){this.trigger(AFTER_SHOW,{view:this}),this._padIfNativeScrolling()},hideStart:function(){this.trigger(BEFORE_HIDE,{view:this})},hideEnd:function(){var that=this;that.element.hide(),that.trigger(HIDE,{view:that}),that.layout&&that.layout.trigger(HIDE,{view:that,layout:that.layout})},_padIfNativeScrolling:function(){if(mobile.appLevelNativeScrolling()){var isAndroid=kendo.support.mobileOS&&kendo.support.mobileOS.android,topContainer=isAndroid?"footer":"header",bottomContainer=isAndroid?"header":"footer";this.content.css({paddingTop:this[topContainer].height(),paddingBottom:this[bottomContainer].height()})}},contentElement:function(){var that=this;return that.options.stretch?that.content:that.scrollerContent},clone:function(back){return new ViewClone(this);
},_scroller:function(){var that=this;mobile.appLevelNativeScrolling()||(that.options.stretch?that.content.addClass("km-stretched-view"):(that.content.kendoMobileScroller({zoom:that.options.zoom,useNative:that.options.useNativeScrolling}),that.scroller=that.content.data("kendoMobileScroller"),that.scrollerContent=that.scroller.scrollElement),kendo.support.kineticScrollNeeded&&($(that.element).on("touchmove",".km-header",preventScrollIfNotInput),that.options.useNativeScrolling||$(that.element).on("touchmove",".km-content",preventScrollIfNotInput)))},_model:function(){var that=this,element=that.element,model=that.options.model;"string"==typeof model&&(model=kendo.getter(model)(window)),that.model=model,initPopOvers(element),that.element.css("display",""),that.options.initWidgets&&(model?kendo.bind(element.children(),model,ui,kendo.ui,kendo.dataviz.ui):mobile.init(element.children())),that.element.css("display","none")},_id:function(){var element=this.element,idAttrValue=element.attr("id")||"";this.id=attrValue(element,"url")||"#"+idAttrValue,"#"==this.id&&(this.id=kendo.guid(),element.attr("id",this.id))},_layout:function(){var that=this,contentSelector=roleSelector("content"),element=that.element;element.addClass("km-view"),that.header=element.children(roleSelector("header")).addClass("km-header"),that.footer=element.children(roleSelector("footer")).addClass("km-footer"),element.children(contentSelector)[0]||element.wrapInner("<div "+attr("role")+'="content"></div>'),that.content=element.children(roleSelector("content")).addClass("km-content"),that.element.prepend(that.header).append(that.footer),that.layout&&that.layout.setup(that)},_overlay:function(){this.overlay=$(UI_OVERLAY).appendTo(this.element)}}),Layout=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),element=that.element,that.header=element.children(roleSelector("header")).addClass("km-header"),that.footer=element.children(roleSelector("footer")).addClass("km-footer"),that.elements=that.header.add(that.footer),initPopOvers(element),kendo.mobile.init(that.element.children()),that.element.detach(),that.trigger(INIT,{layout:that})},options:{name:"Layout"},events:[INIT,SHOW,HIDE],setup:function(view){view.header[0]||(view.header=this.header),view.footer[0]||(view.footer=this.footer)},detach:function(view){var that=this;view.header===that.header&&that.header[0]&&view.element.prepend(that.header.detach()[0].cloneNode(!0)),view.footer===that.footer&&that.footer.length&&view.element.append(that.footer.detach()[0].cloneNode(!0))},attach:function(view){var that=this,previousView=that.currentView;previousView&&that.detach(previousView),view.header===that.header&&(that.header.detach(),view.element.children(roleSelector("header")).remove(),view.element.prepend(that.header)),view.footer===that.footer&&(that.footer.detach(),view.element.children(roleSelector("footer")).remove(),view.element.append(that.footer)),that.trigger(SHOW,{layout:that,view:view}),that.currentView=view}}),Observable=kendo.Observable,bodyRegExp=/<body[^>]*>(([\u000a\u000d\u2028\u2029]|.)*)<\/body>/i,LOAD_START="loadStart",LOAD_COMPLETE="loadComplete",SHOW_START="showStart",SAME_VIEW_REQUESTED="sameViewRequested",VIEW_SHOW="viewShow",AFTER="after",ViewEngine=Observable.extend({init:function(options){var views,errorMessage,container,that=this;if(Observable.fn.init.call(that),$.extend(that,options),that.sandbox=$("<div />"),container=that.container,views=that._hideViews(container),that.rootView=views.first(),!that.rootView[0]&&options.rootNeeded)throw errorMessage=container[0]==kendo.mobile.application.element[0]?'Your kendo mobile application element does not contain any direct child elements with data-role="view" attribute set. Make sure that you instantiate the mobile application using the correct container.':'Your pane element does not contain any direct child elements with data-role="view" attribute set.',new Error(errorMessage);that.layouts={},that.viewContainer=new kendo.ViewContainer(that.container),that.viewContainer.bind("accepted",function(e){e.view.params=that.params}),that.viewContainer.bind("complete",function(e){that.trigger(VIEW_SHOW,{view:e.view})}),that.viewContainer.bind(AFTER,function(e){that.trigger(AFTER)}),that._setupLayouts(container),initWidgets(container.children(roleSelector("modalview drawer")))},destroy:function(){kendo.destroy(this.container);for(var id in this.layouts)this.layouts[id].destroy()},view:function(){return this.viewContainer.view},showView:function(url,transition,params){if(url=url.replace(new RegExp("^"+this.remoteViewURLPrefix),""),""===url&&this.remoteViewURLPrefix&&(url="/"),url===this.url)return this.trigger(SAME_VIEW_REQUESTED),!1;this.trigger(SHOW_START);var that=this,showClosure=function(view){return that.viewContainer.show(view,transition,url)},element=that._findViewElement(url),view=kendo.widgetInstance(element);return that.url=url,that.params=params,view&&view.reload&&(view.purge(),element=[]),this.trigger("viewTypeDetermined",{remote:0===element.length,url:url}),element[0]?(view||(view=that._createView(element)),showClosure(view)):(that._loadView(url,showClosure),!0)},append:function(html,url){var views,modalViews,view,that=this,sandbox=that.sandbox,urlPath=(url||"").split("?")[0],container=that.container;return bodyRegExp.test(html)&&(html=RegExp.$1),sandbox[0].innerHTML=html,container.append(sandbox.children("script, style")),views=that._hideViews(sandbox),view=views.first(),view.length||(views=view=sandbox.wrapInner("<div data-role=view />").children()),urlPath&&view.hide().attr(attr("url"),urlPath),that._setupLayouts(sandbox),modalViews=sandbox.children(roleSelector("modalview drawer")),container.append(sandbox.children(roleSelector("layout modalview drawer")).add(views)),initWidgets(modalViews),that._createView(view)},_findViewElement:function(url){var element,urlPath=url.split("?")[0];return urlPath?(element=this.container.children("["+attr("url")+"='"+urlPath+"']"),element[0]||urlPath.indexOf("/")!==-1||(element=this.container.children("#"===urlPath.charAt(0)?urlPath:"#"+urlPath)),element):this.rootView},_createView:function(element){var viewOptions,that=this,layout=attrValue(element,"layout");return"undefined"==typeof layout&&(layout=that.layout),layout&&(layout=that.layouts[layout]),viewOptions={defaultTransition:that.transition,loader:that.loader,container:that.container,layout:layout,reload:attrValue(element,"reload")},kendo.initWidget(element,viewOptions,ui.roles)},_loadView:function(url,callback){var that=this;return this.serverNavigation?void(location.href=url):(that._xhr&&that._xhr.abort(),that.trigger(LOAD_START),void(that._xhr=$.get(kendo.absoluteURL(url,that.remoteViewURLPrefix),function(html){that.trigger(LOAD_COMPLETE),callback(that.append(html,url))},"html").fail(function(request){that.trigger(LOAD_COMPLETE),0===request.status&&request.responseText&&callback(that.append(request.responseText,url))})))},_hideViews:function(container){return container.children(roleSelector("view splitview")).hide()},_setupLayouts:function(element){var that=this;element.children(roleSelector("layout")).each(function(){var layout=$(this),platform=attrValue(layout,"platform");platform!==undefined&&platform!==mobile.application.os.name||(that.layouts[kendo.attrValue(layout,"id")]=kendo.initWidget(layout,{},ui.roles))})}});kendo.mobile.ViewEngine=ViewEngine,ui.plugin(View),ui.plugin(Layout)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,ui=kendo.mobile.ui,Widget=ui.Widget,CAPTURE_EVENTS=$.map(kendo.eventMap,function(value){return value}).join(" ").split(" "),Loader=Widget.extend({init:function(container,options){var that=this,element=$('<div class="km-loader"><span class="km-loading km-spin"></span><span class="km-loading-left"></span><span class="km-loading-right"></span></div>');Widget.fn.init.call(that,element,options),that.container=container,that.captureEvents=!1,that._attachCapture(),element.append(that.options.loading).hide().appendTo(container)},options:{name:"Loader",loading:"<h1>Loading...</h1>",timeout:100},show:function(){var that=this;clearTimeout(that._loading),that.options.loading!==!1&&(that.captureEvents=!0,that._loading=setTimeout(function(){that.element.show()},that.options.timeout))},hide:function(){this.captureEvents=!1,clearTimeout(this._loading),this.element.hide()},changeMessage:function(message){this.options.loading=message,this.element.find(">h1").html(message)},transition:function(){this.captureEvents=!0,this.container.css("pointer-events","none")},transitionDone:function(){this.captureEvents=!1,this.container.css("pointer-events","")},_attachCapture:function(){function capture(e){that.captureEvents&&e.preventDefault()}var that=this;that.captureEvents=!1;for(var i=0;i<CAPTURE_EVENTS.length;i++)that.container[0].addEventListener(CAPTURE_EVENTS[i],capture,!0)}});ui.plugin(Loader)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,mobile=kendo.mobile,roleSelector=kendo.roleSelector,ui=mobile.ui,Widget=ui.Widget,ViewEngine=mobile.ViewEngine,View=ui.View,Loader=mobile.ui.Loader,EXTERNAL="external",HREF="href",DUMMY_HREF="#!",NAVIGATE="navigate",VIEW_SHOW="viewShow",SAME_VIEW_REQUESTED="sameViewRequested",WIDGET_RELS=/popover|actionsheet|modalview|drawer/,BACK="#:back",attrValue=kendo.attrValue,buttonRoles="button backbutton detailbutton listview-link",linkRoles="tab",Pane=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),options=that.options,element=that.element,element.addClass("km-pane"),that.options.collapsible&&element.addClass("km-collapsible-pane"),this.history=[],this.historyCallback=function(url,params){var transition=that.transition;return that.transition=null,that.viewEngine.showView(url,transition,params)},this._historyNavigate=function(url){if(url===BACK){if(1===that.history.length)return;that.history.pop(),url=that.history[that.history.length-1]}else that.history.push(url);that.historyCallback(url,kendo.parseQueryStringParams(url))},this._historyReplace=function(url){var params=kendo.parseQueryStringParams(url);that.history[that.history.length-1]=url,that.historyCallback(url,params)},that.loader=new Loader(element,{loading:that.options.loading}),that.viewEngine=new ViewEngine({container:element,transition:options.transition,rootNeeded:!options.initial,serverNavigation:options.serverNavigation,remoteViewURLPrefix:options.root||"",layout:options.layout,loader:that.loader}),that.viewEngine.bind("showStart",function(){that.loader.transition(),that.closeActiveDialogs()}),that.viewEngine.bind("after",function(e){that.loader.transitionDone()}),that.viewEngine.bind(VIEW_SHOW,function(e){that.trigger(VIEW_SHOW,e)}),that.viewEngine.bind("loadStart",function(){that.loader.show()}),that.viewEngine.bind("loadComplete",function(){that.loader.hide()}),that.viewEngine.bind(SAME_VIEW_REQUESTED,function(){that.trigger(SAME_VIEW_REQUESTED)}),that.viewEngine.bind("viewTypeDetermined",function(e){e.remote&&that.options.serverNavigation||that.trigger(NAVIGATE,{url:e.url})}),this._setPortraitWidth(),kendo.onResize(function(){that._setPortraitWidth()}),that._setupAppLinks()},closeActiveDialogs:function(){var dialogs=this.element.find(roleSelector("actionsheet popover modalview")).filter(":visible");dialogs.each(function(){kendo.widgetInstance($(this),ui).close()})},navigateToInitial:function(){var initial=this.options.initial;initial&&this.navigate(initial)},options:{name:"Pane",portraitWidth:"",transition:"",layout:"",collapsible:!1,initial:null,loading:"<h1>Loading...</h1>"},events:[NAVIGATE,VIEW_SHOW,SAME_VIEW_REQUESTED],append:function(html){return this.viewEngine.append(html)},destroy:function(){Widget.fn.destroy.call(this),this.viewEngine.destroy()},navigate:function(url,transition){url instanceof View&&(url=url.id),this.transition=transition,this._historyNavigate(url)},replace:function(url,transition){url instanceof View&&(url=url.id),this.transition=transition,this._historyReplace(url)},bindToRouter:function(router){var that=this,options=that.options,initial=options.initial,viewEngine=this.viewEngine;router.bind("init",function(e){var url=e.url,attrUrl=router.pushState?url:"/";viewEngine.rootView.attr(kendo.attr("url"),attrUrl),"/"===url&&initial&&(router.navigate(initial,!0),e.preventDefault())}),router.bind("routeMissing",function(e){that.historyCallback(e.url,e.params)||e.preventDefault()}),router.bind("same",function(){that.trigger(SAME_VIEW_REQUESTED)}),that._historyNavigate=function(url){router.navigate(url)},that._historyReplace=function(url){router.replace(url)}},hideLoading:function(){this.loader.hide()},showLoading:function(){this.loader.show()},changeLoadingMessage:function(message){this.loader.changeMessage(message)},view:function(){return this.viewEngine.view()},_setPortraitWidth:function(){var width,portraitWidth=this.options.portraitWidth;portraitWidth&&(width=kendo.mobile.application.element.is(".km-vertical")?portraitWidth:"auto",this.element.css("width",width))},_setupAppLinks:function(){this.element.handler(this).on("down",roleSelector(linkRoles),"_mouseup").on("up",roleSelector(buttonRoles),"_mouseup").on("click",roleSelector(linkRoles+" "+buttonRoles),"_appLinkClick")},_appLinkClick:function(e){var href=$(e.currentTarget).attr("href"),remote=href&&"#"!==href[0]&&this.options.serverNavigation;remote||attrValue($(e.currentTarget),"rel")==EXTERNAL||e.preventDefault()},_mouseup:function(e){if(!(e.which>1||e.isDefaultPrevented())){var pane=this,link=$(e.currentTarget),transition=attrValue(link,"transition"),rel=attrValue(link,"rel")||"",target=attrValue(link,"target"),href=link.attr(HREF),remote=href&&"#"!==href[0]&&this.options.serverNavigation;remote||rel===EXTERNAL||"undefined"==typeof href||href===DUMMY_HREF||(link.attr(HREF,DUMMY_HREF),setTimeout(function(){link.attr(HREF,href)}),rel.match(WIDGET_RELS)?(kendo.widgetInstance($(href),ui).openFor(link),"actionsheet"!==rel&&"drawer"!==rel||e.stopPropagation()):("_top"===target?pane=mobile.application.pane:target&&(pane=$("#"+target).data("kendoMobilePane")),pane.navigate(href,transition)),e.preventDefault())}}});Pane.wrap=function(element){element.is(roleSelector("view"))||(element=element.wrap("<div data-"+kendo.ns+'role="view" data-stretch="true"></div>').parent());var paneContainer=element.wrap('<div class="km-pane-wrapper"><div></div></div>').parent(),pane=new Pane(paneContainer);return pane.navigate(""),pane},ui.plugin(Pane)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,mobile=kendo.mobile,ui=mobile.ui,SHOW="show",HIDE="hide",OPEN="open",CLOSE="close",WRAPPER='<div class="km-popup-wrapper" />',ARROW='<div class="km-popup-arrow" />',OVERLAY='<div class="km-popup-overlay" />',DIRECTION_CLASSES="km-up km-down km-left km-right",Widget=ui.Widget,DIRECTIONS={down:{origin:"bottom center",position:"top center"},up:{origin:"top center",position:"bottom center"},left:{origin:"center left",position:"center right",collision:"fit flip"},right:{origin:"center right",position:"center left",collision:"fit flip"}},ANIMATION={animation:{open:{effects:"fade:in",duration:0},close:{effects:"fade:out",duration:400}}},DIMENSIONS={horizontal:{offset:"top",size:"height"},vertical:{offset:"left",size:"width"}},REVERSE={up:"down",down:"up",left:"right",right:"left"},Popup=Widget.extend({init:function(element,options){var popupOptions,axis,that=this,containerPopup=element.closest(".km-modalview-wrapper"),viewport=element.closest(".km-root").children(".km-pane").first(),container=containerPopup[0]?containerPopup:viewport;options.viewport?viewport=options.viewport:viewport[0]||(viewport=window),options.container?container=options.container:container[0]||(container=document.body),popupOptions={viewport:viewport,open:function(){that.overlay.show()},activate:$.proxy(that._activate,that),deactivate:function(){that.overlay.hide(),that.trigger(HIDE)}},Widget.fn.init.call(that,element,options),element=that.element,options=that.options,element.wrap(WRAPPER).addClass("km-popup").show(),axis=that.options.direction.match(/left|right/)?"horizontal":"vertical",that.dimensions=DIMENSIONS[axis],that.wrapper=element.parent().css({width:options.width,height:options.height}).addClass("km-popup-wrapper km-"+options.direction).hide(),that.arrow=$(ARROW).prependTo(that.wrapper).hide(),that.overlay=$(OVERLAY).appendTo(container).hide(),popupOptions.appendTo=that.overlay,popupOptions.copyAnchorStyles=!1,popupOptions.autosize=!0,options.className&&that.overlay.addClass(options.className),that.popup=new kendo.ui.Popup(that.wrapper,$.extend(!0,popupOptions,ANIMATION,DIRECTIONS[options.direction]))},options:{name:"Popup",width:240,height:"",direction:"down",container:null,viewport:null},events:[SHOW,HIDE],show:function(target){var that=this,popup=that.popup;popup.options.anchor=$(target),popup.open()},target:function(){return this.popup.options.anchor},hide:function(){this.popup.close()},destroy:function(){Widget.fn.destroy.call(this),this.popup.destroy(),this.overlay.remove()},_activate:function(){var that=this,direction=that.options.direction,dimensions=that.dimensions,offset=dimensions.offset,popup=that.popup,anchor=popup.options.anchor,anchorOffset=$(anchor).offset(),elementOffset=$(popup.element).offset(),cssClass=popup.flipped?REVERSE[direction]:direction,min=2*that.arrow[dimensions.size](),max=that.element[dimensions.size]()-that.arrow[dimensions.size](),size=$(anchor)[dimensions.size](),offsetAmount=anchorOffset[offset]-elementOffset[offset]+size/2;offsetAmount<min&&(offsetAmount=min),offsetAmount>max&&(offsetAmount=max),that.wrapper.removeClass(DIRECTION_CLASSES).addClass("km-"+cssClass),that.arrow.css(offset,offsetAmount).show(),that.trigger(SHOW)}}),PopOver=Widget.extend({init:function(element,options){var popupOptions,that=this;that.initialOpen=!1,Widget.fn.init.call(that,element,options),popupOptions=$.extend({className:"km-popover-root",show:function(){that.trigger(OPEN,{target:that.popup.target()})},hide:function(){that.trigger(CLOSE)}},this.options.popup),that.popup=new Popup(that.element,popupOptions),that.popup.overlay.on("move",!1),that.pane=new ui.Pane(that.element,this.options.pane),that.pane.navigateToInitial(),kendo.notify(that,ui)},options:{name:"PopOver",popup:{},pane:{}},events:[OPEN,CLOSE],open:function(target){this.openFor(target)},openFor:function(target){this.popup.show(target),this.initialOpen||(this.pane.navigate(""),this.popup.popup._position(),this.initialOpen=!0)},close:function(){this.popup.hide()},destroy:function(){Widget.fn.destroy.call(this),this.pane.destroy(),this.popup.destroy(),kendo.destroy(this.element)}});ui.plugin(Popup),ui.plugin(PopOver)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,ui=kendo.mobile.ui,Popup=kendo.ui.Popup,SHIM='<div class="km-shim"/>',SHOW="show",HIDE="hide",Widget=ui.Widget,Shim=Widget.extend({init:function(element,options){var that=this,app=kendo.mobile.application,os=kendo.support.mobileOS,osname=app?app.os.name:os?os.name:"ios",ioswp="ios"===osname||"wp"===osname||!!app&&app.os.skin,bb="blackberry"===osname,align=options.align||(ioswp?"bottom center":bb?"center right":"center center"),position=options.position||(ioswp?"bottom center":bb?"center right":"center center"),effect=options.effect||(ioswp?"slideIn:up":bb?"slideIn:left":"fade:in"),shim=$(SHIM).handler(that).hide();Widget.fn.init.call(that,element,options),that.shim=shim,element=that.element,options=that.options,options.className&&that.shim.addClass(options.className),options.modal||that.shim.on("up","hide"),(app?app.element:$(document.body)).append(shim),that.popup=new Popup(that.element,{anchor:shim,modal:!0,appendTo:shim,origin:align,position:position,animation:{open:{effects:effect,duration:options.duration},close:{duration:options.duration}},deactivate:function(){shim.hide()},open:function(){shim.show()}}),kendo.notify(that)},events:[SHOW,HIDE],options:{name:"Shim",modal:!1,align:undefined,position:undefined,effect:undefined,duration:200},show:function(){this.popup.open(),this.trigger(SHOW)},hide:function(e){e&&$.contains(this.shim.children().children(".k-popup")[0],e.target)||(this.popup.close(),this.trigger(HIDE))},destroy:function(){Widget.fn.destroy.call(this),this.shim.kendoDestroy(),this.popup.destroy(),this.shim.remove()}});ui.plugin(Shim)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,support=kendo.support,ui=kendo.mobile.ui,Shim=ui.Shim,Popup=ui.Popup,Widget=ui.Widget,OPEN="open",CLOSE="close",COMMAND="command",BUTTONS="li>a",CONTEXT_DATA="actionsheetContext",WRAP='<div class="km-actionsheet-wrapper" />',cancelTemplate=kendo.template('<li class="km-actionsheet-cancel"><a href="\\#">#:cancel#</a></li>'),ActionSheet=Widget.extend({init:function(element,options){var ShimClass,tablet,type,that=this,os=support.mobileOS;Widget.fn.init.call(that,element,options),options=that.options,type=options.type,tablet="auto"===type?os&&os.tablet:"tablet"===type,ShimClass=tablet?Popup:Shim,element=that.element,options.cancelTemplate&&(cancelTemplate=kendo.template(options.cancelTemplate)),element.addClass("km-actionsheet").append(cancelTemplate({cancel:that.options.cancel})).wrap(WRAP).on("up",BUTTONS,"_click").on("click",BUTTONS,kendo.preventDefault),that.view().bind("destroy",function(){that.destroy()}),that.wrapper=element.parent().addClass(type?" km-actionsheet-"+type:""),that.shim=new ShimClass(that.wrapper,$.extend({modal:os.ios&&os.majorVersion<7,className:"km-actionsheet-root"},that.options.popup)),kendo.notify(that,ui),tablet&&kendo.onResize($.proxy(this,"_resize"))},events:[OPEN,CLOSE,COMMAND],options:{name:"ActionSheet",cancel:"Cancel",type:"auto",popup:{height:"auto"}},open:function(target,context){var that=this;that.target=$(target),that.context=context,that.shim.show(target)},close:function(){this.context=this.target=null,this.shim.hide()},openFor:function(target){var that=this,context=target.data(CONTEXT_DATA);that.open(target,context),that.trigger(OPEN,{target:target,context:context})},destroy:function(){Widget.fn.destroy.call(this),this.shim.destroy()},_click:function(e){if(!e.isDefaultPrevented()){var currentTarget=$(e.currentTarget),action=currentTarget.data("action");action&&kendo.getter(action)(window)({target:this.target,context:this.context}),this.trigger(COMMAND,{target:this.target,context:this.context,currentTarget:currentTarget}),e.preventDefault(),this.close(),this.trigger(CLOSE)}},_resize:function(){this.shim.hide()}});ui.plugin(ActionSheet)}(window.kendo.jQuery),function($,undefined){function groupCells(count){return new Array(count+1).join('<td class="k-group-cell">&nbsp;</td>')}function stringifyAttributes(attributes){var attr,result=" ";if(attributes){if(typeof attributes===STRING)return attributes;for(attr in attributes)result+=attr+'="'+attributes[attr]+'"'}return result}function heightAboveHeader(context){var top=0;return $("> .k-grouping-header, > .k-grid-toolbar",context).each(function(){top+=this.offsetHeight}),top}function cursor(context,value){$("th, th .k-grid-filter, th .k-link",context).add(document.body).css("cursor",value)}function buildEmptyAggregatesObject(aggregates){var idx,length,aggregate={},fieldsMap={};if(!isEmptyObject(aggregates))for(isArray(aggregates)||(aggregates=[aggregates]),idx=0,length=aggregates.length;idx<length;idx++)aggregate[aggregates[idx].aggregate]=0,fieldsMap[aggregates[idx].field]=aggregate;return fieldsMap}function reorder(selector,source,dest,before){source=selector.eq(source),"number"==typeof dest?source[before?"insertBefore":"insertAfter"](selector.eq(dest)):source.appendTo(dest)}function elements(lockedContent,content,filter){return $(lockedContent).add(content).find(filter)}function attachCustomCommandEvent(context,container,commands){var idx,length,command,commandName;for(commands=isArray(commands)?commands:[commands],idx=0,length=commands.length;idx<length;idx++)command=commands[idx],isPlainObject(command)&&command.click&&(commandName=command.name||command.text,container.on(CLICK+NS,"a.k-grid-"+(commandName||"").replace(/\s/g,""),{commandName:commandName},proxy(command.click,context)))}function visibleColumns(columns){return grep(columns,function(column){return!column.hidden})}function columnsWidth(cols){for(var colWidth,width=0,idx=0,length=cols.length;idx<length;idx++)colWidth=cols[idx].style.width,colWidth&&colWidth.indexOf("%")==-1&&(width+=parseInt(colWidth,10));return width}function lockedColumns(columns){return grep(columns,function(column){return column.locked})}function nonLockedColumns(columns){return grep(columns,function(column){return!column.locked})}function visibleNonLockedColumns(columns){return grep(columns,function(column){return!column.locked&&!column.hidden})}function visibleLockedColumns(columns){return grep(columns,function(column){return column.locked&&!column.hidden})}function appendContent(tbody,table,html){var placeholder,tmp=tbody;return tbodySupportsInnerHtml?tbody[0].innerHTML=html:(placeholder=document.createElement("div"),placeholder.innerHTML="<table><tbody>"+html+"</tbody></table>",tbody=placeholder.firstChild.firstChild,table[0].replaceChild(tbody,tmp[0]),tbody=$(tbody)),tbody}function addHiddenStyle(attr){attr=attr||{};var style=attr.style;return style?(style=style.replace(/((.*)?display)(.*)?:([^;]*)/i,"$1:none"),style===attr.style&&(style=style.replace(/(.*)?/i,"display:none;$1"))):style="display:none",extend({},attr,{style:style})}function removeHiddenStyle(attr){attr=attr||{};var style=attr.style;return style&&(attr.style=style.replace(/(display\s*:\s*none\s*;?)*/gi,"")),attr}function normalizeCols(table,visibleColumns,hasDetails,groups){var width,colgroup=table.find(">colgroup"),cols=map(visibleColumns,function(column){return width=column.width,width&&0!==parseInt(width,10)?kendo.format('<col style="width:{0}"/>',typeof width===STRING?width:width+"px"):"<col />"});(hasDetails||colgroup.find(".k-hierarchy-col").length)&&cols.splice(0,0,'<col class="k-hierarchy-col" />'),colgroup.length&&colgroup.remove(),colgroup=$(new Array(groups+1).join('<col class="k-group-col">')+cols.join("")),colgroup.is("colgroup")||(colgroup=$("<colgroup/>").append(colgroup)),table.prepend(colgroup),browser.msie&&8==browser.version&&(table.css("display","inline-table"),window.setTimeout(function(){table.css("display","")},1))}function normalizeHeaderCells(th,columns){var idx,len,lastIndex=0;for(idx=0,len=columns.length;idx<len;idx++)columns[idx].locked&&(th.eq(idx).insertBefore(th.eq(lastIndex)),lastIndex++)}function convertToObject(array){var item,idx,length,result={};for(idx=0,length=array.length;idx<length;idx++)item=array[idx],result[item.value]=item.text;return result}function formatGroupValue(value,format,columnValues){var isForiegnKey=columnValues&&columnValues.length&&isPlainObject(columnValues[0])&&"value"in columnValues[0],groupValue=isForiegnKey?convertToObject(columnValues)[value]:value;return groupValue=null!=groupValue?groupValue:"",format?kendo.format(format,groupValue):groupValue}function setCellVisibility(cells,index,visible){for(var state,pad=0,cell=cells[pad];cell;){if(state=!!visible||"none"!==cell.style.display,state&&!nonDataCellsRegExp.test(cell.className)&&--index<0){cell.style.display=visible?"":"none";break}cell=cells[++pad]}}function hideColumnCells(rows,columnIndex){for(var cell,row,idx=0,length=rows.length;idx<length;idx+=1)row=rows.eq(idx),row.is(".k-grouping-row,.k-detail-row")?(cell=row.children(":not(.k-group-cell):first,.k-detail-cell").last(),cell.attr("colspan",parseInt(cell.attr("colspan"),10)-1)):(row.hasClass("k-grid-edit-row")&&(cell=row.children(".k-edit-container")[0])&&(cell=$(cell),cell.attr("colspan",parseInt(cell.attr("colspan"),10)-1),cell.find("col").eq(columnIndex).remove(),row=cell.find("tr:first")),setCellVisibility(row[0].cells,columnIndex,!1))}function showColumnCells(rows,columnIndex){for(var cell,row,columns,idx=0,length=rows.length;idx<length;idx+=1)row=rows.eq(idx),row.is(".k-grouping-row,.k-detail-row")?(cell=row.children(":not(.k-group-cell):first,.k-detail-cell").last(),cell.attr("colspan",parseInt(cell.attr("colspan"),10)+1)):(row.hasClass("k-grid-edit-row")&&(cell=row.children(".k-edit-container")[0])&&(cell=$(cell),cell.attr("colspan",parseInt(cell.attr("colspan"),10)+1),normalizeCols(cell.find(">form>table"),visibleColumns(columns),!1,0),row=cell.find("tr:first")),setCellVisibility(row[0].cells,columnIndex,!0))}function updateColspan(toAdd,toRemove){var item,idx,length;for(idx=0,length=toAdd.length;idx<length;idx+=1)item=toAdd.eq(idx).children().last(),item.attr("colspan",parseInt(item.attr("colspan"),10)+1),item=toRemove.eq(idx).children().last(),item.attr("colspan",parseInt(item.attr("colspan"),10)-1)}function tableWidth(table){var idx,length,width=0,cols=table.find(">colgroup>col");for(idx=0,length=cols.length;idx<length;idx+=1)width+=parseInt(cols[idx].style.width,10);return width}function adjustRowHeight(row1,row2){var height,clientHeight1=row1.clientHeight,clientHeight2=row2.clientHeight;clientHeight1>clientHeight2?height=clientHeight1+"px":clientHeight1<clientHeight2&&(height=clientHeight2+"px"),height&&(row1.style.height=row2.style.height=height)}function getCommand(commands,name){var idx,length,command;if(typeof commands===STRING&&commands===name)return commands;if(isPlainObject(commands)&&commands.name===name)return commands;if(isArray(commands))for(idx=0,length=commands.length;idx<length;idx++)if(command=commands[idx],typeof command===STRING&&command===name||command.name===name)return command;return null}function focusTable(table,direct){var msie=browser.msie;if(direct===!0){table=$(table);var scrollTop,scrollLeft,condition=!0;if(condition&&(scrollTop=table.parent().scrollTop(),scrollLeft=table.parent().scrollLeft()),msie)try{table[0].setActive()}catch(e){table[0].focus()}else table[0].focus();condition&&(table.parent().scrollTop(scrollTop),table.parent().scrollLeft(scrollLeft))}else $(table).one("focusin",function(e){e.preventDefault()}).focus()}function tableClick(e){var currentTarget=$(e.currentTarget),isHeader=currentTarget.is("th"),table=this.table.add(this.lockedTable),headerTable=this.thead.parent().add($(">table",this.lockedHeader)),currentTable=currentTarget.closest("table")[0];kendo.support.touch||currentTable!==table[0]&&currentTable!==table[1]&&currentTable!==headerTable[0]&&currentTable!==headerTable[1]||(this.current(currentTarget),!isHeader&&$(e.target).is(":button,a,:input,a>.k-icon,textarea,span.k-icon,span.k-link,.k-input,.k-multiselect-wrap")||setTimeout(function(){isIE8&&$(kendo._activeElement()).hasClass("k-widget")||focusTable(currentTable,!0)}),isHeader&&e.preventDefault())}function verticalTable(current,downTable,upTable,up){if(current=$(current),up){var temp=downTable;downTable=upTable,upTable=temp}return downTable.not(current).length!=downTable.length?current:current[0]==upTable[0]?downTable.eq(0):downTable.eq(1)}function moveVertical(current,currentTable,dataTable,headerTable,up){var row,index,nextFn=up?"prevAll":"nextAll";return current?(row=current.parent()[nextFn](NAVROW).first(),row[0]||!up&&!current.is("th")||(currentTable=verticalTable(currentTable,dataTable,headerTable,up),focusTable(currentTable),row=currentTable.find((up?">thead>":">tbody>")+NAVROW).first()),index=current.index(),current=row.children().eq(index),current[0]&&current.is(NAVCELL)||(current=row.children(NAVCELL).first())):current=dataTable.find(FIRSTNAVITEM),current}function moveLeft(current,currentTable,dataTable,headerTable,relatedRow){var isLocked=dataTable.length>1;return current?current.prev(":visible")[0]?current=current.prevAll(DATA_CELL).first():isLocked&&(currentTable==dataTable[1]?(focusTable(dataTable[0]),current=relatedRow(current.parent()).children(DATA_CELL).last()):currentTable==headerTable[1]&&(focusTable(headerTable[0]),current=headerTable.eq(0).find("tr>"+DATA_CELL).last())):current=dataTable.find(FIRSTNAVITEM),current}function moveRight(current,currentTable,dataTable,headerTable,relatedRow){
var isLocked=dataTable.length>1;return current?current.next(":visible")[0]?current=current.nextAll(DATA_CELL).first():isLocked&&(currentTable==dataTable[0]?(focusTable(dataTable[1]),current=relatedRow(current.parent()).children(DATA_CELL).first()):currentTable==headerTable[0]&&(focusTable(headerTable[1]),current=headerTable.eq(1).find("tr>"+DATA_CELL).first())):current=dataTable.find(FIRSTNAVITEM),current}function tabNext(current,currentTable,dataTable,relatedRow,back){var isLocked=2==dataTable.length,switchRow=!0,next=back?current.prevAll(DATA_CELL+":first"):current.nextAll(":visible:first");return next.length||(next=current.parent(),isLocked&&(switchRow=back&&currentTable==dataTable[0]||!back&&currentTable==dataTable[1],next=relatedRow(next)),switchRow&&(next=next[back?"prevAll":"nextAll"]("tr:not(.k-grouping-row):not(.k-detail-row):visible:first")),next=next.children(DATA_CELL+(back?":last":":first"))),next}function groupRowBuilder(colspan,level,text){return'<tr class="k-grouping-row">'+groupCells(level)+'<td colspan="'+colspan+'" aria-expanded="true"><p class="k-reset"><a class="k-icon k-i-collapse" href="#" tabindex="-1"></a>'+text+"</p></td></tr>"}function groupRowLockedContentBuilder(colspan,level,text){return'<tr class="k-grouping-row"><td colspan="'+colspan+'" aria-expanded="true"><p class="k-reset">&nbsp;</p></td></tr>'}var kendo=window.kendo,ui=kendo.ui,DataSource=kendo.data.DataSource,Groupable=ui.Groupable,tbodySupportsInnerHtml=kendo.support.tbodyInnerHtml,activeElement=kendo._activeElement,Widget=ui.Widget,keys=kendo.keys,isPlainObject=$.isPlainObject,extend=$.extend,map=$.map,grep=$.grep,isArray=$.isArray,inArray=$.inArray,push=Array.prototype.push,proxy=$.proxy,isFunction=kendo.isFunction,isEmptyObject=$.isEmptyObject,math=Math,PROGRESS="progress",ERROR="error",DATA_CELL=":not(.k-group-cell):not(.k-hierarchy-cell):visible",SELECTION_CELL_SELECTOR="tbody>tr:not(.k-grouping-row):not(.k-detail-row):not(.k-group-footer) > td:not(.k-group-cell):not(.k-hierarchy-cell)",NAVROW="tr:not(.k-footer-template):visible",NAVCELL=":not(.k-group-cell):not(.k-hierarchy-cell):visible",FIRSTNAVITEM=NAVROW+":first>"+NAVCELL+":first",HEADERCELLS="th.k-header:not(.k-group-cell):not(.k-hierarchy-cell)",NS=".kendoGrid",EDIT="edit",SAVE="save",REMOVE="remove",DETAILINIT="detailInit",FILTERMENUINIT="filterMenuInit",COLUMNMENUINIT="columnMenuInit",CHANGE="change",COLUMNHIDE="columnHide",COLUMNSHOW="columnShow",SAVECHANGES="saveChanges",DATABOUND="dataBound",DETAILEXPAND="detailExpand",DETAILCOLLAPSE="detailCollapse",FOCUSED="k-state-focused",SELECTED="k-state-selected",COLUMNRESIZE="columnResize",COLUMNREORDER="columnReorder",COLUMNLOCK="columnLock",COLUMNUNLOCK="columnUnlock",CLICK="click",HEIGHT="height",TABINDEX="tabIndex",FUNCTION="function",STRING="string",DELETECONFIRM="Are you sure you want to delete this record?",CONFIRMDELETE="Delete",CANCELDELETE="Cancel",formatRegExp=/(\}|\#)/gi,templateHashRegExp=/#/gi,whitespaceRegExp="[\\x20\\t\\r\\n\\f]",nonDataCellsRegExp=new RegExp("(^|"+whitespaceRegExp+")(k-group-cell|k-hierarchy-cell)("+whitespaceRegExp+"|$)"),COMMANDBUTTONTMPL='<a class="k-button k-button-icontext #=className#" #=attr# href="\\#"><span class="#=iconClass# #=imageClass#"></span>#=text#</a>',DIR="dir",ASC="asc",SINGLE="single",FIELD="field",DESC="desc",sorterNS=".kendoSorter",TLINK=".k-link",ARIASORT="aria-sort",isRtl=!1,browser=kendo.support.browser,isIE7=browser.msie&&7==browser.version,isIE8=browser.msie&&8==browser.version,VirtualScrollable=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),that._refreshHandler=proxy(that.refresh,that),that.setDataSource(options.dataSource),that.wrap()},setDataSource:function(dataSource){var that=this;that.dataSource&&that.dataSource.unbind(CHANGE,that._refreshHandler),that.dataSource=dataSource,that.dataSource.bind(CHANGE,that._refreshHandler)},options:{name:"VirtualScrollable",itemHeight:$.noop},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.dataSource.unbind(CHANGE,that._refreshHandler),that.wrapper.add(that.verticalScrollbar).off(NS),that.drag&&(that.drag.destroy(),that.drag=null),that.wrapper=that.element=that.verticalScrollbar=null,that._refreshHandler=null},wrap:function(){var wrapper,that=this,scrollbar=kendo.support.scrollbar()+1,element=that.element;element.css({width:"auto",overflow:"hidden"}).css(isRtl?"padding-left":"padding-right",scrollbar),that.content=element.children().first(),wrapper=that.wrapper=that.content.wrap('<div class="k-virtual-scrollable-wrap"/>').parent().bind("DOMMouseScroll"+NS+" mousewheel"+NS,proxy(that._wheelScroll,that)),kendo.support.kineticScrollNeeded&&(that.drag=new kendo.UserEvents(that.wrapper,{global:!0,move:function(e){that.verticalScrollbar.scrollTop(that.verticalScrollbar.scrollTop()-e.y.delta),wrapper.scrollLeft(wrapper.scrollLeft()-e.x.delta),e.preventDefault()}})),that.verticalScrollbar=$('<div class="k-scrollbar k-scrollbar-vertical" />').css({width:scrollbar}).appendTo(element).bind("scroll"+NS,proxy(that._scroll,that))},_wheelScroll:function(e){var scrollTop=this.verticalScrollbar.scrollTop(),delta=kendo.wheelDeltaY(e);delta&&(e.preventDefault(),$(e.currentTarget).one("wheel"+NS,!1),this.verticalScrollbar.scrollTop(scrollTop+-delta))},_scroll:function(e){var that=this,scrollTop=e.currentTarget.scrollTop,dataSource=that.dataSource,rowHeight=that.itemHeight,skip=dataSource.skip()||0,start=that._rangeStart||skip,height=that.element.innerHeight(),isScrollingUp=!!(that._scrollbarTop&&that._scrollbarTop>scrollTop),firstItemIndex=math.max(math.floor(scrollTop/rowHeight),0),lastItemIndex=math.max(firstItemIndex+math.floor(height/rowHeight),0);that._scrollTop=scrollTop-start*rowHeight,that._scrollbarTop=scrollTop,that._fetch(firstItemIndex,lastItemIndex,isScrollingUp)||(that.wrapper[0].scrollTop=that._scrollTop)},_fetch:function(firstItemIndex,lastItemIndex,scrollingUp){var that=this,dataSource=that.dataSource,itemHeight=that.itemHeight,take=dataSource.take(),rangeStart=that._rangeStart||dataSource.skip()||0,currentSkip=math.floor(firstItemIndex/take)*take,fetching=!1,prefetchAt=.33;return firstItemIndex<rangeStart?(fetching=!0,rangeStart=math.max(0,lastItemIndex-take),that._scrollTop=(firstItemIndex-rangeStart)*itemHeight,that._page(rangeStart,take)):lastItemIndex>=rangeStart+take&&!scrollingUp?(fetching=!0,rangeStart=firstItemIndex,that._scrollTop=itemHeight,that._page(rangeStart,take)):that._fetching||(firstItemIndex<currentSkip+take-take*prefetchAt&&firstItemIndex>take&&dataSource.prefetch(currentSkip-take,take),lastItemIndex>currentSkip+take*prefetchAt&&dataSource.prefetch(currentSkip+take,take)),fetching},_page:function(skip,take){var that=this,dataSource=that.dataSource;clearTimeout(that._timeout),that._fetching=!0,that._rangeStart=skip,dataSource.inRange(skip,take)?dataSource.range(skip,take):(kendo.ui.progress(that.wrapper.parent(),!0),that._timeout=setTimeout(function(){dataSource.range(skip,take)},100))},refresh:function(){var totalHeight,idx,itemHeight,that=this,html="",maxHeight=25e4,dataSource=that.dataSource,rangeStart=that._rangeStart,scrollbar=kendo.support.kineticScrollNeeded?0:kendo.support.scrollbar(),wrapperElement=that.wrapper[0];kendo.ui.progress(that.wrapper.parent(),!1),clearTimeout(that._timeout),itemHeight=that.itemHeight=that.options.itemHeight()||0;var addScrollBarHeight=wrapperElement.scrollWidth>wrapperElement.offsetWidth?scrollbar:0;for(totalHeight=dataSource.total()*itemHeight+addScrollBarHeight,idx=0;idx<math.floor(totalHeight/maxHeight);idx++)html+='<div style="width:1px;height:'+maxHeight+'px"></div>';totalHeight%maxHeight&&(html+='<div style="width:1px;height:'+totalHeight%maxHeight+'px"></div>'),that.verticalScrollbar.html(html),wrapperElement.scrollTop=that._scrollTop,that.drag&&that.drag.cancel(),rangeStart&&!that._fetching&&(that._rangeStart=dataSource.skip(),1===dataSource.page()&&(that.verticalScrollbar[0].scrollTop=0)),that._fetching=!1}}),defaultCommands={create:{text:"Add new record",imageClass:"k-add",className:"k-grid-add",iconClass:"k-icon"},cancel:{text:"Cancel changes",imageClass:"k-cancel",className:"k-grid-cancel-changes",iconClass:"k-icon"},save:{text:"Save changes",imageClass:"k-update",className:"k-grid-save-changes",iconClass:"k-icon"},destroy:{text:"Delete",imageClass:"k-delete",className:"k-grid-delete",iconClass:"k-icon"},edit:{text:"Edit",imageClass:"k-edit",className:"k-grid-edit",iconClass:"k-icon"},update:{text:"Update",imageClass:"k-update",className:"k-primary k-grid-update",iconClass:"k-icon"},canceledit:{text:"Cancel",imageClass:"k-cancel",className:"k-grid-cancel",iconClass:"k-icon"}},Grid=Widget.extend({init:function(element,options){var that=this;options=isArray(options)?{dataSource:options}:options,Widget.fn.init.call(that,element,options),isRtl=kendo.support.isRtl(element),that._element(),that._aria(),that._columns(that.options.columns),that._dataSource(),that._tbody(),that._pageable(),that._thead(),that._groupable(),that._toolbar(),that._setContentHeight(),that._templates(),that._navigatable(),that._selectable(),that._details(),that._editable(),that._attachCustomCommandsEvent(),that.options.autoBind?that.dataSource.fetch():that._footer(),that.lockedContent&&(that.wrapper.addClass("k-grid-lockedcolumns"),that._resizeHandler=function(){that.resize()},$(window).on("resize"+NS,that._resizeHandler)),kendo.notify(that)},events:[CHANGE,"dataBinding","cancel",DATABOUND,DETAILEXPAND,DETAILCOLLAPSE,DETAILINIT,FILTERMENUINIT,COLUMNMENUINIT,EDIT,SAVE,REMOVE,SAVECHANGES,COLUMNRESIZE,COLUMNREORDER,COLUMNSHOW,COLUMNHIDE,COLUMNLOCK,COLUMNUNLOCK],setDataSource:function(dataSource){var that=this;that.options.dataSource=dataSource,that._dataSource(),that._pageable(),that._thead(),that.options.groupable&&that._groupable(),that.virtualScrollable&&that.virtualScrollable.setDataSource(that.options.dataSource),that.options.navigatable&&that._navigatable(),that.selectable&&that._selectable(),that.options.autoBind&&dataSource.fetch()},options:{name:"Grid",columns:[],toolbar:null,autoBind:!0,filterable:!1,scrollable:!0,sortable:!1,selectable:!1,navigatable:!1,pageable:!1,editable:!1,groupable:!1,rowTemplate:"",altRowTemplate:"",dataSource:{},height:null,resizable:!1,reorderable:!1,columnMenu:!1,detailTemplate:null,columnResizeHandleWidth:3,mobile:""},destroy:function(){var element,that=this;Widget.fn.destroy.call(that),that._resizeHandler&&$(window).off("resize"+NS,that._resizeHandler),that.pager&&that.pager.element&&that.pager.destroy(),that.pager=null,that.groupable&&that.groupable.element&&that.groupable.element.kendoGroupable("destroy"),that.groupable=null,that.options.reorderable&&that.wrapper.data("kendoReorderable").destroy(),that.selectable&&that.selectable.destroy(),that.resizable&&(that.resizable.destroy(),that._resizeUserEvents&&(that._resizeHandleDocumentClickHandler&&$(document).off("click",that._resizeHandleDocumentClickHandler),that._resizeUserEvents.destroy(),that._resizeUserEvents=null),that.resizable=null),that.virtualScrollable&&that.virtualScrollable.element&&that.virtualScrollable.destroy(),that.virtualScrollable=null,that._destroyColumnAttachments(),that._destroyEditable(),that.dataSource&&(that.dataSource.unbind(CHANGE,that._refreshHandler).unbind(PROGRESS,that._progressHandler).unbind(ERROR,that._errorHandler),that._refreshHandler=that._progressHandler=that._errorHandler=null),element=that.element.add(that.wrapper).add(that.table).add(that.thead).add(that.wrapper.find(">.k-grid-toolbar")),that.content&&(element=element.add(that.content).add(that.content.find(">.k-virtual-scrollable-wrap"))),that.lockedHeader&&that._removeLockedContainers(),that.pane&&that.pane.destroy(),that._draggableInstance&&that._draggableInstance.element&&that._draggableInstance.destroy(),that._draggableInstance=null,element.off(NS),kendo.destroy(that.wrapper),that.scrollables=that.thead=that.tbody=that.element=that.table=that.content=that.footer=that.wrapper=that._groupableClickHandler=that._setContentWidthHandler=null},setOptions:function(options){var that=this;Widget.fn.setOptions.call(this,options),that._templates()},items:function(){return this.tbody.children().filter(function(){var tr=$(this);return!tr.hasClass("k-grouping-row")&&!tr.hasClass("k-detail-row")&&!tr.hasClass("k-group-footer")})},_destroyColumnAttachments:function(){var that=this;that.resizeHandle=null,that.thead&&that.thead.find("th").each(function(){var th=$(this),filterMenu=th.data("kendoFilterMenu"),sortable=th.data("kendoSorter"),columnMenu=th.data("kendoColumnMenu");filterMenu&&filterMenu.destroy(),sortable&&sortable.destroy(),columnMenu&&columnMenu.destroy()})},_attachCustomCommandsEvent:function(){var command,idx,length,that=this,columns=that.columns||[];for(idx=0,length=columns.length;idx<length;idx++)command=columns[idx].command,command&&attachCustomCommandEvent(that,that.wrapper,command)},_aria:function(){var id=this.element.attr("id")||"aria";id&&(this._cellId=id+"_active_cell")},_element:function(){var that=this,table=that.element;table.is("table")||(table=that.options.scrollable?that.element.find("> .k-grid-content > table"):that.element.children("table"),table.length||(table=$("<table />").appendTo(that.element))),isIE7&&table.attr("cellspacing",0),that.table=table.attr("role",that._hasDetails()?"treegrid":"grid"),that._wrapper()},_createResizeHandle:function(container,th){var left,that=this,indicatorWidth=that.options.columnResizeHandleWidth,scrollable=that.options.scrollable,resizeHandle=that.resizeHandle;if(resizeHandle&&that.lockedContent&&resizeHandle.data("th")[0]!==th[0]&&(resizeHandle.remove(),resizeHandle=null),resizeHandle||(resizeHandle=that.resizeHandle=$('<div class="k-resize-handle"><div class="k-resize-handle-inner"></div></div>'),container.append(resizeHandle)),isRtl){if(left=th.position().left,scrollable){var headerWrap=th.closest(".k-grid-header-wrap, .k-grid-header-locked"),ieCorrection=browser.msie?headerWrap.scrollLeft():0,webkitCorrection=browser.webkit?headerWrap[0].scrollWidth-headerWrap[0].offsetWidth-headerWrap.scrollLeft():0,firefoxCorrection=browser.mozilla?headerWrap[0].scrollWidth-headerWrap[0].offsetWidth-(headerWrap[0].scrollWidth-headerWrap[0].offsetWidth-headerWrap.scrollLeft()):0;left-=webkitCorrection-firefoxCorrection+ieCorrection}}else left=th[0].offsetWidth,th.prevAll(":visible").each(function(){left+=this.offsetWidth});resizeHandle.css({top:scrollable?0:heightAboveHeader(that.wrapper),left:left-indicatorWidth,height:th.outerHeight(),width:3*indicatorWidth}).data("th",th).show()},_positionColumnResizeHandle:function(container){var that=this,indicatorWidth=that.options.columnResizeHandleWidth,lockedHead=that.lockedHeader?that.lockedHeader.find("thead:first"):$();that.thead.add(lockedHead).on("mousemove"+NS,"th",function(e){var th=$(this);if(!th.hasClass("k-group-cell")&&!th.hasClass("k-hierarchy-cell")){var clientX=e.clientX,winScrollLeft=$(window).scrollLeft(),position=th.offset().left+(isRtl?0:this.offsetWidth);clientX+winScrollLeft>position-indicatorWidth&&clientX+winScrollLeft<position+indicatorWidth?that._createResizeHandle(th.closest("div"),th):that.resizeHandle?that.resizeHandle.hide():cursor(that.wrapper,"")}})},_resizeHandleDocumentClick:function(e){$(e.target).closest(".k-column-active").length||($(document).off(e),this._hideResizeHandle())},_hideResizeHandle:function(){this.resizeHandle&&(this.resizeHandle.data("th").removeClass("k-column-active"),this.lockedContent&&!this._isMobile?(this.resizeHandle.remove(),this.resizeHandle=null):this.resizeHandle.hide())},_positionColumnResizeHandleTouch:function(container){var that=this,lockedHead=that.lockedHeader?that.lockedHeader.find("thead:first"):$();that._resizeUserEvents=new kendo.UserEvents(lockedHead.add(that.thead),{filter:"th:not(.k-group-cell):not(.k-hierarchy-cell)",threshold:10,hold:function(e){var th=$(e.target);e.preventDefault(),th.addClass("k-column-active"),that._createResizeHandle(th.closest("div"),th),that._resizeHandleDocumentClickHandler||(that._resizeHandleDocumentClickHandler=proxy(that._resizeHandleDocumentClick,that)),$(document).on("click",that._resizeHandleDocumentClickHandler)}})},_resizable:function(){var container,columnStart,columnWidth,gridWidth,isLocked,col,th,that=this,options=that.options,isMobile=this._isMobile,scrollbar=kendo.support.mobileOS?0:kendo.support.scrollbar();options.resizable&&(container=options.scrollable?that.wrapper.find(".k-grid-header-wrap:first"):that.wrapper,isMobile?that._positionColumnResizeHandleTouch(container):that._positionColumnResizeHandle(container),that.resizable&&that.resizable.destroy(),that.resizable=new ui.Resizable(container.add(that.lockedHeader),{handle:".k-resize-handle",hint:function(handle){return $('<div class="k-grid-resize-indicator" />').css({height:handle.data("th").outerHeight()+that.tbody.attr("clientHeight")})},start:function(e){th=$(e.currentTarget).data("th"),isMobile&&that._hideResizeHandle();var index=$.inArray(th[0],th.parent().children(":visible")),header=th.closest("table");isLocked=header.parent().hasClass("k-grid-header-locked");var contentTable=isLocked?that.lockedTable:that.table,footer=that.footer||$();that.footer&&that.lockedContent&&(footer=isLocked?that.footer.children(".k-grid-footer-locked"):that.footer.children(".k-grid-footer-wrap")),cursor(that.wrapper,"col-resize"),col=options.scrollable?header.find("col:eq("+index+")").add(contentTable.children("colgroup").find("col:eq("+index+")")).add(footer.find("colgroup").find("col:eq("+index+")")):contentTable.children("colgroup").find("col:eq("+index+")"),columnStart=e.x.location,columnWidth=th.outerWidth(),gridWidth=isLocked?contentTable.children("tbody").outerWidth():that.tbody.outerWidth()},resize:function(e){var rtlMultiplier=isRtl?-1:1,currentWidth=columnWidth+e.x.location*rtlMultiplier-columnStart*rtlMultiplier;if(options.scrollable){var footer=(isLocked?that.lockedFooter.children("table"):that.footer.find(">.k-grid-footer-wrap>table"))||$(),header=th.closest("table"),contentTable=isLocked?that.lockedTable:that.table,constrain=!1,totalWidth=that.wrapper.width()-scrollbar,width=currentWidth;isLocked&&gridWidth-columnWidth+width>totalWidth&&(width=columnWidth+(totalWidth-gridWidth-2*scrollbar),width<0&&(width=currentWidth),constrain=!0),width>10&&(col.css("width",width),gridWidth&&(width=constrain?totalWidth-2*scrollbar:gridWidth+e.x.location*rtlMultiplier-columnStart*rtlMultiplier,contentTable.add(header).add(footer).css("width",width),isLocked||(that._footerWidth=width)))}else currentWidth>10&&col.css("width",currentWidth)},resizeend:function(){var column,header,newWidth=th.outerWidth();cursor(that.wrapper,""),columnWidth!=newWidth&&(header=that.lockedHeader?that.lockedHeader.find("thead:first").add(that.thead):th.parent(),column=that.columns[header.find("th:not(.k-group-cell):not(.k-hierarchy-cell)").index(th)],column.width=newWidth,that.trigger(COLUMNRESIZE,{column:column,oldWidth:columnWidth,newWidth:newWidth}),that._applyLockedContainersWidth(),that._syncLockedContentHeight(),that._syncLockedHeaderHeight()),that._hideResizeHandle(),th=null}}))},_draggable:function(){var that=this;that.options.reorderable&&(that._draggableInstance&&that._draggableInstance.destroy(),that._draggableInstance=that.wrapper.kendoDraggable({group:kendo.guid(),filter:that.content?".k-grid-header:first "+HEADERCELLS:"table:first>.k-grid-header "+HEADERCELLS,drag:function(){that._hideResizeHandle()},hint:function(target){return $('<div class="k-header k-drag-clue" />').css({width:target.width(),paddingLeft:target.css("paddingLeft"),paddingRight:target.css("paddingRight"),lineHeight:target.height()+"px",paddingTop:target.css("paddingTop"),paddingBottom:target.css("paddingBottom")}).html(target.attr(kendo.attr("title"))||target.attr(kendo.attr("field"))||target.text()).prepend('<span class="k-icon k-drag-status k-denied" />')}}).data("kendoDraggable"))},_reorderable:function(){var that=this;that.options.reorderable&&(that.wrapper.data("kendoReorderable")&&that.wrapper.data("kendoReorderable").destroy(),that.wrapper.kendoReorderable({draggable:that._draggableInstance,dragOverContainers:function(index){return that.columns[index].lockable!==!1},inSameContainer:function(x,y){return $(x).parent()[0]===$(y).parent()[0]},change:function(e){var column=that.columns[e.oldIndex];that.trigger(COLUMNREORDER,{newIndex:e.newIndex,oldIndex:inArray(column,that.columns),column:column}),that.reorderColumn(e.newIndex,column,"before"===e.position)}}))},reorderColumn:function(destIndex,column,before){var rows,idx,length,lockChanged,that=this,columns=that.columns,sourceIndex=inArray(column,columns),destColumn=columns[destIndex],colSourceIndex=inArray(column,visibleColumns(columns)),colDest=inArray(destColumn,visibleColumns(columns)),headerCol=colDest,footerCol=colDest,lockedRows=$(),isLocked=!!destColumn.locked,lockedCount=lockedColumns(columns).length,footer=that.footer||that.wrapper.find(".k-grid-footer");if(sourceIndex!==destIndex&&(column.locked||!isLocked||1!=nonLockedColumns(columns).length)&&(!column.locked||isLocked||1!=lockedCount)){for(destColumn.hidden&&(isLocked?(colDest=that.lockedTable.find("colgroup"),headerCol=that.lockedHeader.find("colgroup"),footerCol=$(that.lockedFooter).find(">table>colgroup")):(colDest=that.tbody.prev(),headerCol=that.thead.prev(),footerCol=footer.find(".k-grid-footer-wrap").find(">table>colgroup"))),lockChanged=!!column.locked,lockChanged=lockChanged!=isLocked,column.locked=isLocked,that._hideResizeHandle(),before===undefined&&(before=destIndex<sourceIndex),columns.splice(before?destIndex:destIndex+1,0,column),columns.splice(sourceIndex<destIndex?sourceIndex:sourceIndex+1,1),that._templates(),reorder(elements(that.lockedHeader,that.thead.prev(),"col:not(.k-group-col,.k-hierarchy-col)"),colSourceIndex,headerCol,before),that.options.scrollable&&reorder(elements(that.lockedTable,that.tbody.prev(),"col:not(.k-group-col,.k-hierarchy-col)"),colSourceIndex,colDest,before),reorder(elements(that.lockedHeader,that.thead,"th.k-header:not(.k-group-cell,.k-hierarchy-cell)"),sourceIndex,destIndex,before),footer&&footer.length&&(reorder(elements(that.lockedFooter,footer.find(".k-grid-footer-wrap"),">table>colgroup>col:not(.k-group-col,.k-hierarchy-col)"),colSourceIndex,footerCol,before),reorder(footer.find(".k-footer-template>td:not(.k-group-cell,.k-hierarchy-cell)"),sourceIndex,destIndex,before)),rows=that.tbody.children(":not(.k-grouping-row,.k-detail-row)"),that.lockedTable&&(lockedCount>destIndex?lockedCount<=sourceIndex&&updateColspan(that.lockedTable.find(">tbody>tr.k-grouping-row"),that.table.find(">tbody>tr.k-grouping-row")):lockedCount>sourceIndex&&updateColspan(that.table.find(">tbody>tr.k-grouping-row"),that.lockedTable.find(">tbody>tr.k-grouping-row")),lockedRows=that.lockedTable.find(">tbody>tr:not(.k-grouping-row,.k-detail-row)")),idx=0,length=rows.length;idx<length;idx+=1)reorder(elements(lockedRows[idx],rows[idx],">td:not(.k-group-cell,.k-hierarchy-cell)"),sourceIndex,destIndex,before);that._updateTablesWidth(),that._applyLockedContainersWidth(),that._syncLockedContentHeight(),lockChanged&&(isLocked?that.trigger(COLUMNLOCK,{column:column}):that.trigger(COLUMNUNLOCK,{column:column}))}},lockColumn:function(column){var columns=this.columns;if(column="number"==typeof column?columns[column]:grep(columns,function(item){return item.field===column})[0],column&&!column.locked&&!column.hidden){var index=lockedColumns(columns).length-1;this.reorderColumn(index,column,!1)}},unlockColumn:function(column){var columns=this.columns;if(column="number"==typeof column?columns[column]:grep(columns,function(item){return item.field===column})[0],column&&column.locked&&!column.hidden){var index=lockedColumns(columns).length;this.reorderColumn(index,column,!0)}},cellIndex:function(td){var lockedColumnOffset=0;return this.lockedTable&&!$.contains(this.lockedTable[0],td[0])&&(lockedColumnOffset=lockedColumns(this.columns).length),$(td).parent().children("td:not(.k-group-cell,.k-hierarchy-cell)").index(td)+lockedColumnOffset},_modelForContainer:function(container){container=$(container),container.is("tr")||"popup"===this._editMode()||(container=container.closest("tr"));var id=container.attr(kendo.attr("uid"));return this.dataSource.getByUid(id)},_editable:function(){var that=this,selectable=that.selectable&&that.selectable.options.multiple,editable=that.options.editable,handler=function(){var target=activeElement(),cell=that._editContainer;!cell||$.contains(cell[0],target)||cell[0]===target||$(target).closest(".k-animation-container").length||that.editable.end()&&that.closeCell()};if(editable){var mode=that._editMode();"incell"===mode?editable.update!==!1&&that.wrapper.on(CLICK+NS,"tr:not(.k-grouping-row) > td",function(e){var td=$(this),isLockedCell=that.lockedTable&&td.closest("table")[0]===that.lockedTable[0];td.hasClass("k-hierarchy-cell")||td.hasClass("k-detail-cell")||td.hasClass("k-group-cell")||td.hasClass("k-edit-cell")||td.has("a.k-grid-delete").length||td.has("button.k-grid-delete").length||td.closest("tbody")[0]!==that.tbody[0]&&!isLockedCell||$(e.target).is(":input")||(that.editable?that.editable.end()&&(selectable&&$(activeElement()).blur(),that.closeCell(),that.editCell(td)):that.editCell(td))}).on("focusin"+NS,function(){clearTimeout(that.timer),that.timer=null}).on("focusout"+NS,function(){that.timer=setTimeout(handler,1)}):editable.update!==!1&&that.wrapper.on(CLICK+NS,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible a.k-grid-edit",function(e){e.preventDefault(),that.editRow($(this).closest("tr"))}),editable.destroy!==!1?that.wrapper.on(CLICK+NS,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible .k-grid-delete",function(e){e.preventDefault(),e.stopPropagation(),that.removeRow($(this).closest("tr"))}):that.wrapper.on(CLICK+NS,"tbody>tr:not(.k-detail-row,.k-grouping-row):visible button.k-grid-delete",function(e){e.stopPropagation(),that._confirmation()||e.preventDefault()})}},editCell:function(cell){cell=$(cell);var that=this,column=that.columns[that.cellIndex(cell)],model=that._modelForContainer(cell);if(that.closeCell(),model&&(!model.editable||model.editable(column.field))&&!column.command&&column.field){that._attachModelChange(model),that._editContainer=cell,that.editable=cell.addClass("k-edit-cell").kendoEditable({fields:{field:column.field,format:column.format,editor:column.editor,values:column.values},model:model,change:function(e){that.trigger(SAVE,{values:e.values,container:cell,model:model})&&e.preventDefault()}}).data("kendoEditable");var tr=cell.parent().addClass("k-grid-edit-row");that.lockedContent&&adjustRowHeight(tr[0],that._relatedRow(tr).addClass("k-grid-edit-row")[0]),that.trigger(EDIT,{container:cell,model:model})}},_adjustLockedHorizontalScrollBar:function(){var table=this.table,content=table.parent(),scrollbar=table[0].offsetWidth>content[0].clientWidth?kendo.support.scrollbar():0;this.lockedContent.height(content.height()-scrollbar)},_syncLockedContentHeight:function(){this.lockedTable&&(this._adjustLockedHorizontalScrollBar(),this._adjustRowsHeight(this.table,this.lockedTable))},_syncLockedHeaderHeight:function(){this.lockedHeader&&this._adjustRowsHeight(this.lockedHeader.children("table"),this.thead.parent())},_syncLockedFooterHeight:function(){this.lockedFooter&&this.footer&&this.footer.length&&this._adjustRowsHeight(this.lockedFooter.children("table"),this.footer.find(".k-grid-footer-wrap > table"))},_destroyEditable:function(){var that=this,destroy=function(){that.editable&&(that._detachModelChange(),that.editable.destroy(),that.editable=null,that._editContainer=null,that._destroyEditView())};that.editable&&("popup"!==that._editMode()||that._isMobile?destroy():that._editContainer.data("kendoWindow").bind("deactivate",destroy).close()),that._actionSheet&&(that._actionSheet.destroy(),that._actionSheet=null)},_destroyEditView:function(){this.editView&&(this.editView.purge(),this.editView=null,this.pane.navigate(""))},_attachModelChange:function(model){var that=this;that._modelChangeHandler=function(e){that._modelChange({field:e.field,model:this})},model.bind("change",that._modelChangeHandler)},_detachModelChange:function(){var that=this,container=that._editContainer,model=that._modelForContainer(container);model&&model.unbind(CHANGE,that._modelChangeHandler)},closeCell:function(isCancel){var id,column,tr,model,that=this,cell=that._editContainer;cell&&(id=cell.closest("tr").attr(kendo.attr("uid")),model=that.dataSource.getByUid(id),isCancel&&that.trigger("cancel",{container:cell,model:model})||(cell.removeClass("k-edit-cell"),column=that.columns[that.cellIndex(cell)],tr=cell.parent().removeClass("k-grid-edit-row"),that._destroyEditable(),that._displayCell(cell,column,model),cell.hasClass("k-dirty-cell")&&$('<span class="k-dirty"/>').prependTo(cell),that.lockedContent&&adjustRowHeight(tr.css("height","")[0],that._relatedRow(tr).css("height","")[0])))},_displayCell:function(cell,column,dataItem){var that=this,state={storage:{},count:0},settings=extend({},kendo.Template,that.options.templateSettings),tmpl=kendo.template(that._cellTmpl(column,state),settings);state.count>0&&(tmpl=proxy(tmpl,state.storage)),cell.empty().html(tmpl(dataItem))},removeRow:function(row){this._confirmation(row)&&this._removeRow(row)},_removeRow:function(row){var model,that=this,mode=that._editMode();"incell"!==mode&&that.cancelRow(),row=$(row).hide(),model=that._modelForContainer(row),model&&!that.trigger(REMOVE,{row:row,model:model})?(that.dataSource.remove(model),"inline"!==mode&&"popup"!==mode||that.dataSource.sync()):"incell"===mode&&that._destroyEditable()},_editMode:function(){var mode="incell",editable=this.options.editable;return editable!==!0&&(mode="string"==typeof editable?editable:editable.mode||mode),mode},editRow:function(row){var model,that=this;row instanceof kendo.data.ObservableObject?model=row:(row=$(row),model=that._modelForContainer(row));var container,mode=that._editMode(),navigatable=that.options.navigatable;that.cancelRow(),model&&(that._attachModelChange(model),"popup"===mode?that._createPopupEditor(model):"inline"===mode?that._createInlineEditor(row,model):"incell"===mode&&$(row).children(DATA_CELL).each(function(){var cell=$(this),column=that.columns[cell.index()];if(model=that._modelForContainer(cell),model&&(!model.editable||model.editable(column.field))&&column.field)return that.editCell(cell),!1}),container=that.editView?that.editView.element:that._editContainer,container.on(CLICK+NS,"a.k-grid-cancel",function(e){if(e.preventDefault(),e.stopPropagation(),!that.trigger("cancel",{container:container,model:model})){var currentIndex=that.items().index($(that.current()).parent());that.cancelRow(),navigatable&&(that.current(that.items().eq(currentIndex).children().filter(NAVCELL).first()),focusTable(that.table,!0))}}),container.on(CLICK+NS,"a.k-grid-update",function(e){e.preventDefault(),e.stopPropagation(),that.saveRow()}))},_createPopupEditor:function(model){var column,command,idx,length,tmpl,updateText,cancelText,tempCommand,attr,that=this,html="<div "+kendo.attr("uid")+'="'+model.uid+'" class="k-popup-edit-form'+(that._isMobile?" k-mobile-list":"")+'"><div class="k-edit-form-container">',fields=[],editable=that.options.editable,template=editable.template,options=isPlainObject(editable)?editable.window:{},settings=extend({},kendo.Template,that.options.templateSettings);if(options=options||{},template)for(typeof template===STRING&&(template=window.unescape(template)),html+=kendo.template(template,settings)(model),idx=0,length=that.columns.length;idx<length;idx++)column=that.columns[idx],column.command&&(tempCommand=getCommand(column.command,"edit"),tempCommand&&(command=tempCommand));else for(idx=0,length=that.columns.length;idx<length;idx++)if(column=that.columns[idx],column.command)column.command&&(tempCommand=getCommand(column.command,"edit"),tempCommand&&(command=tempCommand));else if(html+='<div class="k-edit-label"><label for="'+column.field+'">'+(column.title||column.field||"")+"</label></div>",
model.editable&&!model.editable(column.field)||!column.field){var state={storage:{},count:0};tmpl=kendo.template(that._cellTmpl(column,state),settings),state.count>0&&(tmpl=proxy(tmpl,state.storage)),html+='<div class="k-edit-field">'+tmpl(model)+"</div>"}else fields.push({field:column.field,format:column.format,editor:column.editor,values:column.values}),html+="<div "+kendo.attr("container-for")+'="'+column.field+'" class="k-edit-field"></div>';command&&isPlainObject(command)&&(command.text&&isPlainObject(command.text)&&(updateText=command.text.update,cancelText=command.text.cancel),command.attr&&(attr=command.attr));var container;that._isMobile?(html+="</div></div>",that.editView=that.pane.append("<div data-"+kendo.ns+'role="view" data-'+kendo.ns+'init-widgets="false" class="k-grid-edit-form"><div data-'+kendo.ns+'role="header" class="k-header">'+that._createButton({name:"update",text:updateText,attr:attr})+(options.title||"Edit")+that._createButton({name:"canceledit",text:cancelText,attr:attr})+"</div>"+html+"</div>"),container=that._editContainer=that.editView.element.find(".k-popup-edit-form")):(html+='<div class="k-edit-buttons k-state-default">',html+=that._createButton({name:"update",text:updateText,attr:attr})+that._createButton({name:"canceledit",text:cancelText,attr:attr}),html+="</div></div></div>",container=that._editContainer=$(html).appendTo(that.wrapper).eq(0).kendoWindow(extend({modal:!0,resizable:!1,draggable:!0,title:"Edit",visible:!1,close:function(e){if(e.userTriggered){if(e.sender.element.focus(),that.trigger("cancel",{container:container,model:model}))return void e.preventDefault();var currentIndex=that.items().index($(that.current()).parent());that.cancelRow(),that.options.navigatable&&(that.current(that.items().eq(currentIndex).children().filter(NAVCELL).first()),focusTable(that.table,!0))}}},options))),that.editable=that._editContainer.kendoEditable({fields:fields,model:model,clearContainer:!1}).data("kendoEditable"),that._isMobile&&container.find("input[type=checkbox],input[type=radio]").parent(".k-edit-field").addClass("k-check").prev(".k-edit-label").addClass("k-check").click(function(){$(this).next().children("input").click()}),that._openPopUpEditor(),that.trigger(EDIT,{container:container,model:model})},_openPopUpEditor:function(){this._isMobile?this.pane.navigate(this.editView,this._editAnimation):this._editContainer.data("kendoWindow").center().open()},_createInlineEditor:function(row,model){var column,cell,command,that=this,fields=[];that.lockedContent&&(row=row.add(that._relatedRow(row))),row.children(":not(.k-group-cell,.k-hierarchy-cell)").each(function(){if(cell=$(this),column=that.columns[that.cellIndex(cell)],column.command||!column.field||model.editable&&!model.editable(column.field)){if(column.command&&(command=getCommand(column.command,"edit"))){cell.empty();var updateText,cancelText,attr;isPlainObject(command)&&(command.text&&isPlainObject(command.text)&&(updateText=command.text.update,cancelText=command.text.cancel),command.attr&&(attr=command.attr)),$(that._createButton({name:"update",text:updateText,attr:attr})+that._createButton({name:"canceledit",text:cancelText,attr:attr})).appendTo(cell)}}else fields.push({field:column.field,format:column.format,editor:column.editor,values:column.values}),cell.attr(kendo.attr("container-for"),column.field),cell.empty()}),that._editContainer=row,that.editable=new kendo.ui.Editable(row.addClass("k-grid-edit-row"),{fields:fields,model:model,clearContainer:!1}),row.length>1&&(adjustRowHeight(row[0],row[1]),that._applyLockedContainersWidth()),that.trigger(EDIT,{container:row,model:model})},cancelRow:function(){var model,that=this,container=that._editContainer;container&&(model=that._modelForContainer(container),that._destroyEditable(),that.dataSource.cancelChanges(model),"popup"!==that._editMode()?that._displayRow(container):that._displayRow(that.items().filter("["+kendo.attr("uid")+"="+model.uid+"]")))},saveRow:function(){var that=this,container=that._editContainer,model=that._modelForContainer(container),editable=that.editable;container&&editable&&editable.end()&&!that.trigger(SAVE,{container:container,model:model})&&that.dataSource.sync()},_displayRow:function(row){var related,newRow,nextRow,that=this,model=that._modelForContainer(row),isAlt=row.hasClass("k-alt");model&&(that.lockedContent&&(related=$((isAlt?that.lockedAltRowTemplate:that.lockedRowTemplate)(model)),that._relatedRow(row.last()).replaceWith(related)),newRow=$((isAlt?that.altRowTemplate:that.rowTemplate)(model)),row.replaceWith(newRow),related&&adjustRowHeight(newRow[0],related[0]),nextRow=newRow.next(),nextRow.hasClass("k-detail-row")&&nextRow.is(":visible")&&newRow.find(".k-hierarchy-cell .k-icon").removeClass("k-plus").addClass("k-minus"))},_showMessage:function(messages,row){var that=this;if(!that._isMobile)return window.confirm(messages.title);var template=kendo.template('<ul><li class="km-actionsheet-title">#:title#</li><li><a href="\\#" class="k-button k-grid-delete">#:confirmDelete#</a></li></ul>'),html=$(template(messages)).appendTo(that.view.element),actionSheet=that._actionSheet=new kendo.mobile.ui.ActionSheet(html,{cancel:messages.cancelDelete,cancelTemplate:'<li class="km-actionsheet-cancel"><a class="k-button" href="\\#">#:cancel#</a></li>',close:function(){this.destroy()},command:function(e){var item=$(e.currentTarget).parent();item.hasClass("km-actionsheet-cancel")||that._removeRow(row)},popup:that._actionSheetPopupOptions});return actionSheet.open(row),!1},_confirmation:function(row){var that=this,editable=that.options.editable,confirmation=editable===!0||typeof editable===STRING?DELETECONFIRM:editable.confirmation;return confirmation===!1||null==confirmation||(typeof confirmation===FUNCTION&&(confirmation=confirmation(that._modelForContainer(row))),that._showMessage({confirmDelete:editable.confirmDelete||CONFIRMDELETE,cancelDelete:editable.cancelDelete||CANCELDELETE,title:confirmation===!0?DELETECONFIRM:confirmation},row))},cancelChanges:function(){this.dataSource.cancelChanges()},saveChanges:function(){var that=this;(that.editable&&that.editable.end()||!that.editable)&&!that.trigger(SAVECHANGES)&&that.dataSource.sync()},addRow:function(){var index,that=this,dataSource=that.dataSource,mode=that._editMode(),createAt=that.options.editable.createAt||"",pageSize=dataSource.pageSize(),view=dataSource.view()||[];if(that.editable&&that.editable.end()||!that.editable){"incell"!=mode&&that.cancelRow(),index=dataSource.indexOf(view[0]),"bottom"==createAt.toLowerCase()&&(index+=view.length,pageSize&&!dataSource.options.serverPaging&&pageSize<=view.length&&(index-=1)),index<0&&(index=dataSource.page()>dataSource.totalPages()?(dataSource.page()-1)*pageSize:0);var model=dataSource.insert(index,{}),id=model.uid,table=that.lockedContent?that.lockedTable:that.table,row=table.find("tr["+kendo.attr("uid")+"="+id+"]"),cell=row.children("td:not(.k-group-cell,.k-hierarchy-cell)").eq(that._firstEditableColumnIndex(row));"inline"===mode&&row.length?that.editRow(row):"popup"===mode?that.editRow(model):cell.length&&that.editCell(cell),"bottom"==createAt.toLowerCase()&&that.lockedContent&&(that.lockedContent[0].scrollTop=that.content[0].scrollTop=that.content[0].offsetHeight)}},_firstEditableColumnIndex:function(container){var column,idx,length,that=this,columns=that.columns,model=that._modelForContainer(container);for(idx=0,length=columns.length;idx<length;idx++)if(column=columns[idx],model&&(!model.editable||model.editable(column.field))&&!column.command&&column.field)return idx;return-1},_toolbar:function(){var container,that=this,wrapper=that.wrapper,toolbar=that.options.toolbar,editable=that.options.editable;toolbar&&(container=that.wrapper.find(".k-grid-toolbar"),container.length||(isFunction(toolbar)||(toolbar=typeof toolbar===STRING?toolbar:that._toolbarTmpl(toolbar).replace(templateHashRegExp,"\\#"),toolbar=proxy(kendo.template(toolbar),that)),container=$('<div class="k-toolbar k-grid-toolbar" />').html(toolbar({})).prependTo(wrapper)),editable&&editable.create!==!1&&container.on(CLICK+NS,".k-grid-add",function(e){e.preventDefault(),that.addRow()}).on(CLICK+NS,".k-grid-cancel-changes",function(e){e.preventDefault(),that.cancelChanges()}).on(CLICK+NS,".k-grid-save-changes",function(e){e.preventDefault(),that.saveChanges()}))},_toolbarTmpl:function(commands){var idx,length,that=this,html="";if(isArray(commands))for(idx=0,length=commands.length;idx<length;idx++)html+=that._createButton(commands[idx]);return html},_createButton:function(command){var template=command.template||COMMANDBUTTONTMPL,commandName=typeof command===STRING?command:command.name||command.text,className=defaultCommands[commandName]?defaultCommands[commandName].className:"k-grid-"+(commandName||"").replace(/\s/g,""),options={className:className,text:commandName,imageClass:"",attr:"",iconClass:""};if(!(commandName||isPlainObject(command)&&command.template))throw new Error("Custom commands should have name specified");return isPlainObject(command)?(command.className&&(command.className+=" "+options.className),"edit"===commandName&&isPlainObject(command.text)&&(command=extend(!0,{},command),command.text=command.text.edit),command.attr&&isPlainObject(command.attr)&&(command.attr=stringifyAttributes(command.attr)),options=extend(!0,options,defaultCommands[commandName],command)):options=extend(!0,options,defaultCommands[commandName]),kendo.template(template)(options)},_hasFooters:function(){return!!this.footerTemplate||!!this.groupFooterTemplate||this.footer&&this.footer.length>0||this.wrapper.find(".k-grid-footer").length>0},_groupable:function(){var that=this;that._groupableClickHandler?that.table.add(that.lockedTable).off(CLICK+NS,that._groupableClickHandler):that._groupableClickHandler=function(e){var element=$(this),group=element.closest("tr");element.hasClass("k-i-collapse")?that.collapseGroup(group):that.expandGroup(group),e.preventDefault(),e.stopPropagation()},that._isLocked()?that.lockedTable.on(CLICK+NS,".k-grouping-row .k-i-collapse, .k-grouping-row .k-i-expand",that._groupableClickHandler):that.table.on(CLICK+NS,".k-grouping-row .k-i-collapse, .k-grouping-row .k-i-expand",that._groupableClickHandler),that._attachGroupable()},_attachGroupable:function(){var that=this,wrapper=that.wrapper,groupable=that.options.groupable,GROUPINGDRAGGABLES=HEADERCELLS+":visible["+kendo.attr("field")+"]",GROUPINGFILTER=HEADERCELLS+"["+kendo.attr("field")+"]";groupable&&(wrapper.has("div.k-grouping-header")[0]||$("<div>&nbsp;</div>").addClass("k-grouping-header").prependTo(wrapper),that.groupable&&that.groupable.destroy(),that.groupable=new Groupable(wrapper,extend({},groupable,{draggable:that._draggableInstance,groupContainer:">div.k-grouping-header",dataSource:that.dataSource,draggableElements:that.content?".k-grid-header:first "+GROUPINGDRAGGABLES:"table:first>.k-grid-header "+GROUPINGDRAGGABLES,filter:that.content?".k-grid-header:first "+GROUPINGFILTER:"table:first>.k-grid-header "+GROUPINGFILTER,allowDrag:that.options.reorderable})))},_continuousItems:function(filter,cell){if(this.lockedContent){for(var that=this,elements=that.table.add(that.lockedTable),lockedItems=$(filter,elements[0]),nonLockedItems=$(filter,elements[1]),columns=cell?lockedColumns(that.columns).length:1,nonLockedColumns=cell?that.columns.length-columns:1,result=[],idx=0;idx<lockedItems.length;idx+=columns)push.apply(result,lockedItems.slice(idx,idx+columns)),push.apply(result,nonLockedItems.splice(0,nonLockedColumns));return result}},_selectable:function(){var multi,cell,that=this,notString=[],isLocked=that._isLocked(),selectable=that.options.selectable;if(selectable){that.selectable&&that.selectable.destroy(),multi=typeof selectable===STRING&&selectable.toLowerCase().indexOf("multiple")>-1,cell=typeof selectable===STRING&&selectable.toLowerCase().indexOf("cell")>-1,that._hasDetails()&&(notString[notString.length]=".k-detail-row"),(that.options.groupable||that._hasFooters())&&(notString[notString.length]=".k-grouping-row,.k-group-footer"),notString=notString.join(","),""!==notString&&(notString=":not("+notString+")");var elements=that.table;isLocked&&(elements=elements.add(that.lockedTable));var filter=">"+(cell?SELECTION_CELL_SELECTOR:"tbody>tr"+notString);that.selectable=new kendo.ui.Selectable(elements,{filter:filter,aria:!0,multiple:multi,change:function(){that.trigger(CHANGE)},useAllItems:isLocked&&multi&&cell,relatedTarget:function(items){if(!cell&&isLocked){for(var related,result=$(),idx=0,length=items.length;idx<length;idx++)related=that._relatedRow(items[idx]),inArray(related[0],items)<0&&(result=result.add(related));return result}},continuousItems:function(){return that._continuousItems(filter,cell)}}),that.options.navigatable&&elements.on("keydown"+NS,function(e){var current=that.current(),target=e.target;if(e.keyCode===keys.SPACEBAR&&$.inArray(target,elements)>-1&&!current.is(".k-edit-cell,.k-header")&&current.parent().is(":not(.k-grouping-row,.k-detail-row,.k-group-footer)")){if(e.preventDefault(),e.stopPropagation(),current=cell?current:current.parent(),isLocked&&!cell&&(current=current.add(that._relatedRow(current))),multi)if(e.ctrlKey){if(current.hasClass(SELECTED))return current.removeClass(SELECTED),void that.trigger(CHANGE)}else that.selectable.clear();else that.selectable.clear();that.selectable.value(current)}})}},_relatedRow:function(row){var lockedTable=this.lockedTable;if(row=$(row),!lockedTable)return row;var table=row.closest(this.table.add(this.lockedTable)),index=table.find(">tbody>tr").index(row);return table=table[0]===this.table[0]?lockedTable:this.table,table.find(">tbody>tr").eq(index)},clearSelection:function(){var that=this;that.selectable.clear(),that.trigger(CHANGE)},select:function(items){var that=this,selectable=that.selectable;return items=$(items),items.length?(selectable.options.multiple||(selectable.clear(),items=items.first()),that._isLocked()&&(items=items.add(items.map(function(){return that._relatedRow(this)}))),void selectable.value(items)):selectable.value()},current:function(element){var that=this,scrollable=that.options.scrollable,current=that._current,table=that.table.add(that.thead.parent());if(element!==undefined&&element.length&&(!current||current[0]!==element[0])&&(current&&(current.removeClass(FOCUSED).removeAttr("id"),table.removeAttr("aria-activedescendant")),element.attr("id",that._cellId),that._current=element.addClass(FOCUSED),table.attr("aria-activedescendant",that._cellId),element.length&&scrollable)){var content=element.closest("table").parent();content.is(".k-grid-content")?that._scrollTo(element.parent()[0],that.content[0]):content.is(".k-grid-content-locked")&&(that._scrollTo(that._relatedRow(element.parent())[0],that.content[0]),that.lockedContent[0].scrollTop=that.content[0].scrollTop),content.is(".k-grid-content-locked,.k-grid-header-locked")||(scrollable.virtual?that._scrollTo(element[0],that.content.find(">.k-virtual-scrollable-wrap")[0]):that._scrollTo(element[0],that.content[0]))}return that._current},_removeCurrent:function(){this._current&&(this._current.removeClass(FOCUSED),this._current=null)},_scrollTo:function(element,container){var elementToLowercase=element.tagName.toLowerCase(),isHorizontal="td"===elementToLowercase||"th"===elementToLowercase,elementOffset=element[isHorizontal?"offsetLeft":"offsetTop"],elementOffsetDir=element[isHorizontal?"offsetWidth":"offsetHeight"],containerScroll=container[isHorizontal?"scrollLeft":"scrollTop"],containerOffsetDir=container[isHorizontal?"clientWidth":"clientHeight"],bottomDistance=elementOffset+elementOffsetDir,result=0;result=containerScroll>elementOffset?elementOffset:bottomDistance>containerScroll+containerOffsetDir?elementOffsetDir<=containerOffsetDir?bottomDistance-containerOffsetDir:elementOffset:containerScroll,container[isHorizontal?"scrollLeft":"scrollTop"]=result},_navigatable:function(){var that=this,currentProxy=proxy(that.current,that),table=that.table.add(that.lockedTable),headerTable=that.thead.parent().add($(">table",that.lockedHeader)),dataTable=(that._isLocked(),table),isRtl=kendo.support.isRtl(that.element);that.options.navigatable&&(that.options.scrollable&&(dataTable=table.add(headerTable),headerTable.attr(TABINDEX,-1)),dataTable.off("mousedown"+NS+" focus"+NS+" focusout"+NS+" keydown"+NS),headerTable.on("keydown"+NS,function(e){e.altKey&&e.keyCode==keys.DOWN&&(currentProxy().find(".k-grid-filter, .k-header-column-menu").click(),e.stopImmediatePropagation())}).find("a.k-link").attr("tabIndex",-1),table.attr(TABINDEX,math.max(table.attr(TABINDEX)||0,0)).on("mousedown"+NS+" keydown"+NS,".k-detail-cell",function(e){e.target!==e.currentTarget&&e.stopImmediatePropagation()}),dataTable.on(kendo.support.touch?"touchstart"+NS:"mousedown"+NS,NAVROW+">"+NAVCELL,proxy(tableClick,that)).on("focus"+NS,function(){if(!kendo.support.touch){var current=currentProxy();current&&current.is(":visible")?current.addClass(FOCUSED):currentProxy($(this).find(FIRSTNAVITEM)),table.attr(TABINDEX,-1),headerTable.attr(TABINDEX,-1),$(this).attr(TABINDEX,0)}}).on("focusout"+NS,function(){var current=currentProxy();current&&current.removeClass(FOCUSED)}).on("keydown"+NS,function(e){var active,currentIndex,key=e.keyCode,handled=!1,canHandle=!e.isDefaultPrevented()&&!$(e.target).is(":button,a,:input,a>.k-icon"),pageable=that.options.pageable,dataSource=that.dataSource,isInCell="incell"==that._editMode(),shiftKey=e.shiftKey,relatedRow=proxy(that._relatedRow,that),current=currentProxy();if(current&&current.is("th")&&(canHandle=!0),canHandle&&key==keys.UP)currentProxy(moveVertical(current,e.currentTarget,table,headerTable,!0)),handled=!0;else if(canHandle&&key==keys.DOWN)currentProxy(moveVertical(current,e.currentTarget,table,headerTable)),handled=!0;else if(canHandle&&key==(isRtl?keys.RIGHT:keys.LEFT))currentProxy(moveLeft(current,e.currentTarget,table,headerTable,relatedRow)),handled=!0;else if(canHandle&&key==(isRtl?keys.LEFT:keys.RIGHT))currentProxy(moveRight(current,e.currentTarget,table,headerTable,relatedRow)),handled=!0;else if(canHandle&&pageable&&keys.PAGEDOWN==key)dataSource.page(dataSource.page()+1),handled=!0;else if(canHandle&&pageable&&keys.PAGEUP==key)dataSource.page(dataSource.page()-1),handled=!0;else if(key==keys.ENTER||keys.F2==key)if(current=current?current:table.find(FIRSTNAVITEM),$(e.target).is("table")||$.contains(current[0],e.target)||(current=$(e.target).closest("[role=gridcell]")),current.is("th"))current.find(".k-link").click(),handled=!0;else if(current.parent().is(".k-master-row,.k-grouping-row"))current.parent().find(".k-icon:first").click(),handled=!0;else{var focusable=current.find(":kendoFocusable:first");if(!current.hasClass("k-edit-cell")&&focusable[0]&&current.hasClass("k-state-focused"))focusable.focus(),handled=!0;else if(that.options.editable&&!$(e.target).is(":button,.k-button,textarea")){var container=$(e.target).closest("[role=gridcell]");container[0]||(container=current),that._handleEditing(container,!1,isInCell?e.currentTarget:table[0]),handled=!0}}else if(keys.ESC==key)active=activeElement(),current&&$.contains(current[0],active)&&!current.hasClass("k-edit-cell")&&!current.parent().hasClass("k-grid-edit-row")?(focusTable(e.currentTarget,!0),handled=!0):!that._editContainer||current&&!that._editContainer.has(current[0])&&current[0]!==that._editContainer[0]||(isInCell?that.closeCell(!0):(currentIndex=$(current).parent().index(),active&&active.blur(),that.cancelRow(),currentIndex>=0&&that.current(table.find(">tbody>tr").eq(currentIndex).children().filter(NAVCELL).first())),browser.msie&&browser.version<9&&document.body.focus(),focusTable(isInCell?e.currentTarget:table[0],!0),handled=!0);else if(keys.TAB==key){var cell;current=$(current),that.options.editable&&isInCell&&(cell=$(activeElement()).closest(".k-edit-cell"),cell[0]&&cell[0]!==current[0]&&(current=cell)),cell=tabNext(current,e.currentTarget,table,relatedRow,shiftKey),!current.is("th")&&cell.length&&that.options.editable&&isInCell&&(that._handleEditing(current,cell,cell.closest(table)),handled=!0)}handled&&(e.preventDefault(),e.stopPropagation())}))},_handleEditing:function(current,next,table){var focusable,isEdited,that=this,active=$(activeElement()),mode=that._editMode(),isIE=browser.msie,oldIE=isIE&&browser.version<9,editContainer=that._editContainer;if(table=$(table),isEdited="incell"==mode?current.hasClass("k-edit-cell"):current.parent().hasClass("k-grid-edit-row"),that.editable){if($.contains(editContainer[0],active[0])&&(browser.opera||oldIE?active.change().triggerHandler("blur"):(active.blur(),isIE&&active.blur())),!that.editable)return void focusTable(table);if(!that.editable.end())return"incell"==mode?that.current(editContainer):that.current(editContainer.children().filter(DATA_CELL).first()),focusable=editContainer.find(":kendoFocusable:first")[0],void(focusable&&focusable.focus());"incell"==mode?that.closeCell():(that.saveRow(),isEdited=!0)}next&&that.current(next),oldIE&&document.body.focus(),focusTable(table,!0),(!isEdited&&!next||next)&&("incell"==mode?that.editCell(that.current()):that.editRow(that.current().parent()))},_wrapper:function(){var that=this,table=that.table,height=that.options.height,wrapper=that.element;wrapper.is("div")||(wrapper=wrapper.wrap("<div/>").parent()),that.wrapper=wrapper.addClass("k-grid k-widget"),height&&(that.wrapper.css(HEIGHT,height),table.css(HEIGHT,"auto")),that._initMobile()},_initMobile:function(){var options=this.options,that=this;if(this._isMobile=options.mobile===!0&&kendo.support.mobileOS||"phone"===options.mobile||"tablet"===options.mobile,this._isMobile){var html=this.wrapper.addClass("k-grid-mobile").wrap("<div data-"+kendo.ns+'role="view" data-'+kendo.ns+'init-widgets="false"></div>').parent();this.pane=kendo.mobile.ui.Pane.wrap(html),this.view=this.pane.view(),this._actionSheetPopupOptions=$(document.documentElement).hasClass("km-root")?{modal:!1}:{align:"bottom center",position:"bottom center",effect:"slideIn:up"},options.height&&this.pane.element.parent().css(HEIGHT,options.height),this._editAnimation="slide",this.view.bind("show",function(){that._isLocked()&&(that._updateTablesWidth(),that._applyLockedContainersWidth(),that._syncLockedContentHeight(),that._syncLockedHeaderHeight(),that._syncLockedFooterHeight())})}},_tbody:function(){var tbody,that=this,table=that.table;tbody=table.find(">tbody"),tbody.length||(tbody=$("<tbody/>").appendTo(table)),that.tbody=tbody.attr("role","rowgroup")},_scrollable:function(){var header,table,that=this,options=that.options,scrollable=options.scrollable,hasVirtualScroll=scrollable!==!0&&scrollable.virtual&&!that.virtualScrollable,scrollbar=!kendo.support.kineticScrollNeeded||hasVirtualScroll?kendo.support.scrollbar():0;if(scrollable){header=that.wrapper.children(".k-grid-header"),header[0]||(header=$('<div class="k-grid-header" />').insertBefore(that.table)),header.css(isRtl?"padding-left":"padding-right",scrollable.virtual?scrollbar+1:scrollbar),table=$('<table role="grid" />'),isIE7&&table.attr("cellspacing",0),table.append(that.thead),header.empty().append($('<div class="k-grid-header-wrap" />').append(table)),that.content=that.table.parent(),that.content.is(".k-virtual-scrollable-wrap, .km-scroll-container")&&(that.content=that.content.parent()),that.content.is(".k-grid-content, .k-virtual-scrollable-wrap")||(that.content=that.table.wrap('<div class="k-grid-content" />').parent()),hasVirtualScroll&&(that.virtualScrollable=new VirtualScrollable(that.content,{dataSource:that.dataSource,itemHeight:function(){return that._averageRowHeight()}})),that.scrollables=header.children(".k-grid-header-wrap");var footer=that.wrapper.find(".k-grid-footer");if(footer.length&&(that.scrollables=that.scrollables.add(footer.children(".k-grid-footer-wrap"))),scrollable.virtual)that.content.find(">.k-virtual-scrollable-wrap").bind("scroll"+NS,function(){that.scrollables.scrollLeft(this.scrollLeft),that.lockedContent&&(that.lockedContent[0].scrollTop=this.scrollTop)});else{that.content.bind("scroll"+NS,function(){that.scrollables.scrollLeft(this.scrollLeft),that.lockedContent&&(that.lockedContent[0].scrollTop=this.scrollTop)});var touchScroller=kendo.touchScroller(that.content);touchScroller&&touchScroller.movable&&(that.touchScroller=touchScroller,touchScroller.movable.bind("change",function(e){that.scrollables.scrollLeft(-e.sender.x),that.lockedContent&&that.lockedContent.scrollTop(-e.sender.y)}),that.one(DATABOUND,function(e){e.sender.wrapper.addClass("k-grid-backface")}))}}},_setContentWidth:function(){var expander,that=this,hiddenDivClass="k-grid-content-expander",hiddenDiv='<div class="'+hiddenDivClass+'"></div>',resizable=that.resizable;that.options.scrollable&&that.wrapper.is(":visible")&&(expander=that.table.parent().children("."+hiddenDivClass),that._setContentWidthHandler=proxy(that._setContentWidth,that),that.dataSource&&that.dataSource.view().length?expander[0]&&(expander.remove(),resizable&&resizable.unbind("resize",that._setContentWidthHandler)):(expander[0]||(expander=$(hiddenDiv).appendTo(that.table.parent()),resizable&&resizable.bind("resize",that._setContentWidthHandler)),that.thead&&expander.width(that.thead.width())),that._applyLockedContainersWidth())},_applyLockedContainersWidth:function(){if(this.options.scrollable&&this.lockedHeader){var footerWrap,headerTable=this.thead.parent(),headerWrap=headerTable.parent(),contentWidth=this.wrapper[0].clientWidth,groups=this._groups(),scrollbar=kendo.support.scrollbar(),cols=this.lockedHeader.find(">table>colgroup>col:not(.k-group-col, .k-hierarchy-col)"),nonLockedCols=headerTable.find(">colgroup>col:not(.k-group-col, .k-hierarchy-col)"),width=columnsWidth(cols),nonLockedColsWidth=columnsWidth(nonLockedCols);groups>0&&(width+=this.lockedHeader.find(".k-group-cell:first").outerWidth()*groups),width>=contentWidth&&(width=contentWidth-3*scrollbar),this.lockedHeader.add(this.lockedContent).width(width),headerWrap[0].style.width=headerWrap.parent().width()-width-2+"px",headerTable.add(this.table).width(nonLockedColsWidth),this.virtualScrollable&&(contentWidth-=scrollbar),this.content[0].style.width=contentWidth-width-2+"px",this.lockedFooter&&this.lockedFooter.length&&(this.lockedFooter.width(width),footerWrap=this.footer.find(".k-grid-footer-wrap"),footerWrap[0].style.width=headerWrap[0].clientWidth+"px",footerWrap.children().first().width(nonLockedColsWidth))}},_setContentHeight:function(){var that=this,options=that.options,height=that.wrapper.innerHeight(),header=that.wrapper.children(".k-grid-header"),scrollbar=kendo.support.scrollbar();if(options.scrollable&&that.wrapper.is(":visible")){height-=header.outerHeight(),that.pager&&(height-=that.pager.element.outerHeight()),options.groupable&&(height-=that.wrapper.children(".k-grouping-header").outerHeight()),options.toolbar&&(height-=that.wrapper.children(".k-grid-toolbar").outerHeight()),that.footerTemplate&&(height-=that.wrapper.children(".k-grid-footer").outerHeight());var isGridHeightSet=function(el){var initialHeight,newHeight;return!!el[0].style.height||(initialHeight=el.height(),el.height("auto"),newHeight=el.height(),initialHeight!=newHeight?(el.height(""),!0):(el.height(""),!1))};isGridHeightSet(that.wrapper)&&(height>2*scrollbar?(that.lockedContent&&(scrollbar=that.table[0].offsetWidth>that.table.parent()[0].clientWidth?scrollbar:0,that.lockedContent.height(height-scrollbar)),that.content.height(height)):that.content.height(2*scrollbar+1))}},_averageRowHeight:function(){var that=this,itemsCount=that.items().length,rowHeight=that._rowHeight;if(0===itemsCount)return rowHeight;that._rowHeight||(that._rowHeight=rowHeight=that.table.outerHeight()/itemsCount,that._sum=rowHeight,that._measures=1);var currentRowHeight=that.table.outerHeight()/itemsCount;return rowHeight!==currentRowHeight&&(that._measures++,that._sum+=currentRowHeight,that._rowHeight=that._sum/that._measures),rowHeight},_dataSource:function(){var pageable,that=this,options=that.options,dataSource=options.dataSource;dataSource=isArray(dataSource)?{data:dataSource}:dataSource,isPlainObject(dataSource)&&(extend(dataSource,{table:that.table,fields:that.columns}),pageable=options.pageable,isPlainObject(pageable)&&pageable.pageSize!==undefined&&(dataSource.pageSize=pageable.pageSize)),that.dataSource&&that._refreshHandler?that.dataSource.unbind(CHANGE,that._refreshHandler).unbind(PROGRESS,that._progressHandler).unbind(ERROR,that._errorHandler):(that._refreshHandler=proxy(that.refresh,that),that._progressHandler=proxy(that._requestStart,that),that._errorHandler=proxy(that._error,that)),that.dataSource=DataSource.create(dataSource).bind(CHANGE,that._refreshHandler).bind(PROGRESS,that._progressHandler).bind(ERROR,that._errorHandler)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_modelChange:function(e){var relatedRow,cell,column,tmp,length,that=this,model=e.model,row=that.tbody.find("tr["+kendo.attr("uid")+"="+model.uid+"]"),isAlt=row.hasClass("k-alt"),idx=that.items().index(row),isLocked=that.lockedContent;if(isLocked&&(relatedRow=that._relatedRow(row)),row.add(relatedRow).children(".k-edit-cell").length&&!that.options.rowTemplate)row.add(relatedRow).children(":not(.k-group-cell,.k-hierarchy-cell)").each(function(){cell=$(this),column=that.columns[that.cellIndex(cell)],column.field===e.field&&(cell.hasClass("k-edit-cell")?cell.addClass("k-dirty-cell"):(that._displayCell(cell,column,model),$('<span class="k-dirty"/>').prependTo(cell)))});else if(!row.hasClass("k-grid-edit-row")){for(isLocked&&(tmp=(isAlt?that.lockedAltRowTemplate:that.lockedRowTemplate)(model),relatedRow.replaceWith(tmp)),tmp=(isAlt?that.altRowTemplate:that.rowTemplate)(model),row.replaceWith(tmp),tmp=that.items().eq(idx),isLocked&&(relatedRow=that._relatedRow(tmp)[0],adjustRowHeight(tmp[0],relatedRow),tmp=tmp.add(relatedRow)),idx=0,length=that.columns.length;idx<length;idx++)column=that.columns[idx],column.field===e.field&&(cell=tmp.children(":not(.k-group-cell,.k-hierarchy-cell)").eq(idx),$('<span class="k-dirty"/>').prependTo(cell));that.trigger("itemChange",{item:tmp,data:model,ns:ui})}},_pageable:function(){var wrapper,that=this,pageable=that.options.pageable;pageable&&(wrapper=that.wrapper.children("div.k-grid-pager"),wrapper.length||(wrapper=$('<div class="k-pager-wrap k-grid-pager"/>').appendTo(that.wrapper)),that.pager&&that.pager.destroy(),"object"==typeof pageable&&pageable instanceof kendo.ui.Pager?that.pager=pageable:that.pager=new kendo.ui.Pager(wrapper,extend({},pageable,{dataSource:that.dataSource})))},_footer:function(){var footerWrap,that=this,aggregates=that.dataSource.aggregates(),html="",footerTemplate=that.footerTemplate,options=that.options,footer=that.footer||that.wrapper.find(".k-grid-footer");if(footerTemplate)if(aggregates=isEmptyObject(aggregates)?buildEmptyAggregatesObject(that.dataSource.aggregate()):aggregates,html=$(that._wrapFooter(footerTemplate(aggregates))),footer.length){var tmp=html;footer.replaceWith(tmp),footer=that.footer=tmp}else footer=options.scrollable?that.footer=options.pageable?html.insertBefore(that.wrapper.children("div.k-grid-pager")):html.appendTo(that.wrapper):that.footer=html.insertBefore(that.tbody);else footer&&!that.footer&&(that.footer=footer);if(footer.length&&(options.scrollable&&(footerWrap=footer.attr("tabindex",-1).children(".k-grid-footer-wrap"),that.scrollables=that.scrollables.filter(function(){return!$(this).is(".k-grid-footer-wrap")}).add(footerWrap)),that._footerWidth&&footer.find("table").css("width",that._footerWidth),footerWrap)){var offset=that.content.scrollLeft(),hasVirtualScroll=options.scrollable!==!0&&options.scrollable.virtual&&!that.virtualScrollable;hasVirtualScroll&&(offset=that.wrapper.find(".k-virtual-scrollable-wrap").scrollLeft()),footerWrap.scrollLeft(offset)}that.lockedContent&&(that._appendLockedColumnFooter(),that._applyLockedContainersWidth(),that._syncLockedFooterHeight())},_wrapFooter:function(footerRow){var that=this,html="",scrollbar=kendo.support.mobileOS?0:kendo.support.scrollbar();
return that.options.scrollable?(html=$('<div class="k-grid-footer"><div class="k-grid-footer-wrap"><table'+(isIE7?' cellspacing="0"':"")+"><tbody>"+footerRow+"</tbody></table></div></div>"),that._appendCols(html.find("table")),html.css(isRtl?"padding-left":"padding-right",scrollbar),html):'<tfoot class="k-grid-footer">'+footerRow+"</tfoot>"},_columnMenu:function(){var menu,column,menuOptions,sortable,filterable,cells,that=this,columns=that.columns,options=that.options,columnMenu=options.columnMenu,isMobile=this._isMobile,initCallback=function(e){that.trigger(COLUMNMENUINIT,{field:e.field,container:e.container})},closeCallback=function(element){focusTable(element.closest("table"),!0)};if(columnMenu){"boolean"==typeof columnMenu&&(columnMenu={}),cells=that.thead.find("th:not(.k-hierarchy-cell):not(.k-group-cell)");for(var idx=0,length=cells.length;idx<length;idx++){column=columns[idx];var cell=cells.eq(idx);column.command||!column.field&&!cell.attr("data-"+kendo.ns+"field")||(menu=cell.data("kendoColumnMenu"),menu&&menu.destroy(),sortable=column.sortable!==!1&&columnMenu.sortable!==!1&&options.sortable,filterable=!(!options.filterable||column.filterable===!1||columnMenu.filterable===!1)&&extend({pane:that.pane},column.filterable,options.filterable),menuOptions={dataSource:that.dataSource,values:column.values,columns:columnMenu.columns,sortable:sortable,filterable:filterable,messages:columnMenu.messages,owner:that,closeCallback:closeCallback,init:initCallback,pane:that.pane,filter:isMobile?":not(.k-column-active)":"",lockedColumns:column.lockable!==!1&&lockedColumns(columns).length>0},cell.kendoColumnMenu(menuOptions))}}},_headerCells:function(){return this.thead.find("th").filter(function(){var th=$(this);return!th.hasClass("k-group-cell")&&!th.hasClass("k-hierarchy-cell")})},_filterable:function(){var filterMenu,cells,cell,that=this,columns=that.columns,filterInit=function(e){that.trigger(FILTERMENUINIT,{field:e.field,container:e.container})},closeCallback=function(element){focusTable(element.closest("table"),!0)},filterable=that.options.filterable;if(filterable&&!that.options.columnMenu){cells=that._headerCells();for(var idx=0,length=cells.length;idx<length;idx++)if(cell=cells.eq(idx),columns[idx].filterable!==!1&&!columns[idx].command&&(columns[idx].field||cell.attr("data-"+kendo.ns+"field"))){filterMenu=cell.data("kendoFilterMenu"),filterMenu&&filterMenu.destroy();var columnFilterable=columns[idx].filterable,options=extend({},filterable,columnFilterable,{dataSource:that.dataSource,values:columns[idx].values,closeCallback:closeCallback,init:filterInit,pane:that.pane});columnFilterable&&columnFilterable.messages&&(options.messages=extend(!0,{},filterable.messages,columnFilterable.messages)),cell.kendoFilterMenu(options)}}},_sortable:function(){var column,sortableInstance,cell,that=this,columns=that.columns,sortable=that.options.sortable;if(sortable){for(var cells=that._headerCells(),idx=0,length=cells.length;idx<length;idx++)column=columns[idx],column.sortable!==!1&&!column.command&&column.field&&(cell=cells.eq(idx),sortableInstance=cell.data("kendoSorter"),sortableInstance&&sortableInstance.destroy(),cell.attr("data-"+kendo.ns+"field",column.field).kendoSorter(extend({},sortable,column.sortable,{dataSource:that.dataSource,aria:!0,filter:":not(.k-column-active)"})));cells=null}},_columns:function(columns){var encoded,lockedCols,that=this,table=that.table,cols=table.find("col"),dataSource=that.options.dataSource;if(columns=columns.length?columns:map(table.find("th"),function(th,idx){th=$(th);var sortable=th.attr(kendo.attr("sortable")),filterable=th.attr(kendo.attr("filterable")),type=th.attr(kendo.attr("type")),groupable=th.attr(kendo.attr("groupable")),field=th.attr(kendo.attr("field")),menu=th.attr(kendo.attr("menu"));return field||(field=th.text().replace(/\s|[^A-z0-9]/g,"")),{field:field,type:type,sortable:"false"!==sortable,filterable:"false"!==filterable,groupable:"false"!==groupable,menu:menu,template:th.attr(kendo.attr("template")),width:cols.eq(idx).css("width")}}),encoded=!(that.table.find("tbody tr").length>0&&(!dataSource||!dataSource.transport)),that.options.scrollable){var initialColumns=columns;if(lockedCols=lockedColumns(columns),columns=nonLockedColumns(columns),lockedCols.length>0&&0===columns.length)throw new Error("There should be at least one non locked columns");normalizeHeaderCells(that.element.find("tr:has(th):first").find("th:not(.k-group-cell)"),initialColumns),columns=lockedCols.concat(columns)}that.columns=map(columns,function(column){return column=typeof column===STRING?{field:column}:column,column.hidden&&(column.attributes=addHiddenStyle(column.attributes),column.footerAttributes=addHiddenStyle(column.footerAttributes),column.headerAttributes=addHiddenStyle(column.headerAttributes)),extend({encoded:encoded},column)})},_groups:function(){var group=this.dataSource.group();return group?group.length:0},_tmpl:function(rowTemplate,columns,alt,skipGroupCells){var idx,template,column,type,that=this,settings=extend({},kendo.Template,that.options.templateSettings),length=columns.length,state={storage:{},count:0},hasDetails=that._hasDetails(),className=[],groups=that._groups();if(!rowTemplate){for(rowTemplate="<tr",alt&&className.push("k-alt"),hasDetails&&className.push("k-master-row"),className.length&&(rowTemplate+=' class="'+className.join(" ")+'"'),length&&(rowTemplate+=" "+kendo.attr("uid")+'="#='+kendo.expr("uid",settings.paramName)+'#"'),rowTemplate+=" role='row'>",groups>0&&!skipGroupCells&&(rowTemplate+=groupCells(groups)),hasDetails&&(rowTemplate+='<td class="k-hierarchy-cell"><a class="k-icon k-plus" href="\\#" tabindex="-1"></a></td>'),idx=0;idx<length;idx++)column=columns[idx],template=column.template,type=typeof template,rowTemplate+="<td"+stringifyAttributes(column.attributes)+" role='gridcell'>",rowTemplate+=that._cellTmpl(column,state),rowTemplate+="</td>";rowTemplate+="</tr>"}return rowTemplate=kendo.template(rowTemplate,settings),state.count>0?proxy(rowTemplate,state.storage):rowTemplate},_headerCellText:function(column){var that=this,settings=extend({},kendo.Template,that.options.templateSettings),template=column.headerTemplate,type=typeof template,text=column.title||column.field||"";return type===FUNCTION?text=kendo.template(template,settings)({}):type===STRING&&(text=template),text},_cellTmpl:function(column,state){var idx,length,that=this,settings=extend({},kendo.Template,that.options.templateSettings),template=column.template,paramName=settings.paramName,field=column.field,html="",format=column.format,type=typeof template,columnValues=column.values;if(column.command){if(isArray(column.command)){for(idx=0,length=column.command.length;idx<length;idx++)html+=that._createButton(column.command[idx]);return html.replace(templateHashRegExp,"\\#")}return that._createButton(column.command).replace(templateHashRegExp,"\\#")}return type===FUNCTION?(state.storage["tmpl"+state.count]=template,html+="#=this.tmpl"+state.count+"("+paramName+")#",state.count++):type===STRING?html+=template:columnValues&&columnValues.length&&isPlainObject(columnValues[0])&&"value"in columnValues[0]&&field?(html+="#var v ="+kendo.stringify(convertToObject(columnValues)).replace(templateHashRegExp,"\\#")+"#",html+="#var f = v[",settings.useWithBlock||(html+=paramName+"."),html+=field+"]#",html+="${f != null ? f : ''}"):(html+=column.encoded?"#:":"#=",format&&(html+='kendo.format("'+format.replace(formatRegExp,"\\$1")+'",'),field?(field=kendo.expr(field,paramName),html+=field+"==null?'':"+field):html+="''",format&&(html+=")"),html+="#"),html},_templates:function(){var that=this,options=that.options,dataSource=that.dataSource,groups=dataSource.group(),footer=that.footer||that.wrapper.find(".k-grid-footer"),aggregates=dataSource.aggregate(),columnsLocked=lockedColumns(that.columns),columns=options.scrollable?nonLockedColumns(that.columns):that.columns;if(options.scrollable&&columnsLocked.length){if(options.rowTemplate||options.altRowTemplate)throw new Error("Having both row template and locked columns is not supported");that.rowTemplate=that._tmpl(options.rowTemplate,columns,!1,!0),that.altRowTemplate=that._tmpl(options.altRowTemplate||options.rowTemplate,columns,!0,!0),that.lockedRowTemplate=that._tmpl(options.rowTemplate,columnsLocked),that.lockedAltRowTemplate=that._tmpl(options.altRowTemplate||options.rowTemplate,columnsLocked,!0)}else that.rowTemplate=that._tmpl(options.rowTemplate,columns),that.altRowTemplate=that._tmpl(options.altRowTemplate||options.rowTemplate,columns,!0);that._hasDetails()&&(that.detailTemplate=that._detailTmpl(options.detailTemplate||"")),(that._group&&!isEmptyObject(aggregates)||!isEmptyObject(aggregates)&&!footer.length||grep(that.columns,function(column){return column.footerTemplate}).length)&&(that.footerTemplate=that._footerTmpl(that.columns,aggregates,"footerTemplate","k-footer-template")),groups&&grep(that.columns,function(column){return column.groupFooterTemplate}).length&&(aggregates=$.map(groups,function(g){return g.aggregates}),that.groupFooterTemplate=that._footerTmpl(columns,aggregates,"groupFooterTemplate","k-group-footer",columnsLocked.length),options.scrollable&&columnsLocked.length&&(that.lockedGroupFooterTemplate=that._footerTmpl(columnsLocked,aggregates,"groupFooterTemplate","k-group-footer")))},_footerTmpl:function(columns,aggregates,templateName,rowClass,skipGroupCells){var idx,length,template,type,column,that=this,settings=extend({},kendo.Template,that.options.templateSettings),paramName=settings.paramName,html="",storage={},count=0,scope={},groups=that._groups(),fieldsMap=buildEmptyAggregatesObject(aggregates);for(html+='<tr class="'+rowClass+'">',groups>0&&!skipGroupCells&&(html+=groupCells(groups)),that._hasDetails()&&(html+='<td class="k-hierarchy-cell">&nbsp;</td>'),idx=0,length=columns.length;idx<length;idx++)column=columns[idx],template=column[templateName],type=typeof template,html+="<td"+stringifyAttributes(column.footerAttributes)+">",template?(type!==FUNCTION&&(scope=fieldsMap[column.field]?extend({},settings,{paramName:paramName+"."+column.field}):{},template=kendo.template(template,scope)),storage["tmpl"+count]=template,html+="#=this.tmpl"+count+"("+paramName+")#",count++):html+="&nbsp;",html+="</td>";return html+="</tr>",html=kendo.template(html,settings),count>0?proxy(html,storage):html},_detailTmpl:function(template){var that=this,html="",settings=extend({},kendo.Template,that.options.templateSettings),paramName=settings.paramName,templateFunctionStorage={},templateFunctionCount=0,groups=that._groups(),colspan=visibleColumns(that.columns).length,type=typeof template;return html+='<tr class="k-detail-row">',groups>0&&(html+=groupCells(groups)),html+='<td class="k-hierarchy-cell"></td><td class="k-detail-cell"'+(colspan?' colspan="'+colspan+'"':"")+">",type===FUNCTION?(templateFunctionStorage["tmpl"+templateFunctionCount]=template,html+="#=this.tmpl"+templateFunctionCount+"("+paramName+")#",templateFunctionCount++):html+=template,html+="</td></tr>",html=kendo.template(html,settings),templateFunctionCount>0?proxy(html,templateFunctionStorage):html},_hasDetails:function(){var that=this;return null!==that.options.detailTemplate||(that._events[DETAILINIT]||[]).length},_details:function(){var that=this;if(that.options.scrollable&&that._hasDetails()&&lockedColumns(that.columns).length)throw new Error("Having both detail template and locked columns is not supported");that.table.on(CLICK+NS,".k-hierarchy-cell .k-plus, .k-hierarchy-cell .k-minus",function(e){var detailRow,data,button=$(this),expanding=button.hasClass("k-plus"),masterRow=button.closest("tr.k-master-row"),detailTemplate=that.detailTemplate,hasDetails=that._hasDetails();return button.toggleClass("k-plus",!expanding).toggleClass("k-minus",expanding),hasDetails&&!masterRow.next().hasClass("k-detail-row")&&(data=that.dataItem(masterRow),$(detailTemplate(data)).addClass(masterRow.hasClass("k-alt")?"k-alt":"").insertAfter(masterRow),that.trigger(DETAILINIT,{masterRow:masterRow,detailRow:masterRow.next(),data:data,detailCell:masterRow.next().find(".k-detail-cell")})),detailRow=masterRow.next(),that.trigger(expanding?DETAILEXPAND:DETAILCOLLAPSE,{masterRow:masterRow,detailRow:detailRow}),detailRow.toggle(expanding),that._current&&that._current.attr("aria-expanded",expanding),e.preventDefault(),!1})},dataItem:function(tr){if(tr=$(tr)[0],!tr)return null;var j,correctIdx,rows=this.tbody.children(),classesRegEx=/k-grouping-row|k-detail-row|k-group-footer/,idx=tr.sectionRowIndex;for(correctIdx=idx,j=0;j<idx;j++)classesRegEx.test(rows[j].className)&&correctIdx--;return this._data[correctIdx]},expandRow:function(tr){$(tr).find("> td .k-plus, > td .k-i-expand").click()},collapseRow:function(tr){$(tr).find("> td .k-minus, > td .k-i-collapse").click()},_createHeaderCells:function(columns){var idx,th,text,length,that=this,html="";for(idx=0,length=columns.length;idx<length;idx++)th=columns[idx],text=that._headerCellText(th),th.command?html+="<th"+stringifyAttributes(th.headerAttributes)+">"+text+"</th>":(html+="<th role='columnheader' "+kendo.attr("field")+"='"+(th.field||"")+"' ",th.title&&(html+=kendo.attr("title")+'="'+th.title.replace(/'/g,"'")+'" '),th.groupable!==undefined&&(html+=kendo.attr("groupable")+"='"+th.groupable+"' "),th.aggregates&&(html+=kendo.attr("aggregates")+"='"+th.aggregates+"'"),html+=stringifyAttributes(th.headerAttributes),html+=">"+text+"</th>");return html},_appendLockedColumnContent:function(){var idx,length,container,columns=this.columns,colgroup=this.table.find("colgroup"),cols=colgroup.find("col:not(.k-group-col,.k-hierarchy-col)"),lockedCols=$(),skipHiddenCount=0;for(idx=0,length=columns.length;idx<length;idx++)columns[idx].locked&&(columns[idx].hidden?skipHiddenCount++:lockedCols=lockedCols.add(cols.eq(idx-skipHiddenCount)));container=$('<div class="k-grid-content-locked"><table'+(isIE7?' cellspacing="0"':"")+"><colgroup/><tbody></tbody></table></div>"),colgroup.detach(),container.find("colgroup").append(lockedCols),colgroup.insertBefore(this.table.find("tbody")),this.lockedContent=container.insertBefore(this.content),this.lockedTable=container.children("table")},_appendLockedColumnFooter:function(){var idx,length,that=this,footer=that.footer,cells=footer.find(".k-footer-template>td"),cols=footer.find(".k-grid-footer-wrap>table>colgroup>col"),html=$('<div class="k-grid-footer-locked"><table><colgroup /><tbody><tr class="k-footer-template"></tr></tbody></table></div>'),groups=that._groups(),lockedCells=$(),lockedCols=$();for(lockedCells=lockedCells.add(cells.filter(".k-group-cell")),idx=0,length=lockedColumns(that.columns).length;idx<length;idx++)lockedCells=lockedCells.add(cells.eq(idx+groups));for(lockedCols=lockedCols.add(cols.filter(".k-group-col")),idx=0,length=visibleLockedColumns(that.columns).length;idx<length;idx++)lockedCols=lockedCols.add(cols.eq(idx+groups));lockedCells.appendTo(html.find("tr")),lockedCols.appendTo(html.find("colgroup")),that.lockedFooter=html.prependTo(footer)},_appendLockedColumnHeader:function(container){var idx,html,length,colgroup,tr,table,header,that=this,columns=this.columns,skipHiddenCount=0,cols=$(),cells=$();for(colgroup=that.thead.prev().find("col:not(.k-group-col,.k-hierarchy-col)"),header=that.thead.find(".k-header:not(.k-group-cell,.k-hierarchy-cell)"),idx=0,length=columns.length;idx<length;idx++)columns[idx].locked&&(columns[idx].hidden||(cols=cols.add(colgroup.eq(idx-skipHiddenCount))),cells=cells.add(header.eq(idx))),columns[idx].hidden&&skipHiddenCount++;cells.length&&(html='<div class="k-grid-header-locked" style="width:1px"><table'+(isIE7?' cellspacing="0"':"")+"><colgroup/><thead><tr></tr></thead></table></div>",table=$(html),colgroup=table.find("colgroup"),tr=table.find("thead tr"),colgroup.append(that.thead.prev().find("col.k-group-col").add(cols)),tr.append(that.thead.find(".k-group-cell").add(cells)),this.lockedHeader=table.prependTo(container),this._syncLockedHeaderHeight())},_removeLockedContainers:function(){var elements=this.lockedHeader.add(this.lockedContent).add(this.lockedFooter);elements.off(NS).remove(),this.lockedHeader=this.lockedContent=this.lockedFooter=null},_thead:function(){var tr,that=this,columns=that.columns,hasDetails=that._hasDetails()&&columns.length,html="",thead=that.table.find(">thead");thead.length||(thead=$("<thead/>").insertBefore(that.tbody)),that.lockedHeader&&that.thead?(tr=that.thead.find("tr:has(th):first").html(""),that._removeLockedContainers()):tr=that.element.find("tr:has(th):first"),tr.length||(tr=thead.children().first(),tr.length||(tr=$("<tr/>"))),tr.children().length?hasDetails&&!tr.find(".k-hierarchy-cell")[0]&&tr.prepend('<th class="k-hierarchy-cell">&nbsp;</th>'):(hasDetails&&(html+='<th class="k-hierarchy-cell">&nbsp;</th>'),html+=that._createHeaderCells(that.columns),tr.html(html)),tr.attr("role","row").find("th").addClass("k-header"),that.options.scrollable||thead.addClass("k-grid-header"),tr.find("script").remove().end().appendTo(thead),that.thead&&that._destroyColumnAttachments(),that.thead=thead.attr("role","rowgroup"),that._sortable(),that._filterable(),that._scrollable(),that._updateCols(),that._columnMenu(),this.options.scrollable&&lockedColumns(this.columns).length&&(that._appendLockedColumnHeader(that.thead.closest(".k-grid-header")),that._appendLockedColumnContent(),that.lockedContent.bind("DOMMouseScroll"+NS+" mousewheel"+NS,proxy(that._wheelScroll,that)),that._applyLockedContainersWidth()),that._resizable(),that._draggable(),that._reorderable(),that.groupable&&that._attachGroupable()},_wheelScroll:function(e){var content=this.content;this.options.scrollable.virtual&&(content=this.virtualScrollable.verticalScrollbar);var scrollTop=content.scrollTop(),delta=kendo.wheelDeltaY(e);delta&&(e.preventDefault(),$(e.currentTarget).one("wheel"+NS,!1),content.scrollTop(scrollTop+-delta))},_isLocked:function(){return null!=this.lockedHeader},_updateCols:function(table){table=table||this.thead.parent().add(this.table),this._appendCols(table,this._isLocked())},_updateLockedCols:function(table){this._isLocked()&&(table=table||this.lockedHeader.find("table").add(this.lockedTable),normalizeCols(table,visibleLockedColumns(this.columns),this._hasDetails(),this._groups()))},_appendCols:function(table,locked){locked?normalizeCols(table,visibleNonLockedColumns(this.columns),this._hasDetails(),0):normalizeCols(table,visibleColumns(this.columns),this._hasDetails(),this._groups())},_autoColumns:function(schema){if(schema&&schema.toJSON){var field,that=this;schema=schema.toJSON();for(field in schema)that.columns.push({field:field});that._thead(),that._templates()}},_rowsHtml:function(data,templates){var idx,length,that=this,html="",rowTemplate=templates.rowTemplate,altRowTemplate=templates.altRowTemplate;for(idx=0,length=data.length;idx<length;idx++)html+=idx%2?altRowTemplate(data[idx]):rowTemplate(data[idx]),that._data.push(data[idx]);return html},_groupRowHtml:function(group,colspan,level,groupHeaderBuilder,templates,skipColspan){var idx,length,that=this,html="",field=group.field,column=grep(that.columns,function(column){return column.field==field})[0]||{},template=column.groupHeaderTemplate,text=(column.title||field)+": "+formatGroupValue(group.value,column.format,column.values),data=extend({},{field:group.field,value:group.value},group.aggregates[group.field]),footerDefaults=that._groupAggregatesDefaultObject||{},groupFooterTemplate=(templates.rowTemplate,templates.altRowTemplate,templates.groupFooterTemplate),groupItems=group.items;if(template&&(text=typeof template===FUNCTION?template(data):kendo.template(template)(data)),html+=groupHeaderBuilder(colspan,level,text),group.hasSubgroups)for(idx=0,length=groupItems.length;idx<length;idx++)html+=that._groupRowHtml(groupItems[idx],skipColspan?colspan:colspan-1,level+1,groupHeaderBuilder,templates,skipColspan);else html+=that._rowsHtml(groupItems,templates);return groupFooterTemplate&&(html+=groupFooterTemplate(extend(footerDefaults,group.aggregates))),html},collapseGroup:function(group){group=$(group);var level,offset,idx,length,tr,footerCount=1,relatedGroup=$();for(this._isLocked()&&(group.closest("div").hasClass("k-grid-content-locked")?relatedGroup=this.tbody.children("tr:eq("+group.index()+")").nextAll("tr"):(relatedGroup=group.nextAll("tr"),group=this.lockedTable.find(">tbody>tr:eq("+group.index()+")"))),level=group.find(".k-group-cell").length,group.find(".k-icon").addClass("k-i-expand").removeClass("k-i-collapse"),group.find("td:first").attr("aria-expanded",!1),group=group.nextAll("tr"),idx=0,length=group.length;idx<length&&(tr=group.eq(idx),offset=tr.find(".k-group-cell").length,tr.hasClass("k-grouping-row")?footerCount++:tr.hasClass("k-group-footer")&&footerCount--,!(offset<=level||tr.hasClass("k-group-footer")&&footerCount<0));idx++)tr.hide(),relatedGroup.eq(idx).hide()},expandGroup:function(group){group=$(group);var level,tr,offset,idx,length,that=this,relatedGroup=$(),groupsCount=1;for(this._isLocked()&&(group.closest("div").hasClass("k-grid-content-locked")?relatedGroup=this.tbody.children("tr:eq("+group.index()+")").nextAll("tr"):(relatedGroup=group.nextAll("tr"),group=this.lockedTable.find(">tbody>tr:eq("+group.index()+")"))),level=group.find(".k-group-cell").length,group.find(".k-icon").addClass("k-i-collapse").removeClass("k-i-expand"),group.find("td:first").attr("aria-expanded",!0),group=group.nextAll("tr"),idx=0,length=group.length;idx<length&&(tr=group.eq(idx),offset=tr.find(".k-group-cell").length,!(offset<=level));idx++)offset!=level+1||tr.hasClass("k-detail-row")||(tr.show(),relatedGroup.eq(idx).show(),tr.hasClass("k-grouping-row")&&tr.find(".k-icon").hasClass("k-i-collapse")&&that.expandGroup(tr),tr.hasClass("k-master-row")&&tr.find(".k-icon").hasClass("k-minus")&&(tr.next().show(),relatedGroup.eq(idx+1).show())),tr.hasClass("k-grouping-row")&&groupsCount++,tr.hasClass("k-group-footer")&&(1==groupsCount?(tr.show(),relatedGroup.eq(idx).show()):groupsCount--)},_updateHeader:function(groups){var that=this,container=that._isLocked()?that.lockedHeader:that.thead,cells=container.find("th.k-group-cell"),length=cells.length;groups>length?$(new Array(groups-length+1).join('<th class="k-group-cell k-header">&nbsp;</th>')).prependTo(container.find("tr")):groups<length&&(length-=groups,$(grep(cells,function(item,index){return length>index})).remove())},_firstDataItem:function(data,grouped){return data&&grouped&&(data=data.hasSubgroups?this._firstDataItem(data.items[0],grouped):data.items[0]),data},_updateTablesWidth:function(){var tables,that=this;that._isLocked()&&(tables=$(">.k-grid-footer>.k-grid-footer-wrap>table",that.wrapper).add(that.thead.parent()).add(that.table),that._footerWidth=tableWidth(tables.eq(0)),tables.width(that._footerWidth),tables=$(">.k-grid-footer>.k-grid-footer-locked>table",that.wrapper).add(that.lockedHeader.find(">table")).add(that.lockedTable),tables.width(tableWidth(tables.eq(0))))},hideColumn:function(column){var tables,idx,cols,colWidth,length,columnIndex,that=this,width=0,footer=that.footer||that.wrapper.find(".k-grid-footer"),columns=that.columns,visibleLocked=visibleLockedColumns(columns).length;if(column="number"==typeof column?columns[column]:grep(columns,function(item){return item.field===column})[0],column&&!column.hidden){if(columnIndex=inArray(column,visibleColumns(columns)),column.hidden=!0,column.attributes=addHiddenStyle(column.attributes),column.footerAttributes=addHiddenStyle(column.footerAttributes),column.headerAttributes=addHiddenStyle(column.headerAttributes),that._templates(),that._updateCols(),that._updateLockedCols(),setCellVisibility(elements($(">table>thead",that.lockedHeader),that.thead,">tr>th"),columnIndex,!1),footer[0]&&(that._updateCols(footer.find(">.k-grid-footer-wrap>table")),that._updateLockedCols(footer.find(">.k-grid-footer-locked>table")),setCellVisibility(footer.find(".k-footer-template>td"),columnIndex,!1)),that.lockedTable&&visibleLocked>columnIndex?hideColumnCells(that.lockedTable.find(">tbody>tr"),columnIndex):hideColumnCells(that.tbody.children(),columnIndex-visibleLocked),that.lockedTable)that._updateTablesWidth(),that._applyLockedContainersWidth(),that._syncLockedContentHeight(),that._syncLockedHeaderHeight(),that._syncLockedFooterHeight();else{for(cols=that.thead.prev().find("col"),idx=0,length=cols.length;idx<length;idx+=1){if(colWidth=cols[idx].style.width,!colWidth||colWidth.indexOf("%")!=-1){width=0;break}width+=parseInt(colWidth,10)}tables=$(">.k-grid-header table:first,>.k-grid-footer table:first",that.wrapper).add(that.table),that._footerWidth=null,width&&(tables.width(width),that._footerWidth=width),browser.msie&&8==browser.version&&(tables.css("display","inline-table"),setTimeout(function(){tables.css("display","table")},1))}that.trigger(COLUMNHIDE,{column:column})}},showColumn:function(column){var idx,length,tables,width,colWidth,cols,columnIndex,that=this,columns=that.columns,footer=that.footer||that.wrapper.find(".k-grid-footer"),lockedColumnsCount=lockedColumns(columns).length;if(column="number"==typeof column?columns[column]:grep(columns,function(item){return item.field===column})[0],column&&column.hidden){if(columnIndex=inArray(column,columns),column.hidden=!1,column.attributes=removeHiddenStyle(column.attributes),column.footerAttributes=removeHiddenStyle(column.footerAttributes),column.headerAttributes=removeHiddenStyle(column.headerAttributes),that._templates(),that._updateCols(),that._updateLockedCols(),setCellVisibility(elements($(">table>thead",that.lockedHeader),that.thead,">tr>th"),columnIndex,!0),footer[0]&&(that._updateCols(footer.find(">.k-grid-footer-wrap>table")),that._updateLockedCols(footer.find(">.k-grid-footer-locked>table")),setCellVisibility(footer.find(".k-footer-template>td"),columnIndex,!0)),that.lockedTable&&lockedColumnsCount>columnIndex?showColumnCells(that.lockedTable.find(">tbody>tr"),columnIndex):showColumnCells(that.tbody.children(),columnIndex-lockedColumnsCount),that.lockedTable)that._updateTablesWidth(),that._applyLockedContainersWidth(),that._syncLockedContentHeight(),that._syncLockedHeaderHeight();else if(tables=$(">.k-grid-header table:first,>.k-grid-footer table:first",that.wrapper).add(that.table),column.width){for(width=0,cols=that.thead.prev().find("col"),idx=0,length=cols.length;idx<length;idx+=1){if(colWidth=cols[idx].style.width,colWidth.indexOf("%")>-1){width=0;break}width+=parseInt(colWidth,10)}that._footerWidth=null,width&&(tables.width(width),that._footerWidth=width)}else tables.width("");that.trigger(COLUMNSHOW,{column:column})}},_progress:function(toggle){var element=this.element;this.lockedContent?element=this.wrapper:this.element.is("table")?element=this.element.parent():this.content&&this.content.length&&(element=this.content),kendo.ui.progress(element,toggle)},_resize:function(){this.content&&(this._setContentHeight(),this._setContentWidth())},_isActiveInTable:function(){var active=activeElement();return this.table[0]===active||$.contains(this.table[0],active)||this._isLocked()&&(this.lockedTable[0]===active||$.contains(this.lockedTable[0],active))},refresh:function(e){var currentIndex,that=this,data=that.dataSource.view(),navigatable=that.options.navigatable,current=$(that.current()),isCurrentInHeader=!1,groups=(that.dataSource.group()||[]).length,colspan=groups+visibleColumns(that.columns).length;e&&"itemchange"===e.action&&that.editable||(e=e||{},that.trigger("dataBinding",{action:e.action||"rebind",index:e.index,items:e.items})||(navigatable&&(that._isActiveInTable()||that._editContainer&&that._editContainer.data("kendoWindow"))&&(isCurrentInHeader=current.is("th"),currentIndex=0,isCurrentInHeader&&(currentIndex=that.thead.find("th:not(.k-group-cell)").index(current))),that._destroyEditable(),that._progress(!1),that._hideResizeHandle(),that._data=[],that.columns.length||(that._autoColumns(that._firstDataItem(data[0],groups)),colspan=groups+that.columns.length),that._group=groups>0||that._group,that._group&&(that._templates(),that._updateCols(),that._updateLockedCols(),that._updateHeader(groups),that._group=groups>0),that._renderContent(data,colspan,groups),that._renderLockedContent(data,colspan,groups),that._footer(),that._setContentHeight(),that._setContentWidth(),currentIndex>=0&&(that._removeCurrent(),isCurrentInHeader?that.current(that.thead.find("th:not(.k-group-cell)").eq(currentIndex)):that.current(that.table.add(that.lockedTable).find(FIRSTNAVITEM).first()),that._current&&focusTable(that._current.closest("table")[0],!0)),that.touchScroller&&that.touchScroller.contentResized(),that.trigger(DATABOUND)))},_renderContent:function(data,colspan,groups){var idx,length,that=this,html="",isLocked=null!=that.lockedContent,templates={rowTemplate:that.rowTemplate,altRowTemplate:that.altRowTemplate,groupFooterTemplate:that.groupFooterTemplate};if(colspan=isLocked?colspan-visibleLockedColumns(that.columns).length:colspan,groups>0)for(colspan=isLocked?colspan-groups:colspan,that.detailTemplate&&colspan++,that.groupFooterTemplate&&(that._groupAggregatesDefaultObject=buildEmptyAggregatesObject(that.dataSource.aggregate())),idx=0,length=data.length;idx<length;idx++)html+=that._groupRowHtml(data[idx],colspan,0,isLocked?groupRowLockedContentBuilder:groupRowBuilder,templates,isLocked);else html+=that._rowsHtml(data,templates);that.tbody=appendContent(that.tbody,that.table,html)},_renderLockedContent:function(data,colspan,groups){var idx,length,html="",templates={rowTemplate:this.lockedRowTemplate,altRowTemplate:this.lockedAltRowTemplate,groupFooterTemplate:this.lockedGroupFooterTemplate};if(this.lockedContent){var table=this.lockedTable;if(groups>0)for(colspan-=visibleNonLockedColumns(this.columns).length,idx=0,length=data.length;idx<length;idx++)html+=this._groupRowHtml(data[idx],colspan,0,groupRowBuilder,templates);else html=this._rowsHtml(data,templates);appendContent(table.children("tbody"),table,html),this._syncLockedContentHeight()}},_adjustRowsHeight:function(table1,table2){var idx,rows=table1[0].rows,length=rows.length,rows2=table2[0].rows,containers=table1.add(table2),containersLength=containers.length,heights=[];for(idx=0;idx<length;idx++){rows[idx].style.height&&(rows[idx].style.height=rows2[idx].style.height="");var offsetHeight1=rows[idx].offsetHeight,offsetHeight2=rows2[idx].offsetHeight,height=0;offsetHeight1>offsetHeight2?height=offsetHeight1:offsetHeight1<offsetHeight2&&(height=offsetHeight2),heights.push(height)}for(idx=0;idx<containersLength;idx++)containers[idx].style.display="none";for(idx=0;idx<length;idx++)heights[idx]&&(rows[idx].style.height=rows2[idx].style.height=heights[idx]+"px");for(idx=0;idx<containersLength;idx++)containers[idx].style.display=""}}),Sorter=Widget.extend({init:function(element,options){var link,that=this;Widget.fn.init.call(that,element,options),that._refreshHandler=proxy(that.refresh,that),that.dataSource=that.options.dataSource.bind("change",that._refreshHandler),link=that.element.find(TLINK),link[0]||(link=that.element.wrapInner('<a class="k-link" href="#"/>').find(TLINK)),that.link=link,that.element.on("click"+sorterNS,proxy(that._click,that))},options:{name:"Sorter",mode:SINGLE,allowUnsort:!0,compare:null,filter:""},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.element.off(sorterNS),that.dataSource.unbind("change",that._refreshHandler),that._refreshHandler=that.element=that.link=that.dataSource=null},refresh:function(){var idx,length,descriptor,dir,that=this,sort=that.dataSource.sort()||[],element=that.element,field=element.attr(kendo.attr(FIELD));for(element.removeAttr(kendo.attr(DIR)),element.removeAttr(ARIASORT),idx=0,length=sort.length;idx<length;idx++)descriptor=sort[idx],field==descriptor.field&&element.attr(kendo.attr(DIR),descriptor.dir);dir=element.attr(kendo.attr(DIR)),element.find(".k-i-arrow-n,.k-i-arrow-s").remove(),dir===ASC?($('<span class="k-icon k-i-arrow-n" />').appendTo(that.link),element.attr(ARIASORT,"ascending")):dir===DESC&&($('<span class="k-icon k-i-arrow-s" />').appendTo(that.link),
element.attr(ARIASORT,"descending"))},_click:function(e){var idx,length,that=this,element=that.element,field=element.attr(kendo.attr(FIELD)),dir=element.attr(kendo.attr(DIR)),options=that.options,compare=null==that.options.compare?undefined:that.options.compare,sort=that.dataSource.sort()||[];if(e.preventDefault(),!options.filter||element.is(options.filter)){if(dir=dir===ASC?DESC:dir===DESC&&options.allowUnsort?undefined:ASC,options.mode===SINGLE)sort=[{field:field,dir:dir,compare:compare}];else if("multiple"===options.mode){for(idx=0,length=sort.length;idx<length;idx++)if(sort[idx].field===field){sort.splice(idx,1);break}sort.push({field:field,dir:dir,compare:compare})}that.dataSource.sort(sort)}}});ui.plugin(Grid),ui.plugin(VirtualScrollable),ui.plugin(Sorter)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,CHANGE="change",CANCEL="cancel",DATABOUND="dataBound",DATABINDING="dataBinding",Widget=kendo.ui.Widget,keys=kendo.keys,FOCUSSELECTOR=">*",PROGRESS="progress",ERROR="error",FOCUSED="k-state-focused",SELECTED="k-state-selected",KEDITITEM="k-edit-item",STRING="string",EDIT="edit",REMOVE="remove",SAVE="save",CLICK="click",NS=".kendoListView",proxy=$.proxy,activeElement=kendo._activeElement,progress=kendo.ui.progress,DataSource=kendo.data.DataSource,ListView=Widget.extend({init:function(element,options){var that=this;options=$.isArray(options)?{dataSource:options}:options,Widget.fn.init.call(that,element,options),options=that.options,that.wrapper=element=that.element,element[0].id&&(that._itemId=element[0].id+"_lv_active"),that._element(),that._dataSource(),that._templates(),that._navigatable(),that._selectable(),that._pageable(),that._crudHandlers(),that.options.autoBind&&that.dataSource.fetch(),kendo.notify(that)},events:[CHANGE,CANCEL,DATABINDING,DATABOUND,EDIT,REMOVE,SAVE],options:{name:"ListView",autoBind:!0,selectable:!1,navigatable:!1,template:"",altTemplate:"",editTemplate:""},setOptions:function(options){Widget.fn.setOptions.call(this,options),this._templates()},_templates:function(){var options=this.options;this.template=kendo.template(options.template||""),this.altTemplate=kendo.template(options.altTemplate||options.template),this.editTemplate=kendo.template(options.editTemplate||"")},_item:function(action){return this.element.children()[action]()},items:function(){return this.element.children()},setDataSource:function(dataSource){this.options.dataSource=dataSource,this._dataSource(),this.options.autoBind&&dataSource.fetch()},_unbindDataSource:function(){var that=this;that.dataSource.unbind(CHANGE,that._refreshHandler).unbind(PROGRESS,that._progressHandler).unbind(ERROR,that._errorHandler)},_dataSource:function(){var that=this;that.dataSource&&that._refreshHandler?that._unbindDataSource():(that._refreshHandler=proxy(that.refresh,that),that._progressHandler=proxy(that._progress,that),that._errorHandler=proxy(that._error,that)),that.dataSource=DataSource.create(that.options.dataSource).bind(CHANGE,that._refreshHandler).bind(PROGRESS,that._progressHandler).bind(ERROR,that._errorHandler)},_progress:function(){progress(this.element,!0)},_error:function(){progress(this.element,!1)},_element:function(){this.element.addClass("k-widget k-listview").attr("role","listbox")},refresh:function(e){var data,items,item,idx,length,that=this,view=that.dataSource.view(),html="",template=that.template,altTemplate=that.altTemplate,active=activeElement();if(e=e||{},"itemchange"===e.action)return void(that._hasBindingTarget()||that.editable||(data=e.items[0],item=that.items().filter("["+kendo.attr("uid")+"="+data.uid+"]"),item.length>0&&(idx=item.index(),item.replaceWith(template(data)),item=that.items().eq(idx),item.attr(kendo.attr("uid"),data.uid),that.trigger("itemChange",{item:item,data:data}))));if(!that.trigger(DATABINDING,{action:e.action||"rebind",items:e.items,index:e.index})){for(that._destroyEditable(),idx=0,length=view.length;idx<length;idx++)html+=idx%2?altTemplate(view[idx]):template(view[idx]);for(that.element.html(html),items=that.items(),idx=0,length=view.length;idx<length;idx++)items.eq(idx).attr(kendo.attr("uid"),view[idx].uid).attr("role","option").attr("aria-selected","false");that.element[0]===active&&that.options.navigatable&&that.current(items.eq(0)),that.trigger(DATABOUND)}},_pageable:function(){var settings,pagerId,that=this,pageable=that.options.pageable;$.isPlainObject(pageable)&&(pagerId=pageable.pagerId,settings=$.extend({},pageable,{dataSource:that.dataSource,pagerId:null}),that.pager=new kendo.ui.Pager($("#"+pagerId),settings))},_selectable:function(){var multi,current,that=this,selectable=that.options.selectable,navigatable=that.options.navigatable;selectable&&(multi=typeof selectable===STRING&&selectable.toLowerCase().indexOf("multiple")>-1,multi&&that.element.attr("aria-multiselectable",!0),that.selectable=new kendo.ui.Selectable(that.element,{aria:!0,multiple:multi,filter:FOCUSSELECTOR,change:function(){that.trigger(CHANGE)}}),navigatable&&that.element.on("keydown"+NS,function(e){if(e.keyCode===keys.SPACEBAR){if(current=that.current(),e.target==e.currentTarget&&e.preventDefault(),multi)if(e.ctrlKey){if(current&&current.hasClass(SELECTED))return void current.removeClass(SELECTED)}else that.selectable.clear();else that.selectable.clear();that.selectable.value(current)}}))},current:function(candidate){var that=this,element=that.element,current=that._current,id=that._itemId;return candidate===undefined?current:(current&&current[0]&&(current[0].id===id&&current.removeAttr("id"),current.removeClass(FOCUSED),element.removeAttr("aria-activedescendant")),candidate&&candidate[0]&&(id=candidate[0].id||id,that._scrollTo(candidate[0]),element.attr("aria-activedescendant",id),candidate.addClass(FOCUSED).attr("id",id)),void(that._current=candidate))},_scrollTo:function(element){var container,that=this,UseJQueryoffset=!1,SCROLL="scroll";"auto"==that.wrapper.css("overflow")||that.wrapper.css("overflow")==SCROLL?container=that.wrapper[0]:(container=window,UseJQueryoffset=!0);var scrollDirectionFunc=function(direction,dimension){var elementOffset=UseJQueryoffset?$(element).offset()[direction.toLowerCase()]:element["offset"+direction],elementDimension=element["client"+dimension],containerScrollAmount=$(container)[SCROLL+direction](),containerDimension=$(container)[dimension.toLowerCase()]();elementOffset+elementDimension>containerScrollAmount+containerDimension?$(container)[SCROLL+direction](elementOffset+elementDimension-containerDimension):elementOffset<containerScrollAmount&&$(container)[SCROLL+direction](elementOffset)};scrollDirectionFunc("Top","Height"),scrollDirectionFunc("Left","Width")},_navigatable:function(){var that=this,navigatable=that.options.navigatable,element=that.element,clickCallback=function(e){that.current($(e.currentTarget)),$(e.target).is(":button,a,:input,a>.k-icon,textarea")||element.focus()};navigatable&&(that._tabindex(),element.on("focus"+NS,function(){var current=that._current;current&&current.is(":visible")||(current=that._item("first")),that.current(current)}).on("focusout"+NS,function(){that._current&&that._current.removeClass(FOCUSED)}).on("keydown"+NS,function(e){var idx,key=e.keyCode,current=that.current(),target=$(e.target),canHandle=!target.is(":button,textarea,a,a>.t-icon,input"),isTextBox=target.is(":text"),preventDefault=kendo.preventDefault,editItem=element.find("."+KEDITITEM),active=activeElement();if(!(!canHandle&&!isTextBox&&keys.ESC!=key||isTextBox&&keys.ESC!=key&&keys.ENTER!=key))if(keys.UP===key||keys.LEFT===key)current&&(current=current.prev()),that.current(current&&current[0]?current:that._item("last")),preventDefault(e);else if(keys.DOWN===key||keys.RIGHT===key)current&&(current=current.next()),that.current(current&&current[0]?current:that._item("first")),preventDefault(e);else if(keys.PAGEUP===key)that.current(null),that.dataSource.page(that.dataSource.page()-1),preventDefault(e);else if(keys.PAGEDOWN===key)that.current(null),that.dataSource.page(that.dataSource.page()+1),preventDefault(e);else if(keys.HOME===key)that.current(that._item("first")),preventDefault(e);else if(keys.END===key)that.current(that._item("last")),preventDefault(e);else if(keys.ENTER===key)if(0!==editItem.length&&(canHandle||isTextBox)){idx=that.items().index(editItem),active&&active.blur(),that.save();var focusAgain=function(){that.element.trigger("focus"),that.current(that.items().eq(idx))};that.one("dataBound",focusAgain)}else""!==that.options.editTemplate&&that.edit(current);else if(keys.ESC===key){if(editItem=element.find("."+KEDITITEM),0===editItem.length)return;idx=that.items().index(editItem),that.cancel(),that.element.trigger("focus"),that.current(that.items().eq(idx))}}),element.on("mousedown"+NS+" touchstart"+NS,FOCUSSELECTOR,proxy(clickCallback,that)))},clearSelection:function(){var that=this;that.selectable.clear(),that.trigger(CHANGE)},select:function(items){var that=this,selectable=that.selectable;return items=$(items),items.length?(selectable.options.multiple||(selectable.clear(),items=items.first()),void selectable.value(items)):selectable.value()},_destroyEditable:function(){var that=this;that.editable&&(that.editable.destroy(),delete that.editable)},_modelFromElement:function(element){var uid=element.attr(kendo.attr("uid"));return this.dataSource.getByUid(uid)},_closeEditable:function(validate){var data,index,that=this,editable=that.editable,template=that.template,valid=!0;return editable&&(validate&&(valid=editable.end()),valid&&(editable.element.index()%2&&(template=that.altTemplate),data=that._modelFromElement(editable.element),that._destroyEditable(),index=editable.element.index(),editable.element.replaceWith(template(data)),that.items().eq(index).attr(kendo.attr("uid"),data.uid))),valid},edit:function(item){var container,index,that=this,data=that._modelFromElement(item),uid=data.uid;that.cancel(),item=that.items().filter("["+kendo.attr("uid")+"="+uid+"]"),index=item.index(),item.replaceWith(that.editTemplate(data)),container=that.items().eq(index).addClass(KEDITITEM).attr(kendo.attr("uid"),data.uid),that.editable=container.kendoEditable({model:data,clearContainer:!1,errorTemplate:!1}).data("kendoEditable"),that.trigger(EDIT,{model:data,item:container})},save:function(){var model,that=this,editable=that.editable;editable&&(editable=editable.element,model=that._modelFromElement(editable),!that.trigger(SAVE,{model:model,item:editable})&&that._closeEditable(!0)&&that.dataSource.sync())},remove:function(item){var that=this,dataSource=that.dataSource,data=that._modelFromElement(item);that.trigger(REMOVE,{model:data,item:item})||(item.hide(),dataSource.remove(data),dataSource.sync())},add:function(){var that=this,dataSource=that.dataSource,index=dataSource.indexOf((dataSource.view()||[])[0]);index<0&&(index=0),that.cancel(),dataSource.insert(index,{}),that.edit(that.element.children().first())},cancel:function(){var that=this,dataSource=that.dataSource;if(that.editable){var container=that.editable.element,model=that._modelFromElement(container);that.trigger(CANCEL,{model:model,container:container})||(dataSource.cancelChanges(model),that._closeEditable(!1))}},_crudHandlers:function(){var that=this,clickNS=CLICK+NS;that.element.on(clickNS,".k-edit-button",function(e){var item=$(this).closest("["+kendo.attr("uid")+"]");that.edit(item),e.preventDefault()}),that.element.on(clickNS,".k-delete-button",function(e){var item=$(this).closest("["+kendo.attr("uid")+"]");that.remove(item),e.preventDefault()}),that.element.on(clickNS,".k-update-button",function(e){that.save(),e.preventDefault()}),that.element.on(clickNS,".k-cancel-button",function(e){that.cancel(),e.preventDefault()})},destroy:function(){var that=this;Widget.fn.destroy.call(that),that._unbindDataSource(),that._destroyEditable(),that.element.off(NS),that.pager&&that.pager.destroy(),kendo.destroy(that.element)}});kendo.ui.plugin(ListView)}(window.kendo.jQuery),function($,undefined){function getFileName(input){return $.map(inputFiles(input),function(file){return file.name}).join(", ")}function inputFiles($input){var input=$input[0];return input.files?getAllFileInfo(input.files):[{name:stripPath(input.value),extension:getFileExtension(input.value),size:null}]}function getAllFileInfo(rawFiles){return $.map(rawFiles,function(file){return getFileInfo(file)})}function getFileInfo(rawFile){var fileName=rawFile.name||rawFile.fileName;return{name:kendo.htmlEncode(fileName),extension:getFileExtension(fileName),size:rawFile.size||rawFile.fileSize,rawFile:rawFile}}function getFileExtension(fileName){var matches=fileName.match(rFileExtension);return matches?matches[0]:""}function stripPath(name){var slashIndex=name.lastIndexOf("\\");return slashIndex!=-1?name.substr(slashIndex+1):name}function assignGuidToFiles(files,unique){var uid=kendo.guid();return $.map(files,function(file){return file.uid=unique?kendo.guid():uid,file})}function removeUploadedFile(fileEntry,upload,data){if(upload._supportsRemove()){var files=fileEntry.data("fileNames"),fileNames=$.map(files,function(file){return file.name});upload._submitRemove(fileNames,data,function(data,textStatus,xhr){upload._removeFileEntry(fileEntry),upload.trigger(SUCCESS,{operation:"remove",files:files,response:data,XMLHttpRequest:xhr})},function(xhr){upload.trigger(ERROR,{operation:"remove",files:files,XMLHttpRequest:xhr}),logToConsole("Server response: "+xhr.responseText)})}}function tryParseJSON(input,onSuccess,onError){var success=!1,json="";try{json=$.parseJSON(normalizeJSON(input)),success=!0}catch(e){onError()}success&&onSuccess(json)}function normalizeJSON(input){return"undefined"!=typeof input&&""!==input||(input="{}"),input}function stopEvent(e){e.stopPropagation(),e.preventDefault()}function bindDragEventWrappers(element,namespace,onDragEnter,onDragLeave){var hideInterval,lastDrag;element.on("dragenter"+namespace,function(){onDragEnter(),lastDrag=new Date,hideInterval||(hideInterval=setInterval(function(){var sinceLastDrag=new Date-lastDrag;sinceLastDrag>100&&(onDragLeave(),clearInterval(hideInterval),hideInterval=null)},100))}).on("dragover"+namespace,function(){lastDrag=new Date})}function isFileUploadStarted(fileEntry){return fileEntry.is(".k-file-progress, .k-file-success, .k-file-error")}function getFileEntry(e){return $(e.target).closest(".k-file")}function getAntiForgeryTokens(){var tokens={},csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content");return $("input[name^='__RequestVerificationToken']").each(function(){tokens[this.name]=this.value}),csrf_param!==undefined&&csrf_token!==undefined&&(tokens[csrf_param]=csrf_token),tokens}var kendo=window.kendo,Widget=kendo.ui.Widget,logToConsole=kendo.logToConsole,rFileExtension=/\.([^\.]+)$/,NS=".kendoUpload",SELECT="select",UPLOAD="upload",SUCCESS="success",ERROR="error",COMPLETE="complete",CANCEL="cancel",PROGRESS="progress",REMOVE="remove",Upload=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),that.name=element.name,that.multiple=that.options.multiple,that.localization=that.options.localization;var activeInput=that.element;that.wrapper=activeInput.closest(".k-upload"),0===that.wrapper.length&&(that.wrapper=that._wrapInput(activeInput)),that._activeInput(activeInput),that.toggle(that.options.enabled);var ns=that._ns=NS+"-"+kendo.guid();if(activeInput.closest("form").on("submit"+ns,$.proxy(that._onParentFormSubmit,that)).on("reset"+ns,$.proxy(that._onParentFormReset,that)),that.options.async.saveUrl){that._module=that._supportsFormData()?new formDataUploadModule(that):new iframeUploadModule(that),that._async=!0;var initialFiles=that.options.files;initialFiles.length>0&&that._renderInitialFiles(initialFiles)}else that._module=new syncUploadModule(that);that._supportsDrop()&&that._setupDropZone(),that.wrapper.on("click",".k-upload-action",$.proxy(that._onFileAction,that)).on("click",".k-upload-selected",$.proxy(that._onUploadSelected,that)),that.element.val()&&that._onInputChange({target:that.element})},events:[SELECT,UPLOAD,SUCCESS,ERROR,COMPLETE,CANCEL,PROGRESS,REMOVE],options:{name:"Upload",enabled:!0,multiple:!0,showFileList:!0,template:"",files:[],async:{removeVerb:"POST",autoUpload:!0},localization:{select:"Select files...",cancel:"Cancel",retry:"Retry",remove:"Remove",uploadSelectedFiles:"Upload files",dropFilesHere:"drop files here to upload",statusUploading:"uploading",statusUploaded:"uploaded",statusWarning:"warning",statusFailed:"failed",headerStatusUploading:"Uploading...",headerStatusUploaded:"Done"}},setOptions:function(options){var that=this,activeInput=that.element;Widget.fn.setOptions.call(that,options),that.multiple=that.options.multiple,activeInput.attr("multiple",!!that._supportsMultiple()&&that.multiple),that.toggle(that.options.enabled)},enable:function(enable){enable="undefined"==typeof enable||enable,this.toggle(enable)},disable:function(){this.toggle(!1)},toggle:function(enable){enable="undefined"==typeof enable?enable:!enable,this.wrapper.toggleClass("k-state-disabled",enable),this.element.prop("disabled",enable)},destroy:function(){var that=this;$(document).add($(".k-dropzone",that.wrapper)).add(that.wrapper.closest("form")).off(that._ns),$(that.element).off(NS),Widget.fn.destroy.call(that)},_addInput:function(sourceInput){if(sourceInput[0].nodeType){var that=this,input=sourceInput.clone().val("");input.insertAfter(that.element).data("kendoUpload",that),$(that.element).hide().attr("tabindex","-1").removeAttr("id").off(NS),that._activeInput(input),that.element.focus()}},_activeInput:function(input){var that=this,wrapper=that.wrapper;that.element=input,input.attr("multiple",!!that._supportsMultiple()&&that.multiple).attr("autocomplete","off").on("click"+NS,function(e){wrapper.hasClass("k-state-disabled")&&e.preventDefault()}).on("focus"+NS,function(){$(this).parent().addClass("k-state-focused")}).on("blur"+NS,function(){$(this).parent().removeClass("k-state-focused")}).on("change"+NS,$.proxy(that._onInputChange,that)).on("keydown"+NS,$.proxy(that._onInputKeyDown,that))},_onInputKeyDown:function(e){var that=this,firstButton=that.wrapper.find(".k-upload-action:first");e.keyCode===kendo.keys.TAB&&firstButton.length>0&&(e.preventDefault(),firstButton.focus())},_onInputChange:function(e){var that=this,input=$(e.target),files=assignGuidToFiles(that._inputFiles(input),that._isAsyncNonBatch()),prevented=that.trigger(SELECT,{files:files});prevented?(that._addInput(input),input.remove()):that._module.onSelect({target:input},files)},_onDrop:function(e){var dt=e.originalEvent.dataTransfer,that=this,droppedFiles=dt.files,files=assignGuidToFiles(getAllFileInfo(droppedFiles),that._isAsyncNonBatch());if(stopEvent(e),droppedFiles.length>0){var prevented=that.trigger(SELECT,{files:files});prevented||that._module.onSelect({target:$(".k-dropzone",that.wrapper)},files)}},_isAsyncNonBatch:function(){return this._async&&!this.options.async.batch||!1},_renderInitialFiles:function(files){var that=this,idx=0;for(files=assignGuidToFiles(files,!0),idx=0;idx<files.length;idx++){var currentFile=files[idx],fileEntry=that._enqueueFile(currentFile.name,{fileNames:[currentFile]});fileEntry.addClass("k-file-success").data("files",[files[idx]]),$(".k-progress",fileEntry).width("100%"),$(".k-upload-status",fileEntry).prepend("<span class='k-upload-pct'>100%</span>"),that._fileAction(fileEntry,REMOVE)}},_prepareTemplateData:function(name,data){var filesData=data.fileNames,templateData={},totalSize=0,idx=0;for(idx=0;idx<filesData.length;idx++)totalSize+=filesData[idx].size;return templateData.name=name,templateData.size=totalSize,templateData.files=data.fileNames,templateData},_prepareDefaultFileEntryTemplate:function(name,data){var extension="",defaultTemplate=$("<li class='k-file'><span class='k-progress'></span><span class='k-icon'></span><span class='k-filename' title='"+name+"'>"+name+"</span><strong class='k-upload-status'></strong></li>");return 1==data.fileNames.length&&data.fileNames[0].extension&&(extension=data.fileNames[0].extension.substring(1),$(".k-icon",defaultTemplate).addClass("k-i-"+extension)),defaultTemplate},_enqueueFile:function(name,data){var existingFileEntries,fileEntry,templateData,that=this,fileUid=data.fileNames[0].uid,fileList=$(".k-upload-files",that.wrapper),options=that.options,template=options.template;return 0===fileList.length&&(fileList=$("<ul class='k-upload-files k-reset'></ul>").appendTo(that.wrapper),that.options.showFileList||fileList.hide(),that.wrapper.removeClass("k-upload-empty")),existingFileEntries=$(".k-file",fileList),template?(templateData=that._prepareTemplateData(name,data),template=kendo.template(template),fileEntry=$("<li class='k-file'>"+template(templateData)+"</li>"),fileEntry.find(".k-upload-action").addClass("k-button k-button-bare")):fileEntry=that._prepareDefaultFileEntryTemplate(name,data),fileEntry.attr(kendo.attr("uid"),fileUid).appendTo(fileList).data(data),that._async||$(".k-progress",fileEntry).width("100%"),!that.multiple&&existingFileEntries.length>0&&that._module.onRemove({target:$(existingFileEntries,that.wrapper)}),fileEntry},_removeFileEntry:function(fileEntry){var allFiles,allCompletedFiles,that=this,fileList=fileEntry.closest(".k-upload-files");fileEntry.remove(),allFiles=$(".k-file",fileList),allCompletedFiles=$(".k-file-success, .k-file-error",fileList),allCompletedFiles.length===allFiles.length&&this._hideUploadButton(),0===allFiles.length&&(fileList.remove(),that.wrapper.addClass("k-upload-empty"),that._hideHeaderUploadstatus())},_fileAction:function(fileElement,actionKey){var classDictionary={remove:"k-delete",cancel:"k-cancel",retry:"k-retry"},iconsClassDictionary={remove:"k-i-close",cancel:"k-i-close",retry:"k-i-refresh"};classDictionary.hasOwnProperty(actionKey)&&(this._clearFileAction(fileElement),this.options.template?fileElement.find(".k-upload-action").addClass("k-button k-button-bare").append("<span class='k-icon "+iconsClassDictionary[actionKey]+" "+classDictionary[actionKey]+"' title='"+this.localization[actionKey]+"'></span>").show():(fileElement.find(".k-upload-status .k-upload-action").remove(),fileElement.find(".k-upload-status").append(this._renderAction(classDictionary[actionKey],this.localization[actionKey],iconsClassDictionary[actionKey]))))},_fileState:function(fileEntry,stateKey){var localization=this.localization,states={uploading:{text:localization.statusUploading},uploaded:{text:localization.statusUploaded},failed:{text:localization.statusFailed}},currentState=states[stateKey];currentState&&$(".k-icon:not(.k-delete, .k-cancel, .k-retry)",fileEntry).text(currentState.text)},_renderAction:function(actionClass,actionText,iconClass){return $(""!==actionClass?"<button type='button' class='k-button k-button-bare k-upload-action'><span class='k-icon "+iconClass+" "+actionClass+"' title='"+actionText+"'></span></button>":"<button type='button' class='k-button'>"+actionText+"</button>")},_clearFileAction:function(fileElement){$(".k-upload-action",fileElement).empty().hide()},_onFileAction:function(e){var that=this;if(!that.wrapper.hasClass("k-state-disabled")){var button=$(e.target).closest(".k-upload-action"),icon=button.find(".k-icon"),fileEntry=button.closest(".k-file"),eventArgs={files:fileEntry.data("fileNames")};icon.hasClass("k-delete")?that.trigger(REMOVE,eventArgs)||that._module.onRemove({target:$(fileEntry,that.wrapper)},eventArgs.data):icon.hasClass("k-cancel")?(that.trigger(CANCEL,eventArgs),that._module.onCancel({target:$(fileEntry,that.wrapper)}),this._checkAllComplete(),that._updateHeaderUploadStatus()):icon.hasClass("k-retry")&&($(".k-warning",fileEntry).remove(),that._module.onRetry({target:$(fileEntry,that.wrapper)}))}return!1},_onUploadSelected:function(){return this._module.onSaveSelected(),!1},_onFileProgress:function(e,percentComplete){var progressPct;this.options.template?$(".k-progress",e.target).width(percentComplete+"%"):(progressPct=$(".k-upload-pct",e.target),0===progressPct.length&&$(".k-upload-status",e.target).prepend("<span class='k-upload-pct'></span>"),$(".k-upload-pct",e.target).text(percentComplete+"%"),$(".k-progress",e.target).width(percentComplete+"%")),this.trigger(PROGRESS,{files:getFileEntry(e).data("fileNames"),percentComplete:percentComplete})},_onUploadSuccess:function(e,response,xhr){var fileEntry=getFileEntry(e);this._fileState(fileEntry,"uploaded"),fileEntry.removeClass("k-file-progress").addClass("k-file-success"),this._updateHeaderUploadStatus(),this.trigger(SUCCESS,{files:fileEntry.data("fileNames"),response:response,operation:"upload",XMLHttpRequest:xhr}),this._supportsRemove()?this._fileAction(fileEntry,REMOVE):this._clearFileAction(fileEntry),this._checkAllComplete()},_onUploadError:function(e,xhr){var fileEntry=getFileEntry(e),uploadPercentage=$(".k-upload-pct",fileEntry);this._fileState(fileEntry,"failed"),fileEntry.removeClass("k-file-progress").addClass("k-file-error"),$(".k-progress",fileEntry).width("100%"),uploadPercentage.length>0?uploadPercentage.empty().removeClass("k-upload-pct").addClass("k-icon k-warning"):$(".k-upload-status",fileEntry).prepend("<span class='k-icon k-warning'></span>"),this._updateHeaderUploadStatus(),this._fileAction(fileEntry,"retry"),this.trigger(ERROR,{operation:"upload",files:fileEntry.data("fileNames"),XMLHttpRequest:xhr}),logToConsole("Server response: "+xhr.responseText),this._checkAllComplete()},_showUploadButton:function(){var uploadButton=$(".k-upload-selected",this.wrapper);0===uploadButton.length&&(uploadButton=this._renderAction("",this.localization.uploadSelectedFiles).addClass("k-upload-selected")),this.wrapper.append(uploadButton)},_hideUploadButton:function(){$(".k-upload-selected",this.wrapper).remove()},_showHeaderUploadStatus:function(){var localization=this.localization,dropZone=$(".k-dropzone",this.wrapper),headerUploadStatus=$(".k-upload-status-total",this.wrapper);0!==headerUploadStatus.length&&headerUploadStatus.remove(),headerUploadStatus='<strong class="k-upload-status k-upload-status-total">'+localization.headerStatusUploading+'<span class="k-icon k-loading">'+localization.statusUploading+"</span></strong>",dropZone.length>0?dropZone.append(headerUploadStatus):$(".k-upload-button",this.wrapper).after(headerUploadStatus)},_updateHeaderUploadStatus:function(){var failedUploads,headerUploadStatus,headerUploadStatusIcon,that=this,localization=that.localization,currentlyUploading=$(".k-file",that.wrapper).not(".k-file-success, .k-file-error");0===currentlyUploading.length&&(failedUploads=$(".k-file.k-file-error",that.wrapper),headerUploadStatus=$(".k-upload-status-total",that.wrapper),headerUploadStatusIcon=$(".k-icon",headerUploadStatus).removeClass("k-loading").addClass(0!==failedUploads.length?"k-warning":"k-i-tick").text(0!==failedUploads.length?localization.statusWarning:localization.statusUploaded),headerUploadStatus.text(that.localization.headerStatusUploaded).append(headerUploadStatusIcon))},_hideHeaderUploadstatus:function(){$(".k-upload-status-total",this.wrapper).remove()},_onParentFormSubmit:function(){var upload=this,element=upload.element;if("undefined"!=typeof this._module.onAbort&&this._module.onAbort(),!element.value){var input=$(element);input.attr("disabled","disabled"),window.setTimeout(function(){input.removeAttr("disabled")},0)}},_onParentFormReset:function(){$(".k-upload-files",this.wrapper).remove()},_supportsFormData:function(){return"undefined"!=typeof FormData},_supportsMultiple:function(){var windows=this._userAgent().indexOf("Windows")>-1;return!(kendo.support.browser.opera||kendo.support.browser.safari&&windows)},_supportsDrop:function(){var userAgent=this._userAgent().toLowerCase(),isChrome=/chrome/.test(userAgent),isSafari=!isChrome&&/safari/.test(userAgent),isWindowsSafari=isSafari&&/windows/.test(userAgent);return!isWindowsSafari&&this._supportsFormData()&&this.options.async.saveUrl},_userAgent:function(){return navigator.userAgent},_setupDropZone:function(){var that=this;$(".k-upload-button",this.wrapper).wrap("<div class='k-dropzone'></div>");var ns=that._ns,dropZone=$(".k-dropzone",that.wrapper).append($("<em>"+that.localization.dropFilesHere+"</em>")).on("dragenter"+ns,stopEvent).on("dragover"+ns,function(e){e.preventDefault()}).on("drop"+ns,$.proxy(this._onDrop,this));bindDragEventWrappers(dropZone,ns,function(){dropZone.addClass("k-dropzone-hovered")},function(){dropZone.removeClass("k-dropzone-hovered")}),bindDragEventWrappers($(document),ns,function(){dropZone.addClass("k-dropzone-active"),dropZone.closest(".k-upload").removeClass("k-upload-empty")},function(){dropZone.removeClass("k-dropzone-active"),0===$("li.k-file",dropZone.closest(".k-upload")).length&&dropZone.closest(".k-upload").addClass("k-upload-empty")})},_supportsRemove:function(){return!!this.options.async.removeUrl},_submitRemove:function(fileNames,data,onSuccess,onError){var upload=this,removeField=upload.options.async.removeField||"fileNames",params=$.extend(data,getAntiForgeryTokens());params[removeField]=fileNames,jQuery.ajax({type:this.options.async.removeVerb,dataType:"json",dataFilter:normalizeJSON,url:this.options.async.removeUrl,traditional:!0,data:params,success:onSuccess,error:onError})},_wrapInput:function(input){var that=this,options=that.options;return input.wrap("<div class='k-widget k-upload k-header'><div class='k-button k-upload-button'></div></div>"),options.async.saveUrl||input.closest(".k-upload").addClass("k-upload-sync"),input.closest(".k-upload").addClass("k-upload-empty"),input.closest(".k-button").append("<span>"+this.localization.select+"</span>"),input.closest(".k-upload")},_checkAllComplete:function(){0===$(".k-file.k-file-progress",this.wrapper).length&&this.trigger(COMPLETE)},_inputFiles:function(sourceInput){return inputFiles(sourceInput)}}),syncUploadModule=function(upload){this.name="syncUploadModule",this.element=upload.wrapper,this.upload=upload,this.element.closest("form").attr("enctype","multipart/form-data").attr("encoding","multipart/form-data")};syncUploadModule.prototype={onSelect:function(e,files){var upload=this.upload,sourceInput=$(e.target);upload._addInput(sourceInput);var file=upload._enqueueFile(getFileName(sourceInput),{relatedInput:sourceInput,fileNames:files});upload._fileAction(file,REMOVE)},onRemove:function(e){var fileEntry=getFileEntry(e);fileEntry.data("relatedInput").remove(),this.upload._removeFileEntry(fileEntry)}};var iframeUploadModule=function(upload){this.name="iframeUploadModule",this.element=upload.wrapper,this.upload=upload,this.iframes=[]};Upload._frameId=0,iframeUploadModule.prototype={onSelect:function(e,files){var upload=this.upload,sourceInput=$(e.target),fileEntry=this.prepareUpload(sourceInput,files);upload.options.async.autoUpload?this.performUpload(fileEntry):(upload._supportsRemove()&&this.upload._fileAction(fileEntry,REMOVE),upload._showUploadButton())},prepareUpload:function(sourceInput,files){var upload=this.upload,activeInput=$(upload.element),name=upload.options.async.saveField||sourceInput.attr("name");upload._addInput(sourceInput),sourceInput.attr("name",name);var iframe=this.createFrame(upload.name+"_"+Upload._frameId++);this.registerFrame(iframe);var form=this.createForm(upload.options.async.saveUrl,iframe.attr("name")).append(activeInput),fileEntry=upload._enqueueFile(getFileName(sourceInput),{frame:iframe,relatedInput:activeInput,fileNames:files});return iframe.data({form:form,file:fileEntry}),fileEntry},performUpload:function(fileEntry){var e={files:fileEntry.data("fileNames")},iframe=fileEntry.data("frame"),upload=this.upload;if(upload.trigger(UPLOAD,e))upload._removeFileEntry(iframe.data("file")),this.cleanupFrame(iframe),this.unregisterFrame(iframe);else{upload._hideUploadButton(),upload._showHeaderUploadStatus(),iframe.appendTo(document.body);var form=iframe.data("form").attr("action",upload.options.async.saveUrl).appendTo(document.body);e.data=$.extend({},e.data,getAntiForgeryTokens());for(var key in e.data){var dataInput=form.find("input[name='"+key+"']");0===dataInput.length&&(dataInput=$("<input>",{
type:"hidden",name:key}).prependTo(form)),dataInput.val(e.data[key])}upload._fileAction(fileEntry,CANCEL),upload._fileState(fileEntry,"uploading"),$(fileEntry).removeClass("k-file-error").addClass("k-file-progress"),iframe.one("load",$.proxy(this.onIframeLoad,this)),form[0].submit()}},onSaveSelected:function(){var module=this;$(".k-file",this.element).each(function(){var fileEntry=$(this),started=isFileUploadStarted(fileEntry);started||module.performUpload(fileEntry)})},onIframeLoad:function(e){var responseText,iframe=$(e.target);try{responseText=iframe.contents().text()}catch(ex){responseText="Error trying to get server response: "+ex}this.processResponse(iframe,responseText)},processResponse:function(iframe,responseText){var fileEntry=iframe.data("file"),module=this,fakeXHR={responseText:responseText};tryParseJSON(responseText,function(jsonResult){$.extend(fakeXHR,{statusText:"OK",status:"200"}),module.upload._onFileProgress({target:$(fileEntry,module.upload.wrapper)},100),module.upload._onUploadSuccess({target:$(fileEntry,module.upload.wrapper)},jsonResult,fakeXHR),module.cleanupFrame(iframe),module.unregisterFrame(iframe)},function(){$.extend(fakeXHR,{statusText:"error",status:"500"}),module.upload._onUploadError({target:$(fileEntry,module.upload.wrapper)},fakeXHR)})},onCancel:function(e){var iframe=$(e.target).data("frame");this.stopFrameSubmit(iframe),this.cleanupFrame(iframe),this.unregisterFrame(iframe),this.upload._removeFileEntry(iframe.data("file"))},onRetry:function(e){var fileEntry=getFileEntry(e);this.performUpload(fileEntry)},onRemove:function(e,data){var fileEntry=getFileEntry(e),iframe=fileEntry.data("frame");iframe?(this.unregisterFrame(iframe),this.upload._removeFileEntry(fileEntry),this.cleanupFrame(iframe)):removeUploadedFile(fileEntry,this.upload,data)},onAbort:function(){var element=this.element,module=this;$.each(this.iframes,function(){$("input",this.data("form")).appendTo(element),module.stopFrameSubmit(this[0]),this.data("form").remove(),this.remove()}),this.iframes=[]},createFrame:function(id){return $("<iframe name='"+id+"' id='"+id+"' style='display:none;' />")},createForm:function(action,target){return $("<form enctype='multipart/form-data' method='POST' action='"+action+"' target='"+target+"'/>")},stopFrameSubmit:function(frame){"undefined"!=typeof frame.stop?frame.stop():frame.document&&frame.document.execCommand("Stop")},registerFrame:function(frame){this.iframes.push(frame)},unregisterFrame:function(frame){this.iframes=$.grep(this.iframes,function(value){return value.attr("name")!=frame.attr("name")})},cleanupFrame:function(frame){var form=frame.data("form");frame.data("file").data("frame",null),setTimeout(function(){form.remove(),frame.remove()},1)}};var formDataUploadModule=function(upload){this.name="formDataUploadModule",this.element=upload.wrapper,this.upload=upload};formDataUploadModule.prototype={onSelect:function(e,files){var upload=this.upload,module=this,sourceElement=$(e.target),fileEntries=this.prepareUpload(sourceElement,files);$.each(fileEntries,function(){upload.options.async.autoUpload?module.performUpload(this):(upload._supportsRemove()&&upload._fileAction(this,REMOVE),upload._showUploadButton())})},prepareUpload:function(sourceElement,files){var fileEntries=this.enqueueFiles(files);return sourceElement.is("input")&&($.each(fileEntries,function(){$(this).data("relatedInput",sourceElement)}),sourceElement.data("relatedFileEntries",fileEntries),this.upload._addInput(sourceElement)),fileEntries},enqueueFiles:function(files){var name,i,currentFile,fileEntry,upload=this.upload,filesLength=files.length,fileEntries=[];if(upload.options.async.batch===!0)name=$.map(files,function(file){return file.name}).join(", "),fileEntry=upload._enqueueFile(name,{fileNames:files}),fileEntry.data("files",files),fileEntries.push(fileEntry);else for(i=0;i<filesLength;i++)currentFile=files[i],name=currentFile.name,fileEntry=upload._enqueueFile(name,{fileNames:[currentFile]}),fileEntry.data("files",[currentFile]),fileEntries.push(fileEntry);return fileEntries},performUpload:function(fileEntry){var upload=this.upload,formData=this.createFormData(),xhr=new XMLHttpRequest,e={files:fileEntry.data("fileNames"),XMLHttpRequest:xhr};if(upload.trigger(UPLOAD,e))this.removeFileEntry(fileEntry);else{upload._fileAction(fileEntry,CANCEL),upload._hideUploadButton(),upload._showHeaderUploadStatus(),e.data=$.extend({},e.data,getAntiForgeryTokens());for(var key in e.data)formData.append(key,e.data[key]);this.populateFormData(formData,fileEntry.data("files")),upload._fileState(fileEntry,"uploading"),$(fileEntry).removeClass("k-file-error").addClass("k-file-progress"),this.postFormData(upload.options.async.saveUrl,formData,fileEntry,xhr)}},onSaveSelected:function(){var module=this;$(".k-file",this.element).each(function(){var fileEntry=$(this),started=isFileUploadStarted(fileEntry);started||module.performUpload(fileEntry)})},onCancel:function(e){var fileEntry=getFileEntry(e);this.stopUploadRequest(fileEntry),this.removeFileEntry(fileEntry)},onRetry:function(e){var fileEntry=getFileEntry(e);this.performUpload(fileEntry)},onRemove:function(e,data){var fileEntry=getFileEntry(e);fileEntry.hasClass("k-file-success")?removeUploadedFile(fileEntry,this.upload,data):this.removeFileEntry(fileEntry)},postFormData:function(url,data,fileEntry,xhr){var module=this;fileEntry.data("request",xhr),xhr.addEventListener("load",function(e){module.onRequestSuccess.call(module,e,fileEntry)},!1),xhr.addEventListener(ERROR,function(e){module.onRequestError.call(module,e,fileEntry)},!1),xhr.upload.addEventListener("progress",function(e){module.onRequestProgress.call(module,e,fileEntry)},!1),xhr.open("POST",url,!0),xhr.withCredentials="true",xhr.send(data)},createFormData:function(){return new FormData},populateFormData:function(data,files){var i,upload=this.upload,length=files.length;for(i=0;i<length;i++)data.append(upload.options.async.saveField||upload.name,files[i].rawFile);return data},onRequestSuccess:function(e,fileEntry){function raiseError(){module.upload._onUploadError({target:$(fileEntry,module.upload.wrapper)},xhr)}var xhr=e.target,module=this;xhr.status>=200&&xhr.status<=299?tryParseJSON(xhr.responseText,function(jsonResult){module.upload._onFileProgress({target:$(fileEntry,module.upload.wrapper)},100),module.upload._onUploadSuccess({target:$(fileEntry,module.upload.wrapper)},jsonResult,xhr),module.cleanupFileEntry(fileEntry)},raiseError):raiseError()},onRequestError:function(e,fileEntry){var xhr=e.target;this.upload._onUploadError({target:$(fileEntry,this.upload.wrapper)},xhr)},cleanupFileEntry:function(fileEntry){var relatedInput=fileEntry.data("relatedInput"),uploadComplete=!0;relatedInput&&($.each(relatedInput.data("relatedFileEntries")||[],function(){this.parent().length>0&&this[0]!=fileEntry[0]&&(uploadComplete=uploadComplete&&this.hasClass("k-file-success"))}),uploadComplete&&relatedInput.remove())},removeFileEntry:function(fileEntry){this.cleanupFileEntry(fileEntry),this.upload._removeFileEntry(fileEntry)},onRequestProgress:function(e,fileEntry){var percentComplete=Math.round(100*e.loaded/e.total);this.upload._onFileProgress({target:$(fileEntry,this.upload.wrapper)},percentComplete)},stopUploadRequest:function(fileEntry){fileEntry.data("request").abort()}},kendo.ui.plugin(Upload)}(window.kendo.jQuery),function($,undefined){function bindDragEventWrappers(element,onDragEnter,onDragLeave){var hideInterval,lastDrag;element.on("dragenter"+NS,function(){onDragEnter(),lastDrag=new Date,hideInterval||(hideInterval=setInterval(function(){var sinceLastDrag=new Date-lastDrag;sinceLastDrag>100&&(onDragLeave(),clearInterval(hideInterval),hideInterval=null)},100))}).on("dragover"+NS,function(){lastDrag=new Date})}function concatPaths(path,name){return path!==undefined&&path.match(/\/$/)||(path=(path||"")+"/"),path+name}function sizeFormatter(value){if(!value)return"";var suffix=" bytes";return value>=1073741824?(suffix=" GB",value/=1073741824):value>=1048576?(suffix=" MB",value/=1048576):value>=1024&&(suffix=" KB",value/=1024),Math.round(100*value)/100+suffix}function fieldName(fields,name){var descriptor=fields[name];return isPlainObject(descriptor)?descriptor.from||descriptor.field||name:descriptor}var kendo=window.kendo,Widget=kendo.ui.Widget,isPlainObject=$.isPlainObject,proxy=$.proxy,extend=$.extend,placeholderSupported=kendo.support.placeholder,browser=kendo.support.browser,isFunction=kendo.isFunction,trimSlashesRegExp=/(^\/|\/$)/g,CHANGE="change",APPLY="apply",ERROR="error",CLICK="click",NS=".kendoImageBrowser",BREADCRUBMSNS=".kendoBreadcrumbs",SEARCHBOXNS=".kendoSearchBox",NAMEFIELD="name",SIZEFIELD="size",TYPEFIELD="type",DEFAULTSORTORDER={field:TYPEFIELD,dir:"asc"},EMPTYTILE=kendo.template('<li class="k-tile-empty"><strong>${text}</strong></li>'),TOOLBARTMPL='<div class="k-widget k-toolbar k-header k-floatwrap"><div class="k-toolbar-wrap"># if (showUpload) { # <div class="k-widget k-upload"><div class="k-button k-button-icontext k-upload-button"><span class="k-icon k-add"></span>#=messages.uploadFile#<input type="file" name="file" /></div></div># } ## if (showCreate) { #<button type="button" class="k-button k-button-icon"><span class="k-icon k-addfolder" /></button># } ## if (showDelete) { #<button type="button" class="k-button k-button-icon k-state-disabled"><span class="k-icon k-delete" /></button>&nbsp;# } #</div><div class="k-tiles-arrange"><label>#=messages.orderBy#: <select /></label></a></div></div>';extend(!0,kendo.data,{schemas:{imagebrowser:{data:function(data){return data.items||data||[]},model:{id:"name",fields:{name:"name",size:"size",type:"type"}}}}}),extend(!0,kendo.data,{transports:{imagebrowser:kendo.data.RemoteTransport.extend({init:function(options){kendo.data.RemoteTransport.fn.init.call(this,$.extend(!0,{},this.options,options))},_call:function(type,options){options.data=$.extend({},options.data,{path:this.options.path()}),isFunction(this.options[type])?this.options[type].call(this,options):kendo.data.RemoteTransport.fn[type].call(this,options)},read:function(options){this._call("read",options)},create:function(options){this._call("create",options)},destroy:function(options){this._call("destroy",options)},update:function(){},options:{read:{type:"POST"},update:{type:"POST"},create:{type:"POST"},destroy:{type:"POST"}}})}});var offsetTop;offsetTop=browser.msie&&browser.version<8?function(element){return element.offsetTop}:function(element){return element.offsetTop-$(element).height()};var ImageBrowser=Widget.extend({init:function(element,options){var that=this;options=options||{},Widget.fn.init.call(that,element,options),that.element.addClass("k-imagebrowser"),that.element.on(CLICK+NS,".k-toolbar button:not(.k-state-disabled):has(.k-delete)",proxy(that._deleteClick,that)).on(CLICK+NS,".k-toolbar button:not(.k-state-disabled):has(.k-addfolder)",proxy(that._addClick,that)).on("keydown"+NS,"li.k-state-selected input",proxy(that._directoryKeyDown,that)).on("blur"+NS,"li.k-state-selected input",proxy(that._directoryBlur,that)),that._dataSource(),that.refresh(),that.path(that.options.path)},options:{name:"ImageBrowser",messages:{uploadFile:"Upload",orderBy:"Arrange by",orderByName:"Name",orderBySize:"Size",directoryNotFound:"A directory with this name was not found.",emptyFolder:"Empty Folder",deleteFile:'Are you sure you want to delete "{0}"?',invalidFileType:'The selected file "{0}" is not valid. Supported file types are {1}.',overwriteFile:'A file with name "{0}" already exists in the current directory. Do you want to overwrite it?',dropFilesHere:"drop file here to upload",search:"Search"},transport:{},path:"/",fileTypes:"*.png,*.gif,*.jpg,*.jpeg"},events:[ERROR,CHANGE,APPLY],destroy:function(){var that=this;Widget.fn.destroy.call(that),that.dataSource.unbind(ERROR,that._errorHandler),that.element.add(that.list).add(that.toolbar).off(NS),kendo.destroy(that.element)},value:function(){var path,that=this,selected=that._selectedItem(),imageUrl=that.options.transport.imageUrl;if(selected&&"f"===selected.get(TYPEFIELD))return path=concatPaths(that.path(),selected.get(NAMEFIELD)).replace(trimSlashesRegExp,""),imageUrl&&(path=isFunction(imageUrl)?imageUrl(path):kendo.format(imageUrl,encodeURIComponent(path))),path},_selectedItem:function(){var listView=this.listView,selected=listView.select();if(selected.length)return this.dataSource.getByUid(selected.attr(kendo.attr("uid")))},_toolbar:function(){var that=this,template=kendo.template(TOOLBARTMPL),messages=that.options.messages,arrangeBy=[{text:messages.orderByName,value:"name"},{text:messages.orderBySize,value:"size"}];that.toolbar=$(template({messages:messages,showUpload:that.options.transport.uploadUrl,showCreate:that.options.transport.create,showDelete:that.options.transport.destroy})).appendTo(that.element).find(".k-upload input").kendoUpload({multiple:!1,localization:{dropFilesHere:messages.dropFilesHere},async:{saveUrl:that.options.transport.uploadUrl,autoUpload:!0},upload:proxy(that._fileUpload,that),error:function(e){that._error({xhr:e.XMLHttpRequest,status:"error"})}}).end(),that.upload=that.toolbar.find(".k-upload input").data("kendoUpload"),that.arrangeBy=that.toolbar.find(".k-tiles-arrange select").kendoDropDownList({dataSource:arrangeBy,dataTextField:"text",dataValueField:"value",change:function(){that.orderBy(this.value())}}).data("kendoDropDownList"),that._attachDropzoneEvents()},_attachDropzoneEvents:function(){var that=this;that.options.transport.uploadUrl&&(bindDragEventWrappers($(document.documentElement),$.proxy(that._dropEnter,that),$.proxy(that._dropLeave,that)),that._scrollHandler=proxy(that._positionDropzone,that))},_dropEnter:function(){this._positionDropzone(),$(document).on("scroll"+NS,this._scrollHandler)},_dropLeave:function(){this._removeDropzone(),$(document).off("scroll"+NS,this._scrollHandler)},_positionDropzone:function(){var that=this,element=that.element,offset=element.offset();that.toolbar.find(".k-dropzone").addClass("k-imagebrowser-dropzone").offset(offset).css({width:element[0].clientWidth,height:element[0].clientHeight,lineHeight:element[0].clientHeight+"px"})},_removeDropzone:function(){this.toolbar.find(".k-dropzone").removeClass("k-imagebrowser-dropzone").css({width:"",height:"",lineHeight:"",top:"",left:""})},_deleteClick:function(){var that=this,item=that.listView.select(),message=kendo.format(that.options.messages.deleteFile,item.find("strong").text());item.length&&that._showMessage(message,"confirm")&&that.listView.remove(item)},_addClick:function(){this.createDirectory()},_getFieldName:function(name){return fieldName(this.dataSource.reader.model.fields,name)},_fileUpload:function(e){var model,that=this,options=that.options,fileTypes=options.fileTypes,filterRegExp=new RegExp(("("+fileTypes.split(",").join(")|(")+")").replace(/\*\./g,".*."),"i"),fileName=e.files[0].name,fileNameField=NAMEFIELD,sizeField=SIZEFIELD;filterRegExp.test(fileName)?(e.data={path:that.path()},model=that._createFile(fileName),model?that.upload.one("success",function(e){model.set(fileNameField,e.response[that._getFieldName(fileNameField)]),model.set(sizeField,e.response[that._getFieldName(sizeField)]),that._tiles=that.listView.items().filter("["+kendo.attr("type")+"=f]"),that._scroll()}):e.preventDefault()):(e.preventDefault(),that._showMessage(kendo.format(options.messages.invalidFileType,fileName,fileTypes)))},_findFile:function(name){var idx,result,length,data=this.dataSource.data(),typeField=TYPEFIELD,nameField=NAMEFIELD;for(name=name.toLowerCase(),idx=0,length=data.length;idx<length;idx++)if("f"===data[idx].get(typeField)&&data[idx].get(nameField).toLowerCase()===name){result=data[idx];break}return result},_createFile:function(fileName){var idx,length,that=this,index=0,model={},typeField=TYPEFIELD,view=that.dataSource.view(),file=that._findFile(fileName);if(file&&!that._showMessage(kendo.format(that.options.messages.overwriteFile,fileName),"confirm"))return null;if(file)return file;for(idx=0,length=view.length;idx<length;idx++)if("f"===view[idx].get(typeField)){index=idx;break}return model[typeField]="f",model[NAMEFIELD]=fileName,model[SIZEFIELD]=0,that.dataSource.insert(++index,model)},createDirectory:function(){var idx,length,that=this,lastDirectoryIdx=0,typeField=TYPEFIELD,nameField=NAMEFIELD,view=that.dataSource.data(),name=that._nameDirectory(),model=new that.dataSource.reader.model;for(idx=0,length=view.length;idx<length;idx++)"d"===view[idx].get(typeField)&&(lastDirectoryIdx=idx);model.set(typeField,"d"),model.set(nameField,name),that.listView.one("dataBound",function(){var selected=that.listView.items().filter("["+kendo.attr("uid")+"="+model.uid+"]"),input=selected.find("input");selected.length&&this.edit(selected),this.element.scrollTop(selected.attr("offsetTop")-this.element[0].offsetHeight),setTimeout(function(){input.select()})}).one("save",function(e){var value=e.model.get(nameField);value?e.model.set(nameField,that._nameExists(value,model.uid)?that._nameDirectory():value):e.model.set(nameField,name)}),that.dataSource.insert(++lastDirectoryIdx,model)},_directoryKeyDown:function(e){13==e.keyCode&&e.currentTarget.blur()},_directoryBlur:function(){this.listView.save()},_nameExists:function(name,uid){var idx,length,data=this.dataSource.data(),typeField=TYPEFIELD,nameField=NAMEFIELD;for(idx=0,length=data.length;idx<length;idx++)if("d"===data[idx].get(typeField)&&data[idx].get(nameField).toLowerCase()===name.toLowerCase()&&data[idx].uid!==uid)return!0;return!1},_nameDirectory:function(){var candidate,idx,length,name="New folder",data=this.dataSource.data(),directoryNames=[],typeField=TYPEFIELD,nameField=NAMEFIELD;for(idx=0,length=data.length;idx<length;idx++)"d"===data[idx].get(typeField)&&data[idx].get(nameField).toLowerCase().indexOf(name.toLowerCase())>-1&&directoryNames.push(data[idx].get(nameField));if($.inArray(name,directoryNames)>-1){idx=2;do candidate=name+" ("+idx+")",idx++;while($.inArray(candidate,directoryNames)>-1);name=candidate}return name},orderBy:function(field){this.dataSource.sort([{field:TYPEFIELD,dir:"asc"},{field:field,dir:"asc"}])},search:function(name){this.dataSource.filter({field:NAMEFIELD,operator:"contains",value:name})},_content:function(){var that=this;that.list=$('<ul class="k-reset k-floats k-tiles" />').appendTo(that.element).on("scroll"+NS,proxy(that._scroll,that)).on("dblclick"+NS,"li",proxy(that._dblClick,that)),that.listView=new kendo.ui.ListView(that.list,{dataSource:that.dataSource,template:that._itemTmpl(),editTemplate:that._editTmpl(),selectable:!0,autoBind:!1,dataBinding:function(e){that.toolbar.find(".k-delete").parent().addClass("k-state-disabled"),"remove"!==e.action&&"sync"!==e.action||e.preventDefault()},dataBound:function(){that.dataSource.view().length?(that._tiles=this.items().filter("["+kendo.attr("type")+"=f]"),that._scroll()):this.wrapper.append(EMPTYTILE({text:that.options.messages.emptyFolder}))},change:proxy(that._listViewChange,that)})},_dblClick:function(e){var that=this,li=$(e.currentTarget);if(li.hasClass("k-edit-item")&&that._directoryBlur(),li.filter("["+kendo.attr("type")+"=d]").length){var folder=that.dataSource.getByUid(li.attr(kendo.attr("uid")));folder&&(that.path(concatPaths(that.path(),folder.get(NAMEFIELD))),that.breadcrumbs.value(that.path()))}else li.filter("["+kendo.attr("type")+"=f]").length&&that.trigger(APPLY)},_listViewChange:function(){var selected=this._selectedItem();selected&&(this.toolbar.find(".k-delete").parent().removeClass("k-state-disabled"),"f"===selected.get(TYPEFIELD)&&this.trigger(CHANGE))},_dataSource:function(){var schema,that=this,options=that.options,transport=options.transport,typeSortOrder=extend({},DEFAULTSORTORDER),nameSortOrder={field:NAMEFIELD,dir:"asc"},dataSource={type:transport.type||"imagebrowser",sort:[typeSortOrder,nameSortOrder]};isPlainObject(transport)&&(transport.path=proxy(that.path,that),dataSource.transport=transport),isPlainObject(options.schema)?dataSource.schema=options.schema:transport.type&&isPlainObject(kendo.data.schemas[transport.type])&&(schema=kendo.data.schemas[transport.type]),that.dataSource&&that._errorHandler?that.dataSource.unbind(ERROR,that._errorHandler):that._errorHandler=proxy(that._error,that),that.dataSource=kendo.data.DataSource.create(dataSource).bind(ERROR,that._errorHandler)},_navigation:function(){var that=this,navigation=$('<div class="k-floatwrap"><input/><input/></div>').appendTo(this.element);that.breadcrumbs=navigation.find("input:first").kendoBreadcrumbs({value:that.options.path,change:function(){that.path(this.value())}}).data("kendoBreadcrumbs"),that.searchBox=navigation.parent().find("input:last").kendoSearchBox({label:that.options.messages.search,change:function(){that.search(this.value())}}).data("kendoSearchBox")},_error:function(e){var status,that=this;that.trigger(ERROR,e)||(status=e.xhr.status,"error"==e.status?"404"==status?that._showMessage(that.options.messages.directoryNotFound):"0"!=status&&that._showMessage("Error! The requested URL returned "+status+" - "+e.xhr.statusText):"timeout"==status&&that._showMessage("Error! Server timeout."))},_showMessage:function(message,type){return window[type||"alert"](message)},refresh:function(){var that=this;that._navigation(),that._toolbar(),that._content()},_loadImage:function(li){var that=this,element=$(li),dataItem=that.dataSource.getByUid(element.attr(kendo.attr("uid"))),name=dataItem.get(NAMEFIELD),thumbnailUrl=that.options.transport.thumbnailUrl,img=$("<img />",{alt:name}),urlJoin="?";img.hide().on("load"+NS,function(){$(this).prev().remove().end().addClass("k-image").fadeIn()}),element.find(".k-loading").after(img),isFunction(thumbnailUrl)?thumbnailUrl=thumbnailUrl(that.path(),encodeURIComponent(name)):(thumbnailUrl.indexOf("?")>=0&&(urlJoin="&"),thumbnailUrl=thumbnailUrl+urlJoin+"path="+that.path()+encodeURIComponent(name)),img.attr("src",thumbnailUrl),li.loaded=!0},_scroll:function(){var that=this;that.options.transport&&that.options.transport.thumbnailUrl&&(clearTimeout(that._timeout),that._timeout=setTimeout(function(){var height=that.list.outerHeight(),viewTop=that.list.scrollTop(),viewBottom=viewTop+height;that._tiles.each(function(){var top=offsetTop(this),bottom=top+this.offsetHeight;if((top>=viewTop&&top<viewBottom||bottom>=viewTop&&bottom<viewBottom)&&that._loadImage(this),top>viewBottom)return!1}),that._tiles=that._tiles.filter(function(){return!this.loaded})},250))},_editTmpl:function(){var html='<li class="k-tile k-state-selected" '+kendo.attr("uid")+'="#=uid#" ';return html+=kendo.attr("type")+'="${'+TYPEFIELD+'}">',html+="#if("+TYPEFIELD+' == "d") { #',html+='<div class="k-thumb"><span class="k-icon k-folder"></span></div>',html+="#}else{#",html+='<div class="k-thumb"><span class="k-icon k-loading"></span></div>',html+="#}#",html+="#if("+TYPEFIELD+' == "d") { #',html+='<input class="k-input" '+kendo.attr("bind")+'="value:'+NAMEFIELD+'"/>',html+="#}#",html+="</li>",proxy(kendo.template(html),{sizeFormatter:sizeFormatter})},_itemTmpl:function(){var that=this,html='<li class="k-tile" '+kendo.attr("uid")+'="#=uid#" ';return html+=kendo.attr("type")+'="${'+TYPEFIELD+'}">',html+="#if("+TYPEFIELD+' == "d") { #',html+='<div class="k-thumb"><span class="k-icon k-folder"></span></div>',html+="#}else{#",html+=that.options.transport&&that.options.transport.thumbnailUrl?'<div class="k-thumb"><span class="k-icon k-loading"></span></div>':'<div class="k-thumb"><span class="k-icon k-file"></span></div>',html+="#}#",html+="<strong>${"+NAMEFIELD+"}</strong>",html+="#if("+TYPEFIELD+' == "f") { # <span class="k-filesize">${this.sizeFormatter('+SIZEFIELD+")}</span> #}#",html+="</li>",proxy(kendo.template(html),{sizeFormatter:sizeFormatter})},path:function(value){var that=this,path=that._path||"";return value!==undefined?(that._path=value.replace(trimSlashesRegExp,"")+"/",void that.dataSource.read({path:that._path})):(path&&(path=path.replace(trimSlashesRegExp,"")),"/"===path||""===path?"":path+"/")}}),SearchBox=Widget.extend({init:function(element,options){var that=this;options=options||{},Widget.fn.init.call(that,element,options),placeholderSupported&&that.element.attr("placeholder",that.options.label),that._wrapper(),that.element.on("keydown"+SEARCHBOXNS,proxy(that._keydown,that)).on("change"+SEARCHBOXNS,proxy(that._updateValue,that)),that.wrapper.on(CLICK+SEARCHBOXNS,"a",proxy(that._click,that)),placeholderSupported||that.element.on("focus"+SEARCHBOXNS,proxy(that._focus,that)).on("blur"+SEARCHBOXNS,proxy(that._blur,that))},options:{name:"SearchBox",label:"Search",value:""},events:[CHANGE],destroy:function(){var that=this;that.wrapper.add(that.element).add(that.label).off(SEARCHBOXNS),Widget.fn.destroy.call(that)},_keydown:function(e){13===e.keyCode&&this._updateValue()},_click:function(e){e.preventDefault(),this._updateValue()},_updateValue:function(){var that=this,value=that.element.val();value!==that.value()&&(that.value(value),that.trigger(CHANGE))},_blur:function(){this._updateValue(),this._toggleLabel()},_toggleLabel:function(){placeholderSupported||this.label.toggle(!this.element.val())},_focus:function(){this.label.hide()},_wrapper:function(){var element=this.element,wrapper=element.parents(".k-search-wrap");element[0].style.width="",element.addClass("k-input"),wrapper.length||(wrapper=element.wrap($('<div class="k-widget k-search-wrap k-textbox"/>')).parent(),placeholderSupported||$('<label style="display:block">'+this.options.label+"</label>").insertBefore(element),$('<a href="#" class="k-icon k-i-search k-search"/>').appendTo(wrapper)),this.wrapper=wrapper,this.label=wrapper.find(">label")},value:function(value){var that=this;return value!==undefined?(that.options.value=value,that.element.val(value),void that._toggleLabel()):that.options.value}}),Breadcrumbs=Widget.extend({init:function(element,options){var that=this;options=options||{},Widget.fn.init.call(that,element,options),that._wrapper(),that.wrapper.on("focus"+BREADCRUBMSNS,"input",proxy(that._focus,that)).on("blur"+BREADCRUBMSNS,"input",proxy(that._blur,that)).on("keydown"+BREADCRUBMSNS,"input",proxy(that._keydown,that)).on(CLICK+BREADCRUBMSNS,"a.k-i-arrow-n:first",proxy(that._rootClick,that)).on(CLICK+BREADCRUBMSNS,"a:not(.k-i-arrow-n)",proxy(that._click,that)),that.value(that.options.value)},options:{name:"Breadcrumbs",gap:50},events:[CHANGE],destroy:function(){var that=this;Widget.fn.destroy.call(that),that.wrapper.add(that.wrapper.find("input")).add(that.wrapper.find("a")).off(BREADCRUBMSNS)},_update:function(val){val="/"===(val||"").charAt(0)?val:"/"+(val||""),val!==this.value()&&(this.value(val),this.trigger(CHANGE))},_click:function(e){e.preventDefault(),this._update(this._path($(e.target).prevAll("a:not(.k-i-arrow-n)").addBack()))},_rootClick:function(e){e.preventDefault(),this._update("")},_focus:function(){var that=this,element=that.element;that.overlay.hide(),that.element.val(that.value()),setTimeout(function(){element.select()})},_blur:function(){if(!this.overlay.is(":visible")){var that=this,element=that.element,val=element.val().replace(/\/{2,}/g,"/");that.overlay.show(),element.val(""),that._update(val)}},_keydown:function(e){var that=this;13===e.keyCode&&(that._blur(),setTimeout(function(){that.overlay.find("a:first").focus()}))},_wrapper:function(){var overlay,element=this.element,wrapper=element.parents(".k-breadcrumbs");element[0].style.width="",element.addClass("k-input"),wrapper.length||(wrapper=element.wrap($('<div class="k-widget k-breadcrumbs k-textbox"/>')).parent()),overlay=wrapper.find(".k-breadcrumbs-wrap"),overlay.length||(overlay=$('<div class="k-breadcrumbs-wrap"/>').appendTo(wrapper)),this.wrapper=wrapper,this.overlay=overlay},refresh:function(){var segments,segment,idx,length,html="",value=this.value();for(value!==undefined&&value.match(/^\//)||(value="/"+(value||"")),segments=value.split("/"),idx=0,length=segments.length;idx<length;idx++)segment=segments[idx],segment&&(html||(html+='<a href="#" class="k-icon k-i-arrow-n">root</a>'),html+='<a class="k-link" href="#">'+segments[idx]+"</a>",html+='<span class="k-icon k-i-arrow-e">&gt;</span>');this.overlay.empty().append($(html)),this._adjustSectionWidth()},_adjustSectionWidth:function(){var a,that=this,wrapper=that.wrapper,width=wrapper.width()-that.options.gap,links=that.overlay.find("a");links.each(function(index){a=$(this),a.parent().width()>width&&(index==links.length-1?a.width(width):a.prev().addBack().hide())})},value:function(val){return val!==undefined?(this._value=val.replace(/\/{2,}/g,"/"),void this.refresh()):this._value},_path:function(trail){return"/"+$.map(trail,function(b){return $(b).text()}).join("/")}});kendo.ui.plugin(ImageBrowser),kendo.ui.plugin(Breadcrumbs),kendo.ui.plugin(SearchBox)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,Class=kendo.Class,Widget=kendo.ui.Widget,os=kendo.support.mobileOS,browser=kendo.support.browser,extend=$.extend,proxy=$.proxy,deepExtend=kendo.deepExtend,NS=".kendoEditor",keys=kendo.keys,ToolTemplate=Class.extend({init:function(options){this.options=options},getHtml:function(){var options=this.options;return kendo.template(options.template,{useWithBlock:!1})(options)}}),EditorUtils={editorWrapperTemplate:'<table cellspacing="4" cellpadding="0" class="k-widget k-editor k-header" role="presentation"><tbody><tr role="presentation"><td class="k-editor-toolbar-wrap" role="presentation"><ul class="k-editor-toolbar" role="toolbar" /></td></tr><tr><td class="k-editable-area" /></tr></tbody></table>',buttonTemplate:'<a href="" role="button" class="k-tool"#= data.popup ? " data-popup" : "" # unselectable="on" title="#= data.title #"><span class="k-tool-icon #= data.cssClass #">#= data.title #</span></a>',colorPickerTemplate:'<div class="k-colorpicker #= data.cssClass #" />',comboBoxTemplate:'<select title="#= data.title #" class="#= data.cssClass #" />',dropDownListTemplate:'<span class="k-editor-dropdown"><select title="#= data.title #" class="#= data.cssClass #" /></span>',separatorTemplate:'<span class="k-separator" />',formatByName:function(name,format){for(var i=0;i<format.length;i++)if($.inArray(name,format[i].tags)>=0)return format[i]},registerTool:function(toolName,tool){var toolOptions=tool.options;toolOptions&&toolOptions.template&&(toolOptions.template.options.cssClass="k-"+toolName),tool.name||(tool.options.name=toolName,tool.name=toolName.toLowerCase()),Editor.defaultTools[toolName]=tool},registerFormat:function(formatName,format){Editor.fn.options.formats[formatName]=format}},messages={bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",superscript:"Superscript",subscript:"Subscript",justifyCenter:"Center text",justifyLeft:"Align text left",justifyRight:"Align text right",justifyFull:"Justify",insertUnorderedList:"Insert unordered list",insertOrderedList:"Insert ordered list",indent:"Indent",outdent:"Outdent",createLink:"Insert hyperlink",unlink:"Remove hyperlink",insertImage:"Insert image",insertHtml:"Insert HTML",viewHtml:"View HTML",fontName:"Select font family",fontNameInherit:"(inherited font)",fontSize:"Select font size",fontSizeInherit:"(inherited size)",formatBlock:"Format",formatting:"Format",foreColor:"Color",backColor:"Background color",style:"Styles",emptyFolder:"Empty Folder",uploadFile:"Upload",orderBy:"Arrange by:",orderBySize:"Size",orderByName:"Name",invalidFileType:'The selected file "{0}" is not valid. Supported file types are {1}.',deleteFile:'Are you sure you want to delete "{0}"?',overwriteFile:'A file with name "{0}" already exists in the current directory. Do you want to overwrite it?',directoryNotFound:"A directory with this name was not found.",imageWebAddress:"Web address",imageAltText:"Alternate text",imageWidth:"Width (px)",imageHeight:"Height (px)",linkWebAddress:"Web address",linkText:"Text",linkToolTip:"ToolTip",linkOpenInNewWindow:"Open link in new window",dialogUpdate:"Update",dialogInsert:"Insert",dialogButtonSeparator:"or",dialogCancel:"Cancel",createTable:"Create table",addColumnLeft:"Add column on the left",addColumnRight:"Add column on the right",
addRowAbove:"Add row above",addRowBelow:"Add row below",deleteRow:"Delete row",deleteColumn:"Delete column"},supportedBrowser=!os||os.ios&&os.flatVersion>=500||!os.ios&&"undefined"!=typeof document.documentElement.contentEditable,toolGroups={basic:["bold","italic","underline"],alignment:["justifyLeft","justifyCenter","justifyRight"],lists:["insertUnorderedList","insertOrderedList"],indenting:["indent","outdent"],links:["createLink","unlink"],tables:["createTable","addColumnLeft","addColumnRight","addRowAbove","addRowBelow","deleteRow","deleteColumn"]},Editor=Widget.extend({init:function(element,options){var value,toolbarContainer,toolbarOptions,type,that=this,editorNS=kendo.ui.editor;supportedBrowser&&(Widget.fn.init.call(that,element,options),that.options=deepExtend({},that.options,options),element=that.element,type=editorNS.Dom.name(element[0]),element.closest("form").on("submit"+NS,function(){that.update()}),toolbarOptions=extend({},that.options),toolbarOptions.editor=that,"textarea"==type?(that._wrapTextarea(),toolbarContainer=that.wrapper.find(".k-editor-toolbar"),element[0].id&&toolbarContainer.attr("aria-controls",element[0].id)):(that.element.attr("contenteditable",!0).addClass("k-widget k-editor k-editor-inline"),toolbarOptions.popup=!0,toolbarContainer=$('<ul class="k-editor-toolbar" role="toolbar" />').insertBefore(element)),that.toolbar=new editorNS.Toolbar(toolbarContainer[0],toolbarOptions),that.toolbar.bindTo(that),that._initializeContentElement(that),that.keyboard=new editorNS.Keyboard([new editorNS.TypingHandler(that),new editorNS.SystemHandler(that)]),that.clipboard=new editorNS.Clipboard(this),that.undoRedoStack=new editorNS.UndoRedoStack,value=options&&options.value?options.value:that.textarea?element.val().replace(/[\r\n\v\f\t ]+/gi," "):element[0].innerHTML,that.value(value),$(document).on("mousedown",proxy(that._endTyping,that)).on("mouseup",proxy(that._mouseup,that)),kendo.notify(that))},_endTyping:function(){var keyboard=this.keyboard;try{keyboard.isTypingInProgress()&&(keyboard.endTyping(!0),this.saveSelection())}catch(e){}},_selectionChange:function(){browser.msie||kendo.ui.editor.Dom.ensureTrailingBreaks(this.body),this._selectionStarted=!1,this.saveSelection(),this.trigger("select",{})},_wrapTextarea:function(){var that=this,textarea=that.element,w=textarea[0].style.width,h=textarea[0].style.height,template=EditorUtils.editorWrapperTemplate,editorWrap=$(template).insertBefore(textarea).width(w).height(h),editArea=editorWrap.find(".k-editable-area");textarea.attr("autocomplete","off").appendTo(editArea).addClass("k-content k-raw-content").css("display","none"),that.textarea=textarea,that.wrapper=editorWrap},_createContentElement:function(stylesheets){var iframe,wnd,doc,editor=this,textarea=editor.textarea,specifiedDomain=editor.options.domain,domain=specifiedDomain||document.domain,domainScript="",src='javascript:""';return(specifiedDomain||domain!=location.hostname)&&(domainScript='<script>document.domain="'+domain+'"</script>',src="javascript:document.write('"+domainScript+"')"),textarea.hide(),iframe=$("<iframe />",{frameBorder:"0"})[0],$(iframe).css("display","").addClass("k-content").insertBefore(textarea),iframe.src=src,wnd=iframe.contentWindow||iframe,doc=wnd.document||iframe.contentDocument,$(iframe).one("load",function(){editor.toolbar.decorateFrom(doc.body)}),doc.open(),doc.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0;margin:0;height:100%;min-height:100%;}body{font-size:12px;font-family:Verdana,Geneva,sans-serif;padding-top:1px;margin-top:-1px;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;"+(kendo.support.isRtl(textarea)?"direction:rtl;":"")+"}h1{font-size:2em;margin:.67em 0}h2{font-size:1.5em}h3{font-size:1.16em}h4{font-size:1em}h5{font-size:.83em}h6{font-size:.7em}p{margin:0 0 1em;padding:0 .2em}.k-marker{display:none;}.k-paste-container,.Apple-style-span{position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden}ul,ol{padding-left:2.5em}span{-ms-high-contrast-adjust:none;}a{color:#00a}code{font-size:1.23em}telerik\\3Ascript{display: none;}.k-table{table-layout:fixed;width:100%;border-spacing:0;margin: 0 0 1em;}.k-table td{min-width:1px;padding:.2em .3em;}.k-table,.k-table td{outline:0;border: 1px dotted #ccc;}.k-table p{margin:0;padding:0;}</style>"+domainScript+"<script>(function(d,c){d[c]('header'),d[c]('article'),d[c]('nav'),d[c]('section'),d[c]('footer');})(document, 'createElement');</script>"+$.map(stylesheets,function(href){return"<link rel='stylesheet' href='"+href+"'>"}).join("")+"</head><body autocorrect='off' contenteditable='true'></body></html>"),doc.close(),wnd},_blur:function(){var textarea=this.textarea,old=textarea?textarea.val():this._oldValue,value=this.options.encoded?this.encodedValue():this.value();this.update(),textarea&&textarea.trigger("blur"),value!=old&&this.trigger("change")},_initializeContentElement:function(){var doc,blurTrigger,editor=this;editor.textarea?(editor.window=editor._createContentElement(editor.options.stylesheets),doc=editor.document=editor.window.contentDocument||editor.window.document,editor.body=doc.body,blurTrigger=editor.window,$(doc).on("mouseup"+NS,proxy(editor._mouseup,editor))):(editor.window=window,doc=editor.document=document,editor.body=editor.element[0],blurTrigger=editor.body,editor.toolbar.decorateFrom(editor.body)),$(blurTrigger).on("blur"+NS,proxy(this._blur,this));try{doc.execCommand("enableInlineTableEditing",null,!1)}catch(e){}kendo.support.touch&&$(doc).on("selectionchange"+NS,proxy(this._selectionChange,this)).on("keydown"+NS,function(){kendo._activeElement()!=doc.body&&editor.window.focus()}),$(editor.body).on("keydown"+NS,function(e){var range;if(e.keyCode===keys.F10)return setTimeout(proxy(editor.toolbar.focus,editor.toolbar),100),void e.preventDefault();if(e.keyCode===keys.BACKSPACE){range=editor.getRange();var ancestor,emptyParagraphContent=browser.msie?"":'<br _moz_dirty="" />',dom=kendo.ui.editor.Dom;range.deleteContents(),ancestor=range.commonAncestorContainer,"p"===dom.name(ancestor)&&""===ancestor.innerHTML&&(ancestor.innerHTML=emptyParagraphContent,range.setStart(ancestor,0),range.collapse(!0),editor.selectRange(range))}else if(e.keyCode==keys.LEFT||e.keyCode==keys.RIGHT){range=editor.getRange();var left=e.keyCode==keys.LEFT,container=range[left?"startContainer":"endContainer"],offset=range[left?"startOffset":"endOffset"],direction=left?-1:1;left&&(offset-=1),offset+direction>0&&3==container.nodeType&&"\ufeff"==container.nodeValue[offset]&&(range.setStart(container,offset+direction),range.collapse(!0),editor.selectRange(range))}var toolName=editor.keyboard.toolFromShortcut(editor.toolbar.tools,e);return toolName?(e.preventDefault(),/^(undo|redo)$/.test(toolName)||editor.keyboard.endTyping(!0),editor.trigger("keydown",e),editor.exec(toolName),!1):(editor.keyboard.clearTimeout(),void editor.keyboard.keydown(e))}).on("keyup"+NS,function(e){var selectionCodes=[8,9,33,34,35,36,37,38,39,40,40,45,46];($.inArray(e.keyCode,selectionCodes)>-1||65==e.keyCode&&e.ctrlKey&&!e.altKey&&!e.shiftKey)&&editor._selectionChange(),editor.keyboard.keyup(e)}).on("mousedown"+NS,function(e){editor._selectionStarted=!0;var target=$(e.target);!browser.gecko&&2==e.which&&target.is("a[href]")&&window.open(target.attr("href"),"_new")}).on("click"+NS,function(e){var range,dom=kendo.ui.editor.Dom;"img"===dom.name(e.target)&&(range=editor.createRange(),range.selectNode(e.target),editor.selectRange(range))}).on("cut"+NS+" paste"+NS,function(e){editor.clipboard["on"+e.type](e)}).on("focusin"+NS,function(){$(this).addClass("k-state-active"),editor.toolbar.show()}).on("focusout"+NS,function(){setTimeout(function(){var active=kendo._activeElement(),body=editor.body,toolbar=editor.toolbar;active==body||$.contains(body,active)||$(active).is(".k-editortoolbar-dragHandle")||toolbar.focused()||($(body).removeClass("k-state-active"),toolbar.hide())},10)})},_mouseup:function(){var that=this;that._selectionStarted&&setTimeout(function(){that._selectionChange()},1)},refresh:function(){var that=this;that.textarea&&(that.textarea.val(that.value()),that.wrapper.find("iframe").remove(),that._initializeContentElement(that),that.value(that.textarea.val()))},events:["select","change","execute","error","paste","keydown","keyup"],options:{name:"Editor",messages:messages,formats:{},encoded:!0,domain:null,serialization:{entities:!0},stylesheets:[],dialogOptions:{modal:!0,resizable:!1,draggable:!0,animation:!1},fontName:[{text:"Arial",value:"Arial,Helvetica,sans-serif"},{text:"Courier New",value:"'Courier New',Courier,monospace"},{text:"Georgia",value:"Georgia,serif"},{text:"Impact",value:"Impact,Charcoal,sans-serif"},{text:"Lucida Console",value:"'Lucida Console',Monaco,monospace"},{text:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{text:"Times New Roman",value:"'Times New Roman',Times,serif"},{text:"Trebuchet MS",value:"'Trebuchet MS',Helvetica,sans-serif"},{text:"Verdana",value:"Verdana,Geneva,sans-serif"}],fontSize:[{text:"1 (8pt)",value:"xx-small"},{text:"2 (10pt)",value:"x-small"},{text:"3 (12pt)",value:"small"},{text:"4 (14pt)",value:"medium"},{text:"5 (18pt)",value:"large"},{text:"6 (24pt)",value:"x-large"},{text:"7 (36pt)",value:"xx-large"}],formatBlock:[{text:"Paragraph",value:"p"},{text:"Quotation",value:"blockquote"},{text:"Heading 1",value:"h1"},{text:"Heading 2",value:"h2"},{text:"Heading 3",value:"h3"},{text:"Heading 4",value:"h4"},{text:"Heading 5",value:"h5"},{text:"Heading 6",value:"h6"}],tools:[].concat.call(["formatting"],toolGroups.basic,toolGroups.alignment,toolGroups.lists,toolGroups.indenting,toolGroups.links,["insertImage"],toolGroups.tables)},destroy:function(){var that=this;Widget.fn.destroy.call(that),$(that.window).add(that.document).add(that.body).add(that.wrapper).add(that.element.closest("form")).off(NS),$(document).off("mousedown",proxy(that._endTyping,that)).off("mouseup",proxy(that._mouseup,that)),that.toolbar.destroy(),kendo.destroy(that.wrapper)},state:function(toolName){var range,textNodes,tool=Editor.defaultTools[toolName],finder=tool&&(tool.options.finder||tool.finder),RangeUtils=kendo.ui.editor.RangeUtils;return!!finder&&(range=this.getRange(),textNodes=RangeUtils.textNodes(range),!textNodes.length&&range.collapsed&&(textNodes=[range.startContainer]),finder.getFormat?finder.getFormat(textNodes):finder.isFormatted(textNodes))},value:function(html){var body=this.body,editorNS=kendo.ui.editor,currentHtml=(editorNS.Dom,editorNS.Serializer.domToXhtml(body,this.options.serialization));return html===undefined?currentHtml:void(html!=currentHtml&&(editorNS.Serializer.htmlToDom(html,body),this.selectionRestorePoint=null,this.update()))},saveSelection:function(range){range=range||this.getRange();var container=range.commonAncestorContainer,body=this.body;(container==body||$.contains(body,container))&&(this.selectionRestorePoint=new kendo.ui.editor.RestorePoint(range))},_focusBody:function(){var body=this.body,documentElement=this.document.documentElement;if(kendo._activeElement()!=body){var scrollTop=documentElement.scrollTop;body.focus(),documentElement.scrollTop=scrollTop}},restoreSelection:function(){this._focusBody(),this.selectionRestorePoint&&this.selectRange(this.selectionRestorePoint.toRange())},focus:function(){this.restoreSelection()},update:function(value){value=value||this.options.encoded?this.encodedValue():this.value(),this.textarea?this.textarea.val(value):this._oldValue=value},encodedValue:function(){return kendo.ui.editor.Dom.encode(this.value())},createRange:function(document){return kendo.ui.editor.RangeUtils.createRange(document||this.document)},getSelection:function(){return kendo.ui.editor.SelectionUtils.selectionFromDocument(this.document)},selectRange:function(range){this._focusBody();var selection=this.getSelection();selection.removeAllRanges(),selection.addRange(range),this.saveSelection(range)},getRange:function(){var selection=this.getSelection(),range=selection.rangeCount>0?selection.getRangeAt(0):this.createRange(),doc=this.document;return range.startContainer!=doc||range.endContainer!=doc||range.startOffset||range.endOffset||(range.setStart(this.body,0),range.collapse(!0)),range},selectedHtml:function(){return kendo.ui.editor.Serializer.domToXhtml(this.getRange().cloneContents())},paste:function(html,options){this.clipboard.paste(html,options)},exec:function(name,params){var range,tool,that=this,command=null;if(!name)throw new Error("kendoEditor.exec(): `name` parameter cannot be empty");if(name=name.toLowerCase(),that.keyboard.isTypingInProgress()||that.restoreSelection(),tool=that.toolbar.toolById(name),!tool)for(var id in Editor.defaultTools)if(id.toLowerCase()==name){tool=Editor.defaultTools[id];break}if(tool){if(range=that.getRange(),tool.command&&(command=tool.command(extend({range:range},params))),that.trigger("execute",{name:name,command:command}),/^(undo|redo)$/i.test(name))that.undoRedoStack[name]();else if(command&&(command.managesUndoRedo||that.undoRedoStack.push(command),command.editor=that,command.exec(),command.async))return void(command.change=proxy(that._selectionChange,that));that._selectionChange()}}});Editor.defaultTools={undo:{options:{key:"Z",ctrl:!0}},redo:{options:{key:"Y",ctrl:!0}}},kendo.ui.plugin(Editor);var Tool=Class.extend({init:function(options){this.options=options},initialize:function(ui,options){ui.attr({unselectable:"on",title:options.title})},command:function(commandArguments){return new this.options.command(commandArguments)},update:$.noop});Tool.exec=function(editor,name,value){editor.exec(name,{value:value})};var FormatTool=Tool.extend({init:function(options){Tool.fn.init.call(this,options)},command:function(commandArguments){var that=this;return new kendo.ui.editor.FormatCommand(extend(commandArguments,{formatter:that.options.formatter}))},update:function(ui,nodes){var isFormatted=this.options.finder.isFormatted(nodes);ui.toggleClass("k-state-selected",isFormatted),ui.attr("aria-pressed",isFormatted)}});EditorUtils.registerTool("separator",new Tool({template:new ToolTemplate({template:EditorUtils.separatorTemplate})}));var bomFill=browser.msie&&browser.version<9?"\ufeff":"";extend(kendo.ui,{editor:{ToolTemplate:ToolTemplate,EditorUtils:EditorUtils,Tool:Tool,FormatTool:FormatTool,_bomFill:bomFill,emptyElementContent:browser.msie?"\ufeff":'<br _moz_dirty="" />'}})}(window.jQuery),function($){function makeMap(items){var i,len,obj={};for(i=0,len=items.length;i<len;i++)obj[items[i]]=!0;return obj}var kendo=window.kendo,map=$.map,extend=$.extend,browser=kendo.support.browser,STYLE="style",FLOAT="float",CSSFLOAT="cssFloat",STYLEFLOAT="styleFloat",CLASS="class",KMARKER="k-marker",empty=makeMap("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed".split(",")),nonListBlockElements="div,p,h1,h2,h3,h4,h5,h6,address,applet,blockquote,button,center,dd,dir,dl,dt,fieldset,form,frameset,hr,iframe,isindex,map,menu,noframes,noscript,object,pre,script,table,tbody,td,tfoot,th,thead,tr,header,article,nav,footer,section,aside,main,figure,figcaption".split(","),blockElements=nonListBlockElements.concat(["ul","ol","li"]),block=makeMap(blockElements),inlineElements="span,em,a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,strike,strong,sub,sup,textarea,tt,u,var,data,time,mark,ruby".split(","),inline=makeMap(inlineElements),fillAttrs=makeMap("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected".split(",")),normalize=function(node){1==node.nodeType&&node.normalize()};browser.msie&&browser.version>=8&&(normalize=function(parent){if(1==parent.nodeType&&parent.firstChild)for(var prev=parent.firstChild,node=prev;;){if(node=node.nextSibling,!node)break;3==node.nodeType&&3==prev.nodeType&&(node.nodeValue=prev.nodeValue+node.nodeValue,Dom.remove(prev)),prev=node}});var persistedScrollTop,whitespace=/^\s+$/,rgb=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i,bom=/\ufeff/g,whitespaceOrBom=/^(\s+|\ufeff)$/,cssAttributes="color,padding-left,padding-right,padding-top,padding-bottom,background-color,background-attachment,background-image,background-position,background-repeat,border-top-style,border-top-width,border-top-color,border-bottom-style,border-bottom-width,border-bottom-color,border-left-style,border-left-width,border-left-color,border-right-style,border-right-width,border-right-color,font-family,font-size,font-style,font-variant,font-weight,line-height".split(","),htmlRe=/[<>\&]/g,entityRe=/[\u00A0-\u2666<>\&]/g,entityTable={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"},Dom={block:block,inline:inline,findNodeIndex:function(node,skipText){var i=0;if(!node)return-1;for(;;){if(node=node.previousSibling,!node)break;skipText&&3==node.nodeType||i++}return i},isDataNode:function(node){return node&&null!==node.nodeValue&&null!==node.data},isAncestorOf:function(parent,node){try{return!Dom.isDataNode(parent)&&($.contains(parent,Dom.isDataNode(node)?node.parentNode:node)||node.parentNode==parent)}catch(e){return!1}},isAncestorOrSelf:function(root,node){return Dom.isAncestorOf(root,node)||root==node},findClosestAncestor:function(root,node){if(Dom.isAncestorOf(root,node))for(;node&&node.parentNode!=root;)node=node.parentNode;return node},getNodeLength:function(node){return Dom.isDataNode(node)?node.length:node.childNodes.length},splitDataNode:function(node,offset){for(var newNode=node.cloneNode(!1),denormalizedText="",iterator=node;iterator.nextSibling&&3==iterator.nextSibling.nodeType&&iterator.nextSibling.nodeValue;)denormalizedText+=iterator.nextSibling.nodeValue,iterator=iterator.nextSibling;node.deleteData(offset,node.length),newNode.deleteData(0,offset),newNode.nodeValue+=denormalizedText,Dom.insertAfter(newNode,node)},attrEquals:function(node,attributes){for(var key in attributes){var value=node[key];if(key==FLOAT&&(value=node[kendo.support.cssFloat?CSSFLOAT:STYLEFLOAT]),"object"==typeof value){if(!Dom.attrEquals(value,attributes[key]))return!1}else if(value!=attributes[key])return!1}return!0},blockParentOrBody:function(node){return Dom.parentOfType(node,blockElements)||node.ownerDocument.body},blockParents:function(nodes){var i,len,blocks=[];for(i=0,len=nodes.length;i<len;i++){var block=Dom.parentOfType(nodes[i],Dom.blockElements);block&&$.inArray(block,blocks)<0&&blocks.push(block)}return blocks},windowFromDocument:function(document){return document.defaultView||document.parentWindow},normalize:normalize,blockElements:blockElements,nonListBlockElements:nonListBlockElements,inlineElements:inlineElements,empty:empty,fillAttrs:fillAttrs,toHex:function(color){var matches=rgb.exec(color);return matches?"#"+map(matches.slice(1),function(x){return x=parseInt(x,10).toString(16),x.length>1?x:"0"+x}).join(""):color},encode:function(value,options){var encodableChars=!options||options.entities?entityRe:htmlRe;return value.replace(encodableChars,function(c){var charCode=c.charCodeAt(0),entity=entityTable[charCode];return entity?"&"+entity+";":c})},stripBom:function(text){return(text||"").replace(bom,"")},insignificant:function(node){var attr=node.attributes;return"k-marker"==node.className||Dom.is(node,"br")&&(attr._moz_dirty||attr._moz_editor_bogus_node)},emptyNode:function(node){var significantNodes=$.grep(node.childNodes,function(child){return!Dom.is(child,"br")&&(!Dom.insignificant(child)&&((3!=child.nodeType||!whitespaceOrBom.test(child.nodeValue))&&(!Dom.is(child,"p")||!Dom.emptyNode(child))))});return!significantNodes.length},name:function(node){return node.nodeName.toLowerCase()},significantChildNodes:function(node){return $.grep(node.childNodes,function(child){return 3!=child.nodeType||!Dom.isWhitespace(child)})},lastTextNode:function(node){var result=null;if(3==node.nodeType)return node;for(var child=node.lastChild;child;child=child.previousSibling)if(result=Dom.lastTextNode(child))return result;return result},is:function(node,nodeName){return Dom.name(node)==nodeName},isMarker:function(node){return node.className==KMARKER},isWhitespace:function(node){return whitespace.test(node.nodeValue)},isBlock:function(node){return block[Dom.name(node)]},isEmpty:function(node){return empty[Dom.name(node)]},isInline:function(node){return inline[Dom.name(node)]},scrollContainer:function(doc){var wnd=Dom.windowFromDocument(doc),scrollContainer=(wnd.contentWindow||wnd).document||wnd.ownerDocument||wnd;return scrollContainer=kendo.support.browser.webkit||"BackCompat"==scrollContainer.compatMode?scrollContainer.body:scrollContainer.documentElement},scrollTo:function(node){var elementTop,elementHeight,element=$(Dom.isDataNode(node)?node.parentNode:node),wnd=Dom.windowFromDocument(node.ownerDocument),windowHeight=wnd.innerHeight,scrollContainer=Dom.scrollContainer(node.ownerDocument);"br"==Dom.name(element[0])&&(element=element.parent()),elementTop=element.offset().top,elementHeight=element[0].offsetHeight,elementHeight+elementTop>scrollContainer.scrollTop+windowHeight&&(scrollContainer.scrollTop=elementHeight+elementTop-windowHeight)},persistScrollTop:function(doc){persistedScrollTop=Dom.scrollContainer(doc).scrollTop},restoreScrollTop:function(doc){Dom.scrollContainer(doc).scrollTop=persistedScrollTop},insertAt:function(parent,newElement,position){parent.insertBefore(newElement,parent.childNodes[position]||null)},insertBefore:function(newElement,referenceElement){return referenceElement.parentNode?referenceElement.parentNode.insertBefore(newElement,referenceElement):referenceElement},insertAfter:function(newElement,referenceElement){return referenceElement.parentNode.insertBefore(newElement,referenceElement.nextSibling)},remove:function(node){node.parentNode.removeChild(node)},removeTextSiblings:function(node){for(var parentNode=node.parentNode;node.nextSibling&&3==node.nextSibling.nodeType;)parentNode.removeChild(node.nextSibling);for(;node.previousSibling&&3==node.previousSibling.nodeType;)parentNode.removeChild(node.previousSibling)},trim:function(parent){for(var i=parent.childNodes.length-1;i>=0;i--){var node=parent.childNodes[i];Dom.isDataNode(node)?(Dom.stripBom(node.nodeValue).length||Dom.remove(node),Dom.isWhitespace(node)&&Dom.insertBefore(node,parent)):node.className!=KMARKER&&(Dom.trim(node),node.childNodes.length||Dom.isEmpty(node)||Dom.remove(node))}return parent},closest:function(node,tag){for(;node&&Dom.name(node)!=tag;)node=node.parentNode;return node},sibling:function(node,direction){do node=node[direction];while(node&&1!=node.nodeType);return node},next:function(node){return Dom.sibling(node,"nextSibling")},prev:function(node){return Dom.sibling(node,"previousSibling")},parentOfType:function(node,tags){do node=node.parentNode;while(node&&!Dom.ofType(node,tags));return node},ofType:function(node,tags){return $.inArray(Dom.name(node),tags)>=0},changeTag:function(referenceElement,tagName){var i,len,name,value,attribute,newElement=Dom.create(referenceElement.ownerDocument,tagName),attributes=referenceElement.attributes;for(i=0,len=attributes.length;i<len;i++)attribute=attributes[i],attribute.specified&&(name=attribute.nodeName,value=attribute.nodeValue,name==CLASS?newElement.className=value:name==STYLE?newElement.style.cssText=referenceElement.style.cssText:newElement.setAttribute(name,value));for(;referenceElement.firstChild;)newElement.appendChild(referenceElement.firstChild);return Dom.insertBefore(newElement,referenceElement),Dom.remove(referenceElement),newElement},editableParent:function(node){for(;3==node.nodeType||"true"!==node.contentEditable;)node=node.parentNode;return node},wrap:function(node,wrapper){return Dom.insertBefore(wrapper,node),wrapper.appendChild(node),wrapper},unwrap:function(node){for(var parent=node.parentNode;node.firstChild;)parent.insertBefore(node.firstChild,node);parent.removeChild(node)},create:function(document,tagName,attributes){return Dom.attr(document.createElement(tagName),attributes)},attr:function(element,attributes){attributes=extend({},attributes),attributes&&STYLE in attributes&&(Dom.style(element,attributes.style),delete attributes.style);for(var attr in attributes)null===attributes[attr]?(element.removeAttribute(attr),delete attributes[attr]):"className"==attr&&(element[attr]=attributes[attr]);return extend(element,attributes)},style:function(node,value){$(node).css(value||{})},unstyle:function(node,value){for(var key in value)key==FLOAT&&(key=kendo.support.cssFloat?CSSFLOAT:STYLEFLOAT),node.style[key]="";""===node.style.cssText&&node.removeAttribute(STYLE)},inlineStyle:function(body,name,attributes){var style,span=$(Dom.create(body.ownerDocument,name,attributes));return body.appendChild(span[0]),style=map(cssAttributes,function(value){return browser.msie&&"line-height"==value&&"1px"==span.css(value)?"line-height:1.5":value+":"+span.css(value)}).join(";"),span.remove(),style},getEffectiveBackground:function(element){var backgroundStyle=element.css("background-color");return backgroundStyle.indexOf("rgba(0, 0, 0, 0")<0&&"transparent"!==backgroundStyle?backgroundStyle:"html"===element[0].tagName.toLowerCase()?"Window":Dom.getEffectiveBackground(element.parent())},removeClass:function(node,classNames){var i,len,className=" "+node.className+" ",classes=classNames.split(" ");for(i=0,len=classes.length;i<len;i++)className=className.replace(" "+classes[i]+" "," ");className=$.trim(className),className.length?node.className=className:node.removeAttribute(CLASS)},commonAncestor:function(){var i,ancestors,node,first,j,count=arguments.length,paths=[],minPathLength=1/0,output=null;if(!count)return null;if(1==count)return arguments[0];for(i=0;i<count;i++){for(ancestors=[],node=arguments[i];node;)ancestors.push(node),node=node.parentNode;paths.push(ancestors.reverse()),minPathLength=Math.min(minPathLength,ancestors.length)}if(1==count)return paths[0][0];for(i=0;i<minPathLength;i++){for(first=paths[0][i],j=1;j<count;j++)if(first!=paths[j][i])return output;output=first}return output},closestSplittableParent:function(nodes){var result;result=1==nodes.length?Dom.parentOfType(nodes[0],["ul","ol"]):Dom.commonAncestor.apply(null,nodes),result||(result=Dom.parentOfType(nodes[0],["p","td"])||nodes[0].ownerDocument.body),Dom.isInline(result)&&(result=Dom.blockParentOrBody(result));var editableParents=map(nodes,Dom.editableParent),editableAncestor=Dom.commonAncestor(editableParents)[0];return $.contains(result,editableAncestor)&&(result=editableAncestor),result},closestEditable:function(node,types){var closest=Dom.parentOfType(node,types),editable=Dom.editableParent(node);return closest&&editable&&$.contains(closest,editable)?closest=editable:!closest&&editable&&(closest=editable),closest},closestEditableOfType:function(node,types){var editable=Dom.closestEditable(node,types);if(editable&&Dom.ofType(editable,types))return editable},filter:function(tagName,nodes,invert){for(var name,i=0,len=nodes.length,result=[];i<len;i++)name=Dom.name(nodes[i]),(!invert&&name==tagName||invert&&name!=tagName)&&result.push(nodes[i]);return result},ensureTrailingBreaks:function(node){var elements=$(node).find("p,td,th"),length=elements.length,i=0;if(length)for(;i<length;i++)Dom.ensureTrailingBreak(elements[i]);else Dom.ensureTrailingBreak(node)},ensureTrailingBreak:function(node){var br,name=node.lastChild&&Dom.name(node.lastChild);(!name||"br"!=name&&"img"!=name)&&(br=node.ownerDocument.createElement("br"),br.setAttribute("_moz_dirty",!0),node.appendChild(br))}};kendo.ui.editor.Dom=Dom}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,Editor=kendo.ui.editor,dom=Editor.Dom,extend=$.extend,fontSizeMappings="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),quoteRe=/"/g,brRe=/<br[^>]*>/i,pixelRe=/^\d+(\.\d*)?(px)?$/i,emptyPRe=/<p><\/p>/i,cssDeclaration=/([\w|\-]+)\s*:\s*([^;]+);?/i,sizzleAttr=/^sizzle-\d+/i,onerrorRe=/\s*onerror\s*=\s*(?:'|")?([^'">\s]*)(?:'|")?/i,div=document.createElement("div");div.innerHTML=" <hr>";var supportsLeadingWhitespace=3===div.firstChild.nodeType;div=null;var Serializer={toEditableHtml:function(html){var br='<br _moz_dirty="">';return html=html||"",html.replace(/<!\[CDATA\[(.*)?\]\]>/g,"<!--[CDATA[$1]]-->").replace(/<script([^>]*)>(.*)?<\/script>/gi,"<telerik:script$1>$2</telerik:script>").replace(/<img([^>]*)>/gi,function(match){return match.replace(onerrorRe,"")}).replace(/(<\/?img[^>]*>)[\r\n\v\f\t ]+/gi,"$1").replace(/^<(table|blockquote)/i,br+"<$1").replace(/<\/(table|blockquote)>$/i,"</$1>"+br)},_fillEmptyElements:function(body){$(body).find("p").each(function(){var p=$(this);if(/^\s*$/g.test(p.text())&&!p.find("img,input").length){for(var node=this;node.firstChild&&3!=node.firstChild.nodeType;)node=node.firstChild;1!=node.nodeType||dom.empty[dom.name(node)]||(node.innerHTML=kendo.ui.editor.emptyElementContent)}})},_removeSystemElements:function(body){$(".k-paste-container",body).remove()},_resetOrderedLists:function(root){var i,ol,originalStart,ols=root.getElementsByTagName("ol");for(i=0;i<ols.length;i++)ol=ols[i],originalStart=ol.getAttribute("start"),
ol.setAttribute("start",1),originalStart?ol.setAttribute("start",originalStart):ol.removeAttribute(originalStart)},htmlToDom:function(html,root){var browser=kendo.support.browser,msie=browser.msie,legacyIE=msie&&browser.version<9;if(html=Serializer.toEditableHtml(html),legacyIE){html="<br/>"+html;var originalSrc="originalsrc",originalHref="originalhref";html=html.replace(/href\s*=\s*(?:'|")?([^'">\s]*)(?:'|")?/,originalHref+'="$1"'),html=html.replace(/src\s*=\s*(?:'|")?([^'">\s]*)(?:'|")?/,originalSrc+'="$1"')}return root.innerHTML=html,legacyIE?(dom.remove(root.firstChild),$(root).find("telerik\\:script,script,link,img,a").each(function(){var node=this;node[originalHref]&&(node.setAttribute("href",node[originalHref]),node.removeAttribute(originalHref)),node[originalSrc]&&(node.setAttribute("src",node[originalSrc]),node.removeAttribute(originalSrc))})):msie&&(dom.normalize(root),Serializer._resetOrderedLists(root)),Serializer._fillEmptyElements(root),Serializer._removeSystemElements(root),$("table",root).addClass("k-table"),root},domToXhtml:function(root,options){function styleAttr(cssText){var i,match,property,value,trim=$.trim,css=trim(cssText).split(";"),length=css.length;for(i=0,length=css.length;i<length;i++)css[i].length&&(match=cssDeclaration.exec(css[i]),match&&(property=trim(match[1].toLowerCase()),value=trim(match[2]),"font-size-adjust"!=property&&"font-stretch"!=property&&(property.indexOf("color")>=0?value=dom.toHex(value):property.indexOf("font")>=0?value=value.replace(quoteRe,"'"):/\burl\(/g.test(value)&&(value=value.replace(quoteRe,"")),result.push(property),result.push(":"),result.push(value),result.push(";"))))}function attr(node){var attribute,i,l,name,value,specified,specifiedAttributes=[],attributes=node.attributes;if(dom.is(node,"img")){var width=node.style.width,height=node.style.height,$node=$(node);width&&pixelRe.test(width)&&($node.attr("width",parseInt(width,10)),dom.unstyle(node,{width:undefined})),height&&pixelRe.test(height)&&($node.attr("height",parseInt(height,10)),dom.unstyle(node,{height:undefined}))}for(i=0,l=attributes.length;i<l;i++)attribute=attributes[i],name=attribute.nodeName,value=attribute.nodeValue,specified=attribute.specified,"value"==name&&"value"in node&&node.value?specified=!0:"type"==name&&"text"==value?specified=!0:"class"!=name||value?sizzleAttr.test(name)?specified=!1:"complete"==name?specified=!1:"altHtml"==name?specified=!1:"start"==name&&(dom.is(node,"ul")||dom.is(node,"ol"))?specified=!1:name.indexOf("_moz")>=0&&(specified=!1):specified=!1,specified&&specifiedAttributes.push(attribute);if(specifiedAttributes.length)for(specifiedAttributes.sort(function(a,b){return a.nodeName>b.nodeName?1:a.nodeName<b.nodeName?-1:0}),i=0,l=specifiedAttributes.length;i<l;i++)attribute=specifiedAttributes[i],name=attribute.nodeName,value=attribute.nodeValue,"class"==name&&"k-table"==value||(result.push(" "),result.push(name),result.push('="'),"style"==name?styleAttr(value||node.style.cssText):"src"==name||"href"==name?result.push(node.getAttribute(name,2)):result.push(dom.fillAttrs[name]?name:value),result.push('"'))}function children(node,skip,skipEncoding){for(var childNode=node.firstChild;childNode;childNode=childNode.nextSibling)child(childNode,skip,skipEncoding)}function text(node){return node.nodeValue.replace(/\ufeff/g,"")}function child(node,skip,skipEncoding){var tagName,mapper,parent,value,previous,nodeType=node.nodeType;if(1==nodeType){if(tagName=dom.name(node),!tagName||dom.insignificant(node))return;if(dom.isInline(node)&&1==node.childNodes.length&&3==node.firstChild.nodeType&&!text(node.firstChild))return;if(mapper=tagMap[tagName])return mapper.start(node),children(node,!1,mapper.skipEncoding),void mapper.end(node);result.push("<"),result.push(tagName),attr(node),dom.empty[tagName]?result.push(" />"):(result.push(">"),children(node,skip||dom.is(node,"pre")),result.push("</"),result.push(tagName),result.push(">"))}else 3==nodeType?(value=text(node),!skip&&supportsLeadingWhitespace&&(parent=node.parentNode,previous=node.previousSibling,previous||(previous=(dom.isInline(parent)?parent:node).previousSibling),previous&&""!==previous.innerHTML&&!dom.isBlock(previous)||(value=value.replace(/^[\r\n\v\f\t ]+/,"")),value=value.replace(/ +/," ")),result.push(skipEncoding?value:dom.encode(value,options))):4==nodeType?(result.push("<![CDATA["),result.push(node.data),result.push("]]>")):8==nodeType&&(node.data.indexOf("[CDATA[")<0?(result.push("<!--"),result.push(node.data),result.push("-->")):(result.push("<!"),result.push(node.data),result.push(">")))}var result=[],tagMap={"telerik:script":{start:function(node){result.push("<script"),attr(node),result.push(">")},end:function(){result.push("</script>")},skipEncoding:!0},b:{start:function(){result.push("<strong>")},end:function(){result.push("</strong>")}},i:{start:function(){result.push("<em>")},end:function(){result.push("</em>")}},u:{start:function(){result.push('<span style="text-decoration:underline;">')},end:function(){result.push("</span>")}},iframe:{start:function(node){result.push("<iframe"),attr(node),result.push(">")},end:function(){result.push("</iframe>")}},font:{start:function(node){result.push('<span style="');var color=node.getAttribute("color"),size=fontSizeMappings[node.getAttribute("size")],face=node.getAttribute("face");color&&(result.push("color:"),result.push(dom.toHex(color)),result.push(";")),face&&(result.push("font-face:"),result.push(face),result.push(";")),size&&(result.push("font-size:"),result.push(size),result.push(";")),result.push('">')},end:function(){result.push("</span>")}}};return 1==root.childNodes.length&&3==root.firstChild.nodeType?dom.encode(text(root.firstChild).replace(/[\r\n\v\f\t ]+/," "),options):(children(root),result=result.join(""),""===result.replace(brRe,"").replace(emptyPRe,"")?"":result)}};extend(Editor,{Serializer:Serializer})}(window.kendo.jQuery),function($){function compareBoundaries(start,end,startOffset,endOffset){if(start==end)return endOffset-startOffset;for(var container=end;container&&container.parentNode!=start;)container=container.parentNode;if(container)return findNodeIndex(container)-startOffset;for(container=start;container&&container.parentNode!=end;)container=container.parentNode;if(container)return endOffset-findNodeIndex(container)-1;for(var root=dom.commonAncestor(start,end),startAncestor=start;startAncestor&&startAncestor.parentNode!=root;)startAncestor=startAncestor.parentNode;startAncestor||(startAncestor=root);for(var endAncestor=end;endAncestor&&endAncestor.parentNode!=root;)endAncestor=endAncestor.parentNode;return endAncestor||(endAncestor=root),startAncestor==endAncestor?0:findNodeIndex(endAncestor)-findNodeIndex(startAncestor)}function fixIvalidRange(range,toStart){function isInvalidRange(range){try{return compareBoundaries(range.startContainer,range.endContainer,range.startOffset,range.endOffset)<0}catch(ex){return!0}}isInvalidRange(range)&&(toStart?(range.commonAncestorContainer=range.endContainer=range.startContainer,range.endOffset=range.startOffset):(range.commonAncestorContainer=range.startContainer=range.endContainer,range.startOffset=range.endOffset),range.collapsed=!0)}function updateRangeProperties(range){range.collapsed=range.startContainer==range.endContainer&&range.startOffset==range.endOffset;for(var node=range.startContainer;node&&node!=range.endContainer&&!dom.isAncestorOf(node,range.endContainer);)node=node.parentNode;range.commonAncestorContainer=node}function textRangeContainer(textRange){var left=textRange.duplicate(),right=textRange.duplicate();return left.collapse(!0),right.collapse(!1),dom.commonAncestor(textRange.parentElement(),left.parentElement(),right.parentElement())}function adoptContainer(textRange,range,start){var cursorNode,container=range[start?"startContainer":"endContainer"],offset=range[start?"startOffset":"endOffset"],textOffset=0,isData=isDataNode(container),anchorNode=isData?container:container.childNodes[offset]||null,anchorParent=isData?container.parentNode:container,doc=range.ownerDocument,cursor=doc.body.createTextRange();3!=container.nodeType&&4!=container.nodeType||(textOffset=offset),anchorParent||(anchorParent=doc.body),"img"==anchorParent.nodeName.toLowerCase()?(cursor.moveToElementText(anchorParent),cursor.collapse(!1),textRange.setEndPoint(start?"StartToStart":"EndToStart",cursor)):(cursorNode=anchorParent.insertBefore(dom.create(doc,"a"),anchorNode),cursor.moveToElementText(cursorNode),dom.remove(cursorNode),cursor[start?"moveStart":"moveEnd"]("character",textOffset),cursor.collapse(!1),textRange.setEndPoint(start?"StartToStart":"EndToStart",cursor))}function adoptEndPoint(textRange,range,commonAncestor,start){var result,parent,target,previous,next,args,index,cursorNode=dom.create(range.ownerDocument,"a"),cursor=textRange.duplicate(),comparison=start?"StartToStart":"StartToEnd",appended=!1;cursorNode.innerHTML="\ufeff",cursor.collapse(start),parent=cursor.parentElement(),dom.isAncestorOrSelf(commonAncestor,parent)||(parent=commonAncestor);do appended?parent.insertBefore(cursorNode,cursorNode.previousSibling):(parent.appendChild(cursorNode),appended=!0),cursor.moveToElementText(cursorNode);while((result=cursor.compareEndPoints(comparison,textRange))>0&&cursorNode.previousSibling);target=cursorNode.nextSibling,result==-1&&isDataNode(target)?(cursor.setEndPoint(start?"EndToStart":"EndToEnd",textRange),dom.remove(cursorNode),args=[target,cursor.text.length]):(previous=!start&&cursorNode.previousSibling,next=start&&cursorNode.nextSibling,isDataNode(next)?args=[next,0]:isDataNode(previous)?args=[previous,previous.length]:(index=findNodeIndex(cursorNode),args=parent.nextSibling&&index==parent.childNodes.length-1?[parent.nextSibling,0]:[parent,index]),dom.remove(cursorNode)),range[start?"setStart":"setEnd"].apply(range,args)}var kendo=window.kendo,Class=kendo.Class,extend=$.extend,Editor=kendo.ui.editor,browser=kendo.support.browser,dom=Editor.Dom,findNodeIndex=dom.findNodeIndex,isDataNode=dom.isDataNode,findClosestAncestor=dom.findClosestAncestor,getNodeLength=dom.getNodeLength,normalize=dom.normalize,SelectionUtils={selectionFromWindow:function(window){return"getSelection"in window?window.getSelection():new W3CSelection(window.document)},selectionFromRange:function(range){var rangeDocument=RangeUtils.documentFromRange(range);return SelectionUtils.selectionFromDocument(rangeDocument)},selectionFromDocument:function(document){return SelectionUtils.selectionFromWindow(dom.windowFromDocument(document))}},W3CRange=Class.extend({init:function(doc){$.extend(this,{ownerDocument:doc,startContainer:doc,endContainer:doc,commonAncestorContainer:doc,startOffset:0,endOffset:0,collapsed:!0})},setStart:function(node,offset){this.startContainer=node,this.startOffset=offset,updateRangeProperties(this),fixIvalidRange(this,!0)},setEnd:function(node,offset){this.endContainer=node,this.endOffset=offset,updateRangeProperties(this),fixIvalidRange(this,!1)},setStartBefore:function(node){this.setStart(node.parentNode,findNodeIndex(node))},setStartAfter:function(node){this.setStart(node.parentNode,findNodeIndex(node)+1)},setEndBefore:function(node){this.setEnd(node.parentNode,findNodeIndex(node))},setEndAfter:function(node){this.setEnd(node.parentNode,findNodeIndex(node)+1)},selectNode:function(node){this.setStartBefore(node),this.setEndAfter(node)},selectNodeContents:function(node){this.setStart(node,0),this.setEnd(node,node[1===node.nodeType?"childNodes":"nodeValue"].length)},collapse:function(toStart){var that=this;toStart?that.setEnd(that.startContainer,that.startOffset):that.setStart(that.endContainer,that.endOffset)},deleteContents:function(){var that=this,range=that.cloneRange();that.startContainer!=that.commonAncestorContainer&&that.setStartAfter(findClosestAncestor(that.commonAncestorContainer,that.startContainer)),that.collapse(!0),function deleteSubtree(iterator){for(;iterator.next();)iterator.hasPartialSubtree()?deleteSubtree(iterator.getSubtreeIterator()):iterator.remove()}(new RangeIterator(range))},cloneContents:function(){var document=RangeUtils.documentFromRange(this);return function cloneSubtree(iterator){for(var node,frag=document.createDocumentFragment();node=iterator.next();)node=node.cloneNode(!iterator.hasPartialSubtree()),iterator.hasPartialSubtree()&&node.appendChild(cloneSubtree(iterator.getSubtreeIterator())),frag.appendChild(node);return frag}(new RangeIterator(this))},extractContents:function(){var that=this,range=that.cloneRange();that.startContainer!=that.commonAncestorContainer&&that.setStartAfter(findClosestAncestor(that.commonAncestorContainer,that.startContainer)),that.collapse(!0);var document=RangeUtils.documentFromRange(that);return function extractSubtree(iterator){for(var node,frag=document.createDocumentFragment();node=iterator.next();)iterator.hasPartialSubtree()?(node=node.cloneNode(!1),node.appendChild(extractSubtree(iterator.getSubtreeIterator()))):iterator.remove(that.originalRange),frag.appendChild(node);return frag}(new RangeIterator(range))},insertNode:function(node){var that=this;isDataNode(that.startContainer)?(that.startOffset!=that.startContainer.nodeValue.length&&dom.splitDataNode(that.startContainer,that.startOffset),dom.insertAfter(node,that.startContainer)):dom.insertAt(that.startContainer,node,that.startOffset),that.setStart(that.startContainer,that.startOffset)},cloneRange:function(){return $.extend(new W3CRange(this.ownerDocument),{startContainer:this.startContainer,endContainer:this.endContainer,commonAncestorContainer:this.commonAncestorContainer,startOffset:this.startOffset,endOffset:this.endOffset,collapsed:this.collapsed,originalRange:this})},toString:function(){var startNodeName=this.startContainer.nodeName,endNodeName=this.endContainer.nodeName;return["#text"==startNodeName?this.startContainer.nodeValue:startNodeName,"(",this.startOffset,") : ","#text"==endNodeName?this.endContainer.nodeValue:endNodeName,"(",this.endOffset,")"].join("")}}),RangeIterator=Class.extend({init:function(range){if($.extend(this,{range:range,_current:null,_next:null,_end:null}),!range.collapsed){var root=range.commonAncestorContainer;this._next=range.startContainer!=root||isDataNode(range.startContainer)?findClosestAncestor(root,range.startContainer):range.startContainer.childNodes[range.startOffset],this._end=range.endContainer!=root||isDataNode(range.endContainer)?findClosestAncestor(root,range.endContainer).nextSibling:range.endContainer.childNodes[range.endOffset]}},hasNext:function(){return!!this._next},next:function(){var that=this,current=that._current=that._next;return that._next=that._current&&that._current.nextSibling!=that._end?that._current.nextSibling:null,isDataNode(that._current)&&(that.range.endContainer==that._current&&(current=current.cloneNode(!0),current.deleteData(that.range.endOffset,current.length-that.range.endOffset)),that.range.startContainer==that._current&&(current=current.cloneNode(!0),current.deleteData(0,that.range.startOffset))),current},traverse:function(callback){function next(){return that._current=that._next,that._next=that._current&&that._current.nextSibling!=that._end?that._current.nextSibling:null,that._current}for(var current,that=this;current=next();)that.hasPartialSubtree()?that.getSubtreeIterator().traverse(callback):callback(current);return current},remove:function(originalRange){var start,end,delta,that=this,inStartContainer=that.range.startContainer==that._current,inEndContainer=that.range.endContainer==that._current;if(isDataNode(that._current)&&(inStartContainer||inEndContainer))start=inStartContainer?that.range.startOffset:0,end=inEndContainer?that.range.endOffset:that._current.length,delta=end-start,originalRange&&(inStartContainer||inEndContainer)&&(that._current==originalRange.startContainer&&start<=originalRange.startOffset&&(originalRange.startOffset-=delta),that._current==originalRange.endContainer&&end<=originalRange.endOffset&&(originalRange.endOffset-=delta)),that._current.deleteData(start,delta);else{var parent=that._current.parentNode;if(originalRange&&(that.range.startContainer==parent||that.range.endContainer==parent)){var nodeIndex=findNodeIndex(that._current);parent==originalRange.startContainer&&nodeIndex<=originalRange.startOffset&&(originalRange.startOffset-=1),parent==originalRange.endContainer&&nodeIndex<originalRange.endOffset&&(originalRange.endOffset-=1)}dom.remove(that._current)}},hasPartialSubtree:function(){return!isDataNode(this._current)&&(dom.isAncestorOrSelf(this._current,this.range.startContainer)||dom.isAncestorOrSelf(this._current,this.range.endContainer))},getSubtreeIterator:function(){var that=this,subRange=that.range.cloneRange();return subRange.selectNodeContents(that._current),dom.isAncestorOrSelf(that._current,that.range.startContainer)&&subRange.setStart(that.range.startContainer,that.range.startOffset),dom.isAncestorOrSelf(that._current,that.range.endContainer)&&subRange.setEnd(that.range.endContainer,that.range.endOffset),new RangeIterator(subRange)}}),W3CSelection=Class.extend({init:function(doc){this.ownerDocument=doc,this.rangeCount=1},addRange:function(range){var textRange=this.ownerDocument.body.createTextRange();adoptContainer(textRange,range,!1),adoptContainer(textRange,range,!0),textRange.select()},removeAllRanges:function(){var selection=this.ownerDocument.selection;"None"!=selection.type&&selection.empty()},getRangeAt:function(){var textRange,element,commonAncestor,range=new W3CRange(this.ownerDocument),selection=this.ownerDocument.selection;try{if(textRange=selection.createRange(),element=textRange.item?textRange.item(0):textRange.parentElement(),element.ownerDocument!=this.ownerDocument)return range}catch(ex){return range}if("Control"==selection.type)range.selectNode(textRange.item(0));else{commonAncestor=textRangeContainer(textRange),adoptEndPoint(textRange,range,commonAncestor,!0),adoptEndPoint(textRange,range,commonAncestor,!1),9==range.startContainer.nodeType&&range.setStart(range.endContainer,range.startOffset),9==range.endContainer.nodeType&&range.setEnd(range.startContainer,range.endOffset),0===textRange.compareEndPoints("StartToEnd",textRange)&&range.collapse(!1);var startContainer=range.startContainer,endContainer=range.endContainer,body=this.ownerDocument.body;if(!(range.collapsed||0!==range.startOffset||range.endOffset!=getNodeLength(range.endContainer)||startContainer==endContainer&&isDataNode(startContainer)&&startContainer.parentNode==body)){for(var movedStart=!1,movedEnd=!1;0===findNodeIndex(startContainer)&&startContainer==startContainer.parentNode.firstChild&&startContainer!=body;)startContainer=startContainer.parentNode,movedStart=!0;for(;findNodeIndex(endContainer)==getNodeLength(endContainer.parentNode)-1&&endContainer==endContainer.parentNode.lastChild&&endContainer!=body;)endContainer=endContainer.parentNode,movedEnd=!0;startContainer==body&&endContainer==body&&movedStart&&movedEnd&&(range.setStart(startContainer,0),range.setEnd(endContainer,getNodeLength(body)))}}return range}}),RangeEnumerator=Class.extend({init:function(range){this.enumerate=function(){function visit(node){if(dom.is(node,"img")||3==node.nodeType&&(!dom.isWhitespace(node)||"\ufeff"==node.nodeValue))nodes.push(node);else for(node=node.firstChild;node;)visit(node),node=node.nextSibling}var nodes=[];return new RangeIterator(range).traverse(visit),nodes}}}),RestorePoint=Class.extend({init:function(range,body){var that=this;that.range=range,that.rootNode=RangeUtils.documentFromRange(range),that.body=body||that.getEditable(range),"body"!=dom.name(that.body)&&(that.rootNode=that.body),that.html=that.body.innerHTML,that.startContainer=that.nodeToPath(range.startContainer),that.endContainer=that.nodeToPath(range.endContainer),that.startOffset=that.offset(range.startContainer,range.startOffset),that.endOffset=that.offset(range.endContainer,range.endOffset)},index:function(node){for(var result=0,lastType=node.nodeType;node=node.previousSibling;){var nodeType=node.nodeType;3==nodeType&&lastType==nodeType||result++,lastType=nodeType}return result},getEditable:function(range){for(var root=range.commonAncestorContainer;root&&(3==root.nodeType||root.attributes&&!root.attributes.contentEditable);)root=root.parentNode;return root},restoreHtml:function(){this.body.innerHTML=this.html},offset:function(node,value){if(3==node.nodeType)for(;(node=node.previousSibling)&&3==node.nodeType;)value+=node.nodeValue.length;return value},nodeToPath:function(node){for(var path=[];node!=this.rootNode;)path.push(this.index(node)),node=node.parentNode;return path},toRangePoint:function(range,start,path,denormalizedOffset){for(var node=this.rootNode,length=path.length,offset=denormalizedOffset;length--;)node=node.childNodes[path[length]];for(;3==node.nodeType&&node.nodeValue.length<offset;)offset-=node.nodeValue.length,node=node.nextSibling;range[start?"setStart":"setEnd"](node,offset)},toRange:function(){var that=this,result=that.range.cloneRange();return that.toRangePoint(result,!0,that.startContainer,that.startOffset),that.toRangePoint(result,!1,that.endContainer,that.endOffset),result}}),Marker=Class.extend({init:function(){this.caret=null},addCaret:function(range){var that=this;return that.caret=dom.create(RangeUtils.documentFromRange(range),"span",{className:"k-marker"}),range.insertNode(that.caret),range.selectNode(that.caret),that.caret},removeCaret:function(range){var that=this,previous=that.caret.previousSibling,startOffset=0;previous&&(startOffset=isDataNode(previous)?previous.nodeValue.length:findNodeIndex(previous));var container=that.caret.parentNode,containerIndex=previous?findNodeIndex(previous):0;dom.remove(that.caret),normalize(container);var node=container.childNodes[containerIndex];if(isDataNode(node))range.setStart(node,startOffset);else if(node){var textNode=dom.lastTextNode(node);textNode?range.setStart(textNode,textNode.nodeValue.length):range[previous?"setStartAfter":"setStartBefore"](node)}else browser.msie||container.innerHTML||(container.innerHTML='<br _moz_dirty="" />'),range.selectNodeContents(container);range.collapse(!0)},add:function(range,expand){var that=this,collapsed=range.collapsed&&!RangeUtils.isExpandable(range),doc=RangeUtils.documentFromRange(range);expand&&range.collapsed&&(that.addCaret(range),range=RangeUtils.expand(range));var rangeBoundary=range.cloneRange();if(rangeBoundary.collapse(!1),that.end=dom.create(doc,"span",{className:"k-marker"}),rangeBoundary.insertNode(that.end),rangeBoundary=range.cloneRange(),rangeBoundary.collapse(!0),that.start=that.end.cloneNode(!0),rangeBoundary.insertNode(that.start),that._removeDeadMarkers(that.start,that.end),collapsed){var bom=doc.createTextNode("\ufeff");dom.insertAfter(bom.cloneNode(),that.start),dom.insertBefore(bom,that.end)}return range.setStartBefore(that.start),range.setEndAfter(that.end),normalize(range.commonAncestorContainer),range},_removeDeadMarkers:function(start,end){start.previousSibling&&"\ufeff"==start.previousSibling.nodeValue&&dom.remove(start.previousSibling),end.nextSibling&&"\ufeff"==end.nextSibling.nodeValue&&dom.remove(end.nextSibling)},remove:function(range){var shouldNormalizeStart,shouldNormalizeEnd,shouldNormalize,that=this,start=that.start,end=that.end;for(normalize(range.commonAncestorContainer);!start.nextSibling&&start.parentNode;)start=start.parentNode;for(;!end.previousSibling&&end.parentNode;)end=end.parentNode;shouldNormalizeStart=start.previousSibling&&3==start.previousSibling.nodeType&&start.nextSibling&&3==start.nextSibling.nodeType,shouldNormalizeEnd=end.previousSibling&&3==end.previousSibling.nodeType&&end.nextSibling&&3==end.nextSibling.nodeType,shouldNormalize=shouldNormalizeStart&&shouldNormalizeEnd,start=start.nextSibling,end=end.previousSibling;var collapsed=!1,collapsedToStart=!1;if(start==that.end&&(collapsedToStart=!!that.start.previousSibling,start=end=that.start.previousSibling||that.end.nextSibling,collapsed=!0),dom.remove(that.start),dom.remove(that.end),!start||!end)return range.selectNodeContents(range.commonAncestorContainer),void range.collapse(!0);var startOffset=collapsed?isDataNode(start)?start.nodeValue.length:start.childNodes.length:0,endOffset=isDataNode(end)?end.nodeValue.length:end.childNodes.length;if(3==start.nodeType)for(;start.previousSibling&&3==start.previousSibling.nodeType;)start=start.previousSibling,startOffset+=start.nodeValue.length;if(3==end.nodeType)for(;end.previousSibling&&3==end.previousSibling.nodeType;)end=end.previousSibling,endOffset+=end.nodeValue.length;for(var startIndex=findNodeIndex(start),startParent=start.parentNode,endIndex=findNodeIndex(end),endParent=end.parentNode,startPointer=start;startPointer.previousSibling;startPointer=startPointer.previousSibling)3==startPointer.nodeType&&3==startPointer.previousSibling.nodeType&&startIndex--;for(var endPointer=end;endPointer.previousSibling;endPointer=endPointer.previousSibling)3==endPointer.nodeType&&3==endPointer.previousSibling.nodeType&&endIndex--;normalize(startParent),3==start.nodeType&&(start=startParent.childNodes[startIndex]),normalize(endParent),3==end.nodeType&&(end=endParent.childNodes[endIndex]),collapsed?(3==start.nodeType?range.setStart(start,startOffset):range[collapsedToStart?"setStartAfter":"setStartBefore"](start),range.collapse(!0)):(3==start.nodeType?range.setStart(start,startOffset):range.setStartBefore(start),3==end.nodeType?range.setEnd(end,endOffset):range.setEndAfter(end)),that.caret&&that.removeCaret(range)}}),boundary=/[\u0009-\u000d]|\u0020|\u00a0|\ufeff|\.|,|;|:|!|\(|\)|\?/,RangeUtils={nodes:function(range){var nodes=RangeUtils.textNodes(range);return nodes.length||(range.selectNodeContents(range.commonAncestorContainer),nodes=RangeUtils.textNodes(range),nodes.length||(nodes=dom.significantChildNodes(range.commonAncestorContainer))),nodes},textNodes:function(range){return new RangeEnumerator(range).enumerate()},documentFromRange:function(range){var startContainer=range.startContainer;return 9==startContainer.nodeType?startContainer:startContainer.ownerDocument},createRange:function(document){return browser.msie&&browser.version<9?new W3CRange(document):document.createRange()},selectRange:function(range){var image=RangeUtils.image(range);image&&(range.setStartAfter(image),range.setEndAfter(image));var selection=SelectionUtils.selectionFromRange(range);selection.removeAllRanges(),selection.addRange(range)},stringify:function(range){return kendo.format("{0}:{1} - {2}:{3}",dom.name(range.startContainer),range.startOffset,dom.name(range.endContainer),range.endOffset)},split:function(range,node,trim){function partition(start){var partitionRange=range.cloneRange();partitionRange.collapse(start),partitionRange[start?"setStartBefore":"setEndAfter"](node);var contents=partitionRange.extractContents();trim&&(contents=dom.trim(contents)),dom[start?"insertBefore":"insertAfter"](contents,node)}partition(!0),partition(!1)},getMarkers:function(range){var markers=[];return new RangeIterator(range).traverse(function(node){"k-marker"==node.className&&markers.push(node)}),markers},image:function(range){var nodes=[];if(new RangeIterator(range).traverse(function(node){dom.is(node,"img")&&nodes.push(node)}),1==nodes.length)return nodes[0]},expand:function(range){var result=range.cloneRange(),startContainer=result.startContainer.childNodes[0===result.startOffset?0:result.startOffset-1],endContainer=result.endContainer.childNodes[result.endOffset];if(!isDataNode(startContainer)||!isDataNode(endContainer))return result;var beforeCaret=startContainer.nodeValue,afterCaret=endContainer.nodeValue;if(!beforeCaret||!afterCaret)return result;var startOffset=beforeCaret.split("").reverse().join("").search(boundary),endOffset=afterCaret.search(boundary);return startOffset&&endOffset?(endOffset=endOffset==-1?afterCaret.length:endOffset,startOffset=startOffset==-1?0:beforeCaret.length-startOffset,result.setStart(startContainer,startOffset),result.setEnd(endContainer,endOffset),result):result},isExpandable:function(range){var node=range.startContainer,rangeDocument=RangeUtils.documentFromRange(range);if(node==rangeDocument||node==rangeDocument.body)return!1;var result=range.cloneRange(),value=node.nodeValue;if(!value)return!1;var beforeCaret=value.substring(0,result.startOffset),afterCaret=value.substring(result.startOffset),startOffset=0,endOffset=0;return beforeCaret&&(startOffset=beforeCaret.split("").reverse().join("").search(boundary)),afterCaret&&(endOffset=afterCaret.search(boundary)),startOffset&&endOffset}};extend(Editor,{SelectionUtils:SelectionUtils,W3CRange:W3CRange,RangeIterator:RangeIterator,W3CSelection:W3CSelection,RangeEnumerator:RangeEnumerator,RestorePoint:RestorePoint,Marker:Marker,RangeUtils:RangeUtils})}(window.kendo.jQuery),function($){var kendo=window.kendo,Class=kendo.Class,editorNS=kendo.ui.editor,EditorUtils=editorNS.EditorUtils,registerTool=EditorUtils.registerTool,dom=editorNS.Dom,Tool=editorNS.Tool,ToolTemplate=editorNS.ToolTemplate,RestorePoint=editorNS.RestorePoint,Marker=editorNS.Marker,extend=$.extend,Command=Class.extend({init:function(options){this.options=options,this.restorePoint=new RestorePoint(options.range),this.marker=new Marker,this.formatter=options.formatter},getRange:function(){return this.restorePoint.toRange()},lockRange:function(expand){return this.marker.add(this.getRange(),expand)},releaseRange:function(range){this.marker.remove(range),this.editor.selectRange(range)},undo:function(){var point=this.restorePoint;point.restoreHtml(),this.editor.selectRange(point.toRange())},redo:function(){this.exec()},createDialog:function(content,options){var editor=this.editor;return $(content).appendTo(document.body).kendoWindow(extend({},editor.options.dialogOptions,options)).closest(".k-window").toggleClass("k-rtl",kendo.support.isRtl(editor.wrapper)).end()},exec:function(){var range=this.lockRange(!0);this.formatter.editor=this.editor,this.formatter.toggle(range),this.releaseRange(range)}}),GenericCommand=Class.extend({init:function(startRestorePoint,endRestorePoint){this.body=startRestorePoint.body,this.startRestorePoint=startRestorePoint,this.endRestorePoint=endRestorePoint},redo:function(){this.body.innerHTML=this.endRestorePoint.html,this.editor.selectRange(this.endRestorePoint.toRange())},undo:function(){this.body.innerHTML=this.startRestorePoint.html,this.editor.selectRange(this.startRestorePoint.toRange())}}),InsertHtmlCommand=Command.extend({init:function(options){Command.fn.init.call(this,options),this.managesUndoRedo=!0},exec:function(){var editor=this.editor,options=this.options,range=options.range,body=editor.body,startRestorePoint=new RestorePoint(range,body),html=options.html||options.value||"";editor.selectRange(range),editor.clipboard.paste(html,options),options.postProcess&&options.postProcess(editor,editor.getRange());var genericCommand=new GenericCommand(startRestorePoint,new RestorePoint(editor.getRange(),body));genericCommand.editor=editor,editor.undoRedoStack.push(genericCommand),editor.focus()}}),InsertHtmlTool=Tool.extend({initialize:function(ui,initOptions){var editor=initOptions.editor,options=this.options,dataSource=options.items?options.items:editor.options.insertHtml;new editorNS.SelectBox(ui,{dataSource:dataSource,dataTextField:"text",dataValueField:"value",change:function(){Tool.exec(editor,"insertHtml",this.value())},title:editor.options.messages.insertHtml,highlightFirst:!1})},command:function(commandArguments){return new InsertHtmlCommand(commandArguments)},update:function(ui){var selectbox=ui.data("kendoSelectBox")||ui.find("select").data("kendoSelectBox");selectbox.close(),selectbox.value(selectbox.options.title)}}),UndoRedoStack=Class.extend({init:function(){this.stack=[],this.currentCommandIndex=-1},push:function(command){this.stack=this.stack.slice(0,this.currentCommandIndex+1),this.currentCommandIndex=this.stack.push(command)-1},undo:function(){this.canUndo()&&this.stack[this.currentCommandIndex--].undo()},redo:function(){this.canRedo()&&this.stack[++this.currentCommandIndex].redo()},canUndo:function(){return this.currentCommandIndex>=0;
},canRedo:function(){return this.currentCommandIndex!=this.stack.length-1}}),TypingHandler=Class.extend({init:function(editor){this.editor=editor},keydown:function(e){var that=this,editor=that.editor,keyboard=editor.keyboard,isTypingKey=keyboard.isTypingKey(e),evt=extend($.Event(),e);if(that.editor.trigger("keydown",evt),evt.isDefaultPrevented()&&e.preventDefault(),!evt.isDefaultPrevented()&&isTypingKey&&!keyboard.isTypingInProgress()){var range=editor.getRange();return that.startRestorePoint=new RestorePoint(range),keyboard.startTyping(function(){editor.selectionRestorePoint=that.endRestorePoint=new RestorePoint(editor.getRange());var genericCommand=new GenericCommand(that.startRestorePoint,that.endRestorePoint);genericCommand.editor=editor,editor.undoRedoStack.push(genericCommand)}),!0}return!1},keyup:function(e){var keyboard=this.editor.keyboard;return this.editor.trigger("keyup",e),!!keyboard.isTypingInProgress()&&(keyboard.endTyping(),!0)}}),SystemHandler=Class.extend({init:function(editor){this.editor=editor,this.systemCommandIsInProgress=!1},createUndoCommand:function(){var that=this;that.endRestorePoint=new RestorePoint(that.editor.getRange());var command=new GenericCommand(that.startRestorePoint,that.endRestorePoint);command.editor=that.editor,that.editor.undoRedoStack.push(command),that.startRestorePoint=that.endRestorePoint},changed:function(){return!!this.startRestorePoint&&this.startRestorePoint.html!=this.editor.body.innerHTML},keydown:function(e){var that=this,editor=that.editor,keyboard=editor.keyboard;return keyboard.isModifierKey(e)?(keyboard.isTypingInProgress()&&keyboard.endTyping(!0),that.startRestorePoint=new RestorePoint(editor.getRange()),!0):!!keyboard.isSystem(e)&&(that.systemCommandIsInProgress=!0,that.changed()&&(that.systemCommandIsInProgress=!1,that.createUndoCommand()),!0)},keyup:function(e){var that=this;return!(!that.systemCommandIsInProgress||!that.changed())&&(that.systemCommandIsInProgress=!1,that.createUndoCommand(e),!0)}}),Keyboard=Class.extend({init:function(handlers){this.handlers=handlers,this.typingInProgress=!1},isCharacter:function(keyCode){return keyCode>=48&&keyCode<=90||keyCode>=96&&keyCode<=111||keyCode>=186&&keyCode<=192||keyCode>=219&&keyCode<=222||229==keyCode},toolFromShortcut:function(tools,e){var toolName,toolOptions,key=String.fromCharCode(e.keyCode);for(toolName in tools)if(toolOptions=$.extend({ctrl:!1,alt:!1,shift:!1},tools[toolName].options),(toolOptions.key==key||toolOptions.key==e.keyCode)&&toolOptions.ctrl==e.ctrlKey&&toolOptions.alt==e.altKey&&toolOptions.shift==e.shiftKey)return toolName},isTypingKey:function(e){var keyCode=e.keyCode;return this.isCharacter(keyCode)&&!e.ctrlKey&&!e.altKey||32==keyCode||13==keyCode||8==keyCode||46==keyCode&&!e.shiftKey&&!e.ctrlKey&&!e.altKey},isModifierKey:function(e){var keyCode=e.keyCode;return 17==keyCode&&!e.shiftKey&&!e.altKey||16==keyCode&&!e.ctrlKey&&!e.altKey||18==keyCode&&!e.ctrlKey&&!e.shiftKey},isSystem:function(e){return 46==e.keyCode&&e.ctrlKey&&!e.altKey&&!e.shiftKey},startTyping:function(callback){this.onEndTyping=callback,this.typingInProgress=!0},stopTyping:function(){this.typingInProgress&&this.onEndTyping&&this.onEndTyping(),this.typingInProgress=!1},endTyping:function(force){var that=this;that.clearTimeout(),force?that.stopTyping():that.timeout=window.setTimeout($.proxy(that.stopTyping,that),1e3)},isTypingInProgress:function(){return this.typingInProgress},clearTimeout:function(){window.clearTimeout(this.timeout)},notify:function(e,what){var i,handlers=this.handlers;for(i=0;i<handlers.length&&!handlers[i][what](e);i++);},keydown:function(e){this.notify(e,"keydown")},keyup:function(e){this.notify(e,"keyup")}}),Clipboard=Class.extend({init:function(editor){this.editor=editor,this.cleaners=[new ScriptCleaner,new MSWordFormatCleaner,new WebkitFormatCleaner]},htmlToFragment:function(html){var editor=this.editor,doc=editor.document,container=dom.create(doc,"div"),fragment=doc.createDocumentFragment();for(container.innerHTML=html;container.firstChild;)fragment.appendChild(container.firstChild);return fragment},isBlock:function(html){return/<(div|p|ul|ol|table|h[1-6])/i.test(html)},_contentModification:function(before,after){var range,startRestorePoint,that=this,editor=that.editor;that._inProgress||(that._inProgress=!0,range=editor.getRange(),startRestorePoint=new RestorePoint(range),dom.persistScrollTop(editor.document),before.call(that,editor,range),setTimeout(function(){after.call(that,editor,range);var endRestorePoint=new RestorePoint(editor.getRange()),genericCommand=new GenericCommand(startRestorePoint,endRestorePoint);genericCommand.editor=editor,editor.undoRedoStack.push(genericCommand),editor._selectionChange(),that._inProgress=!1}))},oncut:function(){this._contentModification($.noop,$.noop)},onpaste:function(e){this._contentModification(function(editor,range){var clipboardNode=dom.create(editor.document,"div",{className:"k-paste-container",innerHTML:"\ufeff"});if(editor.body.appendChild(clipboardNode),editor.body.createTextRange){e.preventDefault();var r=editor.createRange();r.selectNodeContents(clipboardNode),editor.selectRange(r);var textRange=editor.body.createTextRange();textRange.moveToElementText(clipboardNode),$(editor.body).unbind("paste"),textRange.execCommand("Paste"),$(editor.body).bind("paste",$.proxy(this.onpaste,this))}else{var clipboardRange=editor.createRange();clipboardRange.selectNodeContents(clipboardNode),editor.selectRange(clipboardRange)}range.deleteContents()},function(editor,range){var containers,html="",args={html:""};kendo.support.browser;editor.selectRange(range),containers=$(editor.body).children(".k-paste-container"),containers.each(function(){var lastChild=this.lastChild;lastChild&&dom.is(lastChild,"br")&&dom.remove(lastChild),html+=this.innerHTML}),containers.remove(),html=html.replace(/\ufeff/g,""),args.html=html,editor.trigger("paste",args),editor.clipboard.paste(args.html,{clean:!0})})},splittableParent:function(block,node){var parentNode,body;if(block)return dom.closestEditableOfType(node,["p","ul","ol"])||node.parentNode;if(parentNode=node.parentNode,body=node.ownerDocument.body,dom.isInline(parentNode))for(;parentNode.parentNode!=body&&!dom.isBlock(parentNode.parentNode);)parentNode=parentNode.parentNode;return parentNode},paste:function(html,options){var i,l,editor=this.editor;for(options=extend({clean:!1,split:!0},options),i=0,l=this.cleaners.length;i<l;i++)this.cleaners[i].applicable(html)&&(html=this.cleaners[i].clean(html));options.clean&&(html=html.replace(/(<br>(\s|&nbsp;)*)+(<\/?(div|p|li|col|t))/gi,"$3"),html=html.replace(/<(a|span)[^>]*><\/\1>/gi,"")),html=html.replace(/^<li/i,"<ul><li").replace(/li>$/g,"li></ul>");var block=this.isBlock(html);editor.focus();var range=editor.getRange();range.deleteContents(),range.startContainer==editor.document&&range.selectNodeContents(editor.body);var marker=new Marker,caret=marker.addCaret(range),parent=this.splittableParent(block,caret),unwrap=!1,splittable=parent!=editor.body&&!dom.is(parent,"td");options.split&&splittable&&(block||dom.isInline(parent))&&(range.selectNode(caret),editorNS.RangeUtils.split(range,parent,!0),unwrap=!0);var fragment=this.htmlToFragment(html);if(fragment.firstChild&&"k-paste-container"===fragment.firstChild.className){var fragmentsHtml=[];for(i=0,l=fragment.childNodes.length;i<l;i++)fragmentsHtml.push(fragment.childNodes[i].innerHTML);fragment=this.htmlToFragment(fragmentsHtml.join("<br />"))}if($(fragment.childNodes).filter("table").addClass("k-table").end().find("table").addClass("k-table"),range.insertNode(fragment),parent=this.splittableParent(block,caret),unwrap){for(;caret.parentNode!=parent;)dom.unwrap(caret.parentNode);dom.unwrap(caret.parentNode)}dom.normalize(range.commonAncestorContainer),caret.style.display="inline",dom.restoreScrollTop(editor.document),dom.scrollTo(caret),marker.removeCaret(range),editor.selectRange(range)}}),Cleaner=Class.extend({clean:function(html){var i,l,that=this,replacements=that.replacements;for(i=0,l=replacements.length;i<l;i+=2)html=html.replace(replacements[i],replacements[i+1]);return html}}),ScriptCleaner=Cleaner.extend({init:function(){this.replacements=[/<(\/?)script([^>]*)>/i,"<$1telerik:script$2>"]},applicable:function(html){return/<script[^>]*>/i.test(html)}}),MSWordFormatCleaner=Cleaner.extend({init:function(){this.replacements=[/<\?xml[^>]*>/gi,"",/<!--(.|\n)*?-->/g,"",/&quot;/g,"'",/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6]|hr|p|div|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|address|pre|form|blockquote|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1",/<br><br>/g,"<BR><BR>",/<br>(?!\n)/g," ",/<table([^>]*)>(\s|&nbsp;)+<t/gi,"<table$1><t",/<tr[^>]*>(\s|&nbsp;)*<\/tr>/gi,"",/<tbody[^>]*>(\s|&nbsp;)*<\/tbody>/gi,"",/<table[^>]*>(\s|&nbsp;)*<\/table>/gi,"",/<BR><BR>/g,"<br>",/^\s*(&nbsp;)+/gi,"",/(&nbsp;|<br[^>]*>)+\s*$/gi,"",/mso-[^;"]*;?/gi,"",/<(\/?)b(\s[^>]*)?>/gi,"<$1strong$2>",/<(\/?)i(\s[^>]*)?>/gi,"<$1em$2>",/<o:p>&nbsp;<\/o:p>/gi,"&nbsp;",/<\/?(meta|link|style|o:|v:|x:)[^>]*>((?:.|\n)*?<\/(meta|link|style|o:|v:|x:)[^>]*>)?/gi,"",/<\/o>/g,"",/style=(["|'])\s*\1/g,"",/(<br[^>]*>)?\n/g,function($0,$1){return $1?$0:" "}]},applicable:function(html){return/class="?Mso|style="[^"]*mso-/i.test(html)||/urn:schemas-microsoft-com:office/.test(html)},stripEmptyAnchors:function(html){return html.replace(/<a([^>]*)>\s*<\/a>/gi,function(a,attributes){return!attributes||attributes.indexOf("href")<0?"":a})},listType:function(html){var startingSymbol;return/^(<span [^>]*texhtml[^>]*>)?<span [^>]*(Symbol|Wingdings)[^>]*>/i.test(html)&&(startingSymbol=!0),html=html.replace(/<\/?\w+[^>]*>/g,"").replace(/&nbsp;/g," "),!startingSymbol&&/^[\u2022\u00b7\u00a7\u00d8o]\u00a0+/.test(html)||startingSymbol&&/^.\u00a0+/.test(html)?"ul":/^\s*\w+[\.\)]\u00a0{2,}/.test(html)?"ol":void 0},lists:function(placeholder){var lastType,name,i,p,type,margin,list,key,child,blockChildren=$(dom.blockElements.join(","),placeholder),lastMargin=-1,levels={ul:{},ol:{}},li=placeholder;for(i=0;i<blockChildren.length;i++)if(p=blockChildren[i],type=this.listType(p.innerHTML),name=dom.name(p),"td"!=name)if(type&&"p"==name){if(margin=parseFloat(p.style.marginLeft||0),list=levels[type][margin],(margin>lastMargin||!list)&&(list=dom.create(document,type),li==placeholder?dom.insertBefore(list,p):li.appendChild(list),levels[type][margin]=list),lastType!=type)for(key in levels)for(child in levels[key])$.contains(list,levels[key][child])&&delete levels[key][child];dom.remove(p.firstChild),li=dom.create(document,"li",{innerHTML:p.innerHTML}),list.appendChild(li),dom.remove(p),lastMargin=margin,lastType=type}else p.innerHTML?(levels={ul:{},ol:{}},li=placeholder,lastMargin=-1):dom.remove(p)},removeAttributes:function(element){for(var attributes=element.attributes,i=attributes.length;i--;)"colspan"!=dom.name(attributes[i])&&element.removeAttributeNode(attributes[i])},createColGroup:function(row){var cells=row.cells,table=$(row).closest("table"),colgroup=table.children("colgroup");cells.length<2||(colgroup.length&&(cells=colgroup.children(),colgroup[0].parentNode.removeChild(colgroup[0])),colgroup=$($.map(cells,function(cell){var width=cell.width;return width&&0!==parseInt(width,10)?kendo.format('<col style="width:{0}px;"/>',width):"<col />"}).join("")),colgroup.is("colgroup")||(colgroup=$("<colgroup/>").append(colgroup)),colgroup.prependTo(table))},convertHeaders:function(row){var i,cells=row.cells,boldedCells=$.map(cells,function(cell){var child=$(cell).children("p").children("strong")[0];if(child&&"strong"==dom.name(child))return child});if(boldedCells.length==cells.length){for(i=0;i<boldedCells.length;i++)dom.unwrap(boldedCells[i]);for($(row).closest("table").find("colgroup").after("<thead></thead>").end().find("thead").append(row),i=0;i<cells.length;i++)dom.changeTag(cells[i],"th")}},removeParagraphs:function(cells){var i,j,len,cell,paragraphs;for(i=0;i<cells.length;i++)for(this.removeAttributes(cells[i]),cell=$(cells[i]),paragraphs=cell.children("p"),j=0,len=paragraphs.length;j<len;j++)j<len-1&&dom.insertAfter(dom.create(document,"br"),paragraphs[j]),dom.unwrap(paragraphs[j])},removeDefaultColors:function(spans){for(var i=0;i<spans.length;i++)/^\s*color:\s*[^;]*;?$/i.test(spans[i].style.cssText)&&dom.unwrap(spans[i])},tables:function(placeholder){var rows,firstRow,longestRow,i,j,tables=$(placeholder).find("table"),that=this;for(i=0;i<tables.length;i++){for(rows=tables[i].rows,longestRow=firstRow=rows[0],j=1;j<rows.length;j++)rows[j].cells.length>longestRow.cells.length&&(longestRow=rows[j]);that.createColGroup(longestRow),that.convertHeaders(firstRow),that.removeAttributes(tables[i]),that.removeParagraphs(tables.eq(i).find("td,th")),that.removeDefaultColors(tables.eq(i).find("span"))}},clean:function(html){var placeholder,that=this;return html=Cleaner.fn.clean.call(that,html),html=that.stripEmptyAnchors(html),placeholder=dom.create(document,"div",{innerHTML:html}),that.lists(placeholder),that.tables(placeholder),html=placeholder.innerHTML.replace(/(<[^>]*)\s+class="?[^"\s>]*"?/gi,"$1")}}),WebkitFormatCleaner=Cleaner.extend({init:function(){this.replacements=[/\s+class="Apple-style-span[^"]*"/gi,"",/<(div|p|h[1-6])\s+style="[^"]*"/gi,"<$1",/^<div>(.*)<\/div>$/,"$1"]},applicable:function(html){return/class="?Apple-style-span|style="[^"]*-webkit-nbsp-mode/i.test(html)}});extend(editorNS,{Command:Command,GenericCommand:GenericCommand,InsertHtmlCommand:InsertHtmlCommand,InsertHtmlTool:InsertHtmlTool,UndoRedoStack:UndoRedoStack,TypingHandler:TypingHandler,SystemHandler:SystemHandler,Keyboard:Keyboard,Clipboard:Clipboard,Cleaner:Cleaner,MSWordFormatCleaner:MSWordFormatCleaner,WebkitFormatCleaner:WebkitFormatCleaner}),registerTool("insertHtml",new InsertHtmlTool({template:new ToolTemplate({template:EditorUtils.dropDownListTemplate,title:"Insert HTML",initialValue:"Insert HTML"})}))}(window.kendo.jQuery),function($){var kendo=window.kendo,Class=kendo.Class,Editor=kendo.ui.editor,formats=kendo.ui.Editor.fn.options.formats,EditorUtils=Editor.EditorUtils,Tool=Editor.Tool,ToolTemplate=Editor.ToolTemplate,FormatTool=Editor.FormatTool,dom=Editor.Dom,RangeUtils=Editor.RangeUtils,extend=$.extend,registerTool=Editor.EditorUtils.registerTool,registerFormat=Editor.EditorUtils.registerFormat,KMARKER="k-marker",InlineFormatFinder=Class.extend({init:function(format){this.format=format},numberOfSiblings:function(referenceNode){var node,textNodesCount=0,elementNodesCount=0,markerCount=0,parentNode=referenceNode.parentNode;for(node=parentNode.firstChild;node;node=node.nextSibling)node!=referenceNode&&(node.className==KMARKER?markerCount++:3==node.nodeType?textNodesCount++:elementNodesCount++);return markerCount>1&&parentNode.firstChild.className==KMARKER&&parentNode.lastChild.className==KMARKER?0:elementNodesCount+textNodesCount},findSuitable:function(sourceNode,skip){return!skip&&this.numberOfSiblings(sourceNode)>0?null:dom.parentOfType(sourceNode,this.format[0].tags)},findFormat:function(sourceNode){var i,len,node,tags,attributes,format=this.format,attrEquals=dom.attrEquals;for(i=0,len=format.length;i<len;i++){if(node=sourceNode,tags=format[i].tags,attributes=format[i].attr,node&&dom.ofType(node,tags)&&attrEquals(node,attributes))return node;for(;node;)if(node=dom.parentOfType(node,tags),node&&attrEquals(node,attributes))return node}return null},isFormatted:function(nodes){var i,len;for(i=0,len=nodes.length;i<len;i++)if(this.findFormat(nodes[i]))return!0;return!1}}),InlineFormatter=Class.extend({init:function(format,values){var that=this;that.finder=new InlineFormatFinder(format),that.attributes=extend({},format[0].attr,values),that.tag=format[0].tags[0]},wrap:function(node){return dom.wrap(node,dom.create(node.ownerDocument,this.tag,this.attributes))},activate:function(range,nodes){var that=this;that.finder.isFormatted(nodes)?(that.split(range),that.remove(nodes)):that.apply(nodes)},toggle:function(range){var nodes=RangeUtils.textNodes(range);nodes.length>0&&this.activate(range,nodes)},apply:function(nodes){var i,l,node,formatNode,that=this,formatNodes=[];for(i=0,l=nodes.length;i<l;i++)node=nodes[i],formatNode=that.finder.findSuitable(node),formatNode?dom.attr(formatNode,that.attributes):formatNode=that.wrap(node),formatNodes.push(formatNode);that.consolidate(formatNodes)},remove:function(nodes){var i,l,formatNode,that=this;for(i=0,l=nodes.length;i<l;i++)formatNode=that.finder.findFormat(nodes[i]),formatNode&&(that.attributes&&that.attributes.style?(dom.unstyle(formatNode,that.attributes.style),formatNode.style.cssText||formatNode.attributes["class"]||dom.unwrap(formatNode)):dom.unwrap(formatNode))},split:function(range){var i,formatNode,nodes=RangeUtils.textNodes(range),l=nodes.length;if(l>0)for(i=0;i<l;i++)formatNode=this.finder.findFormat(nodes[i]),formatNode&&RangeUtils.split(range,formatNode,!0)},consolidate:function(nodes){for(var node,last;nodes.length>1;)if(node=nodes.pop(),last=nodes[nodes.length-1],node.previousSibling&&node.previousSibling.className==KMARKER&&last.appendChild(node.previousSibling),node.tagName==last.tagName&&node.previousSibling==last&&node.style.cssText==last.style.cssText){for(;node.firstChild;)last.appendChild(node.firstChild);dom.remove(node)}}}),GreedyInlineFormatFinder=InlineFormatFinder.extend({init:function(format,greedyProperty){var that=this;that.format=format,that.greedyProperty=greedyProperty,InlineFormatFinder.fn.init.call(that,format)},getInlineCssValue:function(node){var i,l,attribute,name,attributeValue,css,pair,cssIndex,len,propertyAndValue,property,value,attributes=node.attributes,trim=$.trim;if(attributes)for(i=0,l=attributes.length;i<l;i++)if(attribute=attributes[i],name=attribute.nodeName,attributeValue=attribute.nodeValue,attribute.specified&&"style"==name)for(css=trim(attributeValue||node.style.cssText).split(";"),cssIndex=0,len=css.length;cssIndex<len;cssIndex++)if(pair=css[cssIndex],pair.length){if(propertyAndValue=pair.split(":"),property=trim(propertyAndValue[0].toLowerCase()),value=trim(propertyAndValue[1]),property!=this.greedyProperty)continue;return property.indexOf("color")>=0?dom.toHex(value):value}},getFormatInner:function(node){var i,len,value,$node=$(dom.isDataNode(node)?node.parentNode:node),parents=$node.parentsUntil("[contentEditable]").addBack();for(i=0,len=parents.length;i<len;i++)if(value="className"==this.greedyProperty?parents[i].className:this.getInlineCssValue(parents[i]))return value;return"inherit"},getFormat:function(nodes){var i,len,result=this.getFormatInner(nodes[0]);for(i=1,len=nodes.length;i<len;i++)if(result!=this.getFormatInner(nodes[i]))return"";return result},isFormatted:function(nodes){return""!==this.getFormat(nodes)}}),GreedyInlineFormatter=InlineFormatter.extend({init:function(format,values,greedyProperty){InlineFormatter.fn.init.call(this,format,values),this.values=values,this.finder=new GreedyInlineFormatFinder(format,greedyProperty),greedyProperty&&(this.greedyProperty=kendo.toCamelCase(greedyProperty))},activate:function(range,nodes){var greedyProperty=this.greedyProperty,action="apply";this.split(range),greedyProperty&&"inherit"==this.values.style[greedyProperty]&&(action="remove"),this[action](nodes)}}),InlineFormatTool=FormatTool.extend({init:function(options){FormatTool.fn.init.call(this,extend(options,{finder:new InlineFormatFinder(options.format),formatter:function(){return new InlineFormatter(options.format)}}))}}),DelayedExecutionTool=Tool.extend({update:function(ui,nodes){var list=ui.data(this.type);list.close(),list.value(this.finder.getFormat(nodes))}}),FontTool=DelayedExecutionTool.extend({init:function(options){var that=this;Tool.fn.init.call(that,options),that.type=kendo.support.browser.msie||kendo.support.touch?"kendoDropDownList":"kendoComboBox",that.format=[{tags:["span"]}],that.finder=new GreedyInlineFormatFinder(that.format,options.cssAttr)},command:function(commandArguments){var options=this.options,format=this.format,style={};return new Editor.FormatCommand(extend(commandArguments,{formatter:function(){return style[options.domAttr]=commandArguments.value,new GreedyInlineFormatter(format,{style:style},options.cssAttr)}}))},initialize:function(ui,initOptions){var dataSource,editor=initOptions.editor,options=this.options,toolName=options.name,defaultValue=[];options.defaultValue&&(defaultValue=[{text:editor.options.messages[options.defaultValue[0].text],value:options.defaultValue[0].value}]),dataSource=defaultValue.concat(options.items?options.items:editor.options[toolName]),ui[this.type]({dataTextField:"text",dataValueField:"value",dataSource:dataSource,change:function(){Tool.exec(editor,toolName,this.value())},highlightFirst:!1}),ui.closest(".k-widget").removeClass("k-"+toolName).find("*").addBack().attr("unselectable","on"),ui.data(this.type).value("inherit")}}),ColorTool=Tool.extend({init:function(options){Tool.fn.init.call(this,options),this.format=[{tags:["span"]}],this.finder=new GreedyInlineFormatFinder(this.format,options.cssAttr)},options:{palette:"websafe"},update:function(){this._widget.close()},command:function(commandArguments){var options=this.options,format=this.format,style={};return new Editor.FormatCommand(extend(commandArguments,{formatter:function(){return style[options.domAttr]=commandArguments.value,new GreedyInlineFormatter(format,{style:style},options.cssAttr)}}))},initialize:function(ui,initOptions){var editor=initOptions.editor,toolName=this.name,options=extend({},ColorTool.fn.options,this.options),palette=options.palette;ui=this._widget=new kendo.ui.ColorPicker(ui,{value:$.isArray(palette)?palette[0]:"#000",toolIcon:"k-"+options.name,palette:palette,change:function(){var color=ui.value();color&&Tool.exec(editor,toolName,color),editor.focus()},activate:function(e){e.preventDefault(),ui.trigger("change")}}),ui.wrapper.attr({title:initOptions.title,unselectable:"on"}).find("*").attr("unselectable","on")}});extend(Editor,{InlineFormatFinder:InlineFormatFinder,InlineFormatter:InlineFormatter,DelayedExecutionTool:DelayedExecutionTool,GreedyInlineFormatFinder:GreedyInlineFormatFinder,GreedyInlineFormatter:GreedyInlineFormatter,InlineFormatTool:InlineFormatTool,FontTool:FontTool,ColorTool:ColorTool}),registerFormat("bold",[{tags:["strong","b"]},{tags:["span"],attr:{style:{fontWeight:"bold"}}}]),registerTool("bold",new InlineFormatTool({key:"B",ctrl:!0,format:formats.bold,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Bold"})})),registerFormat("italic",[{tags:["em","i"]},{tags:["span"],attr:{style:{fontStyle:"italic"}}}]),registerTool("italic",new InlineFormatTool({key:"I",ctrl:!0,format:formats.italic,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Italic"})})),registerFormat("underline",[{tags:["span"],attr:{style:{textDecoration:"underline"}}},{tags:["u"]}]),registerTool("underline",new InlineFormatTool({key:"U",ctrl:!0,format:formats.underline,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Underline"})})),registerFormat("strikethrough",[{tags:["del","strike"]},{tags:["span"],attr:{style:{textDecoration:"line-through"}}}]),registerTool("strikethrough",new InlineFormatTool({format:formats.strikethrough,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Strikethrough"})})),registerFormat("superscript",[{tags:["sup"]}]),registerTool("superscript",new InlineFormatTool({format:formats.superscript,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Superscript"})})),registerFormat("subscript",[{tags:["sub"]}]),registerTool("subscript",new InlineFormatTool({format:formats.subscript,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Subscript"})})),registerTool("foreColor",new ColorTool({cssAttr:"color",domAttr:"color",name:"foreColor",template:new ToolTemplate({template:EditorUtils.colorPickerTemplate,title:"Color"})})),registerTool("backColor",new ColorTool({cssAttr:"background-color",domAttr:"backgroundColor",name:"backColor",template:new ToolTemplate({template:EditorUtils.colorPickerTemplate,title:"Background Color"})})),registerTool("fontName",new FontTool({cssAttr:"font-family",domAttr:"fontFamily",name:"fontName",defaultValue:[{text:"fontNameInherit",value:"inherit"}],template:new ToolTemplate({template:EditorUtils.comboBoxTemplate,title:"Font Name"})})),registerTool("fontSize",new FontTool({cssAttr:"font-size",domAttr:"fontSize",name:"fontSize",defaultValue:[{text:"fontSizeInherit",value:"inherit"}],template:new ToolTemplate({template:EditorUtils.comboBoxTemplate,title:"Font Size"})}))}(window.kendo.jQuery),function($){var kendo=window.kendo,Class=kendo.Class,extend=$.extend,Editor=kendo.ui.editor,formats=kendo.ui.Editor.fn.options.formats,dom=Editor.Dom,Command=Editor.Command,ToolTemplate=Editor.ToolTemplate,FormatTool=Editor.FormatTool,EditorUtils=Editor.EditorUtils,registerTool=EditorUtils.registerTool,registerFormat=EditorUtils.registerFormat,RangeUtils=Editor.RangeUtils,BlockFormatFinder=Class.extend({init:function(format){this.format=format},contains:function(node,children){var i,len,child;for(i=0,len=children.length;i<len;i++)if(child=children[i],!child||!dom.isAncestorOrSelf(node,child))return!1;return!0},findSuitable:function(nodes){var i,len,candidate,format=this.format,suitable=[];for(i=0,len=nodes.length;i<len;i++){for(var f=format.length-1;f>=0&&!(candidate=dom.ofType(nodes[i],format[f].tags)?nodes[i]:dom.parentOfType(nodes[i],format[f].tags));f--);if(!candidate||"true"===candidate.contentEditable)return[];$.inArray(candidate,suitable)<0&&suitable.push(candidate)}for(i=0,len=suitable.length;i<len;i++)if(this.contains(suitable[i],suitable))return[suitable[i]];return suitable},findFormat:function(sourceNode){var i,len,node,tags,attributes,format=this.format;for(i=0,len=format.length;i<len;i++)for(node=sourceNode,tags=format[i].tags,attributes=format[i].attr;node;){if(dom.ofType(node,tags)&&dom.attrEquals(node,attributes))return node;node=node.parentNode}return null},getFormat:function(nodes){var i,len,that=this,findFormat=function(node){return that.findFormat(dom.isDataNode(node)?node.parentNode:node)},result=findFormat(nodes[0]);if(!result)return"";for(i=1,len=nodes.length;i<len;i++)if(result!=findFormat(nodes[i]))return"";return result.nodeName.toLowerCase()},isFormatted:function(nodes){for(var i=0,len=nodes.length;i<len;i++)if(!this.findFormat(nodes[i]))return!1;return!0}}),BlockFormatter=Class.extend({init:function(format,values){this.format=format,this.values=values,this.finder=new BlockFormatFinder(format)},wrap:function(tag,attributes,nodes){var commonAncestor=1==nodes.length?dom.blockParentOrBody(nodes[0]):dom.commonAncestor.apply(null,nodes);dom.isInline(commonAncestor)&&(commonAncestor=dom.blockParentOrBody(commonAncestor));var i,ancestor,ancestors=dom.significantChildNodes(commonAncestor),position=dom.findNodeIndex(ancestors[0]),wrapper=dom.create(commonAncestor.ownerDocument,tag,attributes);for(i=0;i<ancestors.length;i++)ancestor=ancestors[i],dom.isBlock(ancestor)?(dom.attr(ancestor,attributes),wrapper.childNodes.length&&(dom.insertBefore(wrapper,ancestor),wrapper=wrapper.cloneNode(!1)),position=dom.findNodeIndex(ancestor)+1):wrapper.appendChild(ancestor);wrapper.firstChild&&dom.insertAt(commonAncestor,wrapper,position)},apply:function(nodes){function attributes(format){return extend({},format&&format.attr,values)}var format,values=this.values,images=dom.filter("img",nodes),imageFormat=EditorUtils.formatByName("img",this.format),imageAttributes=attributes(imageFormat);if($.each(images,function(){dom.attr(this,imageAttributes)}),images.length!=nodes.length){var nonImages=dom.filter("img",nodes,!0),formatNodes=this.finder.findSuitable(nonImages);if(formatNodes.length)for(var i=0,len=formatNodes.length;i<len;i++)format=EditorUtils.formatByName(dom.name(formatNodes[i]),this.format),dom.attr(formatNodes[i],attributes(format));else format=this.format[0],this.wrap(format.tags[0],attributes(format),nonImages)}},remove:function(nodes){var i,l,formatNode,namedFormat,name;for(i=0,l=nodes.length;i<l;i++)formatNode=this.finder.findFormat(nodes[i]),formatNode&&(name=dom.name(formatNode),"div"!=name||formatNode.getAttribute("class")?(namedFormat=EditorUtils.formatByName(name,this.format),namedFormat.attr.style&&dom.unstyle(formatNode,namedFormat.attr.style),namedFormat.attr.className&&dom.removeClass(formatNode,namedFormat.attr.className)):dom.unwrap(formatNode))},toggle:function(range){var that=this,nodes=RangeUtils.nodes(range);that.finder.isFormatted(nodes)?that.remove(nodes):that.apply(nodes)}}),GreedyBlockFormatter=Class.extend({init:function(format,values){var that=this;that.format=format,that.values=values,that.finder=new BlockFormatFinder(format)},apply:function(nodes){var i,len,list,formatter,range,element,tagName,format=this.format,blocks=dom.blockParents(nodes),formatTag=format[0].tags[0];if(blocks.length)for(i=0,len=blocks.length;i<len;i++)tagName=dom.name(blocks[i]),"li"==tagName?(list=blocks[i].parentNode,formatter=new Editor.ListFormatter(list.nodeName.toLowerCase(),formatTag),range=this.editor.createRange(),range.selectNode(blocks[i]),formatter.toggle(range)):formatTag&&("td"==tagName||blocks[i].attributes.contentEditable)?new BlockFormatter(format,this.values).apply(blocks[i].childNodes):(element=dom.changeTag(blocks[i],formatTag),dom.attr(element,format[0].attr));else new BlockFormatter(format,this.values).apply(nodes)},toggle:function(range){var nodes=RangeUtils.textNodes(range);nodes.length||(range.selectNodeContents(range.commonAncestorContainer),nodes=RangeUtils.textNodes(range),nodes.length||(nodes=dom.significantChildNodes(range.commonAncestorContainer))),this.apply(nodes)}}),FormatCommand=Command.extend({init:function(options){options.formatter=options.formatter(),Command.fn.init.call(this,options)}}),BlockFormatTool=FormatTool.extend({init:function(options){FormatTool.fn.init.call(this,extend(options,{finder:new BlockFormatFinder(options.format),formatter:function(){return new BlockFormatter(options.format)}}))}});extend(Editor,{BlockFormatFinder:BlockFormatFinder,BlockFormatter:BlockFormatter,GreedyBlockFormatter:GreedyBlockFormatter,FormatCommand:FormatCommand,BlockFormatTool:BlockFormatTool}),registerFormat("justifyLeft",[{tags:dom.blockElements,attr:{style:{textAlign:"left",listStylePosition:""}}},{tags:["img"],attr:{style:{"float":"left",display:"",marginLeft:"",marginRight:""}}}]),registerTool("justifyLeft",new BlockFormatTool({format:formats.justifyLeft,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Justify Left"})})),registerFormat("justifyCenter",[{tags:dom.nonListBlockElements,attr:{style:{textAlign:"center"}}},{tags:["img"],attr:{style:{display:"block",marginLeft:"auto",marginRight:"auto","float":""}}},{tags:["ul","ol","li"],attr:{style:{textAlign:"center",listStylePosition:"inside"}}}]),registerTool("justifyCenter",new BlockFormatTool({format:formats.justifyCenter,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Justify Center"})})),registerFormat("justifyRight",[{tags:dom.nonListBlockElements,attr:{style:{textAlign:"right"}}},{tags:["img"],attr:{style:{"float":"right",display:"",marginLeft:"",marginRight:""}}},{tags:["ul","ol","li"],attr:{style:{textAlign:"right",listStylePosition:"inside"}}}]),registerTool("justifyRight",new BlockFormatTool({format:formats.justifyRight,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Justify Right"})})),registerFormat("justifyFull",[{tags:dom.blockElements,attr:{style:{textAlign:"justify",listStylePosition:""}}}]),registerTool("justifyFull",new BlockFormatTool({format:formats.justifyFull,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Justify Full"})}))}(window.kendo.jQuery),function($){var kendo=window.kendo,extend=$.extend,editorNS=kendo.ui.editor,dom=editorNS.Dom,Command=editorNS.Command,Tool=editorNS.Tool,BlockFormatter=editorNS.BlockFormatter,normalize=dom.normalize,RangeUtils=editorNS.RangeUtils,registerTool=editorNS.EditorUtils.registerTool,ParagraphCommand=Command.extend({
init:function(options){this.options=options,Command.fn.init.call(this,options)},_insertMarker:function(doc,range){var container,marker=dom.create(doc,"a");return marker.className="k-marker",range.insertNode(marker),marker.parentNode||(container=range.commonAncestorContainer,container.innerHTML="",container.appendChild(marker)),normalize(marker.parentNode),marker},_moveFocus:function(range,next){if(dom.is(next,"img"))range.setStartBefore(next);else{range.selectNodeContents(next);var textNode=RangeUtils.textNodes(range)[0];if(textNode)dom.is(textNode,"img")?range.setStartBefore(textNode):range.selectNodeContents(textNode);else{for(;next.childNodes.length&&!dom.is(next.firstChild,"br");)next=next.firstChild;range.selectNodeContents(next)}}},shouldTrim:function(range){var blocks="p,h1,h2,h3,h4,h5,h6".split(","),startInBlock=dom.parentOfType(range.startContainer,blocks),endInBlock=dom.parentOfType(range.endContainer,blocks);return startInBlock&&!endInBlock||!startInBlock&&endInBlock},_blankAfter:function(node){for(;node&&(dom.isMarker(node)||""===dom.stripBom(node.nodeValue));)node=node.nextSibling;return!node},exec:function(){var parent,previous,next,paragraph,marker,li,heading,rng,range=this.getRange(),doc=RangeUtils.documentFromRange(range),emptyParagraphContent=editorNS.emptyElementContent,shouldTrim=this.shouldTrim(range);range.deleteContents(),marker=this._insertMarker(doc,range),li=dom.closestEditableOfType(marker,["li"]),heading=dom.closestEditableOfType(marker,"h1,h2,h3,h4,h5,h6".split(",")),li?dom.emptyNode(li)&&(paragraph=dom.create(doc,"p"),li.nextSibling&&(rng=range.cloneRange(),rng.selectNode(li),RangeUtils.split(rng,li.parentNode)),dom.insertAfter(paragraph,li.parentNode),dom.remove(1==li.parentNode.childNodes.length?li.parentNode:li),paragraph.innerHTML=emptyParagraphContent,next=paragraph):heading&&this._blankAfter(marker)&&(paragraph=dom.create(doc,"p"),dom.insertAfter(paragraph,heading),paragraph.innerHTML=emptyParagraphContent,dom.remove(marker),next=paragraph),next||(li||heading||new BlockFormatter([{tags:["p"]}]).apply([marker]),range.selectNode(marker),parent=dom.parentOfType(marker,[li?"li":heading?dom.name(heading):"p"]),RangeUtils.split(range,parent,shouldTrim),previous=parent.previousSibling,dom.is(previous,"li")&&previous.firstChild&&!dom.is(previous.firstChild,"br")&&(previous=previous.firstChild),next=parent.nextSibling,dom.is(next,"li")&&next.firstChild&&!dom.is(next.firstChild,"br")&&(next=next.firstChild),dom.remove(parent),this.clean(previous),this.clean(next,{links:!0}),normalize(previous)),normalize(next),this._moveFocus(range,next),range.collapse(!0),dom.scrollTo(next),RangeUtils.selectRange(range)},clean:function(node,options){var root=node;if(node.firstChild&&dom.is(node.firstChild,"br")&&dom.remove(node.firstChild),dom.isDataNode(node)&&!node.nodeValue&&(node=node.parentNode),node){for(;node.firstChild&&1==node.firstChild.nodeType;)node=node.firstChild;if(!dom.isEmpty(node)&&/^\s*$/.test(node.innerHTML)&&(node.innerHTML=editorNS.emptyElementContent),options&&options.links)for(;node!=root;){if(dom.is(node,"a")&&dom.emptyNode(node)){dom.unwrap(node);break}node=node.parentNode}}}}),NewLineCommand=Command.extend({init:function(options){this.options=options,Command.fn.init.call(this,options)},exec:function(){var filler,range=this.getRange(),br=dom.create(RangeUtils.documentFromRange(range),"br");range.deleteContents(),range.insertNode(br),normalize(br.parentNode),kendo.support.browser.msie||br.nextSibling&&!dom.isWhitespace(br.nextSibling)||(filler=br.cloneNode(!0),filler.setAttribute("_moz_dirty",""),dom.insertAfter(filler,br)),range.setStartAfter(br),range.collapse(!0),dom.scrollTo(br.nextSibling||br),RangeUtils.selectRange(range)}});extend(editorNS,{ParagraphCommand:ParagraphCommand,NewLineCommand:NewLineCommand}),registerTool("insertLineBreak",new Tool({key:13,shift:!0,command:NewLineCommand})),registerTool("insertParagraph",new Tool({key:13,command:ParagraphCommand}))}(window.kendo.jQuery),function($){var kendo=window.kendo,Class=kendo.Class,extend=$.extend,Editor=kendo.ui.editor,dom=Editor.Dom,RangeUtils=Editor.RangeUtils,EditorUtils=Editor.EditorUtils,Command=Editor.Command,ToolTemplate=Editor.ToolTemplate,FormatTool=Editor.FormatTool,BlockFormatFinder=Editor.BlockFormatFinder,textNodes=RangeUtils.textNodes,registerTool=Editor.EditorUtils.registerTool,ListFormatFinder=BlockFormatFinder.extend({init:function(tag){this.tag=tag;var tags=this.tags=["ul"==tag?"ol":"ul",tag];BlockFormatFinder.fn.init.call(this,[{tags:tags}])},isFormatted:function(nodes){for(var formatNode,formatNodes=[],i=0;i<nodes.length;i++)(formatNode=this.findFormat(nodes[i]))&&dom.name(formatNode)==this.tag&&formatNodes.push(formatNode);if(formatNodes.length<1)return!1;if(formatNodes.length!=nodes.length)return!1;for(i=0;i<formatNodes.length&&formatNodes[i].parentNode==formatNode.parentNode;i++)if(formatNodes[i]!=formatNode)return!1;return!0},findSuitable:function(nodes){var candidate=dom.parentOfType(nodes[0],this.tags);return candidate&&dom.name(candidate)==this.tag?candidate:null}}),ListFormatter=Class.extend({init:function(tag,unwrapTag){var that=this;that.finder=new ListFormatFinder(tag),that.tag=tag,that.unwrapTag=unwrapTag},isList:function(node){var name=dom.name(node);return"ul"==name||"ol"==name||"dl"==name},wrap:function(list,nodes){var i,node,li=dom.create(list.ownerDocument,"li");for(i=0;i<nodes.length;i++)if(node=nodes[i],dom.is(node,"li"))list.appendChild(node);else if(this.isList(node))for(;node.firstChild;)list.appendChild(node.firstChild);else if(dom.is(node,"td")){for(;node.firstChild;)li.appendChild(node.firstChild);list.appendChild(li),node.appendChild(list),list=list.cloneNode(!1),li=li.cloneNode(!1)}else li.appendChild(node),dom.isBlock(node)&&(list.appendChild(li),dom.unwrap(node),li=li.cloneNode(!1));li.firstChild&&list.appendChild(li)},containsAny:function(parent,nodes){for(var i=0;i<nodes.length;i++)if(dom.isAncestorOrSelf(parent,nodes[i]))return!0;return!1},suitable:function(candidate,nodes){if("k-marker"==candidate.className){var sibling=candidate.nextSibling;if(sibling&&dom.isBlock(sibling))return!1;if(sibling=candidate.previousSibling,sibling&&dom.isBlock(sibling))return!1}return this.containsAny(candidate,nodes)||dom.isInline(candidate)||3==candidate.nodeType},split:function(range){var start,end,nodes=textNodes(range);if(nodes.length){start=dom.parentOfType(nodes[0],["li"]),end=dom.parentOfType(nodes[nodes.length-1],["li"]),range.setStartBefore(start),range.setEndAfter(end);for(var i=0,l=nodes.length;i<l;i++){var formatNode=this.finder.findFormat(nodes[i]);if(formatNode){var parents=$(formatNode).parents("ul,ol");parents[0]?RangeUtils.split(range,parents.last()[0],!0):RangeUtils.split(range,formatNode,!0)}}}},merge:function(tag,formatNode){for(var next,prev=formatNode.previousSibling;prev&&("k-marker"==prev.className||3==prev.nodeType&&dom.isWhitespace(prev));)prev=prev.previousSibling;if(prev&&dom.name(prev)==tag){for(;formatNode.firstChild;)prev.appendChild(formatNode.firstChild);dom.remove(formatNode),formatNode=prev}for(next=formatNode.nextSibling;next&&("k-marker"==next.className||3==next.nodeType&&dom.isWhitespace(next));)next=next.nextSibling;if(next&&dom.name(next)==tag){for(;formatNode.lastChild;)next.insertBefore(formatNode.lastChild,next.firstChild);dom.remove(formatNode)}},breakable:function(node){return node!=node.ownerDocument.body&&!/table|tbody|tr|td/.test(dom.name(node))&&!node.attributes.contentEditable},applyOnSection:function(section,nodes){function pushAncestor(){ancestors.push(this)}var tag=this.tag,commonAncestor=dom.closestSplittableParent(nodes),ancestors=[],formatNode=this.finder.findSuitable(nodes);formatNode||(formatNode=new ListFormatFinder("ul"==tag?"ol":"ul").findSuitable(nodes));var childNodes;/table|tbody/.test(dom.name(commonAncestor))?childNodes=$.map(nodes,function(node){return dom.parentOfType(node,["td"])}):(childNodes=dom.significantChildNodes(commonAncestor),$.grep(childNodes,dom.isBlock).length&&(childNodes=$.grep(childNodes,$.proxy(function(node){return this.containsAny(node,nodes)},this))),childNodes.length||(childNodes=nodes));for(var i=0;i<childNodes.length;i++){var child=childNodes[i],suitable=(!formatNode||!dom.isAncestorOrSelf(formatNode,child))&&this.suitable(child,nodes);suitable&&(formatNode&&this.isList(child)?($.each(child.childNodes,pushAncestor),dom.remove(child)):ancestors.push(child))}ancestors.length==childNodes.length&&this.breakable(commonAncestor)&&(ancestors=[commonAncestor]),formatNode||(formatNode=dom.create(commonAncestor.ownerDocument,tag),dom.insertBefore(formatNode,ancestors[0])),this.wrap(formatNode,ancestors),dom.is(formatNode,tag)||dom.changeTag(formatNode,tag),this.merge(tag,formatNode)},apply:function(nodes){var lastSection,lastNodes,section,i=0,sections=[];do section=dom.closestEditable(nodes[i],["td","body"]),lastSection&&section==lastSection?lastNodes.push(nodes[i]):(lastSection&&sections.push({section:lastSection,nodes:lastNodes}),lastNodes=[nodes[i]],lastSection=section),i++;while(i<nodes.length);for(sections.push({section:lastSection,nodes:lastNodes}),i=0;i<sections.length;i++)this.applyOnSection(sections[i].section,sections[i].nodes)},unwrap:function(ul){var parents,li,p,child,fragment=ul.ownerDocument.createDocumentFragment(),unwrapTag=this.unwrapTag;for(li=ul.firstChild;li;li=li.nextSibling){for(p=dom.create(ul.ownerDocument,unwrapTag||"p");li.firstChild;)child=li.firstChild,dom.isBlock(child)?(p.firstChild&&(fragment.appendChild(p),p=dom.create(ul.ownerDocument,unwrapTag||"p")),fragment.appendChild(child)):p.appendChild(child);p.firstChild&&fragment.appendChild(p)}parents=$(ul).parents("ul,ol"),parents[0]?(dom.insertAfter(fragment,parents.last()[0]),parents.last().remove()):dom.insertAfter(fragment,ul),dom.remove(ul)},remove:function(nodes){for(var formatNode,i=0,l=nodes.length;i<l;i++)formatNode=this.finder.findFormat(nodes[i]),formatNode&&this.unwrap(formatNode)},toggle:function(range){var that=this,nodes=textNodes(range),ancestor=range.commonAncestorContainer;if(!nodes.length&&(range.selectNodeContents(ancestor),nodes=textNodes(range),!nodes.length)){var text=ancestor.ownerDocument.createTextNode("");range.startContainer.appendChild(text),nodes=[text],range.selectNode(text.parentNode)}that.finder.isFormatted(nodes)?(that.split(range),that.remove(nodes)):that.apply(nodes)}}),ListCommand=Command.extend({init:function(options){options.formatter=new ListFormatter(options.tag),Command.fn.init.call(this,options)}}),ListTool=FormatTool.extend({init:function(options){this.options=options,FormatTool.fn.init.call(this,extend(options,{finder:new ListFormatFinder(options.tag)}))},command:function(commandArguments){return new ListCommand(extend(commandArguments,{tag:this.options.tag}))}});extend(Editor,{ListFormatFinder:ListFormatFinder,ListFormatter:ListFormatter,ListCommand:ListCommand,ListTool:ListTool}),registerTool("insertUnorderedList",new ListTool({tag:"ul",template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Insert unordered list"})})),registerTool("insertOrderedList",new ListTool({tag:"ol",template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Insert ordered list"})}))}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,Class=kendo.Class,extend=$.extend,proxy=$.proxy,Editor=kendo.ui.editor,dom=Editor.Dom,RangeUtils=Editor.RangeUtils,EditorUtils=Editor.EditorUtils,Command=Editor.Command,Tool=Editor.Tool,ToolTemplate=Editor.ToolTemplate,InlineFormatter=Editor.InlineFormatter,InlineFormatFinder=Editor.InlineFormatFinder,textNodes=RangeUtils.textNodes,registerTool=Editor.EditorUtils.registerTool,LinkFormatFinder=Class.extend({findSuitable:function(sourceNode){return dom.parentOfType(sourceNode,["a"])}}),LinkFormatter=Class.extend({init:function(){this.finder=new LinkFormatFinder},apply:function(range,attributes){var markers,doc,formatter,a,nodes=textNodes(range);attributes.innerHTML?(markers=RangeUtils.getMarkers(range),doc=RangeUtils.documentFromRange(range),range.deleteContents(),a=dom.create(doc,"a",attributes),range.insertNode(a),"a"==dom.name(a.parentNode)&&dom.insertAfter(a,a.parentNode),markers.length>1&&(dom.insertAfter(markers[markers.length-1],a),dom.insertAfter(markers[1],a),dom[nodes.length>0?"insertBefore":"insertAfter"](markers[0],a))):(formatter=new InlineFormatter([{tags:["a"]}],attributes),formatter.finder=this.finder,formatter.apply(nodes))}}),UnlinkCommand=Command.extend({init:function(options){options.formatter={toggle:function(range){new InlineFormatter([{tags:["a"]}]).remove(textNodes(range))}},this.options=options,Command.fn.init.call(this,options)}}),LinkCommand=Command.extend({init:function(options){var cmd=this;cmd.options=options,Command.fn.init.call(cmd,options),cmd.formatter=new LinkFormatter,options.url?this.exec=function(){this.formatter.apply(options.range,{href:options.url,innerHTML:options.text||options.url,target:options.target})}:(cmd.attributes=null,cmd.async=!0)},_dialogTemplate:function(){return kendo.template("<div class=\"k-editor-dialog k-popup-edit-form k-edit-form-container\"><div class='k-edit-label'><label for='k-editor-link-url'>#: messages.linkWebAddress #</label></div><div class='k-edit-field'><input type='text' class='k-input k-textbox' id='k-editor-link-url'></div><div class='k-edit-label k-editor-link-text-row'><label for='k-editor-link-text'>#: messages.linkText #</label></div><div class='k-edit-field k-editor-link-text-row'><input type='text' class='k-input k-textbox' id='k-editor-link-text'></div><div class='k-edit-label'><label for='k-editor-link-title'>#: messages.linkToolTip #</label></div><div class='k-edit-field'><input type='text' class='k-input k-textbox' id='k-editor-link-title'></div><div class='k-edit-label'></div><div class='k-edit-field'><input type='checkbox' class='k-checkbox' id='k-editor-link-target'><label for='k-editor-link-target'>#: messages.linkOpenInNewWindow #</label></div><div class='k-edit-buttons k-state-default'><button class=\"k-dialog-insert k-button k-primary\">#: messages.dialogInsert #</button><button class=\"k-dialog-close k-button\">#: messages.dialogCancel #</button></div></div>")({messages:this.editor.options.messages})},exec:function(){var collapsed=this.getRange().collapsed,messages=this.editor.options.messages;this._initialText="",this._range=this.lockRange(!0);var nodes=textNodes(this._range),a=nodes.length?this.formatter.finder.findSuitable(nodes[0]):null,img=nodes.length&&"img"==dom.name(nodes[0]),dialog=this.createDialog(this._dialogTemplate(),{title:messages.createLink,close:proxy(this._close,this),visible:!1});dialog.find(".k-dialog-insert").click(proxy(this._apply,this)).end().find(".k-dialog-close").click(proxy(this._close,this)).end().find(".k-edit-field input").keydown(proxy(this._keydown,this)).end().find("#k-editor-link-url").val(this.linkUrl(a)).end().find("#k-editor-link-text").val(this.linkText(nodes)).end().find("#k-editor-link-title").val(a?a.title:"").end().find("#k-editor-link-target").attr("checked",!!a&&"_blank"==a.target).end().find(".k-editor-link-text-row").toggle(!img),nodes.length>0&&!collapsed&&(this._initialText=$("#k-editor-link-text",dialog).val()),this._dialog=dialog.data("kendoWindow").center().open(),$("#k-editor-link-url",dialog).focus().select()},_keydown:function(e){var keys=kendo.keys;e.keyCode==keys.ENTER?this._apply(e):e.keyCode==keys.ESC&&this._close(e)},_apply:function(e){var title,text,target,element=this._dialog.element,href=$("#k-editor-link-url",element).val(),textInput=$("#k-editor-link-text",element);href&&"http://"!=href&&(href.indexOf("@")>0&&!/^(\w+:)|(\/\/)/i.test(href)&&(href="mailto:"+href),this.attributes={href:href},title=$("#k-editor-link-title",element).val(),title&&(this.attributes.title=title),textInput.is(":visible")&&(text=textInput.val(),text||this._initialText?text&&text!==this._initialText&&(this.attributes.innerHTML=dom.stripBom(text)):this.attributes.innerHTML=href),target=$("#k-editor-link-target",element).is(":checked"),this.attributes.target=target?"_blank":null,this.formatter.apply(this._range,this.attributes)),this._close(e),this.change&&this.change()},_close:function(e){e.preventDefault(),this._dialog.destroy(),dom.windowFromDocument(RangeUtils.documentFromRange(this._range)).focus(),this.releaseRange(this._range)},linkUrl:function(anchor){return anchor?anchor.getAttribute("href",2):"http://"},linkText:function(nodes){var text="";return 1==nodes.length?text=nodes[0].nodeValue:nodes.length&&(text=nodes[0].nodeValue+nodes[1].nodeValue),dom.stripBom(text||"")},redo:function(){var range=this.lockRange(!0);this.formatter.apply(range,this.attributes),this.releaseRange(range)}}),UnlinkTool=Tool.extend({init:function(options){this.options=options,this.finder=new InlineFormatFinder([{tags:["a"]}]),Tool.fn.init.call(this,$.extend(options,{command:UnlinkCommand}))},initialize:function(ui,options){Tool.fn.initialize.call(this,ui,options),ui.addClass("k-state-disabled")},update:function(ui,nodes){ui.toggleClass("k-state-disabled",!this.finder.isFormatted(nodes)).removeClass("k-state-hover")}});extend(kendo.ui.editor,{LinkFormatFinder:LinkFormatFinder,LinkFormatter:LinkFormatter,UnlinkCommand:UnlinkCommand,LinkCommand:LinkCommand,UnlinkTool:UnlinkTool}),registerTool("createLink",new Tool({key:"K",ctrl:!0,command:LinkCommand,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Create Link"})})),registerTool("unlink",new UnlinkTool({key:"K",ctrl:!0,shift:!0,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Remove Link"})}))}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,extend=$.extend,Editor=kendo.ui.editor,EditorUtils=Editor.EditorUtils,dom=Editor.Dom,registerTool=EditorUtils.registerTool,ToolTemplate=Editor.ToolTemplate,RangeUtils=Editor.RangeUtils,Command=Editor.Command,keys=kendo.keys,KEDITORIMAGEURL="#k-editor-image-url",KEDITORIMAGETITLE="#k-editor-image-title",KEDITORIMAGEWIDTH="#k-editor-image-width",KEDITORIMAGEHEIGHT="#k-editor-image-height",ImageCommand=Command.extend({init:function(options){var that=this;Command.fn.init.call(that,options),that.async=!0,that.attributes={}},insertImage:function(img,range){var attributes=this.attributes,doc=RangeUtils.documentFromRange(range);if(attributes.src&&"http://"!=attributes.src){var removeIEAttributes=function(){setTimeout(function(){attributes.width||img.removeAttribute("width"),attributes.height||img.removeAttribute("height"),img.removeAttribute("complete")})};if(!img)return img=dom.create(doc,"img",attributes),img.onload=img.onerror=function(){removeIEAttributes()},range.deleteContents(),range.insertNode(img),img.nextSibling||dom.insertAfter(doc.createTextNode("\ufeff"),img),removeIEAttributes(),range.setStartAfter(img),range.setEndAfter(img),RangeUtils.selectRange(range),!0;dom.attr(img,attributes),removeIEAttributes()}return!1},_dialogTemplate:function(showBrowser){return kendo.template('<div class="k-editor-dialog k-popup-edit-form k-edit-form-container"># if (showBrowser) { #<div class="k-imagebrowser"></div># } #<div class=\'k-edit-label\'><label for="k-editor-image-url">#: messages.imageWebAddress #</label></div><div class=\'k-edit-field\'><input type="text" class="k-input k-textbox" id="k-editor-image-url"></div><div class=\'k-edit-label\'><label for="k-editor-image-title">#: messages.imageAltText #</label></div><div class=\'k-edit-field\'><input type="text" class="k-input k-textbox" id="k-editor-image-title"></div><div class=\'k-edit-label\'><label for="k-editor-image-width">#: messages.imageWidth #</label></div><div class=\'k-edit-field\'><input type="text" class="k-input k-textbox" id="k-editor-image-width"></div><div class=\'k-edit-label\'><label for="k-editor-image-height">#: messages.imageHeight #</label></div><div class=\'k-edit-field\'><input type="text" class="k-input k-textbox" id="k-editor-image-height"></div><div class="k-edit-buttons k-state-default"><button class="k-dialog-insert k-button k-primary">#: messages.dialogInsert #</button><button class="k-dialog-close k-button">#: messages.dialogCancel #</button></div></div>')({messages:this.editor.options.messages,showBrowser:showBrowser})},redo:function(){var that=this,range=that.lockRange();that.insertImage(RangeUtils.image(range),range)||that.releaseRange(range)},exec:function(){function apply(e){var element=dialog.element,w=parseInt(element.find(KEDITORIMAGEWIDTH).val(),10),h=parseInt(element.find(KEDITORIMAGEHEIGHT).val(),10);that.attributes={src:element.find(KEDITORIMAGEURL).val().replace(/ /g,"%20"),alt:element.find(KEDITORIMAGETITLE).val()},that.attributes.width=null,that.attributes.height=null,!isNaN(w)&&w>0&&(that.attributes.width=w),!isNaN(h)&&h>0&&(that.attributes.height=h),applied=that.insertImage(img,range),close(e),that.change&&that.change()}function close(e){e.preventDefault(),dialog.destroy(),dom.windowFromDocument(RangeUtils.documentFromRange(range)).focus(),applied||that.releaseRange(range)}function keyDown(e){e.keyCode==keys.ENTER?apply(e):e.keyCode==keys.ESC&&close(e)}var dialog,that=this,range=that.lockRange(),applied=!1,img=RangeUtils.image(range),imageWidth=img&&img.getAttribute("width")||"",imageHeight=img&&img.getAttribute("height")||"",options=that.editor.options,messages=options.messages,imageBrowser=options.imageBrowser,showBrowser=!!(kendo.ui.ImageBrowser&&imageBrowser&&imageBrowser.transport&&imageBrowser.transport.read!==undefined);dialog=this.createDialog(that._dialogTemplate(showBrowser),{title:messages.insertImage,close:close,visible:!1,resizable:showBrowser}).toggleClass("k-imagebrowser-dialog",showBrowser).find(".k-dialog-insert").click(apply).end().find(".k-dialog-close").click(close).end().find(".k-edit-field input").keydown(keyDown).end().find(KEDITORIMAGEURL).val(img?img.getAttribute("src",2):"http://").end().find(KEDITORIMAGETITLE).val(img?img.alt:"").end().find(KEDITORIMAGEWIDTH).val(imageWidth).end().find(KEDITORIMAGEHEIGHT).val(imageHeight).end().data("kendoWindow"),showBrowser&&new kendo.ui.ImageBrowser(dialog.element.find(".k-imagebrowser"),extend({},imageBrowser,{change:function(){dialog.element.find(KEDITORIMAGEURL).val(this.value())},apply:apply})),dialog.center().open(),dialog.element.find(KEDITORIMAGEURL).focus().select()}});kendo.ui.editor.ImageCommand=ImageCommand,registerTool("insertImage",new Editor.Tool({command:ImageCommand,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Insert Image"})}))}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,DropDownList=kendo.ui.DropDownList,dom=kendo.ui.editor.Dom,SelectBox=DropDownList.extend({init:function(element,options){var that=this;DropDownList.fn.init.call(that,element,options),that.value(that.options.title),kendo.support.mobileOS.ios&&that._initSelectOverlay(),that.bind("open",function(){if(that.options.autoSize){var listWidth,list=that.list;list.css({whiteSpace:"nowrap",width:"auto"}),listWidth=list.width(),listWidth?listWidth+=20:listWidth=that._listWidth,list.css("width",listWidth+kendo.support.scrollbar()),that._listWidth=listWidth}})},options:{name:"SelectBox"},_initSelectOverlay:function(){var element=$(this.element),select=$("<select class='k-select-overlay' />"),wrapper=element.closest(".k-widget"),selectBox=this;select.on("change",function(){selectBox.value(this.value),selectBox.trigger("change")}),this.bind("dataBound",function(){for(var item,value=selectBox.value(),view=this.dataSource.view(),html="",i=0;i<view.length;i++)item=view[i],html+="<option value='"+item.value+"'",item.value==value&&(html+=" selected"),html+=">"+item.text+"</option>";select.html(html)}),select.insertAfter(wrapper)},value:function(value){var that=this,result=DropDownList.fn.value.call(that,value);return value===undefined?result:void(value!==DropDownList.fn.value.call(that)&&(that.text(that.options.title),that._current&&that._current.removeClass("k-state-selected"),that.current(null),that._oldIndex=that.selectedIndex=-1))},decorate:function(body){var i,tag,className,style,that=this,dataSource=that.dataSource,items=dataSource.data();for(body&&that.list.css("background-color",dom.getEffectiveBackground($(body))),i=0;i<items.length;i++)tag=items[i].tag||"span",className=items[i].className,style=dom.inlineStyle(body,tag,{className:className}),style=style.replace(/"/g,"'"),items[i].style=style+";display:inline-block";dataSource.trigger("change")}});kendo.ui.plugin(SelectBox),kendo.ui.editor.SelectBox=SelectBox}(window.kendo.jQuery),function($,undefined){function indent(node,value){var isRtl="rtl"==$(node).css("direction"),indentDirection=isRtl?"Right":"Left",property="td"!=dom.name(node)?"margin"+indentDirection:"padding"+indentDirection;return value===undefined?node.style[property]||0:void(value>0?node.style[property]=value+"px":(node.style[property]="",node.style.cssText||node.removeAttribute("style")))}var kendo=window.kendo,Class=kendo.Class,extend=$.extend,Editor=kendo.ui.editor,dom=Editor.Dom,EditorUtils=Editor.EditorUtils,registerTool=EditorUtils.registerTool,Command=Editor.Command,Tool=Editor.Tool,ToolTemplate=Editor.ToolTemplate,RangeUtils=Editor.RangeUtils,blockElements=dom.blockElements,BlockFormatFinder=Editor.BlockFormatFinder,BlockFormatter=Editor.BlockFormatter,IndentFormatter=Class.extend({init:function(){this.finder=new BlockFormatFinder([{tags:dom.blockElements}])},apply:function(nodes){var i,len,formatNode,parentList,sibling,formatNodes=this.finder.findSuitable(nodes),targets=[];if(formatNodes.length){for(i=0,len=formatNodes.length;i<len;i++)dom.is(formatNodes[i],"li")?$(formatNodes[i]).index()?$.inArray(formatNodes[i].parentNode,targets)<0&&targets.push(formatNodes[i]):targets.push(formatNodes[i].parentNode):targets.push(formatNodes[i]);for(;targets.length;)if(formatNode=targets.shift(),dom.is(formatNode,"li")){parentList=formatNode.parentNode,sibling=$(formatNode).prev("li");var siblingList=sibling.find("ul,ol").last(),nestedList=$(formatNode).children("ul,ol")[0];if(nestedList&&sibling[0])siblingList[0]?(siblingList.append(formatNode),siblingList.append($(nestedList).children()),dom.remove(nestedList)):(sibling.append(nestedList),nestedList.insertBefore(formatNode,nestedList.firstChild));else for(nestedList=sibling.children("ul,ol")[0],nestedList||(nestedList=dom.create(formatNode.ownerDocument,dom.name(parentList)),sibling.append(nestedList));formatNode&&formatNode.parentNode==parentList;)nestedList.appendChild(formatNode),formatNode=targets.shift()}else{var marginLeft=parseInt(indent(formatNode),10)+30;indent(formatNode,marginLeft);for(var targetIndex=0;targetIndex<targets.length;targetIndex++)$.contains(formatNode,targets[targetIndex])&&targets.splice(targetIndex,1)}}else{var formatter=new BlockFormatter([{tags:["p"]}],{style:{marginLeft:30}});formatter.apply(nodes)}},remove:function(nodes){var targetNode,i,len,list,listParent,siblings,formatNode,marginLeft,formatNodes=this.finder.findSuitable(nodes);for(i=0,len=formatNodes.length;i<len;i++){if(formatNode=$(formatNodes[i]),formatNode.is("li")){if(list=formatNode.parent(),listParent=list.parent(),listParent.is("li,ul,ol")&&!indent(list[0])){if(targetNode&&$.contains(targetNode,listParent[0]))continue;siblings=formatNode.nextAll("li"),siblings.length&&$(list[0].cloneNode(!1)).appendTo(formatNode).append(siblings),listParent.is("li")?formatNode.insertAfter(listParent):formatNode.appendTo(listParent),list.children("li").length||list.remove();continue}if(targetNode==list[0])continue;targetNode=list[0]}else targetNode=formatNodes[i];marginLeft=parseInt(indent(targetNode),10)-30,indent(targetNode,marginLeft)}}}),IndentCommand=Command.extend({init:function(options){options.formatter={toggle:function(range){(new IndentFormatter).apply(RangeUtils.nodes(range))}},Command.fn.init.call(this,options)}}),OutdentCommand=Command.extend({init:function(options){options.formatter={toggle:function(range){(new IndentFormatter).remove(RangeUtils.nodes(range))}},Command.fn.init.call(this,options)}}),OutdentTool=Tool.extend({init:function(options){Tool.fn.init.call(this,options),this.finder=new BlockFormatFinder([{tags:blockElements}])},initialize:function(ui,options){Tool.fn.initialize.call(this,ui,options),ui.addClass("k-state-disabled")},update:function(ui,nodes){var isOutdentable,listParentsCount,i,len,suitable=this.finder.findSuitable(nodes);for(i=0,len=suitable.length;i<len;i++)if(isOutdentable=indent(suitable[i]),isOutdentable||(listParentsCount=$(suitable[i]).parents("ul,ol").length,isOutdentable=dom.is(suitable[i],"li")&&(listParentsCount>1||indent(suitable[i].parentNode))||dom.ofType(suitable[i],["ul","ol"])&&listParentsCount>0),isOutdentable)return void ui.removeClass("k-state-disabled");ui.addClass("k-state-disabled").removeClass("k-state-hover")}});extend(Editor,{IndentFormatter:IndentFormatter,IndentCommand:IndentCommand,OutdentCommand:OutdentCommand,OutdentTool:OutdentTool}),registerTool("indent",new Tool({command:IndentCommand,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Indent"})})),registerTool("outdent",new OutdentTool({command:OutdentCommand,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Outdent"})}))}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,extend=$.extend,Editor=kendo.ui.editor,EditorUtils=Editor.EditorUtils,Command=Editor.Command,Tool=Editor.Tool,ToolTemplate=Editor.ToolTemplate,ViewHtmlCommand=Command.extend({init:function(options){var cmd=this;cmd.options=options,Command.fn.init.call(cmd,options),cmd.attributes=null,cmd.async=!0},exec:function(){function apply(e){editor.value(dialog.find(textarea).val()),close(e),that.change&&that.change(),editor.trigger("change")}function close(e){e.preventDefault(),dialog.data("kendoWindow").destroy(),editor.focus()}var that=this,editor=that.editor,messages=editor.options.messages,dialog=$(kendo.template(ViewHtmlCommand.template)(messages)).appendTo(document.body),content=ViewHtmlCommand.indent(editor.value()),textarea=".k-editor-textarea";this.createDialog(dialog,{title:messages.viewHtml,close:close,visible:!1}).find(textarea).val(content).end().find(".k-dialog-update").click(apply).end().find(".k-dialog-close").click(close).end().data("kendoWindow").center().open(),dialog.find(textarea).focus()}});extend(ViewHtmlCommand,{template:"<div class='k-editor-dialog k-popup-edit-form k-edit-form-container k-viewhtml-dialog'><textarea class='k-editor-textarea k-input'></textarea><div class='k-edit-buttons k-state-default'><button class='k-dialog-update k-button k-primary'>#: dialogUpdate #</button><button class='k-dialog-close k-button'>#: dialogCancel #</button></div></div>",indent:function(content){return content.replace(/<\/(p|li|ul|ol|h[1-6]|table|tr|td|th)>/gi,"</$1>\n").replace(/<(ul|ol)([^>]*)><li/gi,"<$1$2>\n<li").replace(/<br \/>/gi,"<br />\n").replace(/\n$/,"")}}),kendo.ui.editor.ViewHtmlCommand=ViewHtmlCommand,Editor.EditorUtils.registerTool("viewHtml",new Tool({command:ViewHtmlCommand,template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"View HTML"})}))}(window.kendo.jQuery),function($){function deprecatedFormattingTool(name,property,finder){return FormattingTool.extend({init:function(options){FormattingTool.fn.init.call(this,options),this.finder=finder},command:function(args){var item=args.value;return $.isPlainObject(item)?item[property]=item.value:(args.value={},args.value[property]=item),FormattingTool.fn.command.call(this,args)},initialize:function(ui,initOptions){var i,console=window.console,items=this.options.items;for(i=0;i<items.length;i++)items[i][property]=items[i].value;console&&console.warn("The `"+this.options.name+"` tool has been deprecated in favor of the `formatting` tool. See http://docs.telerik.com/kendo-ui/getting-started/changes-and-backward-compatibility for more information"),FormattingTool.fn.initialize.call(this,ui,initOptions)}})}var kendo=window.kendo,Editor=kendo.ui.editor,Tool=Editor.Tool,ToolTemplate=Editor.ToolTemplate,DelayedExecutionTool=Editor.DelayedExecutionTool,dom=Editor.Dom,dropDownListTemplate=Editor.EditorUtils.dropDownListTemplate,registerTool=Editor.EditorUtils.registerTool,FormattingTool=DelayedExecutionTool.extend({
init:function(options){var that=this;Tool.fn.init.call(that,kendo.deepExtend({},that.options,options)),that.type="kendoSelectBox",that.finder={getFormat:function(){return""}}},options:{items:[{text:"Paragraph",value:"p"},{text:"Quotation",value:"blockquote"},{text:"Heading 1",value:"h1"},{text:"Heading 2",value:"h2"},{text:"Heading 3",value:"h3"},{text:"Heading 4",value:"h4"},{text:"Heading 5",value:"h5"},{text:"Heading 6",value:"h6"}],width:90},toFormattingItem:function(item){var value=item.value;if(!value)return item;if(item.tag||item.className)return item;var dot=value.indexOf(".");return 0===dot?item.className=value.substring(1):dot==-1?item.tag=value:(item.tag=value.substring(0,dot),item.className=value.substring(dot+1)),item},command:function(args){var item=args.value;return item=this.toFormattingItem(item),new Editor.FormatCommand({range:args.range,formatter:function(){var formatter,tags=(item.tag||item.context||"span").split(","),format=[{tags:tags,attr:{className:item.className||""}}];return formatter=$.inArray(tags[0],dom.inlineElements)>=0?new Editor.GreedyInlineFormatter(format):new Editor.GreedyBlockFormatter(format)}})},initialize:function(ui,initOptions){var editor=initOptions.editor,options=this.options,toolName=options.name,that=this;ui.width(options.width),ui.kendoSelectBox({dataTextField:"text",dataValueField:"value",dataSource:options.items||editor.options[toolName],title:editor.options.messages[toolName],autoSize:!0,change:function(){Tool.exec(editor,toolName,this.dataItem().toJSON())},dataBound:function(){var i,items=this.dataSource.data();for(i=0;i<items.length;i++)items[i]=that.toFormattingItem(items[i])},highlightFirst:!1,template:kendo.template('<span unselectable="on" style="display:block;#=(data.style||"")#">#:data.text#</span>')}),ui.addClass("k-decorated").closest(".k-widget").removeClass("k-"+toolName).find("*").addBack().attr("unselectable","on")},getFormattingValue:function(items,nodes){for(var i=0;i<items.length;i++){var item=items[i],tag=item.tag||item.context||"",className=item.className?"."+item.className:"",selector=tag+className,element=$(nodes[0]).closest(selector)[0];if(element){if(1==nodes.length)return item.value;for(var n=1;n<nodes.length&&$(nodes[n]).closest(selector)[0];n++)if(n==nodes.length-1)return item.value}}return""},update:function(ui,nodes){var selectBox=$(ui).data(this.type);if(selectBox){var i,context,dataSource=selectBox.dataSource,items=dataSource.data(),ancestor=dom.commonAncestor.apply(null,nodes);for(i=0;i<items.length;i++)context=items[i].context,items[i].visible=!context||!!$(ancestor).closest(context).length;dataSource.filter([{field:"visible",operator:"eq",value:!0}]),DelayedExecutionTool.fn.update.call(this,ui,nodes),selectBox.value(this.getFormattingValue(dataSource.view(),nodes)),selectBox.wrapper.toggleClass("k-state-disabled",!dataSource.view().length)}}}),StyleTool=deprecatedFormattingTool("style","className",new Editor.GreedyInlineFormatFinder([{tags:["span"]}],"className")),FormatBlockTool=deprecatedFormattingTool("formatBlock","tag",new Editor.BlockFormatFinder([{tags:dom.blockElements}]));$.extend(Editor,{FormattingTool:FormattingTool,StyleTool:StyleTool,FormatBlockTool:FormatBlockTool}),registerTool("formatting",new FormattingTool({template:new ToolTemplate({template:dropDownListTemplate,title:"Format"})})),registerTool("style",new StyleTool({template:new ToolTemplate({template:dropDownListTemplate,title:"Styles"})})),registerTool("formatBlock",new FormatBlockTool({template:new ToolTemplate({template:dropDownListTemplate})}))}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,ui=kendo.ui,editorNS=ui.editor,Widget=ui.Widget,extend=$.extend,proxy=$.proxy,keys=kendo.keys,NS=".kendoEditor",focusable="a.k-tool:not(.k-state-disabled),.k-widget.k-colorpicker,.k-selectbox,.k-dropdown,.k-combobox .k-input",Toolbar=Widget.extend({init:function(element,options){var that=this;options=extend({},options,{name:"EditorToolbar"}),Widget.fn.init.call(that,element,options),options.popup&&that._initPopup()},events:["execute"],groups:{basic:["bold","italic","underline","strikethrough"],scripts:["subscript","superscript"],alignment:["justifyLeft","justifyCenter","justifyRight","justifyFull"],links:["insertImage","createLink","unlink"],lists:["insertUnorderedList","insertOrderedList","indent","outdent"],tables:["createTable","addColumnLeft","addColumnRight","addRowAbove","addRowBelow","deleteRow","deleteColumn"],advanced:["viewHtml"]},_initPopup:function(){this.window=$(this.element).wrap("<div class='editorToolbarWindow k-header' />").parent().prepend("<button class='k-button k-button-bare k-editortoolbar-dragHandle'><span class='k-icon k-i-move' /></button>").kendoWindow({title:!1,resizable:!1,draggable:{dragHandle:".k-editortoolbar-dragHandle"},animation:{open:{effects:"fade:in"},close:{effects:"fade:out"}},minHeight:42,visible:!1,autoFocus:!1,actions:[],dragend:function(){this._moved=!0}}).on("mousedown",function(e){$(e.target).is(".k-icon")||e.preventDefault()}).data("kendoWindow")},items:function(){return this.element.children().find("> *, select")},focused:function(){return this.element.find(".k-state-focused").length>0},toolById:function(name){var id,tools=this.tools;for(id in tools)if(id.toLowerCase()==name)return tools[id]},toolGroupFor:function(toolName){var i,groups=this.groups;if(this.isCustomTool(toolName))return"custom";for(i in groups)if($.inArray(toolName,groups[i])>=0)return i},bindTo:function(editor){var that=this,window=that.window;that._editor&&that._editor.unbind("select",proxy(that._updateTool,that)),that._editor=editor,that.tools=that.expandTools(editor.options.tools),that.render(),that.element.find(".k-combobox .k-input").keydown(function(e){var combobox=$(this).closest(".k-combobox").data("kendoComboBox"),key=e.keyCode;key==keys.RIGHT||key==keys.LEFT?combobox.close():key==keys.DOWN&&(combobox.dropDown.isOpened()||(e.stopImmediatePropagation(),combobox.open()))}),that._attachEvents(),that.items().each(function(){var toolName=that._toolName(this),tool=that.tools[toolName],options=tool&&tool.options,messages=editor.options.messages,description=options&&options.tooltip||messages[toolName],ui=$(this);if(tool&&tool.initialize){if("fontSize"==toolName||"fontName"==toolName){var inheritText=messages[toolName+"Inherit"];ui.find("input").val(inheritText).end().find("span.k-input").text(inheritText).end()}tool.initialize(ui,{title:that._appendShortcutSequence(description,tool),editor:that._editor}),ui.closest(".k-widget",that.element).addClass("k-editor-widget"),ui.closest(".k-colorpicker",that.element).next(".k-colorpicker").addClass("k-editor-widget")}}),editor.bind("select",proxy(that._updateTool,that)),that.update(),window&&window.wrapper.css({top:"",left:"",width:""})},show:function(){var wrapper,editorElement,that=this,window=that.window,editorOptions=that.options.editor;window&&(wrapper=window.wrapper,editorElement=editorOptions.element,wrapper.is(":visible")&&that.window.options.visible||(wrapper[0].style.width||wrapper.width(editorElement.outerWidth()-parseInt(wrapper.css("border-left-width"),10)-parseInt(wrapper.css("border-right-width"),10)),window._moved||(wrapper.css("top",parseInt(editorElement.offset().top,10)-wrapper.outerHeight()-parseInt(that.window.element.css("padding-bottom"),10)),wrapper.css("left",parseInt(editorElement.offset().left,10))),window.open()))},hide:function(){this.window&&this.window.close()},focus:function(){var TABINDEX="tabIndex",element=this.element,tabIndex=this._editor.element.attr(TABINDEX);element.attr(TABINDEX,tabIndex||0).focus().find(focusable).first().focus(),tabIndex||0===tabIndex||element.removeAttr(TABINDEX)},_appendShortcutSequence:function(localizedText,tool){if(!tool.key)return localizedText;var res=localizedText+" (";return tool.ctrl&&(res+="Ctrl + "),tool.shift&&(res+="Shift + "),tool.alt&&(res+="Alt + "),res+=tool.key+")"},_nativeTools:["insertLineBreak","insertParagraph","redo","undo"],tools:{},isCustomTool:function(toolName){return!(toolName in kendo.ui.Editor.defaultTools)},expandTools:function(tools){var currentTool,i,options,name,nativeTools=this._nativeTools,defaultTools=kendo.deepExtend({},kendo.ui.Editor.defaultTools),result={};for(i=0;i<tools.length;i++)currentTool=tools[i],name=currentTool.name,$.isPlainObject(currentTool)?name&&defaultTools[name]?(result[name]=extend({},defaultTools[name]),extend(result[name].options,currentTool)):(options=extend({cssClass:"k-i-custom",type:"button",title:""},currentTool),options.name||(options.name="custom"),options.cssClass="k-"+("custom"==options.name?"i-custom":options.name),options.template||"button"!=options.type||(options.template=editorNS.EditorUtils.buttonTemplate,options.title=options.title||options.tooltip),result[name]={options:options}):defaultTools[currentTool]&&(result[currentTool]=defaultTools[currentTool]);for(i=0;i<nativeTools.length;i++)result[nativeTools[i]]||(result[nativeTools[i]]=defaultTools[nativeTools[i]]);return result},render:function(){function stringify(template){var result;return template.getHtml?result=template.getHtml():($.isFunction(template)||(template=kendo.template(template)),result=template(options)),$.trim(result)}function endGroup(){group.children().length&&group.appendTo(element)}function startGroup(){group=$("<li class='k-tool-group' role='presentation' />")}var options,template,toolElement,toolName,groupName,newGroupName,group,i,that=this,tools=that.tools,editorElement=that._editor.element,element=that.element.empty(),toolConfig=that._editor.options.tools,browser=kendo.support.browser;for(element.empty(),startGroup(),i=0;i<toolConfig.length;i++)toolName=toolConfig[i].name||toolConfig[i],options=tools[toolName]&&tools[toolName].options,!options&&$.isPlainObject(toolName)&&(options=toolName),template=options&&options.template,"break"==toolName&&(endGroup(),$("<li class='k-row-break' />").appendTo(that.element),startGroup()),template&&(newGroupName=that.toolGroupFor(toolName),groupName!=newGroupName&&(endGroup(),startGroup(),groupName=newGroupName),template=stringify(template),toolElement=$(template).appendTo(group),"custom"==newGroupName&&(endGroup(),startGroup()),options.exec&&toolElement.hasClass("k-tool")&&toolElement.click(proxy(options.exec,editorElement[0])));endGroup(),$(that.element).children(":has(> .k-tool)").addClass("k-button-group"),that.options.popup&&browser.msie&&browser.version<9&&that.window.wrapper.find("*").attr("unselectable","on"),this.updateGroups()},updateGroups:function(){$(this.element).children().each(function(){$(this).children().filter(function(){return"none"!==this.style.display}).removeClass("k-group-end").first().addClass("k-group-start").end().last().addClass("k-group-end").end()})},decorateFrom:function(body){this.items().filter(".k-decorated").each(function(){var selectBox=$(this).data("kendoSelectBox");selectBox&&selectBox.decorate(body)})},destroy:function(){Widget.fn.destroy.call(this);var id,tools=this.tools;for(id in tools)tools[id].destroy&&tools[id].destroy();this.window&&this.window.destroy()},_attachEvents:function(){var that=this,buttons="[role=button].k-tool",enabledButtons=buttons+":not(.k-state-disabled)",disabledButtons=buttons+".k-state-disabled";that.element.off(NS).on("mouseenter"+NS,enabledButtons,function(){$(this).addClass("k-state-hover")}).on("mouseleave"+NS,enabledButtons,function(){$(this).removeClass("k-state-hover")}).on("mousedown"+NS,buttons,function(e){e.preventDefault()}).on("keydown"+NS,focusable,function(e){function move(direction,constrain){var tools=that.element.find(focusable),index=tools.index(current)+direction;return constrain&&(index=Math.max(0,Math.min(tools.length-1,index))),tools[index]}var focusElement,current=this,keyCode=e.keyCode;keyCode==keys.RIGHT||keyCode==keys.LEFT?$(current).hasClass(".k-dropdown")||(focusElement=move(keyCode==keys.RIGHT?1:-1,!0)):keyCode==keys.ESC?focusElement=that._editor:keyCode!=keys.TAB||e.ctrlKey||e.altKey||(e.shiftKey?focusElement=move(-1):(focusElement=move(1),focusElement||(focusElement=that._editor))),focusElement&&(e.preventDefault(),focusElement.focus())}).on("click"+NS,enabledButtons,function(e){var button=$(this);e.preventDefault(),e.stopPropagation(),button.removeClass("k-state-hover"),button.is("[data-popup]")||that._editor.exec(that._toolName(this))}).on("click"+NS,disabledButtons,function(e){e.preventDefault()})},_toolName:function(element){if(element){var className=element.className;/k-tool\b/i.test(className)&&(className=element.firstChild.className);var tool=$.grep(className.split(" "),function(x){return!/^k-(widget|tool|tool-icon|state-hover|header|combobox|dropdown|selectbox|colorpicker)$/i.test(x)});return tool[0]?tool[0].substring(tool[0].lastIndexOf("-")+1):"custom"}},_updateTool:function(){var that=this,editor=that._editor,range=editor.getRange(),nodes=kendo.ui.editor.RangeUtils.textNodes(range);nodes.length||(nodes=[range.startContainer]),that.items().each(function(){var tool=that.tools[that._toolName(this)];tool&&tool.update&&tool.update($(this),nodes)}),this.update()},update:function(){this.element.children().children().each(function(){var tool=$(this);tool.css("display",tool.hasClass("k-state-disabled")?"none":"")}),this.updateGroups()}});$.extend(editorNS,{Toolbar:Toolbar})}(window.jQuery),function($,undefined){var kendo=window.kendo,extend=$.extend,proxy=$.proxy,Editor=kendo.ui.editor,dom=Editor.Dom,EditorUtils=Editor.EditorUtils,Command=Editor.Command,NS=".kendoEditor",ACTIVESTATE="k-state-active",SELECTEDSTATE="k-state-selected",Tool=Editor.Tool,ToolTemplate=Editor.ToolTemplate,InsertHtmlCommand=Editor.InsertHtmlCommand,BlockFormatFinder=Editor.BlockFormatFinder,registerTool=Editor.EditorUtils.registerTool,editableCell="<td>"+Editor.emptyElementContent+"</td>",tableFormatFinder=new BlockFormatFinder([{tags:["table"]}]),TableCommand=InsertHtmlCommand.extend({_tableHtml:function(rows,columns){return rows=rows||1,columns=columns||1,"<table class='k-table' data-last>"+new Array(rows+1).join("<tr>"+new Array(columns+1).join(editableCell)+"</tr>")+"</table>"},postProcess:function(editor,range){var insertedTable=$("table[data-last]",editor.document).removeAttr("data-last");range.selectNodeContents(insertedTable.find("td")[0]),editor.selectRange(range)},exec:function(){var options=this.options;options.html=this._tableHtml(options.rows,options.columns),options.postProcess=this.postProcess,InsertHtmlCommand.fn.exec.call(this)}}),PopupTool=Tool.extend({initialize:function(ui,options){Tool.fn.initialize.call(this,ui,options);var popup=$(this.options.popupTemplate).appendTo("body").kendoPopup({anchor:ui,copyAnchorStyles:!1,open:proxy(this._open,this),activate:proxy(this._activate,this),close:proxy(this._close,this)}).data("kendoPopup");ui.click(proxy(this._toggle,this)).keydown(proxy(this._keydown,this)),this._editor=options.editor,this._popup=popup},popup:function(){return this._popup},_activate:$.noop,_open:function(){this._popup.options.anchor.addClass(ACTIVESTATE)},_close:function(){this._popup.options.anchor.removeClass(ACTIVESTATE)},_keydown:function(e){var keys=kendo.keys,key=e.keyCode;key==keys.DOWN&&e.altKey?this._popup.open():key==keys.ESC&&this._popup.close()},_toggle:function(e){var button=$(e.target).closest(".k-tool");button.hasClass("k-state-disabled")||this.popup().toggle()},update:function(ui){this.popup().close(),ui.removeClass("k-state-hover")},destroy:function(){this._popup.destroy()}}),InsertTableTool=PopupTool.extend({init:function(options){this.cols=8,this.rows=6,PopupTool.fn.init.call(this,$.extend(options,{command:TableCommand,popupTemplate:"<div class='k-ct-popup'>"+new Array(this.cols*this.rows+1).join("<span class='k-ct-cell k-state-disabled' />")+"<div class='k-status'>Cancel</div></div>"}))},_activate:function(){function tableFromLocation(e){var w=$(window);return{row:Math.floor((e.clientY+w.scrollTop()-start.top)/cellHeight)+1,col:Math.floor((e.clientX+w.scrollLeft()-start.left)/cellWidth)+1}}var cellWidth,cellHeight,that=this,element=that._popup.element,cells=element.find(".k-ct-cell"),firstCell=cells.eq(0),lastCell=cells.eq(cells.length-1),start=kendo.getOffset(firstCell),end=kendo.getOffset(lastCell),cols=that.cols,rows=that.rows;end.left+=lastCell[0].offsetWidth,end.top+=lastCell[0].offsetHeight,cellWidth=(end.left-start.left)/cols,cellHeight=(end.top-start.top)/rows,element.on("mousemove"+NS,function(e){that._setTableSize(tableFromLocation(e))}).on("mouseleave"+NS,function(){that._setTableSize()}).on("mouseup"+NS,function(e){that._exec(tableFromLocation(e))})},_valid:function(size){return size&&size.row>0&&size.col>0&&size.row<=this.rows&&size.col<=this.cols},_exec:function(size){this._valid(size)&&(this._editor.exec("createTable",{rows:size.row,columns:size.col}),this._popup.close())},_setTableSize:function(size){var element=this._popup.element,status=element.find(".k-status"),cells=element.find(".k-ct-cell"),cols=(this.rows,this.cols);this._valid(size)?(status.text(kendo.format("Create a {0} x {1} table",size.row,size.col)),cells.each(function(i){$(this).toggleClass(SELECTEDSTATE,i%cols<size.col&&i/cols<size.row)})):(status.text("Cancel"),cells.removeClass(SELECTEDSTATE))},_keydown:function(e){PopupTool.fn._keydown.call(this,e);var keys=kendo.keys,key=e.keyCode,cells=this._popup.element.find(".k-ct-cell"),focus=Math.max(cells.filter(".k-state-selected").last().index(),0),selectedRows=Math.floor(focus/this.cols),selectedColumns=focus%this.cols,changed=!1;key!=keys.DOWN||e.altKey?key==keys.UP?(changed=!0,selectedRows--):key==keys.RIGHT?(changed=!0,selectedColumns++):key==keys.LEFT&&(changed=!0,selectedColumns--):(changed=!0,selectedRows++);var tableSize={row:Math.max(1,Math.min(this.rows,selectedRows+1)),col:Math.max(1,Math.min(this.cols,selectedColumns+1))};key==keys.ENTER?this._exec(tableSize):this._setTableSize(tableSize),changed&&(e.preventDefault(),e.stopImmediatePropagation())},_open:function(){PopupTool.fn._open.call(this),this.popup().element.find(".k-ct-cell").removeClass(SELECTEDSTATE)},_close:function(){PopupTool.fn._close.call(this),this.popup().element.off(NS)},update:function(ui,nodes){var isFormatted;PopupTool.fn.update.call(this,ui),isFormatted=tableFormatFinder.isFormatted(nodes),ui.toggleClass("k-state-disabled",isFormatted)}}),InsertRowCommand=Command.extend({exec:function(){for(var cellCount,row,newRow,range=this.lockRange(!0),td=range.endContainer;"td"!=dom.name(td);)td=td.parentNode;row=td.parentNode,cellCount=row.children.length,newRow=row.cloneNode(!0);for(var i=0;i<row.cells.length;i++)newRow.cells[i].innerHTML=Editor.emptyElementContent;"before"==this.options.position?dom.insertBefore(newRow,row):dom.insertAfter(newRow,row),this.releaseRange(range)}}),InsertColumnCommand=Command.extend({exec:function(){var columnIndex,i,cell,newCell,range=this.lockRange(!0),td=dom.closest(range.endContainer,"td"),table=dom.closest(td,"table"),rows=table.rows,position=this.options.position;for(columnIndex=dom.findNodeIndex(td),i=0;i<rows.length;i++)cell=rows[i].cells[columnIndex],newCell=cell.cloneNode(),newCell.innerHTML=Editor.emptyElementContent,"before"==position?dom.insertBefore(newCell,cell):dom.insertAfter(newCell,cell);this.releaseRange(range)}}),DeleteRowCommand=Command.extend({exec:function(){var focusElement,range=this.lockRange(),row=dom.closest(range.endContainer,"tr"),table=dom.closest(row,"table"),rowCount=table.rows.length;1==rowCount?(focusElement=dom.next(table),focusElement&&!dom.insignificant(focusElement)||(focusElement=dom.prev(table)),dom.remove(table)):(dom.removeTextSiblings(row),focusElement=dom.next(row)||dom.prev(row),focusElement=focusElement.cells[0],dom.remove(row)),focusElement&&(range.setStart(focusElement,0),range.collapse(!0),this.editor.selectRange(range))}}),DeleteColumnCommand=Command.extend({exec:function(){var focusElement,i,range=this.lockRange(),td=dom.closest(range.endContainer,"td"),table=dom.closest(td,"table"),rows=table.rows,columnIndex=dom.findNodeIndex(td,!0),columnCount=rows[0].cells.length;if(1==columnCount)focusElement=dom.next(table),focusElement&&!dom.insignificant(focusElement)||(focusElement=dom.prev(table)),dom.remove(table);else for(dom.removeTextSiblings(td),focusElement=dom.next(td)||dom.prev(td),i=0;i<rows.length;i++)dom.remove(rows[i].cells[columnIndex]);focusElement&&(range.setStart(focusElement,0),range.collapse(!0),this.editor.selectRange(range))}}),TableModificationTool=Tool.extend({command:function(options){return options=extend(options,this.options),"delete"==options.action?"row"==options.type?new DeleteRowCommand(options):new DeleteColumnCommand(options):"row"==options.type?new InsertRowCommand(options):new InsertColumnCommand(options)},initialize:function(ui,options){Tool.fn.initialize.call(this,ui,options),ui.addClass("k-state-disabled")},update:function(ui,nodes){var isFormatted=!tableFormatFinder.isFormatted(nodes);ui.toggleClass("k-state-disabled",isFormatted)}});extend(kendo.ui.editor,{PopupTool:PopupTool,TableCommand:TableCommand,InsertTableTool:InsertTableTool,TableModificationTool:TableModificationTool,InsertRowCommand:InsertRowCommand,InsertColumnCommand:InsertColumnCommand,DeleteRowCommand:DeleteRowCommand,DeleteColumnCommand:DeleteColumnCommand}),registerTool("createTable",new InsertTableTool({template:new ToolTemplate({template:EditorUtils.buttonTemplate,popup:!0,title:"Create table"})})),registerTool("addColumnLeft",new TableModificationTool({type:"column",position:"before",template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Add column on the left"})})),registerTool("addColumnRight",new TableModificationTool({type:"column",template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Add column on the right"})})),registerTool("addRowAbove",new TableModificationTool({type:"row",position:"before",template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Add row above"})})),registerTool("addRowBelow",new TableModificationTool({type:"row",template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Add row below"})})),registerTool("deleteRow",new TableModificationTool({type:"row",action:"delete",template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Delete row"})})),registerTool("deleteColumn",new TableModificationTool({type:"column",action:"delete",template:new ToolTemplate({template:EditorUtils.buttonTemplate,title:"Delete column"})}))}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,caret=kendo.caret,keys=kendo.keys,ui=kendo.ui,Widget=ui.Widget,ns=".kendoMaskedTextBox",proxy=$.proxy,INPUT_EVENT_NAME=(kendo.support.propertyChangeEvent?"propertychange":"input")+ns,STATEDISABLED="k-state-disabled",DISABLED="disabled",READONLY="readonly",CHANGE="change",MaskedTextBox=Widget.extend({init:function(element,options){var DOMElement,that=this;Widget.fn.init.call(that,element,options),that._rules=$.extend({},that.rules,that.options.rules),element=that.element,DOMElement=element[0],that.wrapper=element,that._tokenize(),that._reset(),that.element.addClass("k-textbox").attr("autocomplete","off").on("focus"+ns,function(){var value=DOMElement.value;that._oldValue=value,value||(DOMElement.value=that._old=that._emptyMask),that._timeoutId=setTimeout(function(){caret(element,0,value?that._maskLength:0)})}).on("blur"+ns,function(){var value=element.val();clearTimeout(that._timeoutId),DOMElement.value=that._old="",value!==that._emptyMask&&(DOMElement.value=that._old=value),that._change()});var disabled=element.is("[disabled]");disabled?that.enable(!1):that.readonly(element.is("[readonly]")),that.value(that.options.value||element.val()),kendo.notify(that)},options:{name:"MaskedTextBox",promptChar:"_",culture:"",rules:{},value:"",mask:""},events:[CHANGE],rules:{0:/\d/,9:/\d|\s/,"#":/\d|\s|\+|\-/,L:/[a-zA-Z]/,"?":/[a-zA-Z]|\s/,"&":/\S/,C:/./,A:/[a-zA-Z0-9]/,a:/[a-zA-Z0-9]|\s/},setOptions:function(options){var that=this;Widget.fn.setOptions.call(that,options),that._rules=$.extend({},that.rules,that.options.rules),that._tokenize(),this._unbindInput(),this._bindInput(),that.value(that.element.val())},destroy:function(){var that=this;that.element.off(ns),that._form&&that._form.off("reset",that._resetHandler),Widget.fn.destroy.call(that)},value:function(value){var element=this.element,emptyMask=this._emptyMask;return value===undefined?this.element.val():emptyMask?(value=this._unmask(value+""),element.val(value?emptyMask:""),this._mask(0,this._maskLength,value),void(kendo._activeElement()!==element&&element.val()===emptyMask&&element.val(""))):void element.val(value)},readonly:function(readonly){this._editable({readonly:readonly===undefined||readonly,disable:!1})},enable:function(enable){this._editable({readonly:!1,disable:!(enable=enable===undefined||enable)})},_bindInput:function(){var that=this;that._maskLength&&that.element.on("keydown"+ns,proxy(that._keydown,that)).on("keypress"+ns,proxy(that._keypress,that)).on("paste"+ns,proxy(that._paste,that)).on(INPUT_EVENT_NAME,proxy(that._propertyChange,that))},_unbindInput:function(){this.element.off("keydown"+ns).off("keypress"+ns).off("paste"+ns).off(INPUT_EVENT_NAME)},_editable:function(options){var that=this,element=that.element,disable=options.disable,readonly=options.readonly;that._unbindInput(),readonly||disable?element.attr(DISABLED,disable).attr(READONLY,readonly).toggleClass(STATEDISABLED,disable):(element.removeAttr(DISABLED).removeAttr(READONLY).removeClass(STATEDISABLED),that._bindInput())},_change:function(){var that=this,value=that.value();value!==that._oldValue&&(that._oldValue=value,that.trigger(CHANGE),that.element.trigger(CHANGE))},_propertyChange:function(){var unmasked,start,that=this,element=that.element[0],value=element.value;value===that._old||that._pasting||(start=caret(element)[0],unmasked=that._unmask(value.substring(start),start),element.value=that._old=value.substring(0,start)+that._emptyMask.substring(start),that._mask(start,start,unmasked),caret(element,start))},_paste:function(e){var that=this,element=e.target,position=caret(element),start=position[0],end=position[1],unmasked=that._unmask(element.value.substring(end),end);that._pasting=!0,setTimeout(function(){var value=element.value,pasted=value.substring(start,caret(element)[0]);element.value=that._old=value.substring(0,start)+that._emptyMask.substring(start),that._mask(start,start,pasted),start=caret(element)[0],that._mask(start,start,unmasked),caret(element,start),that._pasting=!1})},_reset:function(){var that=this,element=that.element,formId=element.attr("form"),form=formId?$("#"+formId):element.closest("form");form[0]&&(that._resetHandler=function(){setTimeout(function(){that.value(element[0].value)})},that._form=form.on("reset",that._resetHandler))},_keydown:function(e){var placeholder,key=e.keyCode,element=this.element[0],selection=caret(element),start=selection[0],end=selection[1],backward=key===keys.BACKSPACE;backward||key===keys.DELETE?(start===end&&(backward?start-=1:end+=1,placeholder=this._find(start,backward)),placeholder!==undefined&&placeholder!==start?(backward&&(placeholder+=1),caret(element,placeholder)):start>-1&&this._mask(start,end,"",backward),e.preventDefault()):key===keys.ENTER&&(this._change(),e.preventDefault())},_keypress:function(e){if(0!==e.which&&!e.ctrlKey){var selection=caret(this.element);this._mask(selection[0],selection[1],String.fromCharCode(e.which)),e.preventDefault()}},_find:function(idx,backward){var value=this.element.val()||this._emptyMask,step=1;for(backward===!0&&(step=-1);idx>-1||idx<=this._maskLength;){if(value.charAt(idx)!==this.tokens[idx])return idx;idx+=step}return-1},_mask:function(start,end,value,backward){var valueLength,unmasked,chr,idx,element=this.element[0],current=element.value||this._emptyMask,empty=this.options.promptChar,chrIdx=0;for(start=this._find(start,backward),start>end&&(end=start),unmasked=this._unmask(current.substring(end),end),value=this._unmask(value,start),valueLength=value.length,value&&(unmasked=unmasked.replace(new RegExp("^_{0,"+valueLength+"}"),"")),value+=unmasked,current=current.split(""),chr=value.charAt(chrIdx);start<this._maskLength;)current[start]=chr||empty,chr=value.charAt(++chrIdx),idx===undefined&&chrIdx>valueLength&&(idx=start),start=this._find(start+1);element.value=this._old=current.join(""),kendo._activeElement()===element&&(idx===undefined&&(idx=this._maskLength),caret(element,idx))},_unmask:function(value,idx){if(!value)return"";value=(value+"").split("");for(var chr,token,chrIdx=0,tokenIdx=idx||0,empty=this.options.promptChar,valueLength=value.length,tokensLength=this.tokens.length,result="";tokenIdx<tokensLength&&(chr=value[chrIdx],token=this.tokens[tokenIdx],chr===token||chr===empty?(result+=chr===empty?empty:"",chrIdx+=1,tokenIdx+=1):"string"!=typeof token?((token.test&&token.test(chr)||$.isFunction(token)&&token(chr))&&(result+=chr,tokenIdx+=1),chrIdx+=1):tokenIdx+=1,!(chrIdx>=valueLength)););return result},_tokenize:function(){for(var chr,rule,tokens=[],tokenIdx=0,mask=this.options.mask||"",maskChars=mask.split(""),length=maskChars.length,idx=0,emptyMask="",promptChar=this.options.promptChar,numberFormat=kendo.getCulture(this.options.culture).numberFormat,rules=this._rules;idx<length;idx++)if(chr=maskChars[idx],rule=rules[chr])tokens[tokenIdx]=rule,emptyMask+=promptChar,tokenIdx+=1;else{"."===chr||","===chr?chr=numberFormat[chr]:"$"===chr?chr=numberFormat.currency.symbol:"\\"===chr&&(idx+=1,chr=maskChars[idx]),chr=chr.split("");for(var i=0,l=chr.length;i<l;i++)tokens[tokenIdx]=chr[i],emptyMask+=chr[i],tokenIdx+=1}this.tokens=tokens,this._emptyMask=emptyMask,this._maskLength=emptyMask.length}});ui.plugin(MaskedTextBox)}(window.kendo.jQuery),function($,undefined){function updateArrow(items){items=$(items),items.children(LINKSELECTOR).children(".k-icon").remove(),items.filter(":has(.k-panel),:has(.k-content)").children(".k-link:not(:has([class*=k-i-arrow]))").each(function(){var item=$(this),parent=item.parent();item.append("<span class='k-icon "+(parent.hasClass(ACTIVECLASS)?"k-i-arrow-n k-panelbar-collapse":"k-i-arrow-s k-panelbar-expand")+"'/>")})}function updateFirstLast(items){items=$(items),items.filter(".k-first:not(:first-child)").removeClass(FIRST),items.filter(".k-last:not(:last-child)").removeClass(LAST),items.filter(":first-child").addClass(FIRST),items.filter(":last-child").addClass(LAST)}var kendo=window.kendo,ui=kendo.ui,keys=kendo.keys,extend=$.extend,each=$.each,template=kendo.template,Widget=ui.Widget,excludedNodesRegExp=/^(ul|a|div)$/i,NS=".kendoPanelBar",IMG="img",HREF="href",LAST="k-last",LINK="k-link",LINKSELECTOR="."+LINK,ERROR="error",ITEM=".k-item",GROUP=".k-group",VISIBLEGROUP=GROUP+":visible",IMAGE="k-image",FIRST="k-first",EXPAND="expand",SELECT="select",CONTENT="k-content",ACTIVATE="activate",COLLAPSE="collapse",MOUSEENTER="mouseenter",MOUSELEAVE="mouseleave",CONTENTLOAD="contentLoad",ACTIVECLASS="k-state-active",GROUPS="> .k-panel",CONTENTS="> .k-content",FOCUSEDCLASS="k-state-focused",DISABLEDCLASS="k-state-disabled",SELECTEDCLASS="k-state-selected",SELECTEDSELECTOR="."+SELECTEDCLASS,HIGHLIGHTCLASS="k-state-highlight",ACTIVEITEMSELECTOR=ITEM+":not(.k-state-disabled)",clickableItems=ACTIVEITEMSELECTOR+" > .k-link",disabledItems=ITEM+".k-state-disabled > .k-link",selectableItems="> li > "+SELECTEDSELECTOR+", .k-panel > li > "+SELECTEDSELECTOR,defaultState="k-state-default",ARIA_DISABLED="aria-disabled",ARIA_EXPANDED="aria-expanded",ARIA_HIDDEN="aria-hidden",ARIA_SELECTED="aria-selected",VISIBLE=":visible",EMPTY=":empty",SINGLE="single",templates={content:template("<div role='region' class='k-content'#= contentAttributes(data) #>#= content(item) #</div>"),group:template("<ul role='group' aria-hidden='true' class='#= groupCssClass(group) #'#= groupAttributes(group) #>#= renderItems(data) #</ul>"),itemWrapper:template("<#= tag(item) # class='#= textClass(item, group) #' #= contentUrl(item) ##= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) ##= arrow(data) #</#= tag(item) #>"),item:template("<li role='menuitem' #=aria(item)#class='#= wrapperCssClass(group, item) #'>#= itemWrapper(data) ## if (item.items) { ##= subGroup({ items: item.items, panelBar: panelBar, group: { expanded: item.expanded } }) ## } else if (item.content || item.contentUrl) { ##= renderContent(data) ## } #</li>"),
image:template("<img class='k-image' alt='' src='#= imageUrl #' />"),arrow:template("<span class='#= arrowClass(item) #'></span>"),sprite:template("<span class='k-sprite #= spriteCssClass #'></span>"),empty:template("")},rendering={aria:function(item){var attr="";return(item.items||item.content||item.contentUrl)&&(attr+=ARIA_EXPANDED+"='"+(item.expanded?"true":"false")+"' "),item.enabled===!1&&(attr+=ARIA_DISABLED+"='true'"),attr},wrapperCssClass:function(group,item){var result="k-item",index=item.index;return result+=item.enabled===!1?" "+DISABLEDCLASS:item.expanded===!0?" "+ACTIVECLASS:" k-state-default",0===index&&(result+=" k-first"),index==group.length-1&&(result+=" k-last"),item.cssClass&&(result+=" "+item.cssClass),result},textClass:function(item,group){var result=LINK;return group.firstLevel&&(result+=" k-header"),result},textAttributes:function(item){return item.url?" href='"+item.url+"'":""},arrowClass:function(item){var result="k-icon";return result+=item.expanded?" k-i-arrow-n k-panelbar-collapse":" k-i-arrow-s k-panelbar-expand"},text:function(item){return item.encoded===!1?item.text:kendo.htmlEncode(item.text)},tag:function(item){return item.url||item.contentUrl?"a":"span"},groupAttributes:function(group){return group.expanded!==!0?" style='display:none'":""},groupCssClass:function(){return"k-group k-panel"},contentAttributes:function(content){return content.item.expanded!==!0?" style='display:none'":""},content:function(item){return item.content?item.content:item.contentUrl?"":"&nbsp;"},contentUrl:function(item){return item.contentUrl?'href="'+item.contentUrl+'"':""}},PanelBar=Widget.extend({init:function(element,options){var content,that=this;Widget.fn.init.call(that,element,options),element=that.wrapper=that.element.addClass("k-widget k-reset k-header k-panelbar"),options=that.options,element[0].id&&(that._itemId=element[0].id+"_pb_active"),that._tabindex(),that._initData(options),that._updateClasses(),that._animations(options),element.on("click"+NS,clickableItems,function(e){that._click($(e.currentTarget))&&e.preventDefault()}).on(MOUSEENTER+NS+" "+MOUSELEAVE+NS,clickableItems,that._toggleHover).on("click"+NS,disabledItems,!1).on("keydown"+NS,$.proxy(that._keydown,that)).on("focus"+NS,function(){var item=that.select();that._current(item[0]?item:that._first())}).on("blur"+NS,function(){that._current(null)}).attr("role","menu"),content=element.find("li."+ACTIVECLASS+" > ."+CONTENT),content[0]&&that.expand(content.parent(),!1),kendo.notify(that)},events:[EXPAND,COLLAPSE,SELECT,ACTIVATE,ERROR,CONTENTLOAD],options:{name:"PanelBar",animation:{expand:{effects:"expand:vertical",duration:200},collapse:{duration:200}},expandMode:"multiple"},destroy:function(){Widget.fn.destroy.call(this),this.element.off(NS),kendo.destroy(this.element)},_initData:function(options){var that=this;options.dataSource&&(that.element.empty(),that.append(options.dataSource,that.element))},setOptions:function(options){var animation=this.options.animation;this._animations(options),options.animation=extend(!0,animation,options.animation),"dataSource"in options&&this._initData(options),Widget.fn.setOptions.call(this,options)},expand:function(element,useAnimation){var that=this,animBackup={};return useAnimation=useAnimation!==!1,element=this.element.find(element),element.each(function(index,item){item=$(item);var groups=item.find(GROUPS).add(item.find(CONTENTS));if(!item.hasClass(DISABLEDCLASS)&&groups.length>0){if(that.options.expandMode==SINGLE&&that._collapseAllExpanded(item))return that;element.find("."+HIGHLIGHTCLASS).removeClass(HIGHLIGHTCLASS),item.addClass(HIGHLIGHTCLASS),useAnimation||(animBackup=that.options.animation,that.options.animation={expand:{effects:{}},collapse:{hide:!0,effects:{}}}),that._triggerEvent(EXPAND,item)||that._toggleItem(item,!1),useAnimation||(that.options.animation=animBackup)}}),that},collapse:function(element,useAnimation){var that=this,animBackup={};return useAnimation=useAnimation!==!1,element=that.element.find(element),element.each(function(index,item){item=$(item);var groups=item.find(GROUPS).add(item.find(CONTENTS));!item.hasClass(DISABLEDCLASS)&&groups.is(VISIBLE)&&(item.removeClass(HIGHLIGHTCLASS),useAnimation||(animBackup=that.options.animation,that.options.animation={expand:{effects:{}},collapse:{hide:!0,effects:{}}}),that._triggerEvent(COLLAPSE,item)||that._toggleItem(item,!0),useAnimation||(that.options.animation=animBackup))}),that},_toggleDisabled:function(element,enable){element=this.element.find(element),element.toggleClass(defaultState,enable).toggleClass(DISABLEDCLASS,!enable).attr(ARIA_DISABLED,!enable)},select:function(element){var that=this;return element===undefined?that.element.find(selectableItems).parent():(that.element.find(element).each(function(){var item=$(this),link=item.children(LINKSELECTOR);return item.hasClass(DISABLEDCLASS)?that:void(that._triggerEvent(SELECT,item)||that._updateSelected(link))}),that)},enable:function(element,state){return this._toggleDisabled(element,state!==!1),this},disable:function(element){return this._toggleDisabled(element,!1),this},append:function(item,referenceItem){referenceItem=this.element.find(referenceItem);var inserted=this._insert(item,referenceItem,referenceItem.length?referenceItem.find(GROUPS):null);return each(inserted.items,function(){inserted.group.append(this),updateFirstLast(this)}),updateArrow(referenceItem),updateFirstLast(inserted.group.find(".k-first, .k-last")),inserted.group.height("auto"),this},insertBefore:function(item,referenceItem){referenceItem=this.element.find(referenceItem);var inserted=this._insert(item,referenceItem,referenceItem.parent());return each(inserted.items,function(){referenceItem.before(this),updateFirstLast(this)}),updateFirstLast(referenceItem),inserted.group.height("auto"),this},insertAfter:function(item,referenceItem){referenceItem=this.element.find(referenceItem);var inserted=this._insert(item,referenceItem,referenceItem.parent());return each(inserted.items,function(){referenceItem.after(this),updateFirstLast(this)}),updateFirstLast(referenceItem),inserted.group.height("auto"),this},remove:function(element){element=this.element.find(element);var that=this,parent=element.parentsUntil(that.element,ITEM),group=element.parent("ul");return element.remove(),!group||group.hasClass("k-panelbar")||group.children(ITEM).length||group.remove(),parent.length&&(parent=parent.eq(0),updateArrow(parent),updateFirstLast(parent)),that},reload:function(element){var that=this;element=that.element.find(element),element.each(function(){var item=$(this);that._ajaxRequest(item,item.children("."+CONTENT),!item.is(VISIBLE))})},_first:function(){return this.element.children(ACTIVEITEMSELECTOR).first()},_last:function(){var item=this.element.children(ACTIVEITEMSELECTOR).last(),group=item.children(VISIBLEGROUP);return group[0]?group.children(ACTIVEITEMSELECTOR).last():item},_current:function(candidate){var that=this,focused=that._focused,id=that._itemId;return candidate===undefined?focused:(that.element.removeAttr("aria-activedescendant"),focused&&(focused[0].id===id&&focused.removeAttr("id"),focused.children(LINKSELECTOR).removeClass(FOCUSEDCLASS)),candidate&&(id=candidate[0].id||id,candidate.attr("id",id).children(LINKSELECTOR).addClass(FOCUSEDCLASS),that.element.attr("aria-activedescendant",id)),void(that._focused=candidate))},_keydown:function(e){var that=this,key=e.keyCode,current=that._current();e.target==e.currentTarget&&(key==keys.DOWN||key==keys.RIGHT?(that._current(that._nextItem(current)),e.preventDefault()):key==keys.UP||key==keys.LEFT?(that._current(that._prevItem(current)),e.preventDefault()):key==keys.ENTER||key==keys.SPACEBAR?(that._click(current.children(LINKSELECTOR)),e.preventDefault()):key==keys.HOME?(that._current(that._first()),e.preventDefault()):key==keys.END&&(that._current(that._last()),e.preventDefault()))},_nextItem:function(item){if(!item)return this._first();var group=item.children(VISIBLEGROUP),next=item.next();return group[0]&&(next=group.children("."+FIRST)),next[0]||(next=item.parent(VISIBLEGROUP).parent(ITEM).next()),next[0]&&next.is(":visible")||(next=this._first()),next.hasClass(DISABLEDCLASS)&&(next=this._nextItem(next)),next},_prevItem:function(item){if(!item)return this._last();var result,prev=item.prev();if(prev[0])for(result=prev;result[0];)result=result.children(VISIBLEGROUP).children("."+LAST),result[0]&&(prev=result);else prev=item.parent(VISIBLEGROUP).parent(ITEM),prev[0]||(prev=this._last());return prev.hasClass(DISABLEDCLASS)&&(prev=this._prevItem(prev)),prev},_insert:function(item,referenceItem,parent){var items,groupData,that=this,plain=$.isPlainObject(item),isReferenceItem=referenceItem&&referenceItem[0];return isReferenceItem||(parent=that.element),groupData={firstLevel:parent.hasClass("k-panelbar"),expanded:parent.parent().hasClass(ACTIVECLASS),length:parent.children().length},isReferenceItem&&!parent.length&&(parent=$(PanelBar.renderGroup({group:groupData})).appendTo(referenceItem)),plain||$.isArray(item)?(items=$.map(plain?[item]:item,function(value,idx){return $("string"==typeof value?value:PanelBar.renderItem({group:groupData,item:extend(value,{index:idx})}))}),isReferenceItem&&referenceItem.attr(ARIA_EXPANDED,!1)):(items="string"==typeof item&&"<"!=item[0]?that.element.find(item):$(item),that._updateItemsClasses(items)),{items:items,group:parent}},_toggleHover:function(e){var target=$(e.currentTarget);target.parents("li."+DISABLEDCLASS).length||target.toggleClass("k-state-hover",e.type==MOUSEENTER)},_updateClasses:function(){var panels,items,that=this;panels=that.element.find("li > ul").not(function(){return $(this).parentsUntil(".k-panelbar","div").length}).addClass("k-group k-panel").attr("role","group"),panels.parent().attr(ARIA_EXPANDED,!1).not("."+ACTIVECLASS).children("ul").attr(ARIA_HIDDEN,!0).hide(),items=that.element.add(panels).children(),that._updateItemsClasses(items),updateArrow(items),updateFirstLast(items)},_updateItemsClasses:function(items){for(var length=items.length,idx=0;idx<length;idx++)this._updateItemClasses(items[idx],idx)},_updateItemClasses:function(item,index){var wrapElement,link,selected=this._selected,contentUrls=this.options.contentUrls,url=contentUrls&&contentUrls[index],root=this.element[0];item=$(item).addClass("k-item").attr("role","menuitem"),kendo.support.browser.msie&&item.css("list-style-position","inside").css("list-style-position",""),item.children(IMG).addClass(IMAGE),link=item.children("a").addClass(LINK),link[0]&&(link.attr("href",url),link.children(IMG).addClass(IMAGE)),item.filter(":not([disabled]):not([class*=k-state])").addClass("k-state-default"),item.filter("li[disabled]").addClass("k-state-disabled").attr(ARIA_DISABLED,!0).removeAttr("disabled"),item.children("div").addClass(CONTENT).attr("role","region").attr(ARIA_HIDDEN,!0).hide().parent().attr(ARIA_EXPANDED,!1),link=item.children(SELECTEDSELECTOR),link[0]&&(selected&&selected.removeAttr(ARIA_SELECTED).children(SELECTEDSELECTOR).removeClass(SELECTEDCLASS),link.addClass(SELECTEDCLASS),this._selected=item.attr(ARIA_SELECTED,!0)),item.children(LINKSELECTOR)[0]||(wrapElement="<span class='"+LINK+"'/>",contentUrls&&contentUrls[index]&&item[0].parentNode==root&&(wrapElement='<a class="k-link k-header" href="'+contentUrls[index]+'"/>'),item.contents().filter(function(){return!(this.nodeName.match(excludedNodesRegExp)||3==this.nodeType&&!$.trim(this.nodeValue))}).wrapAll(wrapElement)),item.parent(".k-panelbar")[0]&&item.children(LINKSELECTOR).addClass("k-header")},_click:function(target){var prevent,contents,href,isAnchor,that=this,element=that.element;if(!target.parents("li."+DISABLEDCLASS).length&&target.closest(".k-widget")[0]==element[0]){var link=target.closest(LINKSELECTOR),item=link.closest(ITEM);if(that._updateSelected(link),contents=item.find(GROUPS).add(item.find(CONTENTS)),href=link.attr(HREF),isAnchor=href&&("#"==href.charAt(href.length-1)||href.indexOf("#"+that.element[0].id+"-")!=-1),prevent=!(!isAnchor&&!contents.length),contents.data("animating"))return prevent;if(that._triggerEvent(SELECT,item)&&(prevent=!0),prevent!==!1){if(that.options.expandMode==SINGLE&&that._collapseAllExpanded(item))return prevent;if(contents.length){var visibility=contents.is(VISIBLE);that._triggerEvent(visibility?COLLAPSE:EXPAND,item)||(prevent=that._toggleItem(item,visibility))}return prevent}}},_toggleItem:function(element,isVisible){var prevent,content,that=this,childGroup=element.find(GROUPS),link=element.find(LINKSELECTOR),url=link.attr(HREF);return childGroup.length?(this._toggleGroup(childGroup,isVisible),prevent=!0):(content=element.children("."+CONTENT),content.length&&(prevent=!0,content.is(EMPTY)&&url!==undefined?that._ajaxRequest(element,content,isVisible):that._toggleGroup(content,isVisible))),prevent},_toggleGroup:function(element,visibility){var that=this,animationSettings=that.options.animation,animation=animationSettings.expand,collapse=extend({},animationSettings.collapse),hasCollapseAnimation=collapse&&"effects"in collapse;element.is(VISIBLE)==visibility&&(element.parent().attr(ARIA_EXPANDED,!visibility).attr(ARIA_HIDDEN,visibility).toggleClass(ACTIVECLASS,!visibility).find("> .k-link > .k-icon").toggleClass("k-i-arrow-n",!visibility).toggleClass("k-panelbar-collapse",!visibility).toggleClass("k-i-arrow-s",visibility).toggleClass("k-panelbar-expand",visibility),animation=visibility?extend(hasCollapseAnimation?collapse:extend({reverse:!0},animation),{hide:!0}):extend({complete:function(element){that._triggerEvent(ACTIVATE,element.closest(ITEM))}},animation),element.kendoStop(!0,!0).kendoAnimate(animation))},_collapseAllExpanded:function(item){var children,that=this,stopExpand=!1;if(item.children(LINKSELECTOR).hasClass("k-header")){var groups=item.find(GROUPS).add(item.find(CONTENTS));return groups.is(VISIBLE)&&(stopExpand=!0),groups.is(VISIBLE)||0===groups.length||(children=$(that.element).children(),children.find(GROUPS).add(children.find(CONTENTS)).filter(function(){return $(this).is(VISIBLE)}).each(function(index,content){content=$(content),stopExpand=that._triggerEvent(COLLAPSE,content.closest(ITEM)),stopExpand||that._toggleGroup(content,!0)})),stopExpand}},_ajaxRequest:function(element,contentElement,isVisible){var that=this,statusIcon=element.find(".k-panelbar-collapse, .k-panelbar-expand"),link=element.find(LINKSELECTOR),loadingIconTimeout=setTimeout(function(){statusIcon.addClass("k-loading")},100),data={},url=link.attr(HREF);$.ajax({type:"GET",cache:!1,url:url,dataType:"html",data:data,error:function(xhr,status){statusIcon.removeClass("k-loading"),that.trigger(ERROR,{xhr:xhr,status:status})&&this.complete()},complete:function(){clearTimeout(loadingIconTimeout),statusIcon.removeClass("k-loading")},success:function(data){try{contentElement.html(data)}catch(e){var console=window.console;console&&console.error&&console.error(e.name+": "+e.message+" in "+url),this.error(this.xhr,"error")}that._toggleGroup(contentElement,isVisible),that.trigger(CONTENTLOAD,{item:element[0],contentElement:contentElement[0]})}})},_triggerEvent:function(eventName,element){var that=this;return that.trigger(eventName,{item:element[0]})},_updateSelected:function(link){var that=this,element=that.element,item=link.parent(ITEM),selected=that._selected;selected&&selected.removeAttr(ARIA_SELECTED),that._selected=item.attr(ARIA_SELECTED,!0),element.find(selectableItems).removeClass(SELECTEDCLASS),element.find("> ."+HIGHLIGHTCLASS+", .k-panel > ."+HIGHLIGHTCLASS).removeClass(HIGHLIGHTCLASS),link.addClass(SELECTEDCLASS),link.parentsUntil(element,ITEM).filter(":has(.k-header)").addClass(HIGHLIGHTCLASS),that._current(item)},_animations:function(options){options&&"animation"in options&&!options.animation&&(options.animation={expand:{effects:{}},collapse:{hide:!0,effects:{}}})}});extend(PanelBar,{renderItem:function(options){options=extend({panelBar:{},group:{}},options);var empty=templates.empty,item=options.item;return templates.item(extend(options,{image:item.imageUrl?templates.image:empty,sprite:item.spriteCssClass?templates.sprite:empty,itemWrapper:templates.itemWrapper,renderContent:PanelBar.renderContent,arrow:item.items||item.content||item.contentUrl?templates.arrow:empty,subGroup:PanelBar.renderGroup},rendering))},renderGroup:function(options){return templates.group(extend({renderItems:function(options){for(var html="",i=0,items=options.items,len=items?items.length:0,group=extend({length:len},options.group);i<len;i++)html+=PanelBar.renderItem(extend(options,{group:group,item:extend({index:i},items[i])}));return html}},options,rendering))},renderContent:function(options){return templates.content(extend(options,rendering))}}),kendo.ui.plugin(PanelBar)}(window.kendo.jQuery),function($,undefined){var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget,HORIZONTAL="horizontal",VERTICAL="vertical",DEFAULTMIN=0,DEFAULTMAX=100,DEFAULTVALUE=0,DEFAULTCHUNKCOUNT=5,KPROGRESSBAR="k-progressbar",KPROGRESSBARREVERSE="k-progressbar-reverse",KPROGRESSBARINDETERMINATE="k-progressbar-indeterminate",KPROGRESSBARCOMPLETE="k-complete",KPROGRESSWRAPPER="k-state-selected",KPROGRESSSTATUS="k-progress-status",KCOMPLETEDCHUNK="k-state-selected",KUPCOMINGCHUNK="k-state-default",KSTATEDISABLED="k-state-disabled",PROGRESSTYPE={VALUE:"value",PERCENT:"percent",CHUNK:"chunk"},CHANGE="change",COMPLETE="complete",BOOLEAN="boolean",math=Math,extend=$.extend,proxy=$.proxy,HUNDREDPERCENT=100,DEFAULTANIMATIONDURATION=400,PRECISION=3,templates={progressStatus:"<span class='k-progress-status-wrap'><span class='k-progress-status'></span></span>"},ProgressBar=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(this,element,options),options=that.options,that._progressProperty=options.orientation===HORIZONTAL?"width":"height",that._fields(),options.value=that._validateValue(options.value),that._validateType(options.type),that._wrapper(),that._progressAnimation(),options.value!==options.min&&options.value!==!1&&that._updateProgress()},setOptions:function(options){var that=this;Widget.fn.setOptions.call(that,options),options.hasOwnProperty("reverse")&&that.wrapper.toggleClass("k-progressbar-reverse",options.reverse),options.hasOwnProperty("enable")&&that.enable(options.enable),that._progressAnimation(),that._validateValue(),that._updateProgress()},events:[CHANGE,COMPLETE],options:{name:"ProgressBar",orientation:HORIZONTAL,reverse:!1,min:DEFAULTMIN,max:DEFAULTMAX,value:DEFAULTVALUE,enable:!0,type:PROGRESSTYPE.VALUE,chunkCount:DEFAULTCHUNKCOUNT,showStatus:!0,animation:{}},_fields:function(){var that=this;that._isStarted=!1,that.progressWrapper=that.progressStatus=$()},_validateType:function(currentType){var isValid=!1;if($.each(PROGRESSTYPE,function(k,type){if(type===currentType)return isValid=!0,!1}),!isValid)throw new Error(kendo.format("Invalid ProgressBar type '{0}'",currentType))},_wrapper:function(){var initialStatusValue,that=this,container=that.wrapper=that.element,options=that.options,orientation=options.orientation;container.addClass("k-widget "+KPROGRESSBAR),container.addClass(KPROGRESSBAR+"-"+(orientation===HORIZONTAL?HORIZONTAL:VERTICAL)),options.enable===!1&&container.addClass(KSTATEDISABLED),options.reverse&&container.addClass(KPROGRESSBARREVERSE),options.value===!1&&container.addClass(KPROGRESSBARINDETERMINATE),options.type===PROGRESSTYPE.CHUNK?that._addChunkProgressWrapper():options.showStatus&&(that.progressStatus=that.wrapper.prepend(templates.progressStatus).find("."+KPROGRESSSTATUS),initialStatusValue=options.value!==!1?options.value:options.min,options.type===PROGRESSTYPE.VALUE?that.progressStatus.text(initialStatusValue):that.progressStatus.text(that._calculatePercentage(initialStatusValue)+"%"))},value:function(value){return this._value(value)},_value:function(value){var validated,that=this,options=that.options;return value===undefined?options.value:void(typeof value!==BOOLEAN?(value=that._roundValue(value),isNaN(value)||(validated=that._validateValue(value),validated!==options.value&&(that.wrapper.removeClass(KPROGRESSBARINDETERMINATE),options.value=validated,that._isStarted=!0,that._updateProgress()))):value||(that.wrapper.addClass(KPROGRESSBARINDETERMINATE),options.value=!1))},_roundValue:function(value){value=parseFloat(value);var power=math.pow(10,PRECISION);return math.floor(value*power)/power},_validateValue:function(value){var that=this,options=that.options;if(value!==!1){if(value<=options.min||value===!0)return options.min;if(value>=options.max)return options.max}else if(value===!1)return!1;return isNaN(that._roundValue(value))?options.min:value},_updateProgress:function(){var that=this,options=that.options,percentage=that._calculatePercentage();options.type===PROGRESSTYPE.CHUNK?(that._updateChunks(percentage),that._onProgressUpdateAlways(options.value)):that._updateProgressWrapper(percentage)},_updateChunks:function(percentage){var completedChunks,that=this,options=that.options,chunkCount=options.chunkCount,percentagesPerChunk=parseInt(HUNDREDPERCENT/chunkCount*100,10)/100,percentageParsed=parseInt(100*percentage,10)/100,completedChunksCount=math.floor(percentageParsed/percentagesPerChunk);completedChunks=options.orientation===HORIZONTAL&&!options.reverse||options.orientation===VERTICAL&&options.reverse?that.wrapper.find("li.k-item:lt("+completedChunksCount+")"):that.wrapper.find("li.k-item:gt(-"+(completedChunksCount+1)+")"),that.wrapper.find("."+KCOMPLETEDCHUNK).removeClass(KCOMPLETEDCHUNK).addClass(KUPCOMINGCHUNK),completedChunks.removeClass(KUPCOMINGCHUNK).addClass(KCOMPLETEDCHUNK)},_updateProgressWrapper:function(percentage){var that=this,options=that.options,progressWrapper=that.wrapper.find("."+KPROGRESSWRAPPER),animationDuration=that._isStarted?that._animation.duration:0,animationCssOptions={};0===progressWrapper.length&&that._addRegularProgressWrapper(),animationCssOptions[that._progressProperty]=percentage+"%",that.progressWrapper.animate(animationCssOptions,{duration:animationDuration,start:proxy(that._onProgressAnimateStart,that),progress:proxy(that._onProgressAnimate,that),complete:proxy(that._onProgressAnimateComplete,that,options.value),always:proxy(that._onProgressUpdateAlways,that,options.value)})},_onProgressAnimateStart:function(){this.progressWrapper.show()},_onProgressAnimate:function(e){var progressStatusWrapSize,that=this,options=that.options,progressInPercent=parseFloat(e.elem.style[that._progressProperty],10);options.showStatus&&(progressStatusWrapSize=1e4/parseFloat(that.progressWrapper[0].style[that._progressProperty]),that.progressWrapper.find(".k-progress-status-wrap").css(that._progressProperty,progressStatusWrapSize+"%")),options.type!==PROGRESSTYPE.CHUNK&&progressInPercent<=98&&that.progressWrapper.removeClass(KPROGRESSBARCOMPLETE)},_onProgressAnimateComplete:function(currentValue){var that=this,options=that.options,progressWrapperSize=parseFloat(that.progressWrapper[0].style[that._progressProperty]);options.type!==PROGRESSTYPE.CHUNK&&progressWrapperSize>98&&that.progressWrapper.addClass(KPROGRESSBARCOMPLETE),options.showStatus&&(options.type===PROGRESSTYPE.VALUE?that.progressStatus.text(currentValue):that.progressStatus.text(math.floor(that._calculatePercentage(currentValue))+"%")),currentValue===options.min&&that.progressWrapper.hide()},_onProgressUpdateAlways:function(currentValue){var that=this,options=that.options;that._isStarted&&that.trigger(CHANGE,{value:currentValue}),currentValue===options.max&&that._isStarted&&that.trigger(COMPLETE,{value:options.max})},enable:function(enable){var that=this,options=that.options;options.enable="undefined"==typeof enable||enable,that.wrapper.toggleClass(KSTATEDISABLED,!options.enable)},destroy:function(){var that=this;Widget.fn.destroy.call(that)},_addChunkProgressWrapper:function(){var that=this,options=that.options,container=that.wrapper,chunkSize=HUNDREDPERCENT/options.chunkCount,html="";options.chunkCount<=1&&(options.chunkCount=DEFAULTCHUNKCOUNT),html+="<ul class='k-reset'>";for(var i=options.chunkCount-1;i>=0;i--)html+="<li class='k-item k-state-default'></li>";html+="</ul>",container.append(html).find(".k-item").css(that._progressProperty,chunkSize+"%").first().addClass("k-first").end().last().addClass("k-last"),that._normalizeChunkSize()},_normalizeChunkSize:function(){var that=this,options=that.options,lastChunk=that.wrapper.find(".k-item:last"),currentSize=parseFloat(lastChunk[0].style[that._progressProperty]),difference=HUNDREDPERCENT-options.chunkCount*currentSize;difference>0&&lastChunk.css(that._progressProperty,currentSize+difference+"%")},_addRegularProgressWrapper:function(){var that=this;that.progressWrapper=$("<div class='"+KPROGRESSWRAPPER+"'></div>").appendTo(that.wrapper),that.options.showStatus&&(that.progressWrapper.append(templates.progressStatus),that.progressStatus=that.wrapper.find("."+KPROGRESSSTATUS))},_calculateChunkSize:function(){var that=this,chunkCount=that.options.chunkCount,chunkContainer=that.wrapper.find("ul.k-reset");return(parseInt(chunkContainer.css(that._progressProperty),10)-(chunkCount-1))/chunkCount},_calculatePercentage:function(currentValue){var that=this,options=that.options,value=currentValue!==undefined?currentValue:options.value,min=options.min,max=options.max;return that._onePercent=math.abs((max-min)/100),math.abs((value-min)/that._onePercent)},_progressAnimation:function(){var that=this,options=that.options,animation=options.animation;animation===!1?that._animation={duration:0}:that._animation=extend({duration:DEFAULTANIMATIONDURATION},options.animation)}});kendo.ui.plugin(ProgressBar)}(window.kendo.jQuery),function($,undefined){function updateTabClasses(tabs){tabs.children(IMG).addClass(IMAGE),tabs.children("a").addClass(LINK).children(IMG).addClass(IMAGE),tabs.filter(":not([disabled]):not([class*=k-state-disabled])").addClass(DEFAULTSTATE),tabs.filter("li[disabled]").addClass(DISABLEDSTATE).removeAttr("disabled"),tabs.filter(":not([class*=k-state])").children("a").filter(":focus").parent().addClass(ACTIVESTATE+" "+TABONTOP),tabs.attr("role","tab"),tabs.filter("."+ACTIVESTATE).attr("aria-selected",!0),tabs.each(function(){var item=$(this);item.children("."+LINK).length||item.contents().filter(function(){return!(this.nodeName.match(excludedNodesRegExp)||3==this.nodeType&&!trim(this.nodeValue))}).wrapAll("<a class='"+LINK+"'/>")})}function updateFirstLast(tabGroup){var tabs=tabGroup.children(".k-item");tabs.filter(".k-first:not(:first-child)").removeClass(FIRST),tabs.filter(".k-last:not(:last-child)").removeClass(LAST),tabs.filter(":first-child").addClass(FIRST),tabs.filter(":last-child").addClass(LAST)}var kendo=window.kendo,ui=kendo.ui,keys=kendo.keys,map=$.map,each=$.each,trim=$.trim,extend=$.extend,template=kendo.template,Widget=ui.Widget,excludedNodesRegExp=/^(a|div)$/i,NS=".kendoTabStrip",IMG="img",HREF="href",PREV="prev",LINK="k-link",LAST="k-last",CLICK="click",ERROR="error",EMPTY=":empty",IMAGE="k-image",FIRST="k-first",SELECT="select",ACTIVATE="activate",CONTENT="k-content",CONTENTURL="contentUrl",MOUSEENTER="mouseenter",MOUSELEAVE="mouseleave",CONTENTLOAD="contentLoad",DISABLEDSTATE="k-state-disabled",DEFAULTSTATE="k-state-default",ACTIVESTATE="k-state-active",FOCUSEDSTATE="k-state-focused",HOVERSTATE="k-state-hover",TABONTOP="k-tab-on-top",NAVIGATABLEITEMS=".k-item:not(."+DISABLEDSTATE+")",HOVERABLEITEMS=".k-tabstrip-items > "+NAVIGATABLEITEMS+":not(."+ACTIVESTATE+")",templates={content:template("<div class='k-content'#= contentAttributes(data) # role='tabpanel'>#= content(item) #</div>"),itemWrapper:template("<#= tag(item) # class='k-link'#= contentUrl(item) ##= textAttributes(item) #>#= image(item) ##= sprite(item) ##= text(item) #</#= tag(item) #>"),item:template("<li class='#= wrapperCssClass(group, item) #' role='tab' #=item.active ? \"aria-selected='true'\" : ''#>#= itemWrapper(data) #</li>"),image:template("<img class='k-image' alt='' src='#= imageUrl #' />"),sprite:template("<span class='k-sprite #= spriteCssClass #'></span>"),empty:template("")},rendering={wrapperCssClass:function(group,item){var result="k-item",index=item.index;return result+=item.enabled===!1?" k-state-disabled":" k-state-default",0===index&&(result+=" k-first"),index==group.length-1&&(result+=" k-last"),result},textAttributes:function(item){return item.url?" href='"+item.url+"'":""},text:function(item){return item.encoded===!1?item.text:kendo.htmlEncode(item.text)},tag:function(item){return item.url?"a":"span"},contentAttributes:function(content){return content.active!==!0?" style='display:none' aria-hidden='true' aria-expanded='false'":""},content:function(item){return item.content?item.content:item.contentUrl?"":"&nbsp;"},contentUrl:function(item){return item.contentUrl?kendo.attr("content-url")+'="'+item.contentUrl+'"':""}},TabStrip=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),that._animations(that.options),that.element.is("ul")?that.wrapper=that.element.wrapAll("<div />").parent():that.wrapper=that.element,options=that.options,that._isRtl=kendo.support.isRtl(that.wrapper),that._tabindex(),that._updateClasses(),that._dataSource(),options.dataSource&&that.dataSource.fetch(),that.options.contentUrls&&that.wrapper.find(".k-tabstrip-items > .k-item").each(function(index,item){$(item).find(">."+LINK).data(CONTENTURL,that.options.contentUrls[index])}),that.wrapper.on(MOUSEENTER+NS+" "+MOUSELEAVE+NS,HOVERABLEITEMS,that._toggleHover).on("focus"+NS,$.proxy(that._active,that)).on("blur"+NS,function(){that._current(null)}),that._keyDownProxy=$.proxy(that._keydown,that),options.navigatable&&that.wrapper.on("keydown"+NS,that._keyDownProxy),that.wrapper.children(".k-tabstrip-items").on(CLICK+NS,".k-state-disabled .k-link",!1).on(CLICK+NS," > "+NAVIGATABLEITEMS,function(e){that.wrapper[0]!==document.activeElement&&that.wrapper.focus(),that._click($(e.currentTarget))&&e.preventDefault()});var selectedItems=that.tabGroup.children("li."+ACTIVESTATE),content=that.contentHolder(selectedItems.index());selectedItems[0]&&content.length>0&&0===content[0].childNodes.length&&that.activateTab(selectedItems.eq(0)),that.element.attr("role","tablist"),that.element[0].id&&(that._ariaId=that.element[0].id+"_ts_active"),kendo.notify(that)},_active:function(){var item=this.tabGroup.children().filter("."+ACTIVESTATE);item=item[0]?item:this._endItem("first"),item[0]&&this._current(item)},_endItem:function(action){return this.tabGroup.children(NAVIGATABLEITEMS)[action]()},_item:function(item,action){var endItem;return endItem=action===PREV?"last":"first",item?(item=item[action](),item[0]||(item=this._endItem(endItem)),item.hasClass(DISABLEDSTATE)&&(item=this._item(item,action)),item):this._endItem(endItem)},_current:function(candidate){var that=this,focused=that._focused,id=that._ariaId;return candidate===undefined?focused:(focused&&(focused[0].id===id&&focused.removeAttr("id"),focused.removeClass(FOCUSEDSTATE)),candidate&&(candidate.hasClass(ACTIVESTATE)||candidate.addClass(FOCUSEDSTATE),that.element.removeAttr("aria-activedescendant"),id=candidate[0].id||id,id&&(candidate.attr("id",id),that.element.attr("aria-activedescendant",id))),void(that._focused=candidate))},_keydown:function(e){var action,that=this,key=e.keyCode,current=that._current(),rtl=that._isRtl;if(e.target==e.currentTarget){if(key==keys.DOWN||key==keys.RIGHT)action=rtl?PREV:"next";else if(key==keys.UP||key==keys.LEFT)action=rtl?"next":PREV;else if(key==keys.ENTER||key==keys.SPACEBAR)that._click(current),e.preventDefault();else{if(key==keys.HOME)return that._click(that._endItem("first")),void e.preventDefault();if(key==keys.END)return that._click(that._endItem("last")),void e.preventDefault()}action&&(that._click(that._item(current,action)),e.preventDefault())}},_dataSource:function(){var that=this;that.dataSource&&that._refreshHandler?that.dataSource.unbind("change",that._refreshHandler):that._refreshHandler=$.proxy(that.refresh,that),that.dataSource=kendo.data.DataSource.create(that.options.dataSource).bind("change",that._refreshHandler);
},setDataSource:function(dataSource){this.options.dataSource=dataSource,this._dataSource(),dataSource.fetch()},_animations:function(options){options&&"animation"in options&&!options.animation&&(options.animation={open:{effects:{}},close:{effects:{}}})},refresh:function(e){var idx,tab,action,length,that=this,options=that.options,text=kendo.getter(options.dataTextField),content=kendo.getter(options.dataContentField),contentUrl=kendo.getter(options.dataContentUrlField),image=kendo.getter(options.dataImageUrlField),url=kendo.getter(options.dataUrlField),sprite=kendo.getter(options.dataSpriteCssClass),tabs=[],view=that.dataSource.view();for(e=e||{},action=e.action,action&&(view=e.items),idx=0,length=view.length;idx<length;idx++)tab={text:text(view[idx])},options.dataContentField&&(tab.content=content(view[idx])),options.dataContentUrlField&&(tab.contentUrl=contentUrl(view[idx])),options.dataUrlField&&(tab.url=url(view[idx])),options.dataImageUrlField&&(tab.imageUrl=image(view[idx])),options.dataSpriteCssClass&&(tab.spriteCssClass=sprite(view[idx])),tabs[idx]=tab;if("add"==e.action)e.index<that.tabGroup.children().length?that.insertBefore(tabs,that.tabGroup.children().eq(e.index)):that.append(tabs);else if("remove"==e.action)for(idx=0;idx<view.length;idx++)that.remove(e.index);else"itemchange"==e.action?(idx=that.dataSource.view().indexOf(view[0]),e.field===options.dataTextField&&that.tabGroup.children().eq(idx).find(".k-link").text(view[0].get(e.field))):(that.trigger("dataBinding"),that.remove("li"),that.append(tabs),that.trigger("dataBound"))},value:function(value){var that=this;return value===undefined?that.select().text():void(value!=that.value()&&that.tabGroup.children().each(function(){$.trim($(this).text())==value&&that.select(this)}))},items:function(){return this.tabGroup[0].children},setOptions:function(options){var that=this,animation=that.options.animation;that._animations(options),options.animation=extend(!0,animation,options.animation),options.navigatable?that.wrapper.on("keydown"+NS,that._keyDownProxy):that.wrapper.off("keydown"+NS,that._keyDownProxy),Widget.fn.setOptions.call(that,options)},events:[SELECT,ACTIVATE,ERROR,CONTENTLOAD,"change","dataBinding","dataBound"],options:{name:"TabStrip",dataTextField:"",dataContentField:"",dataImageUrlField:"",dataUrlField:"",dataSpriteCssClass:"",dataContentUrlField:"",animation:{open:{effects:"expand:vertical fadeIn",duration:200},close:{duration:200}},collapsible:!1,navigatable:!0,contentUrls:!1},destroy:function(){var that=this;Widget.fn.destroy.call(that),that._refreshHandler&&that.dataSource.unbind("change",that._refreshHandler),that.wrapper.off(NS),that.wrapper.children(".k-tabstrip-items").off(NS),kendo.destroy(that.wrapper)},select:function(element){var that=this;return 0===arguments.length?that.tabGroup.children("li."+ACTIVESTATE):(isNaN(element)||(element=that.tabGroup.children().get(element)),element=that.tabGroup.find(element),$(element).each(function(index,item){item=$(item),item.hasClass(ACTIVESTATE)||that.trigger(SELECT,{item:item[0],contentElement:that.contentHolder(item.index())[0]})||that.activateTab(item)}),that)},enable:function(element,state){return this._toggleDisabled(element,state!==!1),this},disable:function(element){return this._toggleDisabled(element,!1),this},reload:function(element){element=this.tabGroup.find(element);var that=this;return element.each(function(){var item=$(this),contentUrl=item.find("."+LINK).data(CONTENTURL),content=that.contentHolder(item.index());contentUrl&&that.ajaxRequest(item,content,null,contentUrl)}),that},append:function(tab){var that=this,inserted=that._create(tab);return each(inserted.tabs,function(idx){that.tabGroup.append(this),that.wrapper.append(inserted.contents[idx])}),updateFirstLast(that.tabGroup),that._updateContentElements(),that},insertBefore:function(tab,referenceTab){referenceTab=this.tabGroup.find(referenceTab);var that=this,inserted=that._create(tab),referenceContent=$(that.contentElement(referenceTab.index()));return each(inserted.tabs,function(idx){referenceTab.before(this),referenceContent.before(inserted.contents[idx])}),updateFirstLast(that.tabGroup),that._updateContentElements(),that},insertAfter:function(tab,referenceTab){referenceTab=this.tabGroup.find(referenceTab);var that=this,inserted=that._create(tab),referenceContent=$(that.contentElement(referenceTab.index()));return each(inserted.tabs,function(idx){referenceTab.after(this),referenceContent.after(inserted.contents[idx])}),updateFirstLast(that.tabGroup),that._updateContentElements(),that},remove:function(elements){var that=this,type=typeof elements,contents=$();return"string"===type?elements=that.tabGroup.find(elements):"number"===type&&(elements=that.tabGroup.children().eq(elements)),elements.each(function(){contents.push(that.contentElement($(this).index()))}),elements.remove(),contents.remove(),that._updateContentElements(),that},_create:function(tab){var tabs,contents,content,plain=$.isPlainObject(tab),that=this;return plain||$.isArray(tab)?(tab=$.isArray(tab)?tab:[tab],tabs=map(tab,function(value,idx){return $(TabStrip.renderItem({group:that.tabGroup,item:extend(value,{index:idx})}))}),contents=map(tab,function(value,idx){if(value.content||value.contentUrl)return $(TabStrip.renderContent({item:extend(value,{index:idx})}))})):(tabs="string"==typeof tab&&"<"!=tab[0]?that.element.find(tab):$(tab),contents=$(),tabs.each(function(){if(content=$("<div class='"+CONTENT+"'/>"),/k-tabstrip-items/.test(this.parentNode.className)){var index=parseInt(this.getAttribute("aria-controls").replace(/^.*-/,""),10)-1;content=$(that.contentElement(index))}contents=contents.add(content)}),updateTabClasses(tabs)),{tabs:tabs,contents:contents}},_toggleDisabled:function(element,enable){element=this.tabGroup.find(element),element.each(function(){$(this).toggleClass(DEFAULTSTATE,enable).toggleClass(DISABLEDSTATE,!enable)})},_updateClasses:function(){var tabs,activeItem,activeTab,that=this;that.wrapper.addClass("k-widget k-header k-tabstrip"),that.tabGroup=that.wrapper.children("ul").addClass("k-tabstrip-items k-reset"),that.tabGroup[0]||(that.tabGroup=$("<ul class='k-tabstrip-items k-reset'/>").appendTo(that.wrapper)),tabs=that.tabGroup.find("li").addClass("k-item"),tabs.length&&(activeItem=tabs.filter("."+ACTIVESTATE).index(),activeTab=activeItem>=0?activeItem:undefined,that.tabGroup.contents().filter(function(){return 3==this.nodeType&&!trim(this.nodeValue)}).remove()),activeItem>=0&&tabs.eq(activeItem).addClass(TABONTOP),that.contentElements=that.wrapper.children("div"),that.contentElements.addClass(CONTENT).eq(activeTab).addClass(ACTIVESTATE).css({display:"block"}),tabs.length&&(updateTabClasses(tabs),updateFirstLast(that.tabGroup),that._updateContentElements())},_updateContentElements:function(){var that=this,contentUrls=that.options.contentUrls||[],items=that.tabGroup.find(".k-item"),tabStripID=(that.element.attr("id")||kendo.guid())+"-",contentElements=that.wrapper.children("div");contentElements.length&&items.length>contentElements.length?(contentElements.each(function(idx){var currentIndex=parseInt(this.id.replace(tabStripID,""),10),item=items.filter("[aria-controls="+tabStripID+currentIndex+"]"),id=tabStripID+(idx+1);item.data("aria",id),this.setAttribute("id",id)}),items.each(function(){var item=$(this);this.setAttribute("aria-controls",item.data("aria")),item.removeData("aria")})):items.each(function(idx){var currentContent=contentElements.eq(idx),id=tabStripID+(idx+1);this.setAttribute("aria-controls",id),!currentContent.length&&contentUrls[idx]?$("<div class='"+CONTENT+"'/>").appendTo(that.wrapper).attr("id",id):(currentContent.attr("id",id),$(this).children(".k-loading")[0]||contentUrls[idx]||$("<span class='k-loading k-complete'/>").prependTo(this)),currentContent.attr("role","tabpanel"),currentContent.filter(":not(."+ACTIVESTATE+")").attr("aria-hidden",!0).attr("aria-expanded",!1),currentContent.filter("."+ACTIVESTATE).attr("aria-expanded",!0)}),that.contentElements=that.contentAnimators=that.wrapper.children("div"),kendo.kineticScrollNeeded&&kendo.mobile.ui.Scroller&&(kendo.touchScroller(that.contentElements),that.contentElements=that.contentElements.children(".km-scroll-container"))},_toggleHover:function(e){$(e.currentTarget).toggleClass(HOVERSTATE,e.type==MOUSEENTER)},_click:function(item){var prevent,isAnchor,that=this,link=item.find("."+LINK),href=link.attr(HREF),collapse=that.options.collapsible,contentHolder=that.contentHolder(item.index());if(item.closest(".k-widget")[0]==that.wrapper[0]){if(item.is("."+DISABLEDSTATE+(collapse?"":",."+ACTIVESTATE)))return!0;if(isAnchor=link.data(CONTENTURL)||href&&("#"==href.charAt(href.length-1)||href.indexOf("#"+that.element[0].id+"-")!=-1),prevent=!href||isAnchor,that.tabGroup.children("[data-animating]").length)return prevent;if(that.trigger(SELECT,{item:item[0],contentElement:contentHolder[0]}))return!0;if(prevent!==!1)return collapse&&item.is("."+ACTIVESTATE)?(that.deactivateTab(item),!0):(that.activateTab(item)&&(prevent=!0),prevent)}},deactivateTab:function(item){var that=this,animationSettings=that.options.animation,animation=animationSettings.open,close=extend({},animationSettings.close),hasCloseAnimation=close&&"effects"in close;item=that.tabGroup.find(item),close=extend(hasCloseAnimation?close:extend({reverse:!0},animation),{hide:!0}),kendo.size(animation.effects)?(item.kendoAddClass(DEFAULTSTATE,{duration:animation.duration}),item.kendoRemoveClass(ACTIVESTATE,{duration:animation.duration})):(item.addClass(DEFAULTSTATE),item.removeClass(ACTIVESTATE)),item.removeAttr("aria-selected"),that.contentAnimators.filter("."+ACTIVESTATE).kendoStop(!0,!0).kendoAnimate(close).removeClass(ACTIVESTATE).attr("aria-hidden",!0)},activateTab:function(item){if(!this.tabGroup.children("[data-animating]").length){item=this.tabGroup.find(item);var that=this,animationSettings=that.options.animation,animation=animationSettings.open,close=extend({},animationSettings.close),hasCloseAnimation=close&&"effects"in close,neighbours=item.parent().children(),oldTab=neighbours.filter("."+ACTIVESTATE),itemIndex=neighbours.index(item);close=extend(hasCloseAnimation?close:extend({reverse:!0},animation),{hide:!0}),kendo.size(animation.effects)?(oldTab.kendoRemoveClass(ACTIVESTATE,{duration:close.duration}),item.kendoRemoveClass(HOVERSTATE,{duration:close.duration})):(oldTab.removeClass(ACTIVESTATE),item.removeClass(HOVERSTATE));var contentAnimators=that.contentAnimators;if(that.inRequest&&(that.xhr.abort(),that.inRequest=!1),0===contentAnimators.length)return oldTab.removeClass(TABONTOP),item.addClass(TABONTOP).css("z-index"),item.addClass(ACTIVESTATE),that._current(item),that.trigger("change"),!1;var visibleContents=contentAnimators.filter("."+ACTIVESTATE),contentHolder=that.contentHolder(itemIndex),contentElement=contentHolder.closest(".k-content");if(0===contentHolder.length)return visibleContents.removeClass(ACTIVESTATE).attr("aria-hidden",!0).kendoStop(!0,!0).kendoAnimate(close),!1;item.attr("data-animating",!0);var isAjaxContent=(item.children("."+LINK).data(CONTENTURL)||!1)&&contentHolder.is(EMPTY),showContentElement=function(){oldTab.removeClass(TABONTOP),item.addClass(TABONTOP).css("z-index"),kendo.size(animation.effects)?(oldTab.kendoAddClass(DEFAULTSTATE,{duration:animation.duration}),item.kendoAddClass(ACTIVESTATE,{duration:animation.duration})):(oldTab.addClass(DEFAULTSTATE),item.addClass(ACTIVESTATE)),oldTab.removeAttr("aria-selected"),item.attr("aria-selected",!0),that._current(item),contentElement.addClass(ACTIVESTATE).removeAttr("aria-hidden").kendoStop(!0,!0).attr("aria-expanded",!0).kendoAnimate(extend({init:function(){that.trigger(ACTIVATE,{item:item[0],contentElement:contentHolder[0]})}},animation,{complete:function(){item.removeAttr("data-animating")}}))},showContent=function(){isAjaxContent?(item.removeAttr("data-animating"),that.ajaxRequest(item,contentHolder,function(){item.attr("data-animating",!0),showContentElement(),that.trigger("change")})):(showContentElement(),that.trigger("change"))};return visibleContents.removeClass(ACTIVESTATE),visibleContents.attr("aria-hidden",!0),visibleContents.attr("aria-expanded",!1),visibleContents.length?visibleContents.kendoStop(!0,!0).kendoAnimate(extend({complete:showContent},close)):showContent(),!0}},contentElement:function(itemIndex){if(isNaN(itemIndex-0))return undefined;var contentElements=this.contentElements&&this.contentElements[0]&&!kendo.kineticScrollNeeded?this.contentElements:this.contentAnimators;itemIndex=contentElements&&itemIndex<0?contentElements.length+itemIndex:itemIndex;var idTest=new RegExp("-"+(itemIndex+1)+"$");if(contentElements)for(var i=0,len=contentElements.length;i<len;i++)if(idTest.test(contentElements.eq(i).closest(".k-content")[0].id))return contentElements[i];return undefined},contentHolder:function(itemIndex){var contentElement=$(this.contentElement(itemIndex)),scrollContainer=contentElement.children(".km-scroll-container");return kendo.support.touch&&scrollContainer[0]?scrollContainer:contentElement},ajaxRequest:function(element,content,complete,url){element=this.tabGroup.find(element);var that=this,xhr=$.ajaxSettings.xhr,link=element.find("."+LINK),data={},halfWidth=element.width()/2,fakeProgress=!1,statusIcon=element.find(".k-loading").removeClass("k-complete");statusIcon[0]||(statusIcon=$("<span class='k-loading'/>").prependTo(element));var endState=2*halfWidth-statusIcon.width(),oldProgressAnimation=function(){statusIcon.animate({marginLeft:(parseInt(statusIcon.css("marginLeft"),10)||0)<halfWidth?endState:0},500,oldProgressAnimation)};kendo.support.browser.msie&&kendo.support.browser.version<10&&setTimeout(oldProgressAnimation,40),url=url||link.data(CONTENTURL)||link.attr(HREF),that.inRequest=!0,that.xhr=$.ajax({type:"GET",cache:!1,url:url,dataType:"html",data:data,xhr:function(){var current=this,request=xhr(),event=current.progressUpload?"progressUpload":!!current.progress&&"progress";return request&&$.each([request,request.upload],function(){this.addEventListener&&this.addEventListener("progress",function(evt){event&&current[event](evt)},!1)}),current.noProgress=!(window.XMLHttpRequest&&"upload"in new XMLHttpRequest),request},progress:function(evt){if(evt.lengthComputable){var percent=parseInt(evt.loaded/evt.total*100,10)+"%";statusIcon.stop(!0).addClass("k-progress").css({width:percent,marginLeft:0})}},error:function(xhr,status){that.trigger("error",{xhr:xhr,status:status})&&this.complete()},stopProgress:function(){clearInterval(fakeProgress),statusIcon.stop(!0).addClass("k-progress")[0].style.cssText=""},complete:function(xhr){that.inRequest=!1,this.noProgress?setTimeout(this.stopProgress,500):this.stopProgress(),"abort"==xhr.statusText&&statusIcon.remove()},success:function(data){statusIcon.addClass("k-complete");try{var current=this,loaded=10;current.noProgress&&(statusIcon.width(loaded+"%"),fakeProgress=setInterval(function(){current.progress({lengthComputable:!0,loaded:Math.min(loaded,100),total:100}),loaded+=10},40)),content.html(data)}catch(e){var console=window.console;console&&console.error&&console.error(e.name+": "+e.message+" in "+url),this.error(this.xhr,"error")}complete&&complete.call(that,content),that.trigger(CONTENTLOAD,{item:element[0],contentElement:content[0]})}})}});extend(TabStrip,{renderItem:function(options){options=extend({tabStrip:{},group:{}},options);var empty=templates.empty,item=options.item;return templates.item(extend(options,{image:item.imageUrl?templates.image:empty,sprite:item.spriteCssClass?templates.sprite:empty,itemWrapper:templates.itemWrapper},rendering))},renderContent:function(options){return templates.content(extend(options,rendering))}}),kendo.ui.plugin(TabStrip)}(window.kendo.jQuery),function($,undefined){function setTime(date,time,ignoreDST){var offsetDiff,offset=date.getTimezoneOffset();date.setTime(date.getTime()+time),ignoreDST||(offsetDiff=date.getTimezoneOffset()-offset,date.setTime(date.getTime()+offsetDiff*MS_PER_MINUTE))}function dst(){var today=new DATE,midnight=new DATE(today.getFullYear(),today.getMonth(),today.getDate(),0,0,0),noon=new DATE(today.getFullYear(),today.getMonth(),today.getDate(),12,0,0);return-1*(midnight.getTimezoneOffset()-noon.getTimezoneOffset())}function getMilliseconds(date){return 60*date.getHours()*MS_PER_MINUTE+date.getMinutes()*MS_PER_MINUTE+1e3*date.getSeconds()+date.getMilliseconds()}function isInRange(value,min,max){var msValue,msMin=getMilliseconds(min),msMax=getMilliseconds(max);return!value||msMin==msMax||(msValue=getMilliseconds(value),msMin>msValue&&(msValue+=MS_PER_DAY),msMax<msMin&&(msMax+=MS_PER_DAY),msValue>=msMin&&msValue<=msMax)}function normalize(options){var parseFormats=options.parseFormats;options.format=extractFormat(options.format||kendo.getCulture(options.culture).calendars.standard.patterns.t),parseFormats=isArray(parseFormats)?parseFormats:[parseFormats],parseFormats.splice(0,0,options.format),options.parseFormats=parseFormats}function preventDefault(e){e.preventDefault()}var kendo=window.kendo,keys=kendo.keys,parse=kendo.parseDate,activeElement=kendo._activeElement,extractFormat=kendo._extractFormat,support=kendo.support,browser=support.browser,ui=kendo.ui,Widget=ui.Widget,OPEN="open",CLOSE="close",CHANGE="change",ns=".kendoTimePicker",CLICK="click"+ns,DEFAULT="k-state-default",DISABLED="disabled",READONLY="readonly",LI="li",SPAN="<span/>",FOCUSED="k-state-focused",HOVER="k-state-hover",HOVEREVENTS="mouseenter"+ns+" mouseleave"+ns,MOUSEDOWN="mousedown"+ns,MS_PER_MINUTE=6e4,MS_PER_DAY=864e5,SELECTED="k-state-selected",STATEDISABLED="k-state-disabled",ARIA_SELECTED="aria-selected",ARIA_EXPANDED="aria-expanded",ARIA_HIDDEN="aria-hidden",ARIA_DISABLED="aria-disabled",ARIA_READONLY="aria-readonly",ARIA_ACTIVEDESCENDANT="aria-activedescendant",ID="id",isArray=$.isArray,extend=$.extend,proxy=$.proxy,DATE=Date,TODAY=new DATE;TODAY=new DATE(TODAY.getFullYear(),TODAY.getMonth(),TODAY.getDate(),0,0,0);var TimeView=function(options){var that=this,id=options.id;that.options=options,that.ul=$('<ul tabindex="-1" role="listbox" aria-hidden="true" unselectable="on" class="k-list k-reset"/>').css({overflow:support.kineticScrollNeeded?"":"auto"}).on(CLICK,LI,proxy(that._click,that)).on("mouseenter"+ns,LI,function(){$(this).addClass(HOVER)}).on("mouseleave"+ns,LI,function(){$(this).removeClass(HOVER)}),that.list=$("<div class='k-list-container'/>").append(that.ul).on(MOUSEDOWN,preventDefault),id&&(that._timeViewID=id+"_timeview",that._optionID=id+"_option_selected",that.ul.attr(ID,that._timeViewID)),that._popup(),that.template=kendo.template('<li tabindex="-1" role="option" class="k-item" unselectable="on">#=data#</li>',{useWithBlock:!1})};TimeView.prototype={current:function(candidate){var that=this,active=that.options.active;return candidate===undefined?that._current:(that._current&&that._current.removeClass(SELECTED).removeAttr(ARIA_SELECTED).removeAttr(ID),candidate&&(candidate=$(candidate).addClass(SELECTED).attr(ID,that._optionID).attr(ARIA_SELECTED,!0),that.scroll(candidate[0])),that._current=candidate,active&&active(candidate),void 0)},close:function(){this.popup.close()},destroy:function(){var that=this;that.ul.off(ns),that.list.off(ns),that._touchScroller&&that._touchScroller.destroy(),that.popup.destroy()},open:function(){var that=this;that.ul[0].firstChild||that.bind(),that.popup.open(),that._current&&that.scroll(that._current[0])},dataBind:function(dates){for(var date,that=this,options=that.options,format=options.format,toString=kendo.toString,template=that.template,length=dates.length,idx=0,html="";idx<length;idx++)date=dates[idx],isInRange(date,options.min,options.max)&&(html+=template(toString(date,format,options.culture)));that._html(html,length)},refresh:function(){var msStart,lastIdx,length,that=this,options=that.options,format=options.format,offset=dst(),ignoreDST=offset<0,min=options.min,max=options.max,msMin=getMilliseconds(min),msMax=getMilliseconds(max),msInterval=options.interval*MS_PER_MINUTE,toString=kendo.toString,template=that.template,start=new DATE((+min)),startDay=start.getDate(),idx=0,html="";for(length=ignoreDST?(MS_PER_DAY+offset*MS_PER_MINUTE)/msInterval:MS_PER_DAY/msInterval,msMin!=msMax&&(msMin>msMax&&(msMax+=MS_PER_DAY),length=(msMax-msMin)/msInterval+1),lastIdx=parseInt(length,10);idx<length;idx++)idx&&setTime(start,msInterval,ignoreDST),msMax&&lastIdx==idx&&(msStart=getMilliseconds(start),startDay<start.getDate()&&(msStart+=MS_PER_DAY),msStart>msMax&&(start=new DATE((+max)))),html+=template(toString(start,format,options.culture));that._html(html,length)},bind:function(){var that=this,dates=that.options.dates;dates&&dates[0]?that.dataBind(dates):that.refresh()},_html:function(html,length){var that=this;that.ul[0].innerHTML=html,that._height(length),that.current(null),that.select(that._value)},scroll:function(item){if(item){var elementHeight,ul=this.ul[0],itemOffsetTop=item.offsetTop,itemOffsetHeight=item.offsetHeight,ulScrollTop=ul.scrollTop,ulOffsetHeight=ul.clientHeight,bottomDistance=itemOffsetTop+itemOffsetHeight,touchScroller=this._touchScroller;touchScroller?(elementHeight=this.list.height(),itemOffsetTop>elementHeight&&(itemOffsetTop=itemOffsetTop-elementHeight+itemOffsetHeight),touchScroller.scrollTo(0,-itemOffsetTop)):ul.scrollTop=ulScrollTop>itemOffsetTop?itemOffsetTop:bottomDistance>ulScrollTop+ulOffsetHeight?bottomDistance-ulOffsetHeight:ulScrollTop}},select:function(li){var that=this,options=that.options,current=that._current;li instanceof Date&&(li=kendo.toString(li,options.format,options.culture)),"string"==typeof li&&(current&&current.text()===li?li=current:(li=$.grep(that.ul[0].childNodes,function(node){return(node.textContent||node.innerText)==li}),li=li[0]?li:null)),that.current(li)},setOptions:function(options){var old=this.options;options.min=parse(options.min),options.max=parse(options.max),this.options=extend(old,options,{active:old.active,change:old.change,close:old.close,open:old.open}),this.bind()},toggle:function(){var that=this;that.popup.visible()?that.close():that.open()},value:function(value){var that=this;that._value=value,that.ul[0].firstChild&&that.select(value)},_click:function(e){var that=this,li=$(e.currentTarget);e.isDefaultPrevented()||(that.select(li),that.options.change(li.text(),!0),that.close())},_height:function(length){if(length){var that=this,list=that.list,parent=list.parent(".k-animation-container"),height=that.options.height;list.add(parent).show().height(that.ul[0].scrollHeight>height?height:"auto").hide()}},_parse:function(value){var that=this,options=that.options,current=that._value||TODAY;return value instanceof DATE?value:(value=parse(value,options.parseFormats,options.culture),value&&(value=new DATE(current.getFullYear(),current.getMonth(),current.getDate(),value.getHours(),value.getMinutes(),value.getSeconds(),value.getMilliseconds())),value)},_adjustListWidth:function(){var computedStyle,computedWidth,list=this.list,width=list[0].style.width,wrapper=this.options.anchor;!list.data("width")&&width||(computedStyle=window.getComputedStyle?window.getComputedStyle(wrapper[0],null):0,computedWidth=computedStyle?parseFloat(computedStyle.width):wrapper.outerWidth(),computedStyle&&(browser.mozilla||browser.msie)&&(computedWidth+=parseFloat(computedStyle.paddingLeft)+parseFloat(computedStyle.paddingRight)+parseFloat(computedStyle.borderLeftWidth)+parseFloat(computedStyle.borderRightWidth)),width=computedWidth-(list.outerWidth()-list.width()),list.css({fontFamily:wrapper.css("font-family"),width:width}).data("width",width))},_popup:function(){var that=this,list=that.list,options=that.options,anchor=options.anchor;that.popup=new ui.Popup(list,extend(options.popup,{anchor:anchor,open:options.open,close:options.close,animation:options.animation,isRtl:support.isRtl(options.anchor)})),that._touchScroller=kendo.touchScroller(that.popup.element)},move:function(e){var that=this,key=e.keyCode,ul=that.ul[0],current=that._current,down=key===keys.DOWN;if(key===keys.UP||down){if(e.altKey)return void that.toggle(down);current=down?current?current[0].nextSibling:ul.firstChild:current?current[0].previousSibling:ul.lastChild,current&&that.select(current),that.options.change(that._current.text()),e.preventDefault()}else key!==keys.ENTER&&key!==keys.TAB&&key!==keys.ESC||(e.preventDefault(),current&&that.options.change(current.text(),!0),that.close())}},TimeView.getMilliseconds=getMilliseconds,kendo.TimeView=TimeView;var TimePicker=Widget.extend({init:function(element,options){var ul,timeView,disabled,that=this;Widget.fn.init.call(that,element,options),element=that.element,options=that.options,options.min=parse(element.attr("min"))||parse(options.min),options.max=parse(element.attr("max"))||parse(options.max),normalize(options),that._wrapper(),that.timeView=timeView=new TimeView(extend({},options,{id:element.attr(ID),anchor:that.wrapper,format:options.format,change:function(value,trigger){trigger?that._change(value):element.val(value)},open:function(e){that.timeView._adjustListWidth(),that.trigger(OPEN)?e.preventDefault():(element.attr(ARIA_EXPANDED,!0),ul.attr(ARIA_HIDDEN,!1))},close:function(e){that.trigger(CLOSE)?e.preventDefault():(element.attr(ARIA_EXPANDED,!1),ul.attr(ARIA_HIDDEN,!0))},active:function(current){element.removeAttr(ARIA_ACTIVEDESCENDANT),current&&element.attr(ARIA_ACTIVEDESCENDANT,timeView._optionID)}})),ul=timeView.ul,that._icon(),that._reset();try{element[0].setAttribute("type","text")}catch(e){element[0].type="text"}element.addClass("k-input").attr({role:"combobox","aria-expanded":!1,"aria-owns":timeView._timeViewID}),disabled=element.is("[disabled]"),disabled?that.enable(!1):that.readonly(element.is("[readonly]")),that._old=that._update(options.value||that.element.val()),that._oldText=element.val(),kendo.notify(that)},options:{name:"TimePicker",min:TODAY,max:TODAY,format:"",dates:[],parseFormats:[],value:null,interval:30,height:200,animation:{}},events:[OPEN,CLOSE,CHANGE],setOptions:function(options){var that=this,value=that._value;Widget.fn.setOptions.call(that,options),options=that.options,normalize(options),that.timeView.setOptions(options),value&&that.element.val(kendo.toString(value,options.format,options.culture))},dataBind:function(dates){isArray(dates)&&this.timeView.dataBind(dates)},_editable:function(options){var that=this,disable=options.disable,readonly=options.readonly,arrow=that._arrow.off(ns),element=that.element.off(ns),wrapper=that._inputWrapper.off(ns);readonly||disable?(wrapper.addClass(disable?STATEDISABLED:DEFAULT).removeClass(disable?DEFAULT:STATEDISABLED),element.attr(DISABLED,disable).attr(READONLY,readonly).attr(ARIA_DISABLED,disable).attr(ARIA_READONLY,readonly)):(wrapper.addClass(DEFAULT).removeClass(STATEDISABLED).on(HOVEREVENTS,that._toggleHover),element.removeAttr(DISABLED).removeAttr(READONLY).attr(ARIA_DISABLED,!1).attr(ARIA_READONLY,!1).on("keydown"+ns,proxy(that._keydown,that)).on("blur"+ns,proxy(that._blur,that)).on("focus"+ns,function(){that._inputWrapper.addClass(FOCUSED)}),arrow.on(CLICK,proxy(that._click,that)).on(MOUSEDOWN,preventDefault))},readonly:function(readonly){this._editable({readonly:readonly===undefined||readonly,disable:!1})},enable:function(enable){this._editable({readonly:!1,disable:!(enable=enable===undefined||enable)})},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.timeView.destroy(),that.element.off(ns),that._arrow.off(ns),that._inputWrapper.off(ns),that._form&&that._form.off("reset",that._resetHandler)},close:function(){this.timeView.close()},open:function(){this.timeView.open()},min:function(value){return this._option("min",value)},max:function(value){return this._option("max",value)},value:function(value){var that=this;return value===undefined?that._value:(that._old=that._update(value),null===that._old&&that.element.val(""),void(that._oldText=that.element.val()))},_blur:function(){var that=this,value=that.element.val();that.close(),value!==that._oldText&&that._change(value),that._inputWrapper.removeClass(FOCUSED)},_click:function(){var that=this,element=that.element;that.timeView.toggle(),support.touch||element[0]===activeElement()||element.focus()},_change:function(value){var that=this;value=that._update(value),+that._old!=+value&&(that._old=value,that._oldText=that.element.val(),that.trigger(CHANGE),that.element.trigger(CHANGE))},_icon:function(){var arrow,that=this,element=that.element;arrow=element.next("span.k-select"),arrow[0]||(arrow=$('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-clock">select</span></span>').insertAfter(element)),that._arrow=arrow.attr({role:"button","aria-controls":that.timeView._timeViewID})},_keydown:function(e){var that=this,key=e.keyCode,timeView=that.timeView,value=that.element.val();timeView.popup.visible()||e.altKey?timeView.move(e):key===keys.ENTER&&value!==that._oldText&&that._change(value)},_option:function(option,value){var that=this,options=that.options;return value===undefined?options[option]:(value=that.timeView._parse(value),void(value&&(value=new DATE((+value)),options[option]=value,that.timeView.options[option]=value,that.timeView.bind())))},_toggleHover:function(e){$(e.currentTarget).toggleClass(HOVER,"mouseenter"===e.type)},_update:function(value){var that=this,options=that.options,timeView=that.timeView,date=timeView._parse(value);return isInRange(date,options.min,options.max)||(date=null),that._value=date,that.element.val(date?kendo.toString(date,options.format,options.culture):value),timeView.value(date),date},_wrapper:function(){var wrapper,that=this,element=that.element;wrapper=element.parents(".k-timepicker"),wrapper[0]||(wrapper=element.wrap(SPAN).parent().addClass("k-picker-wrap k-state-default"),wrapper=wrapper.wrap(SPAN).parent()),wrapper[0].style.cssText=element[0].style.cssText,that.wrapper=wrapper.addClass("k-widget k-timepicker k-header").addClass(element[0].className),element.css({width:"100%",height:element[0].style.height}),that._inputWrapper=$(wrapper[0].firstChild)},_reset:function(){var that=this,element=that.element,formId=element.attr("form"),form=formId?$("#"+formId):element.closest("form");form[0]&&(that._resetHandler=function(){that.value(element[0].defaultValue)},that._form=form.on("reset",that._resetHandler))}});ui.plugin(TimePicker)}(window.kendo.jQuery),function($,undefined){function lastTimeOption(interval){var date=new Date(2100,0,1);return date.setMinutes(-interval),date}function preventDefault(e){e.preventDefault()}function normalize(options){var timeFormat,patterns=kendo.getCulture(options.culture).calendars.standard.patterns;options.format=extractFormat(options.format||patterns.g),options.timeFormat=timeFormat=extractFormat(options.timeFormat||patterns.t),kendo.DateView.normalize(options),$.inArray(timeFormat,options.parseFormats)===-1&&options.parseFormats.splice(1,0,timeFormat)}var kendo=window.kendo,TimeView=kendo.TimeView,parse=kendo.parseDate,activeElement=kendo._activeElement,extractFormat=kendo._extractFormat,calendar=kendo.calendar,isInRange=calendar.isInRange,restrictValue=calendar.restrictValue,isEqualDatePart=calendar.isEqualDatePart,getMilliseconds=TimeView.getMilliseconds,ui=kendo.ui,Widget=ui.Widget,OPEN="open",CLOSE="close",CHANGE="change",ns=".kendoDateTimePicker",CLICK="click"+ns,DISABLED="disabled",READONLY="readonly",DEFAULT="k-state-default",FOCUSED="k-state-focused",HOVER="k-state-hover",STATEDISABLED="k-state-disabled",HOVEREVENTS="mouseenter"+ns+" mouseleave"+ns,MOUSEDOWN="mousedown"+ns,MONTH="month",SPAN="<span/>",ARIA_ACTIVEDESCENDANT="aria-activedescendant",ARIA_EXPANDED="aria-expanded",ARIA_HIDDEN="aria-hidden",ARIA_OWNS="aria-owns",ARIA_DISABLED="aria-disabled",ARIA_READONLY="aria-readonly",DATE=Date,MIN=new DATE(1900,0,1),MAX=new DATE(2099,11,31),dateViewParams={view:"date"},timeViewParams={view:"time"},extend=$.extend,DateTimePicker=Widget.extend({init:function(element,options){var disabled,that=this;Widget.fn.init.call(that,element,options),element=that.element,options=that.options,
options.min=parse(element.attr("min"))||parse(options.min),options.max=parse(element.attr("max"))||parse(options.max),normalize(options),that._wrapper(),that._views(),that._icons(),that._reset(),that._template();try{element[0].setAttribute("type","text")}catch(e){element[0].type="text"}element.addClass("k-input").attr({role:"combobox","aria-expanded":!1}),that._midnight=getMilliseconds(options.min)+getMilliseconds(options.max)===0,disabled=element.is("[disabled]"),disabled?that.enable(!1):that.readonly(element.is("[readonly]")),that._old=that._update(options.value||that.element.val()),that._oldText=element.val(),kendo.notify(that)},options:{name:"DateTimePicker",value:null,format:"",timeFormat:"",culture:"",parseFormats:[],dates:[],min:new DATE(MIN),max:new DATE(MAX),interval:30,height:200,footer:"",start:MONTH,depth:MONTH,animation:{},month:{},ARIATemplate:'Current focused date is #=kendo.toString(data.current, "d")#'},events:[OPEN,CLOSE,CHANGE],setOptions:function(options){var min,max,currentValue,that=this,value=that._value;that.dateView.options,that.timeView.options;Widget.fn.setOptions.call(that,options),options=that.options,options.min=min=parse(options.min),options.max=max=parse(options.max),normalize(options),currentValue=options.value||that._value||that.dateView._current,min&&!isEqualDatePart(min,currentValue)&&(min=new DATE(MIN)),max&&!isEqualDatePart(max,currentValue)&&(max=new DATE(MAX)),that.dateView.setOptions(options),that.timeView.setOptions(extend({},options,{format:options.timeFormat,min:min,max:max})),value&&(that.element.val(kendo.toString(value,options.format,options.culture)),that._updateARIA(value))},_editable:function(options){var that=this,element=that.element.off(ns),dateIcon=that._dateIcon.off(ns),timeIcon=that._timeIcon.off(ns),wrapper=that._inputWrapper.off(ns),readonly=options.readonly,disable=options.disable;readonly||disable?(wrapper.addClass(disable?STATEDISABLED:DEFAULT).removeClass(disable?DEFAULT:STATEDISABLED),element.attr(DISABLED,disable).attr(READONLY,readonly).attr(ARIA_DISABLED,disable).attr(ARIA_READONLY,readonly)):(wrapper.addClass(DEFAULT).removeClass(STATEDISABLED).on(HOVEREVENTS,that._toggleHover),element.removeAttr(DISABLED).removeAttr(READONLY).attr(ARIA_DISABLED,!1).attr(ARIA_READONLY,!1).on("keydown"+ns,$.proxy(that._keydown,that)).on("focus"+ns,function(){that._inputWrapper.addClass(FOCUSED)}).on("blur"+ns,function(){that._inputWrapper.removeClass(FOCUSED),element.val()!==that._oldText&&that._change(element.val()),that.close("date"),that.close("time")}),dateIcon.on(MOUSEDOWN,preventDefault).on(CLICK,function(){that.toggle("date"),kendo.support.touch||element[0]===activeElement()||element.focus()}),timeIcon.on(MOUSEDOWN,preventDefault).on(CLICK,function(){that.toggle("time"),kendo.support.touch||element[0]===activeElement()||element.focus()}))},readonly:function(readonly){this._editable({readonly:readonly===undefined||readonly,disable:!1})},enable:function(enable){this._editable({readonly:!1,disable:!(enable=enable===undefined||enable)})},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.dateView.destroy(),that.timeView.destroy(),that.element.off(ns),that._dateIcon.off(ns),that._timeIcon.off(ns),that._inputWrapper.off(ns),that._form&&that._form.off("reset",that._resetHandler)},close:function(view){"time"!==view&&(view="date"),this[view+"View"].close()},open:function(view){"time"!==view&&(view="date"),this[view+"View"].open()},min:function(value){return this._option("min",value)},max:function(value){return this._option("max",value)},toggle:function(view){var secondView="timeView";"time"!==view?view="date":secondView="dateView",this[view+"View"].toggle(),this[secondView].close()},value:function(value){var that=this;return value===undefined?that._value:(that._old=that._update(value),null===that._old&&that.element.val(""),void(that._oldText=that.element.val()))},_change:function(value){var that=this;value=that._update(value),+that._old!=+value&&(that._old=value,that._oldText=that.element.val(),that.trigger(CHANGE),that.element.trigger(CHANGE))},_option:function(option,value){var minDateEqual,maxDateEqual,that=this,options=that.options,timeView=that.timeView,timeViewOptions=timeView.options,current=that._value||that._old;if(value===undefined)return options[option];if(value=parse(value,options.parseFormats,options.culture)){if(options.min.getTime()===options.max.getTime()&&(timeViewOptions.dates=[]),options[option]=new DATE(value.getTime()),that.dateView[option](value),that._midnight=getMilliseconds(options.min)+getMilliseconds(options.max)===0,current&&(minDateEqual=isEqualDatePart(options.min,current),maxDateEqual=isEqualDatePart(options.max,current)),minDateEqual||maxDateEqual){if(timeViewOptions[option]=value,minDateEqual&&!maxDateEqual&&(timeViewOptions.max=lastTimeOption(options.interval)),maxDateEqual){if(that._midnight)return void timeView.dataBind([MAX]);minDateEqual||(timeViewOptions.min=MIN)}}else timeViewOptions.max=MAX,timeViewOptions.min=MIN;timeView.bind()}},_toggleHover:function(e){$(e.currentTarget).toggleClass(HOVER,"mouseenter"===e.type)},_update:function(value){var rebind,timeViewOptions,old,skip,formattedValue,that=this,options=that.options,min=options.min,max=options.max,dates=options.dates,timeView=that.timeView,current=that._value,date=parse(value,options.parseFormats,options.culture),isSameType=null===date&&null===current||date instanceof Date&&current instanceof Date;return+date===+current&&isSameType?(formattedValue=kendo.toString(date,options.format,options.culture),formattedValue!==value&&that.element.val(null===date?value:formattedValue),date):(null!==date&&isEqualDatePart(date,min)?date=restrictValue(date,min,max):isInRange(date,min,max)||(date=null),that._value=date,timeView.value(date),that.dateView.value(date),date&&(old=that._old,timeViewOptions=timeView.options,dates[0]&&(dates=$.grep(dates,function(d){return isEqualDatePart(date,d)}),dates[0]&&(timeView.dataBind(dates),skip=!0)),skip||(isEqualDatePart(date,min)&&(timeViewOptions.min=min,timeViewOptions.max=lastTimeOption(options.interval),rebind=!0),isEqualDatePart(date,max)&&(that._midnight?(timeView.dataBind([MAX]),skip=!0):(timeViewOptions.max=max,rebind||(timeViewOptions.min=MIN),rebind=!0))),!skip&&(!old&&rebind||old&&!isEqualDatePart(old,date))&&(rebind||(timeViewOptions.max=MAX,timeViewOptions.min=MIN),timeView.bind())),that.element.val(date?kendo.toString(date,options.format,options.culture):value),that._updateARIA(date),date)},_keydown:function(e){var that=this,dateView=that.dateView,timeView=that.timeView,value=that.element.val(),isDateViewVisible=dateView.popup.visible();e.altKey&&e.keyCode===kendo.keys.DOWN?that.toggle(isDateViewVisible?"time":"date"):isDateViewVisible?(dateView.move(e),that._updateARIA(dateView._current)):timeView.popup.visible()?timeView.move(e):e.keyCode===kendo.keys.ENTER&&value!==that._oldText&&that._change(value)},_views:function(){var dateView,timeView,div,ul,msMin,date,that=this,element=that.element,options=that.options,id=element.attr("id");that.dateView=dateView=new kendo.DateView(extend({},options,{id:id,anchor:that.wrapper,change:function(){var current,value=dateView.calendar.value(),msValue=+value,msMin=+options.min,msMax=+options.max;msValue!==msMin&&msValue!==msMax||(current=new DATE((+that._value)),current.setFullYear(value.getFullYear(),value.getMonth(),value.getDate()),isInRange(current,msMin,msMax)&&(value=current)),that._change(value),that.close("date")},close:function(e){that.trigger(CLOSE,dateViewParams)?e.preventDefault():(element.attr(ARIA_EXPANDED,!1),div.attr(ARIA_HIDDEN,!0),timeView.popup.visible()||element.removeAttr(ARIA_OWNS))},open:function(e){that.trigger(OPEN,dateViewParams)?e.preventDefault():(that.element.val()!==that._oldText&&(date=parse(element.val(),options.parseFormats,options.culture),that.dateView[date?"current":"value"](date)),div.attr(ARIA_HIDDEN,!1),element.attr(ARIA_EXPANDED,!0).attr(ARIA_OWNS,dateView._dateViewID),that._updateARIA(date))}})),div=dateView.div,msMin=options.min.getTime(),that.timeView=timeView=new TimeView({id:id,value:options.value,anchor:that.wrapper,animation:options.animation,format:options.timeFormat,culture:options.culture,height:options.height,interval:options.interval,min:new DATE(MIN),max:new DATE(MAX),dates:msMin===options.max.getTime()?[new Date(msMin)]:[],parseFormats:options.parseFormats,change:function(value,trigger){value=timeView._parse(value),value<options.min?(value=new DATE((+options.min)),timeView.options.min=value):value>options.max&&(value=new DATE((+options.max)),timeView.options.max=value),trigger?(that._timeSelected=!0,that._change(value)):(element.val(kendo.toString(value,options.format,options.culture)),dateView.value(value),that._updateARIA(value))},close:function(e){that.trigger(CLOSE,timeViewParams)?e.preventDefault():(ul.attr(ARIA_HIDDEN,!0),element.attr(ARIA_EXPANDED,!1),dateView.popup.visible()||element.removeAttr(ARIA_OWNS))},open:function(e){timeView._adjustListWidth(),that.trigger(OPEN,timeViewParams)?e.preventDefault():(ul.attr(ARIA_HIDDEN,!1),element.attr(ARIA_EXPANDED,!0).attr(ARIA_OWNS,timeView._timeViewID),timeView.options.active(timeView.current()))},active:function(current){element.removeAttr(ARIA_ACTIVEDESCENDANT),current&&element.attr(ARIA_ACTIVEDESCENDANT,timeView._optionID)}}),ul=timeView.ul},_icons:function(){var icons,that=this,element=that.element;icons=element.next("span.k-select"),icons[0]||(icons=$('<span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-calendar">select</span><span unselectable="on" class="k-icon k-i-clock">select</span></span>').insertAfter(element)),icons=icons.children(),that._dateIcon=icons.eq(0).attr({role:"button","aria-controls":that.dateView._dateViewID}),that._timeIcon=icons.eq(1).attr({role:"button","aria-controls":that.timeView._timeViewID})},_wrapper:function(){var wrapper,that=this,element=that.element;wrapper=element.parents(".k-datetimepicker"),wrapper[0]||(wrapper=element.wrap(SPAN).parent().addClass("k-picker-wrap k-state-default"),wrapper=wrapper.wrap(SPAN).parent()),wrapper[0].style.cssText=element[0].style.cssText,element.css({width:"100%",height:element[0].style.height}),that.wrapper=wrapper.addClass("k-widget k-datetimepicker k-header").addClass(element[0].className),that._inputWrapper=$(wrapper[0].firstChild)},_reset:function(){var that=this,element=that.element,formId=element.attr("form"),form=formId?$("#"+formId):element.closest("form");form[0]&&(that._resetHandler=function(){that.value(element[0].defaultValue)},that._form=form.on("reset",that._resetHandler))},_template:function(){this._ariaTemplate=kendo.template(this.options.ARIATemplate)},_updateARIA:function(date){var cell,that=this,calendar=that.dateView.calendar;that.element.removeAttr(ARIA_ACTIVEDESCENDANT),calendar&&(cell=calendar._cell,cell.attr("aria-label",that._ariaTemplate({current:date||calendar.current()})),that.element.attr(ARIA_ACTIVEDESCENDANT,cell.attr("id")))}});ui.plugin(DateTimePicker)}(window.kendo.jQuery),function($,undefined){function contentChild(filter){return function(node){var result=node.children(".k-animation-container");return result.length||(result=node),result.children(filter)}}function templateNoWith(code){return kendo.template(code,{useWithBlock:!1})}function checkboxes(node){return node.children("div").find(".k-checkbox:first :checkbox")}function insertAction(indexOffset){return function(nodeData,referenceNode){referenceNode=referenceNode.closest(NODE);var parentNode,group=referenceNode.parent();return group.parent().is("li")&&(parentNode=group.parent()),this._dataSourceMove(nodeData,group,parentNode,function(dataSource,model){return this._insert(dataSource.data(),model,referenceNode.index()+indexOffset)})}}function moveContents(node,container){for(var tmp;node&&"ul"!=node.nodeName.toLowerCase();)tmp=node,node=node.nextSibling,3==tmp.nodeType&&(tmp.nodeValue=$.trim(tmp.nodeValue)),spriteRe.test(tmp.className)?container.insertBefore(tmp,container.firstChild):container.appendChild(tmp)}function updateNodeHtml(node){var wrapper=node.children("div"),group=node.children("ul"),toggleButton=wrapper.children(".k-icon"),checkbox=node.children(":checkbox"),innerWrapper=wrapper.children(".k-in");node.hasClass("k-treeview")||(wrapper.length||(wrapper=$("<div />").prependTo(node)),!toggleButton.length&&group.length?toggleButton=$("<span class='k-icon' />").prependTo(wrapper):group.length&&group.children().length||(toggleButton.remove(),group.remove()),checkbox.length&&$("<span class='k-checkbox' />").appendTo(wrapper).append(checkbox),innerWrapper.length||(innerWrapper=node.children("a").eq(0).addClass("k-in"),innerWrapper.length||(innerWrapper=$("<span class='k-in' />")),innerWrapper.appendTo(wrapper),wrapper.length&&moveContents(wrapper[0].nextSibling,innerWrapper[0])))}function TreeViewDragAndDrop(treeview){var that=this;that.treeview=treeview,that.hovered=treeview.element,that._draggable=new ui.Draggable(treeview.element,{filter:"div:not(.k-state-disabled) .k-in",hint:function(node){return treeview.templates.dragClue({item:treeview.dataItem(node),treeview:treeview.options})},cursorOffset:{left:10,top:kendo.support.touch||kendo.support.msPointers||kendo.support.pointers?-40/kendo.support.zoomLevel():10},dragstart:proxy(that.dragstart,that),dragcancel:proxy(that.dragcancel,that),drag:proxy(that.drag,that),dragend:proxy(that.dragend,that)})}var TreeView,subGroup,nodeContents,nodeIcon,spriteRe,kendo=window.kendo,ui=kendo.ui,data=kendo.data,extend=$.extend,template=kendo.template,isArray=$.isArray,Widget=ui.Widget,HierarchicalDataSource=data.HierarchicalDataSource,proxy=$.proxy,keys=kendo.keys,NS=".kendoTreeView",SELECT="select",NAVIGATE="navigate",EXPAND="expand",CHANGE="change",ERROR="error",CHECKED="checked",INDETERMINATE="indeterminate",COLLAPSE="collapse",DRAGSTART="dragstart",DRAG="drag",DROP="drop",DRAGEND="dragend",DATABOUND="dataBound",CLICK="click",VISIBILITY="visibility",UNDEFINED="undefined",KSTATEHOVER="k-state-hover",KTREEVIEW="k-treeview",VISIBLE=":visible",NODE=".k-item",STRING="string",ARIASELECTED="aria-selected",ARIADISABLED="aria-disabled",bindings={text:"dataTextField",url:"dataUrlField",spriteCssClass:"dataSpriteCssClassField",imageUrl:"dataImageUrlField"},isDomElement=function(o){return"object"==typeof HTMLElement?o instanceof HTMLElement:o&&"object"==typeof o&&1===o.nodeType&&typeof o.nodeName===STRING};subGroup=contentChild(".k-group"),nodeContents=contentChild(".k-group,.k-content"),nodeIcon=function(node){return node.children("div").children(".k-icon")},spriteRe=/k-sprite/,TreeView=Widget.extend({init:function(element,options){var dataInit,list,that=this,inferred=!1,hasDataSource=options&&!!options.dataSource;isArray(options)&&(dataInit=!0,options={dataSource:options}),options&&typeof options.loadOnDemand==UNDEFINED&&isArray(options.dataSource)&&(options.loadOnDemand=!1),Widget.prototype.init.call(that,element,options),element=that.element,options=that.options,list=element.is("ul")&&element||element.hasClass(KTREEVIEW)&&element.children("ul"),inferred=!hasDataSource&&list.length,inferred&&(options.dataSource.list=list),that._animation(),that._accessors(),that._templates(),element.hasClass(KTREEVIEW)?(that.wrapper=element,that.root=element.children("ul").eq(0)):(that._wrapper(),list&&(that.root=element,that._group(that.wrapper))),that._tabindex(),that.wrapper.filter("[role=tree]").length||that.wrapper.attr("role","tree"),that._dataSource(inferred),that._attachEvents(),that._dragging(),inferred?that._syncHtmlAndDataSource():options.autoBind&&(that._progress(!0),that.dataSource.fetch()),options.checkboxes&&options.checkboxes.checkChildren&&that.updateIndeterminate(),that.element[0].id&&(that._ariaId=kendo.format("{0}_tv_active",that.element[0].id)),kendo.notify(that)},_attachEvents:function(){var that=this,clickableItems=".k-in:not(.k-state-selected,.k-state-disabled)",MOUSEENTER="mouseenter";that.wrapper.on(MOUSEENTER+NS,".k-in.k-state-selected",function(e){e.preventDefault()}).on(MOUSEENTER+NS,clickableItems,function(){$(this).addClass(KSTATEHOVER)}).on("mouseleave"+NS,clickableItems,function(){$(this).removeClass(KSTATEHOVER)}).on(CLICK+NS,clickableItems,proxy(that._click,that)).on("dblclick"+NS,".k-in:not(.k-state-disabled)",proxy(that._toggleButtonClick,that)).on(CLICK+NS,".k-plus,.k-minus",proxy(that._toggleButtonClick,that)).on("keydown"+NS,proxy(that._keydown,that)).on("focus"+NS,proxy(that._focus,that)).on("blur"+NS,proxy(that._blur,that)).on("mousedown"+NS,".k-in,.k-checkbox :checkbox,.k-plus,.k-minus",proxy(that._mousedown,that)).on("change"+NS,".k-checkbox :checkbox",proxy(that._checkboxChange,that)).on("click"+NS,".k-checkbox :checkbox",proxy(that._checkboxClick,that)).on("click"+NS,".k-request-retry",proxy(that._retryRequest,that)).on("click"+NS,function(e){$(e.target).is(":kendoFocusable")||that.focus()})},_checkboxClick:function(e){var checkbox=$(e.target);checkbox.data(INDETERMINATE)&&(checkbox.data(INDETERMINATE,!1).prop(INDETERMINATE,!1).prop(CHECKED,!0),this._checkboxChange(e))},_syncHtmlAndDataSource:function(root,dataSource){root=root||this.root,dataSource=dataSource||this.dataSource;var i,item,dataItem,data=dataSource.view(),uidAttr=kendo.attr("uid"),expandedAttr=kendo.attr("expanded"),inferCheckedState=this.options.checkboxes,items=root.children("li");for(i=0;i<items.length;i++)dataItem=data[i],item=items.eq(i),item.attr("role","treeitem").attr(uidAttr,dataItem.uid),dataItem.expanded="true"===item.attr(expandedAttr),inferCheckedState&&(dataItem.checked=checkboxes(item).prop(CHECKED)),this._syncHtmlAndDataSource(item.children("ul"),dataItem.children)},_animation:function(){var options=this.options,animationOptions=options.animation;animationOptions===!1?animationOptions={expand:{effects:{}},collapse:{hide:!0,effects:{}}}:animationOptions.collapse&&"effects"in animationOptions.collapse||(animationOptions.collapse=extend({reverse:!0},animationOptions.expand)),extend(animationOptions.collapse,{hide:!0}),options.animation=animationOptions},_dragging:function(){var enabled=this.options.dragAndDrop,dragging=this.dragging;enabled&&!dragging?this.dragging=new TreeViewDragAndDrop(this):!enabled&&dragging&&(dragging.destroy(),this.dragging=null)},_templates:function(){var that=this,options=that.options,fieldAccessor=proxy(that._fieldAccessor,that);options.template&&typeof options.template==STRING?options.template=template(options.template):options.template||(options.template=templateNoWith("# var text = "+fieldAccessor("text")+"(data.item); ## if (typeof data.item.encoded != 'undefined' && data.item.encoded === false) {##= text ## } else { ##: text ## } #")),that._checkboxes(),that.templates={wrapperCssClass:function(group,item){var result="k-item",index=item.index;return group.firstLevel&&0===index&&(result+=" k-first"),index==group.length-1&&(result+=" k-last"),result},cssClass:function(group,item){var result="",index=item.index,groupLength=group.length-1;return group.firstLevel&&0===index&&(result+="k-top "),result+=0===index&&index!=groupLength?"k-top":index==groupLength?"k-bot":"k-mid"},textClass:function(item){var result="k-in";return item.enabled===!1&&(result+=" k-state-disabled"),item.selected===!0&&(result+=" k-state-selected"),result},toggleButtonClass:function(item){var result="k-icon";return result+=item.expanded!==!0?" k-plus":" k-minus",item.enabled===!1&&(result+="-disabled"),result},groupAttributes:function(group){return group.expanded!==!0?" style='display:none'":""},groupCssClass:function(group){var cssClass="k-group";return group.firstLevel&&(cssClass+=" k-treeview-lines"),cssClass},dragClue:templateNoWith("<div class='k-header k-drag-clue'><span class='k-icon k-drag-status' />#= data.treeview.template(data) #</div>"),group:templateNoWith("<ul class='#= data.r.groupCssClass(data.group) #'#= data.r.groupAttributes(data.group) # role='group'>#= data.renderItems(data) #</ul>"),itemContent:templateNoWith("# var imageUrl = "+fieldAccessor("imageUrl")+"(data.item); ## var spriteCssClass = "+fieldAccessor("spriteCssClass")+"(data.item); ## if (imageUrl) { #<img class='k-image' alt='' src='#= imageUrl #'># } ## if (spriteCssClass) { #<span class='k-sprite #= spriteCssClass #' /># } ##= data.treeview.template(data) #"),itemElement:templateNoWith("# var item = data.item, r = data.r; ## var url = "+fieldAccessor("url")+"(item); #<div class='#= r.cssClass(data.group, item) #'># if (item.hasChildren) { #<span class='#= r.toggleButtonClass(item) #' role='presentation' /># } ## if (data.treeview.checkboxes) { #<span class='k-checkbox' role='presentation'>#= data.treeview.checkboxes.template(data) #</span># } ## var tag = url ? 'a' : 'span'; ## var textAttr = url ? ' href=\\'' + url + '\\'' : ''; #<#=tag#  class='#= r.textClass(item) #'#= textAttr #>#= r.itemContent(data) #</#=tag#></div>"),item:templateNoWith("# var item = data.item, r = data.r; #<li role='treeitem' class='#= r.wrapperCssClass(data.group, item) #' "+kendo.attr("uid")+"='#= item.uid #'#=item.selected ? \"aria-selected='true'\" : ''##=item.enabled === false ? \"aria-disabled='true'\" : ''#>#= r.itemElement(data) #</li>"),loading:templateNoWith("<div class='k-icon k-loading' /> #: data.messages.loading #"),retry:templateNoWith("#: data.messages.requestFailed # <button class='k-button k-request-retry'>#: data.messages.retry #</button>")}},items:function(){return this.element.find(".k-item")},setDataSource:function(dataSource){this.options.dataSource=dataSource,this._dataSource(),this.dataSource.fetch()},_bindDataSource:function(){this._refreshHandler=proxy(this.refresh,this),this._errorHandler=proxy(this._error,this),this.dataSource.bind(CHANGE,this._refreshHandler),this.dataSource.bind(ERROR,this._errorHandler)},_unbindDataSource:function(){var dataSource=this.dataSource;dataSource&&(dataSource.unbind(CHANGE,this._refreshHandler),dataSource.unbind(ERROR,this._errorHandler))},_dataSource:function(silentRead){function recursiveRead(data){for(var i=0;i<data.length;i++)data[i]._initChildren(),data[i].children.fetch(),recursiveRead(data[i].children.view())}var that=this,options=that.options,dataSource=options.dataSource;dataSource=isArray(dataSource)?{data:dataSource}:dataSource,that._unbindDataSource(),dataSource.fields||(dataSource.fields=[{field:"text"},{field:"url"},{field:"spriteCssClass"},{field:"imageUrl"}]),that.dataSource=dataSource=HierarchicalDataSource.create(dataSource),silentRead&&(dataSource.fetch(),recursiveRead(dataSource.view())),that._bindDataSource()},events:[DRAGSTART,DRAG,DROP,DRAGEND,DATABOUND,EXPAND,COLLAPSE,SELECT,CHANGE,NAVIGATE],options:{name:"TreeView",dataSource:{},animation:{expand:{effects:"expand:vertical",duration:200},collapse:{duration:100}},messages:{loading:"Loading...",requestFailed:"Request failed.",retry:"Retry"},dragAndDrop:!1,checkboxes:!1,autoBind:!0,loadOnDemand:!0,template:"",dataTextField:null},_accessors:function(){var i,field,textField,that=this,options=that.options,element=that.element;for(i in bindings)field=options[bindings[i]],textField=element.attr(kendo.attr(i+"-field")),!field&&textField&&(field=textField),field||(field=i),isArray(field)||(field=[field]),options[bindings[i]]=field},_fieldAccessor:function(fieldName){var fieldBindings=this.options[bindings[fieldName]],count=fieldBindings.length,result="(function(item) {";return 0===count?result+="return item['"+fieldName+"'];":(result+="var levels = ["+$.map(fieldBindings,function(x){return"function(d){ return "+kendo.expr(x)+"}"}).join(",")+"];",result+="return levels[Math.min(item.level(), "+count+"-1)](item)"),result+="})"},setOptions:function(options){Widget.fn.setOptions.call(this,options),this._animation(),this._dragging(),this._templates()},_trigger:function(eventName,node){return this.trigger(eventName,{node:node.closest(NODE)[0]})},_setChecked:function(datasource,value){if(datasource&&$.isFunction(datasource.view))for(var i=0,nodes=datasource.view();i<nodes.length;i++)nodes[i][CHECKED]=value,nodes[i].children&&this._setChecked(nodes[i].children,value)},_setIndeterminate:function(node){var siblings,length,i,group=subGroup(node),all=!0;if(group.length&&(siblings=checkboxes(group.children()),length=siblings.length)){if(length>1){for(i=1;i<length;i++)if(siblings[i].checked!=siblings[i-1].checked||siblings[i].indeterminate||siblings[i-1].indeterminate){all=!1;break}}else all=!siblings[0].indeterminate;return checkboxes(node).data(INDETERMINATE,!all).prop(INDETERMINATE,!all).prop(CHECKED,all&&siblings[0].checked)}},updateIndeterminate:function(node){node=node||this.wrapper;var i,checkbox,subnodes=subGroup(node).children();if(subnodes.length){for(i=0;i<subnodes.length;i++)this.updateIndeterminate(subnodes.eq(i));checkbox=this._setIndeterminate(node),checkbox&&checkbox.prop(CHECKED)&&(this.dataItem(node).checked=!0)}},_bubbleIndeterminate:function(node){if(node.length){var checkbox,parentNode=this.parent(node);parentNode.length&&(this._setIndeterminate(parentNode),checkbox=parentNode.children("div").find(".k-checkbox :checkbox"),checkbox.prop(INDETERMINATE)===!1?this.dataItem(parentNode).set(CHECKED,checkbox.prop(CHECKED)):this.dataItem(parentNode).checked=!1,this._bubbleIndeterminate(parentNode))}},_checkboxChange:function(e){var checkbox=$(e.target),isChecked=checkbox.prop(CHECKED),node=checkbox.closest(NODE);this.dataItem(node).set(CHECKED,isChecked)},_toggleButtonClick:function(e){this.toggle($(e.target).closest(NODE))},_mousedown:function(e){var node=$(e.currentTarget).closest(NODE);this._clickTarget=node,this.current(node)},_focusable:function(node){return node&&node.length&&node.is(":visible")&&!node.find(".k-in:first").hasClass("k-state-disabled")},_focus:function(){var current=this.select(),clickTarget=this._clickTarget;kendo.support.touch||(clickTarget&&clickTarget.length&&(current=clickTarget),this._focusable(current)||(current=this.current()),this._focusable(current)||(current=this._nextVisible($())),this.current(current))},focus:function(){var i,wrapper=this.wrapper,scrollContainer=wrapper[0],containers=[],offsets=[],documentElement=document.documentElement;do scrollContainer=scrollContainer.parentNode,scrollContainer.scrollHeight>scrollContainer.clientHeight&&(containers.push(scrollContainer),offsets.push(scrollContainer.scrollTop));while(scrollContainer!=documentElement);for(wrapper.focus(),i=0;i<containers.length;i++)containers[i].scrollTop=offsets[i]},_blur:function(){this.current().find(".k-in:first").removeClass("k-state-focused")},_enabled:function(node){return!node.children("div").children(".k-in").hasClass("k-state-disabled")},parent:function(node){var result,skipSelf,wrapperRe=/\bk-treeview\b/,itemRe=/\bk-item\b/;typeof node==STRING&&(node=this.element.find(node)),isDomElement(node)||(node=node[0]),skipSelf=itemRe.test(node.className);do node=node.parentNode,itemRe.test(node.className)&&(skipSelf?result=node:skipSelf=!0);while(!wrapperRe.test(node.className)&&!result);return $(result)},_nextVisible:function(node){function nextParent(node){for(;node.length&&!node.next().length;)node=that.parent(node);return node.next().length?node.next():node}var result,that=this,expanded=that._expanded(node);return node.length&&node.is(":visible")?expanded?(result=subGroup(node).children().first(),result.length||(result=nextParent(node))):result=nextParent(node):result=that.root.children().eq(0),that._enabled(result)||(result=that._nextVisible(result)),result},_previousVisible:function(node){var lastChild,result,that=this;if(!node.length||node.prev().length)for(result=node.length?node.prev():that.root.children().last();that._expanded(result)&&(lastChild=subGroup(result).children().last(),lastChild.length);)result=lastChild;else result=that.parent(node)||node;return that._enabled(result)||(result=that._previousVisible(result)),result},_keydown:function(e){var target,that=this,key=e.keyCode,focused=that.current(),expanded=that._expanded(focused),checkbox=focused.find(".k-checkbox:first :checkbox"),rtl=kendo.support.isRtl(that.element);e.target==e.currentTarget&&(!rtl&&key==keys.RIGHT||rtl&&key==keys.LEFT?expanded?target=that._nextVisible(focused):that.expand(focused):!rtl&&key==keys.LEFT||rtl&&key==keys.RIGHT?expanded?that.collapse(focused):(target=that.parent(focused),that._enabled(target)||(target=undefined)):key==keys.DOWN?target=that._nextVisible(focused):key==keys.UP?target=that._previousVisible(focused):key==keys.HOME?target=that._nextVisible($()):key==keys.END?target=that._previousVisible($()):key==keys.ENTER?focused.find(".k-in:first").hasClass("k-state-selected")||that._trigger(SELECT,focused)||that.select(focused):key==keys.SPACEBAR&&checkbox.length&&(checkbox.prop(CHECKED,!checkbox.prop(CHECKED)).data(INDETERMINATE,!1).prop(INDETERMINATE,!1),that._checkboxChange({target:checkbox}),target=focused),target&&(e.preventDefault(),focused[0]!=target[0]&&(that._trigger(NAVIGATE,target),that.current(target))))},_click:function(e){var shouldNavigate,that=this,node=$(e.currentTarget),contents=nodeContents(node.closest(NODE)),href=node.attr("href");shouldNavigate=href?"#"==href||href.indexOf("#"+this.element.id+"-")>=0:contents.length&&!contents.children().length,shouldNavigate&&e.preventDefault(),node.hasClass(".k-state-selected")||that._trigger(SELECT,node)||that.select(node)},_wrapper:function(){var wrapper,root,that=this,element=that.element,wrapperClasses="k-widget k-treeview";element.is("ul")?(wrapper=element.wrap("<div />").parent(),root=element):(wrapper=element,root=wrapper.children("ul").eq(0)),that.wrapper=wrapper.addClass(wrapperClasses),that.root=root},_group:function(item){var that=this,firstLevel=item.hasClass(KTREEVIEW),group={firstLevel:firstLevel,expanded:firstLevel||that._expanded(item)},groupElement=item.children("ul");groupElement.addClass(that.templates.groupCssClass(group)).css("display",group.expanded?"":"none"),that._nodes(groupElement,group)},_nodes:function(groupElement,groupData){var nodeData,that=this,nodes=groupElement.children("li");groupData=extend({length:nodes.length},groupData),nodes.each(function(i,node){node=$(node),nodeData={index:i,expanded:that._expanded(node)},updateNodeHtml(node),that._updateNodeClasses(node,groupData,nodeData),that._group(node)})},_checkboxes:function(){var checkboxTemplate,options=this.options,checkboxOptions=options.checkboxes;(checkboxOptions||options.checkboxTemplate)&&(options.checkboxTemplate?checkboxTemplate=options.checkboxTemplate:(checkboxTemplate="<input type='checkbox' #= (item.enabled === false) ? 'disabled' : '' # #= item.checked ? 'checked' : '' #",checkboxOptions.name&&(checkboxTemplate+=" name='"+checkboxOptions.name+"'"),checkboxTemplate+=" />"),checkboxOptions=extend({template:checkboxTemplate},options.checkboxes),typeof checkboxOptions.template==STRING&&(checkboxOptions.template=template(checkboxOptions.template)),options.checkboxes=checkboxOptions)},_updateNodeClasses:function(node,groupData,nodeData){var wrapper=node.children("div"),group=node.children("ul"),templates=this.templates;node.hasClass("k-treeview")||(nodeData=nodeData||{},nodeData.expanded=typeof nodeData.expanded!=UNDEFINED?nodeData.expanded:this._expanded(node),nodeData.index=typeof nodeData.index!=UNDEFINED?nodeData.index:node.index(),nodeData.enabled=typeof nodeData.enabled!=UNDEFINED?nodeData.enabled:!wrapper.children(".k-in").hasClass("k-state-disabled"),groupData=groupData||{},groupData.firstLevel=typeof groupData.firstLevel!=UNDEFINED?groupData.firstLevel:node.parent().parent().hasClass(KTREEVIEW),groupData.length=typeof groupData.length!=UNDEFINED?groupData.length:node.parent().children().length,node.removeClass("k-first k-last").addClass(templates.wrapperCssClass(groupData,nodeData)),wrapper.removeClass("k-top k-mid k-bot").addClass(templates.cssClass(groupData,nodeData)),wrapper.children(".k-in").removeClass("k-in k-state-default k-state-disabled").addClass(templates.textClass(nodeData)),(group.length||"true"==node.attr("data-hasChildren"))&&(wrapper.children(".k-icon").removeClass("k-plus k-minus k-plus-disabled k-minus-disabled").addClass(templates.toggleButtonClass(nodeData)),
group.addClass("k-group")))},_processNodes:function(nodes,callback){var that=this;that.element.find(nodes).each(function(index,item){callback.call(that,index,$(item).closest(NODE))})},dataItem:function(node){var uid=$(node).closest(NODE).attr(kendo.attr("uid")),dataSource=this.dataSource;return dataSource&&dataSource.getByUid(uid)},_insertNode:function(nodeData,index,parentNode,insertCallback,collapsed){var childrenData,node,i,item,that=this,group=subGroup(parentNode),updatedGroupLength=group.children().length+1,groupData={firstLevel:parentNode.hasClass(KTREEVIEW),expanded:!collapsed,length:updatedGroupLength},nodeHtml="",append=function(item,group){item.appendTo(group)};for(i=0;i<nodeData.length;i++)item=nodeData[i],item.index=index+i,nodeHtml+=that._renderItem({group:groupData,item:item});if(node=$(nodeHtml),node.length){for(group.length||(group=$(that._renderGroup({group:groupData})).appendTo(parentNode)),insertCallback(node,group),parentNode.hasClass("k-item")&&(updateNodeHtml(parentNode),that._updateNodeClasses(parentNode)),that._updateNodeClasses(node.prev().first()),that._updateNodeClasses(node.next().last()),i=0;i<nodeData.length;i++)item=nodeData[i],item.hasChildren&&(childrenData=item.children.data(),childrenData.length&&that._insertNode(childrenData,item.index,node.eq(i),append,!that._expanded(node.eq(i))));return node}},_updateNode:function(field,items){function access(){shouldUpdate=!0}function setCheckedState(root,state){root.find(".k-checkbox :checkbox").prop(CHECKED,state).data(INDETERMINATE,!1).prop(INDETERMINATE,!1)}var i,node,item,isChecked,isCollapsed,that=this,context={treeview:that.options,item:item},shouldUpdate=!1;if("selected"==field)item=items[0],node=that.findByUid(item.uid).find(".k-in:first").removeClass("k-state-hover").toggleClass("k-state-selected",item[field]).end(),item[field]?(that.current(node),node.attr(ARIASELECTED,!0)):node.attr(ARIASELECTED,!1);else for($.inArray(field,that.options.dataTextField)>=0?shouldUpdate=!0:(context.item=items[0],context.item.bind("get",access),that.templates.itemContent(context),context.item.unbind("set",access)),i=0;i<items.length;i++)context.item=item=items[i],("spriteCssClass"==field||"imageUrl"==field||shouldUpdate)&&that.findByUid(item.uid).find(">div>.k-in").html(that.templates.itemContent(context)),field==CHECKED?(node=that.findByUid(item.uid),isChecked=item[field],setCheckedState(node.children("div"),isChecked),that.options.checkboxes.checkChildren&&(setCheckedState(node.children(".k-group"),isChecked),that._setChecked(item.children,isChecked),that._bubbleIndeterminate(node))):"expanded"==field?that._toggle(that.findByUid(item.uid),item,item[field]):"enabled"==field&&(node=that.findByUid(item.uid),node.find(".k-checkbox :checkbox").prop("disabled",!item[field]),isCollapsed=!nodeContents(node).is(VISIBLE),node.removeAttr(ARIADISABLED),item[field]||(item.selected&&item.set("selected",!1),item.expanded&&item.set("expanded",!1),isCollapsed=!0,node.removeAttr(ARIASELECTED).attr(ARIADISABLED,!0)),that._updateNodeClasses(node,{},{enabled:item[field],expanded:!isCollapsed}))},_appendItems:function(index,items,parentNode){var group=subGroup(parentNode),children=group.children(),collapsed=!this._expanded(parentNode);typeof index==UNDEFINED&&(index=children.length),this._insertNode(items,index,parentNode,function(item,group){index>=children.length?item.appendTo(group):item.insertBefore(children.eq(index))},collapsed),this._expanded(parentNode)&&(this._updateNodeClasses(parentNode),subGroup(parentNode).css("display","block"))},refresh:function(e){var i,that=this,parentNode=that.wrapper,node=e.node,action=e.action,items=e.items,options=that.options,loadOnDemand=options.loadOnDemand,checkChildren=options.checkboxes&&options.checkboxes.checkChildren;if(e.field){if(!items[0].level)return;return that._updateNode(e.field,items)}if(node&&(parentNode=that.findByUid(node.uid),that._progress(parentNode,!1)),checkChildren&&"remove"!=action&&node&&node.checked)for(i=0;i<items.length;i++)items[i].checked=!0;if("add"==action)this._appendItems(e.index,items,parentNode);else if("remove"==action)that._remove(that.findByUid(items[0].uid),!1);else if(node)subGroup(parentNode).empty(),items.length?(this._appendItems(e.index,items,parentNode),loadOnDemand&&checkChildren&&this._bubbleIndeterminate(subGroup(parentNode).children().last())):updateNodeHtml(parentNode);else{var groupHtml=that._renderGroup({items:items,group:{firstLevel:!0,expanded:!0}});if(that.root.length){var group=$(groupHtml);that.root.attr("class",group.attr("class")).attr("role",group.attr("role")).html(group.html())}else that.root=that.wrapper.html(groupHtml).children("ul")}for(i=0;i<items.length;i++)loadOnDemand&&!items[i].expanded||items[i].load();that.trigger(DATABOUND,{node:node?parentNode:undefined})},_error:function(e){var node=e.node&&this.findByUid(e.node.uid),retryHtml=this.templates.retry({messages:this.options.messages});node?(this._progress(node,!1),this._expanded(node,!1),nodeIcon(node).addClass("k-i-refresh"),e.node.loaded(!1)):(this._progress(!1),this.element.html(retryHtml))},_retryRequest:function(e){e.preventDefault(),this.dataSource.fetch()},expand:function(nodes){this._processNodes(nodes,function(index,item){this.toggle(item,!0)})},collapse:function(nodes){this._processNodes(nodes,function(index,item){this.toggle(item,!1)})},enable:function(nodes,enable){enable=2!=arguments.length||!!enable,this._processNodes(nodes,function(index,item){this.dataItem(item).set("enabled",enable)})},current:function(node){var that=this,current=that._current,element=that.element,id=that._ariaId;return arguments.length>0&&node&&node.length?(current&&(current[0].id===id&&current.removeAttr("id"),current.find(".k-in:first").removeClass("k-state-focused")),current=that._current=$(node,element).closest(NODE),current.find(".k-in:first").addClass("k-state-focused"),id=current[0].id||id,void(id&&(that.wrapper.removeAttr("aria-activedescendant"),current.attr("id",id),that.wrapper.attr("aria-activedescendant",id)))):(current||(current=that._nextVisible($())),current)},select:function(node){var that=this,element=that.element;return arguments.length?(node=$(node,element).closest(NODE),element.find(".k-state-selected").each(function(){var dataItem=that.dataItem(this);dataItem.set("selected",!1),delete dataItem.selected}),node.length&&that.dataItem(node).set("selected",!0),void that.trigger(CHANGE)):element.find(".k-state-selected").closest(NODE)},_toggle:function(node,dataItem,expand){var loaded,that=this,options=that.options,contents=nodeContents(node),direction=expand?"expand":"collapse",animation=options.animation[direction];if(!contents.data("animating")&&!that._trigger(direction,node))if(that._expanded(node,expand),loaded=dataItem&&dataItem.loaded(),loaded&&contents.children().length>0){if(that._updateNodeClasses(node,{},{expanded:expand}),contents.css("display")==(expand?"block":"none"))return;expand||contents.css("height",contents.height()).css("height"),contents.kendoStop(!0,!0).kendoAnimate(extend({reset:!0},animation,{complete:function(){expand&&contents.css("height","")}}))}else expand&&(options.loadOnDemand&&that._progress(node,!0),contents.remove(),dataItem.load())},toggle:function(node,expand){node=$(node),nodeIcon(node).is(".k-minus,.k-plus,.k-minus-disabled,.k-plus-disabled")&&(1==arguments.length&&(expand=!this._expanded(node)),this._expanded(node,expand))},destroy:function(){var that=this;Widget.fn.destroy.call(that),that.wrapper.off(NS),that._unbindDataSource(),that.dragging&&that.dragging.destroy(),kendo.destroy(that.element),that.root=that.wrapper=that.element=null},_expanded:function(node,value){var expandedAttr=kendo.attr("expanded"),dataItem=this.dataItem(node);return 1==arguments.length?"true"===node.attr(expandedAttr)||dataItem&&dataItem.expanded:void(nodeContents(node).data("animating")||(dataItem&&(dataItem.set("expanded",value),value=dataItem.expanded),value?(node.attr(expandedAttr,"true"),node.attr("aria-expanded","true")):(node.removeAttr(expandedAttr),node.attr("aria-expanded","false"))))},_progress:function(node,showProgress){var element=this.element,loadingText=this.templates.loading({messages:this.options.messages});1==arguments.length?(showProgress=node,showProgress?element.html(loadingText):element.empty()):nodeIcon(node).toggleClass("k-loading",showProgress).removeClass("k-i-refresh")},text:function(node,text){var dataItem=this.dataItem(node),fieldBindings=this.options[bindings.text],level=dataItem.level(),length=fieldBindings.length,field=fieldBindings[Math.min(level,length-1)];return text?void dataItem.set(field,text):dataItem[field]},_objectOrSelf:function(node){return $(node).closest("[data-role=treeview]").data("kendoTreeView")||this},_dataSourceMove:function(nodeData,group,parentNode,callback){var referenceDataItem,destTreeview=this._objectOrSelf(parentNode||group),destDataSource=destTreeview.dataSource;return parentNode&&parentNode[0]!=destTreeview.element[0]&&(referenceDataItem=destTreeview.dataItem(parentNode),referenceDataItem.loaded()||(destTreeview._progress(parentNode,!0),referenceDataItem.load()),parentNode!=this.root&&(destDataSource=referenceDataItem.children,destDataSource&&destDataSource instanceof HierarchicalDataSource||(referenceDataItem._initChildren(),referenceDataItem.loaded(!0),destDataSource=referenceDataItem.children))),nodeData=this._toObservableData(nodeData),callback.call(this,destDataSource,nodeData)},_toObservableData:function(node){var dataSource,uid,dataItem=node;return(node instanceof window.jQuery||isDomElement(node))&&(dataSource=this._objectOrSelf(node).dataSource,uid=$(node).attr(kendo.attr("uid")),dataItem=dataSource.getByUid(uid),dataItem&&(dataItem=dataSource.remove(dataItem))),dataItem},_insert:function(data,model,index){model instanceof kendo.data.ObservableArray?model=model.toJSON():isArray(model)||(model=[model]);var parentNode=data.parent();return parentNode&&parentNode._initChildren&&(parentNode.hasChildren=!0,parentNode._initChildren()),data.splice.apply(data,[index,0].concat(model)),this.findByUid(data[index].uid)},insertAfter:insertAction(1),insertBefore:insertAction(0),append:function(nodeData,parentNode,success){var that=this,group=that.root;return success=success||$.noop,parentNode&&(group=subGroup(parentNode)),that._dataSourceMove(nodeData,group,parentNode,function(dataSource,model){function add(){parentNode&&that._expanded(parentNode,!0);var data=dataSource.data(),index=Math.max(data.length,0);return that._insert(data,model,index)}var inserted;return dataSource.data()?(inserted=add(),success(inserted),inserted):(dataSource.one(CHANGE,function(){success(add())}),null)})},_remove:function(node,keepData){var parentNode,prevSibling,nextSibling,that=this;return node=$(node,that.element),parentNode=node.parent().parent(),prevSibling=node.prev(),nextSibling=node.next(),node[keepData?"detach":"remove"](),parentNode.hasClass("k-item")&&(updateNodeHtml(parentNode),that._updateNodeClasses(parentNode)),that._updateNodeClasses(prevSibling),that._updateNodeClasses(nextSibling),node},remove:function(node){var dataItem=this.dataItem(node);dataItem&&this.dataSource.remove(dataItem)},detach:function(node){return this._remove(node,!0)},findByText:function(text){return $(this.element).find(".k-in").filter(function(i,element){return $(element).text()==text}).closest(NODE)},findByUid:function(uid){return this.element.find(".k-item["+kendo.attr("uid")+"="+uid+"]")},expandPath:function(path,complete){var dataSource=this.dataSource,node=dataSource.get(path[0]);for(complete=complete||$.noop;path.length>0&&(node.expanded||node.loaded());)node.set("expanded",!0),path.shift(),node=dataSource.get(path[0]);return path.length?(dataSource.bind("change",function(e){var id=e.node&&e.node.id;id&&id===path[0]&&(path.shift(),path.length?dataSource.get(path[0]).set("expanded",!0):complete())}),void node.set("expanded",!0)):complete()},_renderItem:function(options){return options.group||(options.group={}),options.treeview=this.options,options.r=this.templates,this.templates.item(options)},_renderGroup:function(options){var that=this;return options.renderItems=function(options){var html="",i=0,items=options.items,len=items?items.length:0,group=options.group;for(group.length=len;i<len;i++)options.group=group,options.item=items[i],options.item.index=i,html+=that._renderItem(options);return html},options.r=that.templates,that.templates.group(options)}}),TreeViewDragAndDrop.prototype={_removeTouchHover:function(){var that=this;kendo.support.touch&&that.hovered&&(that.hovered.find("."+KSTATEHOVER).removeClass(KSTATEHOVER),that.hovered=!1)},_hintStatus:function(newStatus){var statusElement=this._draggable.hint.find(".k-drag-status")[0];return newStatus?void(statusElement.className="k-icon k-drag-status "+newStatus):$.trim(statusElement.className.replace(/k-(icon|drag-status)/g,""))},dragstart:function(e){var that=this,treeview=that.treeview,sourceNode=that.sourceNode=e.currentTarget.closest(NODE);treeview.trigger(DRAGSTART,{sourceNode:sourceNode[0]})&&e.preventDefault(),that.dropHint=$("<div class='k-drop-hint' />").css(VISIBILITY,"hidden").appendTo(treeview.element)},drag:function(e){var statusClass,hoveredItem,hoveredItemPos,itemHeight,itemTop,itemContent,delta,insertOnTop,insertOnBottom,addChild,that=this,treeview=that.treeview,sourceNode=that.sourceNode,dropTarget=that.dropTarget=$(kendo.eventTarget(e)),closestTree=dropTarget.closest(".k-treeview");closestTree.length?$.contains(sourceNode[0],dropTarget[0])?statusClass="k-denied":(statusClass="k-insert-middle",hoveredItem=dropTarget.closest(".k-top,.k-mid,.k-bot"),hoveredItem.length?(itemHeight=hoveredItem.outerHeight(),itemTop=kendo.getOffset(hoveredItem).top,itemContent=dropTarget.closest(".k-in"),delta=itemHeight/(itemContent.length>0?4:2),insertOnTop=e.y.location<itemTop+delta,insertOnBottom=itemTop+itemHeight-delta<e.y.location,that._removeTouchHover(),addChild=itemContent.length&&!insertOnTop&&!insertOnBottom,that.hovered=!!addChild&&closestTree,that.dropHint.css(VISIBILITY,addChild?"hidden":"visible"),itemContent.toggleClass(KSTATEHOVER,addChild),addChild?statusClass="k-add":(hoveredItemPos=hoveredItem.position(),hoveredItemPos.top+=insertOnTop?0:itemHeight,that.dropHint.css(hoveredItemPos)[insertOnTop?"prependTo":"appendTo"](dropTarget.closest(NODE).children("div:first")),insertOnTop&&hoveredItem.hasClass("k-top")&&(statusClass="k-insert-top"),insertOnBottom&&hoveredItem.hasClass("k-bot")&&(statusClass="k-insert-bottom"))):dropTarget[0]!=that.dropHint[0]&&(statusClass=closestTree[0]!=treeview.element[0]?"k-add":"k-denied")):(statusClass="k-denied",that._removeTouchHover()),treeview.trigger(DRAG,{sourceNode:sourceNode[0],dropTarget:dropTarget[0],pageY:e.y.location,pageX:e.x.location,statusClass:statusClass.substring(2),setStatusClass:function(value){statusClass=value}}),0!==statusClass.indexOf("k-insert")&&that.dropHint.css(VISIBILITY,"hidden"),that._hintStatus(statusClass)},dragcancel:function(){this.dropHint.remove()},dragend:function(){function triggerDragEnd(sourceNode){treeview.trigger(DRAGEND,{sourceNode:sourceNode&&sourceNode[0],destinationNode:destinationNode[0],dropPosition:dropPosition})}var destinationNode,e,dropPrevented,that=this,treeview=that.treeview,dropPosition="over",sourceNode=that.sourceNode,dropHint=that.dropHint,dropTarget=that.dropTarget;return"visible"==dropHint.css(VISIBILITY)?(dropPosition=dropHint.prevAll(".k-in").length>0?"after":"before",destinationNode=dropHint.closest(NODE)):dropTarget&&(destinationNode=dropTarget.closest(NODE),destinationNode.length||(destinationNode=dropTarget.closest(".k-treeview"))),e={sourceNode:sourceNode[0],destinationNode:destinationNode[0],valid:"k-denied"!=that._hintStatus(),setValid:function(newValid){this.valid=newValid},dropTarget:dropTarget[0],dropPosition:dropPosition},dropPrevented=treeview.trigger(DROP,e),dropHint.remove(),that._removeTouchHover(),!e.valid||dropPrevented?void(that._draggable.dropped=e.valid):(that._draggable.dropped=!0,void("over"==dropPosition?treeview.append(sourceNode,destinationNode,triggerDragEnd):("before"==dropPosition?sourceNode=treeview.insertBefore(sourceNode,destinationNode):"after"==dropPosition&&(sourceNode=treeview.insertAfter(sourceNode,destinationNode)),triggerDragEnd(sourceNode))))},destroy:function(){this._draggable.destroy()}},ui.plugin(TreeView)}(window.kendo.jQuery),function($,undefined){function isPercentageSize(size){return percentageUnitsRegex.test(size)}function isPixelSize(size){return pxUnitsRegex.test(size)||/^\d+$/.test(size)}function isFluid(size){return!isPercentageSize(size)&&!isPixelSize(size)}function panePropertyAccessor(propertyName,triggersResize){return function(pane,value){var paneConfig=this.element.find(pane).data(PANE);if(1==arguments.length)return paneConfig[propertyName];if(paneConfig[propertyName]=value,triggersResize){var splitter=this.element.data("kendo"+this.options.name);splitter.resize(!0)}}}function PaneResizing(splitter){var that=this,orientation=splitter.orientation;that.owner=splitter,that._element=splitter.element,that.orientation=orientation,extend(that,orientation===HORIZONTAL?horizontalDefaults:verticalDefaults),that._resizable=new kendo.ui.Resizable(splitter.element,{orientation:orientation,handle:".k-splitbar-draggable-"+orientation+"[data-marker="+splitter._marker+"]",hint:proxy(that._createHint,that),start:proxy(that._start,that),max:proxy(that._max,that),min:proxy(that._min,that),invalidClass:"k-restricted-size-"+orientation,resizeend:proxy(that._stop,that)})}var kendo=window.kendo,ui=kendo.ui,keys=kendo.keys,extend=$.extend,proxy=$.proxy,Widget=ui.Widget,pxUnitsRegex=/^\d+(\.\d+)?px$/i,percentageUnitsRegex=/^\d+(\.\d+)?%$/i,NS=".kendoSplitter",EXPAND="expand",COLLAPSE="collapse",CONTENTLOAD="contentLoad",ERROR="error",RESIZE="resize",LAYOUTCHANGE="layoutChange",HORIZONTAL="horizontal",VERTICAL="vertical",MOUSEENTER="mouseenter",CLICK="click",PANE="pane",MOUSELEAVE="mouseleave",FOCUSED="k-state-focused",KPANE="k-"+PANE,PANECLASS="."+KPANE,Splitter=Widget.extend({init:function(element,options){var isHorizontal,that=this;Widget.fn.init.call(that,element,options),that.wrapper=that.element,isHorizontal=that.options.orientation.toLowerCase()!=VERTICAL,that.orientation=isHorizontal?HORIZONTAL:VERTICAL,that._dimension=isHorizontal?"width":"height",that._keys={decrease:isHorizontal?keys.LEFT:keys.UP,increase:isHorizontal?keys.RIGHT:keys.DOWN},that._resizeStep=10,that._marker=kendo.guid().substring(0,8),that._resizeHandler=proxy(that.resize,that),that._initPanes(),that.resizing=new PaneResizing(that),that.element.triggerHandler("init"+NS)},events:[EXPAND,COLLAPSE,CONTENTLOAD,ERROR,RESIZE,LAYOUTCHANGE],_attachEvents:function(){var that=this,orientation=that.options.orientation;that.element.children(".k-splitbar-draggable-"+orientation).on("keydown"+NS,$.proxy(that._keydown,that)).on("mousedown"+NS,function(e){e.currentTarget.focus()}).on("focus"+NS,function(e){$(e.currentTarget).addClass(FOCUSED)}).on("blur"+NS,function(e){$(e.currentTarget).removeClass(FOCUSED),that.resizing&&that.resizing.end()}).on(MOUSEENTER+NS,function(){$(this).addClass("k-splitbar-"+that.orientation+"-hover")}).on(MOUSELEAVE+NS,function(){$(this).removeClass("k-splitbar-"+that.orientation+"-hover")}).on("mousedown"+NS,function(){that._panes().append("<div class='k-splitter-overlay k-overlay' />")}).on("mouseup"+NS,function(){that._panes().children(".k-splitter-overlay").remove()}).end().children(".k-splitbar").on("dblclick"+NS,proxy(that._togglePane,that)).children(".k-collapse-next, .k-collapse-prev").on(CLICK+NS,that._arrowClick(COLLAPSE)).end().children(".k-expand-next, .k-expand-prev").on(CLICK+NS,that._arrowClick(EXPAND)).end().end(),that.resizeHandlerAttached_||($(window).on("resize",that._resizeHandler),that.resizeHandlerAttached_=!0)},_detachEvents:function(destroy){var that=this;that.element.children(".k-splitbar-draggable-"+that.orientation).off(NS).end().children(".k-splitbar").off("dblclick"+NS).children(".k-collapse-next, .k-collapse-prev, .k-expand-next, .k-expand-prev").off(NS),destroy&&$(window).off("resize",that._resizeHandler)},options:{name:"Splitter",orientation:HORIZONTAL,panes:[]},destroy:function(){Widget.fn.destroy.call(this),this._detachEvents(!0),this.resizing&&this.resizing.destroy(),kendo.destroy(this.element),this.wrapper=this.element=null},_keydown:function(e){var pane,that=this,key=e.keyCode,resizing=that.resizing,target=$(e.currentTarget),navigationKeys=that._keys,increase=key===navigationKeys.increase,decrease=key===navigationKeys.decrease;increase||decrease?(e.ctrlKey?(pane=target[decrease?"next":"prev"](),resizing&&resizing.isResizing()&&resizing.end(),pane[that._dimension]()?that._triggerAction(COLLAPSE,target[decrease?"prev":"next"]()):that._triggerAction(EXPAND,pane)):resizing&&resizing.move((decrease?-1:1)*that._resizeStep,target),e.preventDefault()):key===keys.ENTER&&resizing&&(resizing.end(),e.preventDefault())},_initPanes:function(){var panesConfig=this.options.panes||[],that=this;this.element.addClass("k-widget").addClass("k-splitter").children().each(function(i,pane){"script"!=pane.nodeName.toLowerCase()&&that._initPane(pane,panesConfig[i])}),this.resize()},_initPane:function(pane,config){pane=$(pane).attr("role","group").addClass(KPANE),pane.data(PANE,config?config:{}).toggleClass("k-scrollable",!config||config.scrollable!==!1),this.ajaxRequest(pane)},ajaxRequest:function(pane,url,data){var paneConfig,that=this;pane=that.element.find(pane),paneConfig=pane.data(PANE),url=url||paneConfig.contentUrl,url&&(pane.append("<span class='k-icon k-loading k-pane-loading' />"),kendo.isLocalUrl(url)?jQuery.ajax({url:url,data:data||{},type:"GET",dataType:"html",success:function(data){pane.html(data),that.trigger(CONTENTLOAD,{pane:pane[0]})},error:function(xhr,status){that.trigger(ERROR,{pane:pane[0],status:status,xhr:xhr})}}):pane.removeClass("k-scrollable").html("<iframe src='"+url+"' frameborder='0' class='k-content-frame'>This page requires frames in order to show content</iframe>"))},_triggerAction:function(type,pane){this.trigger(type,{pane:pane[0]})||this[type](pane[0])},_togglePane:function(e){var arrow,that=this,target=$(e.target);target.closest(".k-splitter")[0]==that.element[0]&&(arrow=target.children(".k-icon:not(.k-resize-handle)"),1===arrow.length&&(arrow.is(".k-collapse-prev")?that._triggerAction(COLLAPSE,target.prev()):arrow.is(".k-collapse-next")?that._triggerAction(COLLAPSE,target.next()):arrow.is(".k-expand-prev")?that._triggerAction(EXPAND,target.prev()):arrow.is(".k-expand-next")&&that._triggerAction(EXPAND,target.next())))},_arrowClick:function(arrowType){var that=this;return function(e){var pane,target=$(e.target);target.closest(".k-splitter")[0]==that.element[0]&&(pane=target.is(".k-"+arrowType+"-prev")?target.parent().prev():target.parent().next(),that._triggerAction(arrowType,pane))}},_updateSplitBar:function(splitbar,previousPane,nextPane){var catIconIf=function(iconType,condition){return condition?"<div class='k-icon "+iconType+"' />":""},orientation=this.orientation,draggable=previousPane.resizable!==!1&&nextPane.resizable!==!1,prevCollapsible=previousPane.collapsible,prevCollapsed=previousPane.collapsed,nextCollapsible=nextPane.collapsible,nextCollapsed=nextPane.collapsed;splitbar.addClass("k-splitbar k-state-default k-splitbar-"+orientation).attr("role","separator").attr("aria-expanded",!(prevCollapsed||nextCollapsed)).removeClass("k-splitbar-"+orientation+"-hover").toggleClass("k-splitbar-draggable-"+orientation,draggable&&!prevCollapsed&&!nextCollapsed).toggleClass("k-splitbar-static-"+orientation,!draggable&&!prevCollapsible&&!nextCollapsible).html(catIconIf("k-collapse-prev",prevCollapsible&&!prevCollapsed&&!nextCollapsed)+catIconIf("k-expand-prev",prevCollapsible&&prevCollapsed&&!nextCollapsed)+catIconIf("k-resize-handle",draggable)+catIconIf("k-collapse-next",nextCollapsible&&!nextCollapsed&&!prevCollapsed)+catIconIf("k-expand-next",nextCollapsible&&nextCollapsed&&!prevCollapsed))},_updateSplitBars:function(){var that=this;this.element.children(".k-splitbar").each(function(){var splitbar=$(this),previousPane=splitbar.prevAll(PANECLASS).first().data(PANE),nextPane=splitbar.nextAll(PANECLASS).first().data(PANE);nextPane&&that._updateSplitBar(splitbar,previousPane,nextPane)})},_removeSplitBars:function(){this.element.children(".k-splitbar").remove()},_panes:function(){return this.element.children(PANECLASS)},_resize:function(){var that=this,element=that.element,panes=element.children(PANECLASS),isHorizontal=that.orientation==HORIZONTAL,splitBars=element.children(".k-splitbar"),splitBarsCount=splitBars.length,sizingProperty=isHorizontal?"width":"height",totalSize=element[sizingProperty]();0===splitBarsCount?(splitBarsCount=panes.length-1,panes.slice(0,splitBarsCount).after("<div tabindex='0' class='k-splitbar' data-marker='"+that._marker+"' />"),that._updateSplitBars(),splitBars=element.children(".k-splitbar")):that._updateSplitBars(),splitBars.each(function(){totalSize-=this[isHorizontal?"offsetWidth":"offsetHeight"]});var sizedPanesWidth=0,sizedPanesCount=0,freeSizedPanes=$();panes.css({position:"absolute",top:0})[sizingProperty](function(){var size,config=$(this).data(PANE)||{};if(config.collapsed)size=0,$(this).css("overflow","hidden");else{if(isFluid(config.size))return void(freeSizedPanes=freeSizedPanes.add(this));size=parseInt(config.size,10),isPercentageSize(config.size)&&(size=Math.floor(size*totalSize/100))}return sizedPanesCount++,sizedPanesWidth+=size,size}),totalSize-=sizedPanesWidth;var freeSizePanesCount=freeSizedPanes.length,freeSizePaneWidth=Math.floor(totalSize/freeSizePanesCount);freeSizedPanes.slice(0,freeSizePanesCount-1).css(sizingProperty,freeSizePaneWidth).end().eq(freeSizePanesCount-1).css(sizingProperty,totalSize-(freeSizePanesCount-1)*freeSizePaneWidth);var sum=0,alternateSizingProperty=isHorizontal?"height":"width",positioningProperty=isHorizontal?"left":"top",sizingDomProperty=isHorizontal?"offsetWidth":"offsetHeight";if(0===freeSizePanesCount){var lastNonCollapsedPane=panes.filter(function(){return!($(this).data(PANE)||{}).collapsed}).last();lastNonCollapsedPane[sizingProperty](totalSize+lastNonCollapsedPane[0][sizingDomProperty])}element.children().css(alternateSizingProperty,element[alternateSizingProperty]()).each(function(i,child){"script"!=child.tagName.toLowerCase()&&(child.style[positioningProperty]=Math.floor(sum)+"px",sum+=child[sizingDomProperty])}),that._detachEvents(),that._attachEvents(),kendo.resize(panes),that.trigger(LAYOUTCHANGE)},toggle:function(pane,expand){var paneConfig,that=this;pane=that.element.find(pane),paneConfig=pane.data(PANE),(expand||paneConfig.collapsible)&&(1==arguments.length&&(expand=paneConfig.collapsed!==undefined&&paneConfig.collapsed),paneConfig.collapsed=!expand,paneConfig.collapsed?pane.css("overflow","hidden"):pane.css("overflow",""),that.resize(!0))},collapse:function(pane){this.toggle(pane,!1)},expand:function(pane){this.toggle(pane,!0)},_addPane:function(config,idx,paneElement){var that=this;return paneElement.length&&(that.options.panes.splice(idx,0,config),that._initPane(paneElement,config),that._removeSplitBars(),that.resize(!0)),paneElement},append:function(config){config=config||{};var that=this,paneElement=$("<div />").appendTo(that.element);return that._addPane(config,that.options.panes.length,paneElement)},insertBefore:function(config,referencePane){referencePane=$(referencePane),config=config||{};var that=this,idx=that.wrapper.children(".k-pane").index(referencePane),paneElement=$("<div />").insertBefore($(referencePane));return that._addPane(config,idx,paneElement)},insertAfter:function(config,referencePane){referencePane=$(referencePane),config=config||{};var that=this,idx=that.wrapper.children(".k-pane").index(referencePane),paneElement=$("<div />").insertAfter($(referencePane));return that._addPane(config,idx+1,paneElement)},remove:function(pane){pane=$(pane);var that=this;return pane.length&&(kendo.destroy(pane),pane.each(function(idx,element){that.options.panes.splice(that.wrapper.children(".k-pane").index(element),1),$(element).remove()}),that._removeSplitBars(),that.options.panes.length&&that.resize(!0)),that},size:panePropertyAccessor("size",!0),min:panePropertyAccessor("min"),max:panePropertyAccessor("max")});ui.plugin(Splitter);var verticalDefaults={sizingProperty:"height",sizingDomProperty:"offsetHeight",alternateSizingProperty:"width",positioningProperty:"top",mousePositioningProperty:"pageY"},horizontalDefaults={sizingProperty:"width",sizingDomProperty:"offsetWidth",alternateSizingProperty:"height",positioningProperty:"left",mousePositioningProperty:"pageX"};PaneResizing.prototype={press:function(target){this._resizable.press(target)},move:function(delta,target){this.pressed||(this.press(target),this.pressed=!0),this._resizable.target||this._resizable.press(target),this._resizable.move(delta)},end:function(){this._resizable.end(),this.pressed=!1},destroy:function(){this._resizable.destroy(),this._resizable=this._element=this.owner=null},isResizing:function(){return this._resizable.resizing},_createHint:function(handle){var that=this;return $("<div class='k-ghost-splitbar k-ghost-splitbar-"+that.orientation+" k-state-default' />").css(that.alternateSizingProperty,handle[that.alternateSizingProperty]())},_start:function(e){var that=this,splitbar=$(e.currentTarget),previousPane=splitbar.prev(),nextPane=splitbar.next(),previousPaneConfig=previousPane.data(PANE),nextPaneConfig=nextPane.data(PANE),prevBoundary=parseInt(previousPane[0].style[that.positioningProperty],10),nextBoundary=parseInt(nextPane[0].style[that.positioningProperty],10)+nextPane[0][that.sizingDomProperty]-splitbar[0][that.sizingDomProperty],totalSize=parseInt(that._element.css(that.sizingProperty),10),toPx=function(value){var val=parseInt(value,10);return(isPixelSize(value)?val:totalSize*val/100)||0},prevMinSize=toPx(previousPaneConfig.min),prevMaxSize=toPx(previousPaneConfig.max)||nextBoundary-prevBoundary,nextMinSize=toPx(nextPaneConfig.min),nextMaxSize=toPx(nextPaneConfig.max)||nextBoundary-prevBoundary;that.previousPane=previousPane,that.nextPane=nextPane,that._maxPosition=Math.min(nextBoundary-nextMinSize,prevBoundary+prevMaxSize),that._minPosition=Math.max(prevBoundary+prevMinSize,nextBoundary-nextMaxSize)},_max:function(){return this._maxPosition},_min:function(){return this._minPosition},_stop:function(e){var that=this,splitbar=$(e.currentTarget),owner=that.owner;if(owner._panes().children(".k-splitter-overlay").remove(),e.keyCode!==kendo.keys.ESC){var ghostPosition=e.position,previousPane=splitbar.prev(),nextPane=splitbar.next(),previousPaneConfig=previousPane.data(PANE),nextPaneConfig=nextPane.data(PANE),previousPaneNewSize=ghostPosition-parseInt(previousPane[0].style[that.positioningProperty],10),nextPaneNewSize=parseInt(nextPane[0].style[that.positioningProperty],10)+nextPane[0][that.sizingDomProperty]-ghostPosition-splitbar[0][that.sizingDomProperty],fluidPanesCount=that._element.children(PANECLASS).filter(function(){return isFluid($(this).data(PANE).size)}).length;(!isFluid(previousPaneConfig.size)||fluidPanesCount>1)&&(isFluid(previousPaneConfig.size)&&fluidPanesCount--,previousPaneConfig.size=previousPaneNewSize+"px"),(!isFluid(nextPaneConfig.size)||fluidPanesCount>1)&&(nextPaneConfig.size=nextPaneNewSize+"px"),owner.resize(!0)}return!1}}}(window.kendo.jQuery),function($){function levels(values,key){function collect(depth,values){if(values=values[key])for(var level=result[depth]=result[depth]||[],idx=0;idx<values.length;idx++)level.push(values[idx]),collect(depth+1,values[idx])}var result=[];return collect(0,values),result}function cellspacing(){return kendo.support.cssBorderSpacing?"":'cellspacing="0"'}function table(tableRows,className){return tableRows.length?"<table "+cellspacing()+' class="'+$.trim("k-scheduler-table "+(className||""))+'"><tr>'+tableRows.join("</tr><tr>")+"</tr></table>":""}function allDayTable(tableRows,className){
return tableRows.length?"<div style='position:relative'>"+table(tableRows,className)+"</div>":""}function timesHeader(columnLevelCount,allDaySlot,rowCount){var tableRows=[];if(rowCount>0)for(var idx=0;idx<columnLevelCount;idx++)tableRows.push("<th></th>");return allDaySlot&&tableRows.push('<th class="k-scheduler-times-all-day">'+allDaySlot.text+"</th>"),rowCount<1?$():$('<div class="k-scheduler-times">'+table(tableRows)+"</div>")}function datesHeader(columnLevels,columnCount,allDaySlot){for(var columnIndex,dateTableRows=[],columnLevelIndex=0;columnLevelIndex<columnLevels.length;columnLevelIndex++){var level=columnLevels[columnLevelIndex],th=[],colspan=columnCount/level.length;for(columnIndex=0;columnIndex<level.length;columnIndex++)th.push('<th colspan="'+colspan+'" class="'+(level[columnIndex].className||"")+'">'+level[columnIndex].text+"</th>");dateTableRows.push(th.join(""))}var allDayTableRows=[];if(allDaySlot){var lastLevel=columnLevels[columnLevels.length-1],td=[],cellContent=allDaySlot.cellContent;for(columnIndex=0;columnIndex<lastLevel.length;columnIndex++)td.push('<td class="'+(lastLevel[columnIndex].className||"")+'">'+(cellContent?cellContent(columnIndex):"&nbsp;")+"</th>");allDayTableRows.push(td.join(""))}return $('<div class="k-scheduler-header k-state-default"><div class="k-scheduler-header-wrap">'+table(dateTableRows)+allDayTable(allDayTableRows,"k-scheduler-header-all-day")+"</div></div>")}function times(rowLevels,rowCount){for(var rowIndex,rows=new Array(rowCount).join().split(","),rowHeaderRows=[],rowLevelIndex=0;rowLevelIndex<rowLevels.length;rowLevelIndex++){var className,level=rowLevels[rowLevelIndex],rowspan=rowCount/level.length;for(rowIndex=0;rowIndex<level.length;rowIndex++)className=level[rowIndex].className||"",level[rowIndex].allDay&&(className="k-scheduler-times-all-day"),rows[rowspan*rowIndex]+='<th class="'+className+'" rowspan="'+rowspan+'">'+level[rowIndex].text+"</th>"}for(rowIndex=0;rowIndex<rowCount;rowIndex++)rowHeaderRows.push(rows[rowIndex]);return rowCount<1?$():$('<div class="k-scheduler-times">'+table(rowHeaderRows)+"</div>")}function content(){return $('<div class="k-scheduler-content"><table '+cellspacing()+' class="k-scheduler-table"/></div>')}function scrollbar(){return scrollbarWidth=scrollbarWidth?scrollbarWidth:kendo.support.scrollbar()}function collidingEvents(elements,start,end){var idx,index,startIndex,overlaps,endIndex;for(idx=elements.length-1;idx>=0;idx--)index=rangeIndex(elements[idx]),startIndex=index.start,endIndex=index.end,overlaps=startIndex<=start&&endIndex>=start,(overlaps||startIndex>=start&&endIndex<=end||start<=startIndex&&end>=startIndex)&&(startIndex<start&&(start=startIndex),endIndex>end&&(end=endIndex));return eventsForSlot(elements,start,end)}function rangeIndex(eventElement){return{start:eventElement.start,end:eventElement.end}}function eventsForSlot(elements,slotStart,slotEnd){for(var events=[],idx=0;idx<elements.length;idx++){var event=rangeIndex(elements[idx]);(event.start<slotStart&&event.end>slotStart||event.start>=slotStart&&event.end<=slotEnd)&&events.push(elements[idx])}return events}function createColumns(eventElements){return _createColumns(eventElements)}function createRows(eventElements){return _createColumns(eventElements)}function _createColumns(eventElements){for(var columns=[],idx=0;idx<eventElements.length;idx++){for(var event=eventElements[idx],eventRange=rangeIndex(event),column=null,j=0,columnLength=columns.length;j<columnLength;j++){var endOverlaps=eventRange.start>columns[j].end;if(eventRange.start<columns[j].start||endOverlaps){column=columns[j],column.end<eventRange.end&&(column.end=eventRange.end);break}}column||(column={start:eventRange.start,end:eventRange.end,events:[]},columns.push(column)),column.events.push(event)}return columns}function createLayoutConfiguration(name,resources,inner){var resource=resources[0];if(resource){for(var configuration=[],data=resource.dataSource.view(),dataIndex=0;dataIndex<data.length;dataIndex++){var obj={text:kendo.getter(resource.dataTextField)(data[dataIndex]),className:"k-slot-cell"};obj[name]=createLayoutConfiguration(name,resources.slice(1),inner),configuration.push(obj)}return configuration}return inner}function groupEqFilter(value){return function(item){if($.isArray(item)||item instanceof kendo.data.ObservableArray){for(var idx=0;idx<item.length;idx++)if(item[idx]==value)return!0;return!1}return item==value}}function addSelectedState(cell){cell.className=cell.className.replace(selectedStateRegExp,"")+" k-state-selected"}var kendo=window.kendo,ui=kendo.ui,Widget=ui.Widget,keys=kendo.keys,NS=".kendoSchedulerView",math=Math,HINT='<div class="k-marquee k-scheduler-marquee"><div class="k-marquee-color"></div><div class="k-marquee-text"><div class="k-label-top"></div><div class="k-label-bottom"></div></div></div>';kendo.ui.scheduler={};var scrollbarWidth,ResourceView=kendo.Class.extend({init:function(index){this._index=index,this._timeSlotCollections=[],this._daySlotCollections=[]},addTimeSlotCollection:function(startDate,endDate){return this._addCollection(startDate,endDate,this._timeSlotCollections)},addDaySlotCollection:function(startDate,endDate){return this._addCollection(startDate,endDate,this._daySlotCollections)},_addCollection:function(startDate,endDate,collections){var collection=new SlotCollection(startDate,endDate,this._index,collections.length);return collections.push(collection),collection},timeSlotCollectionCount:function(){return this._timeSlotCollections.length},daySlotCollectionCount:function(){return this._daySlotCollections.length},daySlotByPosition:function(x,y){return this._slotByPosition(x,y,this._daySlotCollections)},timeSlotByPosition:function(x,y){return this._slotByPosition(x,y,this._timeSlotCollections)},_slotByPosition:function(x,y,collections){for(var collectionIndex=0;collectionIndex<collections.length;collectionIndex++)for(var collection=collections[collectionIndex],slotIndex=0;slotIndex<collection.count();slotIndex++){var slot=collection.at(slotIndex);if(x>=slot.offsetLeft&&x<slot.offsetLeft+slot.clientWidth&&y>=slot.offsetTop&&y<=slot.offsetTop+slot.clientHeight)return slot}},refresh:function(){var collectionIndex;for(collectionIndex=0;collectionIndex<this._daySlotCollections.length;collectionIndex++)this._daySlotCollections[collectionIndex].refresh();for(collectionIndex=0;collectionIndex<this._timeSlotCollections.length;collectionIndex++)this._timeSlotCollections[collectionIndex].refresh()},timeSlotRanges:function(startTime,endTime){var collections=this._timeSlotCollections,start=this._startSlot(startTime,collections);!start.inRange&&startTime>=start.slot.end&&(start=null);var end=start;return startTime<endTime&&(end=this._endSlot(endTime,collections)),end&&!end.inRange&&endTime<=end.slot.start&&(end=null),null===start&&null===end?[]:(null===start&&(start={inRange:!0,slot:collections[end.slot.collectionIndex].first()}),null===end&&(end={inRange:!0,slot:collections[start.slot.collectionIndex].last()}),this._continuousRange(TimeSlotRange,collections,start,end))},daySlotRanges:function(startTime,endTime,isAllDay){var collections=this._daySlotCollections,start=this._startSlot(startTime,collections,isAllDay);!start.inRange&&startTime>=start.slot.end&&(start=null);var end=start;if(startTime<endTime&&(end=this._endSlot(endTime,collections,isAllDay)),end&&!end.inRange&&endTime<=end.slot.start&&(end=null),null===start&&null===end)return[];if(null===start)do startTime+=kendo.date.MS_PER_DAY,start=this._startSlot(startTime,collections,isAllDay);while(!start.inRange&&startTime>=start.slot.end);if(null===end)do endTime-=kendo.date.MS_PER_DAY,end=this._endSlot(endTime,collections,isAllDay);while(!end.inRange&&endTime<=end.slot.start);return this._continuousRange(DaySlotRange,collections,start,end)},_continuousRange:function(range,collections,start,end){for(var startSlot=start.slot,endSlot=end.slot,startIndex=startSlot.collectionIndex,endIndex=endSlot.collectionIndex,ranges=[],collectionIndex=startIndex;collectionIndex<=endIndex;collectionIndex++){var collection=collections[collectionIndex],first=collection.first(),last=collection.last(),head=!1,tail=!1;collectionIndex==startIndex&&(tail=!start.inRange),collectionIndex==endIndex&&(head=!end.inRange),first.start<startSlot.start&&(first=startSlot),last.start>endSlot.start&&(last=endSlot),startIndex<endIndex&&(collectionIndex==startIndex?head=!0:collectionIndex==endIndex?tail=!0:head=tail=!0),ranges.push(new range({start:first,end:last,collection:collection,head:head,tail:tail}))}return ranges},slotRanges:function(event,isDay){var startTime=event.startTime||kendo.date.toUtcTime(event.start),endTime=event.endTime||kendo.date.toUtcTime(event.end);return void 0===isDay&&(isDay=event.isMultiDay()),isDay?this.daySlotRanges(startTime,endTime,event.isAllDay):this.timeSlotRanges(startTime,endTime)},ranges:function(startTime,endTime,isDay,isAllDay){return"number"!=typeof startTime&&(startTime=kendo.date.toUtcTime(startTime)),"number"!=typeof endTime&&(endTime=kendo.date.toUtcTime(endTime)),isDay?this.daySlotRanges(startTime,endTime,isAllDay):this.timeSlotRanges(startTime,endTime)},_startCollection:function(date,collections){for(var collectionIndex=0;collectionIndex<collections.length;collectionIndex++){var collection=collections[collectionIndex];if(collection.startInRange(date))return collection}return null},_endCollection:function(date,collections,isAllDay){for(var collectionIndex=0;collectionIndex<collections.length;collectionIndex++){var collection=collections[collectionIndex];if(collection.endInRange(date,isAllDay))return collection}return null},_getCollections:function(isDay){return isDay?this._daySlotCollections:this._timeSlotCollections},continuousSlot:function(slot,reverse){var pad=reverse?-1:1,collections=this._getCollections(slot.isDaySlot),collection=collections[slot.collectionIndex+pad];return collection?collection[reverse?"last":"first"]():void 0},firstSlot:function(){var collections=this._getCollections(this.daySlotCollectionCount());return collections[0].first()},lastSlot:function(){var collections=this._getCollections(this.daySlotCollectionCount());return collections[collections.length-1].last()},upSlot:function(slot,keepCollection){var that=this,moveToDaySlot=function(isDaySlot,collectionIndex,index){var isFirstCell=0===index;if(!keepCollection&&!isDaySlot&&isFirstCell&&that.daySlotCollectionCount())return that._daySlotCollections[0].at(collectionIndex)};return this.timeSlotCollectionCount()||(keepCollection=!0),this._verticalSlot(slot,-1,moveToDaySlot)},downSlot:function(slot,keepCollection){var that=this,moveToTimeSlot=function(isDaySlot,collectionIndex,index){if(!keepCollection&&isDaySlot&&that.timeSlotCollectionCount())return that._timeSlotCollections[index].at(0)};return this.timeSlotCollectionCount()||(keepCollection=!0),this._verticalSlot(slot,1,moveToTimeSlot)},leftSlot:function(slot){return this._horizontalSlot(slot,-1)},rightSlot:function(slot){return this._horizontalSlot(slot,1)},_horizontalSlot:function(slot,step){var index=slot.index,isDaySlot=slot.isDaySlot,collectionIndex=slot.collectionIndex,collections=this._getCollections(isDaySlot);isDaySlot?index+=step:collectionIndex+=step;var collection=collections[collectionIndex];return collection?collection.at(index):void 0},_verticalSlot:function(slot,step,swapCollection){var index=slot.index,isDaySlot=slot.isDaySlot,collectionIndex=slot.collectionIndex,collections=this._getCollections(isDaySlot);if(slot=swapCollection(isDaySlot,collectionIndex,index))return slot;isDaySlot?collectionIndex+=step:index+=step;var collection=collections[collectionIndex];return collection?collection.at(index):void 0},_collection:function(index,multiday){var collections=multiday?this._daySlotCollections:this._timeSlotCollections;return collections[index]},_startSlot:function(time,collections,isAllDay){var collection=this._startCollection(time,collections),inRange=!0;collection||(collection=collections[0],inRange=!1);var slot=collection.slotByStartDate(time,isAllDay);return slot||(slot=collection.first(),inRange=!1),{slot:slot,inRange:inRange}},_endSlot:function(time,collections,isAllDay){var collection=this._endCollection(time,collections,isAllDay),inRange=!0;collection||(collection=collections[collections.length-1],inRange=!1);var slot=collection.slotByEndDate(time,isAllDay);return slot||(slot=collection.last(),inRange=!1),{slot:slot,inRange:inRange}},getSlotCollection:function(index,isDay){return this[isDay?"getDaySlotCollection":"getTimeSlotCollection"](index)},getTimeSlotCollection:function(index){return this._timeSlotCollections[index]},getDaySlotCollection:function(index){return this._daySlotCollections[index]}}),SlotRange=kendo.Class.extend({init:function(options){$.extend(this,options)},innerHeight:function(){for(var collection=this.collection,startIndex=this.start.index,endIndex=this.end.index,result=0,slotIndex=startIndex;slotIndex<=endIndex;slotIndex++)result+=collection.at(slotIndex).offsetHeight;return result},events:function(){return this.collection.events()},addEvent:function(event){this.events().push(event)},startSlot:function(){return this.start.offsetLeft>this.end.offsetLeft?this.end:this.start},endSlot:function(){return this.start.offsetLeft>this.end.offsetLeft?this.start:this.end}}),TimeSlotRange=SlotRange.extend({innerHeight:function(){for(var collection=this.collection,startIndex=this.start.index,endIndex=this.end.index,result=0,slotIndex=startIndex;slotIndex<=endIndex;slotIndex++)result+=collection.at(slotIndex).offsetHeight;return result},outerRect:function(start,end,snap){return this._rect("offset",start,end,snap)},_rect:function(property,start,end,snap){var top,bottom,startSlot=this.start,endSlot=this.end;if("number"!=typeof start&&(start=kendo.date.toUtcTime(start)),"number"!=typeof end&&(end=kendo.date.toUtcTime(end)),snap)top=startSlot.offsetTop,bottom=endSlot.offsetTop+endSlot[property+"Height"];else{var startOffset=start-startSlot.start;startOffset<0&&(startOffset=0);var startSlotDuration=startSlot.end-startSlot.start;top=startSlot.offsetTop+startSlot[property+"Height"]*startOffset/startSlotDuration;var endOffset=endSlot.end-end;endOffset<0&&(endOffset=0);var endSlotDuration=endSlot.end-endSlot.start;bottom=endSlot.offsetTop+endSlot[property+"Height"]-endSlot[property+"Height"]*endOffset/endSlotDuration}return{top:top,bottom:bottom}},innerRect:function(start,end,snap){return this._rect("client",start,end,snap)}}),DaySlotRange=SlotRange.extend({innerWidth:function(){for(var collection=this.collection,startIndex=this.start.index,endIndex=this.end.index,result=0,width=startIndex!==endIndex?"offsetWidth":"clientWidth",slotIndex=startIndex;slotIndex<=endIndex;slotIndex++)result+=collection.at(slotIndex)[width];return result}}),SlotCollection=kendo.Class.extend({init:function(startDate,endDate,groupIndex,collectionIndex){this._slots=[],this._events=[],this._start=kendo.date.toUtcTime(startDate),this._end=kendo.date.toUtcTime(endDate),this._groupIndex=groupIndex,this._collectionIndex=collectionIndex},refresh:function(){for(var slotIndex=0;slotIndex<this._slots.length;slotIndex++)this._slots[slotIndex].refresh()},startInRange:function(date){return this._start<=date&&date<this._end},endInRange:function(date,isAllDay){var end=isAllDay?date<this._end:date<=this._end;return this._start<=date&&end},slotByStartDate:function(date){var time=date;"number"!=typeof time&&(time=kendo.date.toUtcTime(date));for(var slotIndex=0;slotIndex<this._slots.length;slotIndex++){var slot=this._slots[slotIndex];if(slot.startInRange(time))return slot}return null},slotByEndDate:function(date,allday){var time=date;if("number"!=typeof time&&(time=kendo.date.toUtcTime(date)),allday)return this.slotByStartDate(date,!1);for(var slotIndex=0;slotIndex<this._slots.length;slotIndex++){var slot=this._slots[slotIndex];if(slot.endInRange(time))return slot}return null},count:function(){return this._slots.length},events:function(){return this._events},addTimeSlot:function(element,start,end){var slot=new TimeSlot(element,start,end,this._groupIndex,this._collectionIndex,this._slots.length);this._slots.push(slot)},addDaySlot:function(element,start,end,eventCount){var slot=new DaySlot(element,start,end,this._groupIndex,this._collectionIndex,this._slots.length,eventCount);this._slots.push(slot)},first:function(){return this._slots[0]},last:function(){return this._slots[this._slots.length-1]},at:function(index){return this._slots[index]}}),Slot=kendo.Class.extend({init:function(element,start,end,groupIndex,collectionIndex,index){this.element=element,this.clientWidth=element.clientWidth,this.clientHeight=element.clientHeight,this.offsetWidth=element.offsetWidth,this.offsetHeight=element.offsetHeight,this.offsetTop=element.offsetTop,this.offsetLeft=element.offsetLeft,this.start=start,this.end=end,this.element=element,this.groupIndex=groupIndex,this.collectionIndex=collectionIndex,this.index=index,this.isDaySlot=!1},startDate:function(){return kendo.timezone.toLocalDate(this.start)},endDate:function(){return kendo.timezone.toLocalDate(this.end)},startInRange:function(date){return this.start<=date&&date<this.end},endInRange:function(date){return this.start<date&&date<=this.end},startOffset:function(){return this.start},endOffset:function(){return this.end}}),TimeSlot=Slot.extend({refresh:function(){this.offsetTop=this.element.offsetTop},offsetX:function(rtl,offset){return rtl?this.offsetLeft+offset:this.offsetLeft+offset},startInRange:function(date){return this.start<=date&&date<this.end},endInRange:function(date){return this.start<date&&date<=this.end},startOffset:function(x,y,snap){if(snap)return this.start;var offset=$(this.element).offset(),difference=y-offset.top,duration=this.end-this.start,time=Math.floor(duration*(difference/this.offsetHeight));return this.start+time},endOffset:function(x,y,snap){if(snap)return this.end;var offset=$(this.element).offset(),difference=y-offset.top,duration=this.end-this.start,time=Math.floor(duration*(difference/this.offsetHeight));return this.start+time}}),DaySlot=Slot.extend({init:function(element,start,end,groupIndex,collectionIndex,index,eventCount){Slot.fn.init.apply(this,arguments),this.eventCount=eventCount,this.isDaySlot=!0,this.element.children.length?(this.firstChildHeight=this.element.children[0].offsetHeight+3,this.firstChildTop=this.element.children[0].offsetTop):(this.firstChildHeight=3,this.firstChildTop=0)},refresh:function(){this.clientHeight=this.element.clientHeight,this.offsetTop=this.element.offsetTop},startDate:function(){var date=new Date(this.start);return kendo.timezone.apply(date,"Etc/UTC")},endDate:function(){var date=new Date(this.end);return kendo.timezone.apply(date,"Etc/UTC")},startInRange:function(date){return this.start<=date&&date<this.end},endInRange:function(date){return this.start<date&&date<=this.end}});kendo.ui.SchedulerView=Widget.extend({init:function(element,options){Widget.fn.init.call(this,element,options),this._scrollbar=scrollbar(),this._isRtl=kendo.support.isRtl(element),this._resizeHint=$(),this._moveHint=$(),this._cellId=kendo.guid(),this._resourcesForGroups(),this._selectedSlots=[]},_isMobile:function(){var options=this.options;return options.mobile===!0&&kendo.support.mobileOS||"phone"===options.mobile||"tablet"===options.mobile},_isMobilePhoneView:function(){var options=this.options;return options.mobile===!0&&kendo.support.mobileOS&&!kendo.support.mobileOS.tablet||"phone"===options.mobile},_addResourceView:function(){var resourceView=new ResourceView(this.groups.length);return this.groups.push(resourceView),resourceView},dateForTitle:function(){return kendo.format(this.options.selectedDateFormat,this.startDate(),this.endDate())},_changeGroup:function(selection,previous){var method=previous?"prevGroupSlot":"nextGroupSlot",slot=this[method](selection.start,selection.groupIndex,selection.isAllDay);return slot&&(selection.groupIndex+=previous?-1:1),slot},_changeGroupContinuously:function(){return null},_changeViewPeriod:function(){return!1},_horizontalSlots:function(selection,ranges,multiple,reverse){var method=reverse?"leftSlot":"rightSlot",startSlot=ranges[0].start,endSlot=ranges[ranges.length-1].end,group=this.groups[selection.groupIndex];if(!multiple){var slot=this._normalizeHorizontalSelection(selection,ranges,reverse);slot&&(startSlot=endSlot=slot)}startSlot=group[method](startSlot),endSlot=group[method](endSlot),multiple||this._isVerticallyGrouped()||startSlot&&endSlot||(startSlot=endSlot=this._changeGroup(selection,reverse));var continuousSlot;return startSlot&&endSlot||(continuousSlot=this._continuousSlot(selection,ranges,reverse),continuousSlot=this._changeGroupContinuously(selection,continuousSlot,multiple,reverse),continuousSlot&&(startSlot=endSlot=continuousSlot)),{startSlot:startSlot,endSlot:endSlot}},_verticalSlots:function(selection,ranges,multiple,reverse){var startSlot=ranges[0].start,endSlot=ranges[ranges.length-1].end,group=this.groups[selection.groupIndex];if(!multiple){var slot=this._normalizeVerticalSelection(selection,ranges,reverse);slot&&(startSlot=endSlot=slot)}var method=reverse?"upSlot":"downSlot";return startSlot=group[method](startSlot,multiple),endSlot=group[method](endSlot,multiple),multiple||!this._isVerticallyGrouped()||startSlot&&endSlot||(startSlot=endSlot=this._changeGroup(selection,reverse)),{startSlot:startSlot,endSlot:endSlot}},_normalizeHorizontalSelection:function(){return null},_normalizeVerticalSelection:function(selection,ranges,reverse){var slot;return slot=reverse?ranges[0].start:ranges[ranges.length-1].end},_continuousSlot:function(){return null},constrainSelection:function(selection){var slot,group=this.groups[0];this.inRange(selection)?group.daySlotCollectionCount()||(selection.isAllDay=!1):(slot=group.firstSlot(),selection.isAllDay=slot.isDaySlot,selection.start=slot.startDate(),selection.end=slot.endDate()),this.groups[selection.groupIndex]||(selection.groupIndex=0)},move:function(selection,key,shift){var handled=!1,group=this.groups[selection.groupIndex];group.timeSlotCollectionCount()||(selection.isAllDay=!0);var startSlot,endSlot,reverse,slots,ranges=group.ranges(selection.start,selection.end,selection.isAllDay,!1);if(key===keys.DOWN||key===keys.UP){if(handled=!0,reverse=key===keys.UP,this._updateDirection(selection,ranges,shift,reverse,!0),slots=this._verticalSlots(selection,ranges,shift,reverse),!slots.startSlot&&!shift&&this._changeViewPeriod(selection,reverse,!0))return handled}else if((key===keys.LEFT||key===keys.RIGHT)&&(handled=!0,reverse=key===keys.LEFT,this._updateDirection(selection,ranges,shift,reverse,!1),slots=this._horizontalSlots(selection,ranges,shift,reverse),!slots.startSlot&&!shift&&this._changeViewPeriod(selection,reverse,!1)))return handled;if(handled){if(startSlot=slots.startSlot,endSlot=slots.endSlot,shift){var backward=selection.backward;backward&&startSlot?selection.start=startSlot.startDate():!backward&&endSlot&&(selection.end=endSlot.endDate())}else startSlot&&endSlot&&(selection.isAllDay=startSlot.isDaySlot,selection.start=startSlot.startDate(),selection.end=endSlot.endDate());selection.events=[]}return handled},moveToEventInGroup:function(group,slot,selectedEvents,prev){for(var found,event,events=group._continuousEvents||[],pad=prev?-1:1,length=events.length,idx=prev?length-1:0;idx<length&&idx>-1;){if(event=events[idx],(!prev&&event.start.startDate()>=slot.startDate()||prev&&event.start.startDate()<=slot.startDate())&&(selectedEvents.length&&(event=events[idx+pad]),event&&$.inArray(event.uid,selectedEvents)===-1)){found=!!event;break}idx+=pad}return event},moveToEvent:function(selection,prev){for(var event,groupIndex=selection.groupIndex,group=this.groups[groupIndex],slot=group.ranges(selection.start,selection.end,selection.isAllDay,!1)[0].start,length=this.groups.length,pad=prev?-1:1,events=selection.events;groupIndex<length&&groupIndex>-1&&(event=this.moveToEventInGroup(group,slot,events,prev),groupIndex+=pad,group=this.groups[groupIndex],group&&!event);)events=[],slot=prev?group.lastSlot():group.firstSlot(!0);return event&&(selection.events=[event.uid],selection.start=event.start.startDate(),selection.end=event.end.endDate(),selection.isAllDay=event.start.isDaySlot,selection.groupIndex=event.start.groupIndex),!!event},current:function(candidate){return void 0===candidate?this._current:(this._current=candidate,void this._scrollTo(candidate,this.content[0]))},select:function(selection){this.clearSelection(),this._selectEvents(selection)||this._selectSlots(selection)},_selectSlots:function(selection){var isAllDay=selection.isAllDay,group=this.groups[selection.groupIndex];group.timeSlotCollectionCount()||(isAllDay=!0),this._selectedSlots=[];for(var element,slot,ranges=group.ranges(selection.start,selection.end,isAllDay,!1),rangeIndex=0;rangeIndex<ranges.length;rangeIndex++)for(var range=ranges[rangeIndex],collection=range.collection,slotIndex=range.start.index;slotIndex<=range.end.index;slotIndex++)slot=collection.at(slotIndex),element=slot.element,element.setAttribute("aria-selected",!0),addSelectedState(element),this._selectedSlots.push({start:slot.startDate(),end:slot.endDate(),element:element});selection.backward&&(element=ranges[0].start.element),this.current(element)},_selectEvents:function(selection){var idx,found=!1,events=selection.events,groupEvents=this.groups[selection.groupIndex]._continuousEvents||[],length=groupEvents.length;if(!events[0]||!groupEvents[0])return found;var result=$();for(idx=0;idx<length;idx++)$.inArray(groupEvents[idx].uid,events)>-1&&(result=result.add(groupEvents[idx].element));return result[0]&&(result.addClass("k-state-selected").attr("aria-selected",!0),this.current(result.last()[0]),this._selectedSlots=[],found=!0),found},inRange:function(options){var startDate=this.startDate(),endDate=kendo.date.addDays(this.endDate(),1),start=options.start,end=options.end;return startDate<=start&&start<endDate&&startDate<end&&end<=endDate},_resourceValue:function(resource,item){return resource.valuePrimitive&&(item=kendo.getter(resource.dataValueField)(item)),item},_resourceBySlot:function(slot){var resources=this.groupedResources,result={};if(resources.length)for(var resourceIndex=slot.groupIndex,idx=resources.length-1;idx>=0;idx--){var resource=resources[idx],value=this._resourceValue(resource,resource.dataSource.view()[resourceIndex%resource.dataSource.total()]);resource.multiple&&(value=[value]);var setter=kendo.setter(resource.field);setter(result,value),resourceIndex=Math.floor(resourceIndex/resource.dataSource.total())}return result},_createResizeHint:function(left,top,width,height){return $(HINT).css({left:left,top:top,width:width,height:height})},_removeResizeHint:function(){this._resizeHint.remove(),this._resizeHint=$()},_removeMoveHint:function(){this._moveHint.remove(),this._moveHint=$()},_scrollTo:function(element,container){var elementOffset=element.offsetTop,elementOffsetDir=element.offsetHeight,containerScroll=container.scrollTop,containerOffsetDir=container.clientHeight,bottomDistance=elementOffset+elementOffsetDir,result=0;result=containerScroll>elementOffset?elementOffset:bottomDistance>containerScroll+containerOffsetDir?elementOffsetDir<=containerOffsetDir?bottomDistance-containerOffsetDir:elementOffset:containerScroll,container.scrollTop=result},_shouldInverseResourceColor:function(resource){var resourceColorIsDark=new Color(resource.color).isDark(),currentColor=this.element.css("color"),currentColorIsDark=new Color(currentColor).isDark();return resourceColorIsDark==currentColorIsDark},eventResources:function(event){var resources=[],options=this.options;if(!options.resources)return resources;for(var idx=0;idx<options.resources.length;idx++){var resource=options.resources[idx],field=resource.field,eventResources=kendo.getter(field)(event);if(eventResources){resource.multiple||(eventResources=[eventResources]);for(var data=resource.dataSource.view(),resourceIndex=0;resourceIndex<eventResources.length;resourceIndex++){var eventResource=null,value=eventResources[resourceIndex];resource.valuePrimitive||(value=kendo.getter(resource.dataValueField)(value));for(var dataIndex=0;dataIndex<data.length;dataIndex++)if(data[dataIndex].get(resource.dataValueField)==value){eventResource=data[dataIndex];break}if(null!==eventResource){var resourceColor=kendo.getter(resource.dataColorField)(eventResource);resources.push({field:resource.field,title:resource.title,name:resource.name,text:kendo.getter(resource.dataTextField)(eventResource),value:value,color:resourceColor})}}}}return resources},createLayout:function(layout){var allDayIndex=-1;layout.rows||(layout.rows=[]);for(var idx=0;idx<layout.rows.length;idx++)if(layout.rows[idx].allDay){allDayIndex=idx;break}var allDaySlot=layout.rows[allDayIndex];allDayIndex>=0&&layout.rows.splice(allDayIndex,1);var columnLevels=this.columnLevels=levels(layout,"columns"),rowLevels=this.rowLevels=levels(layout,"rows");this.table=$("<table "+cellspacing()+' class="k-scheduler-layout k-scheduler-'+this.name+'view"/>');var rowCount=rowLevels[rowLevels.length-1].length;this.table.append(this._topSection(columnLevels,allDaySlot,rowCount)),this.table.append(this._bottomSection(columnLevels,rowLevels,rowCount)),this.element.append(this.table),this._scroller()},refreshLayout:function(){for(var that=this,toolbar=that.element.find(">.k-scheduler-toolbar"),height=that.element.innerHeight(),scrollbar=this._scrollbar,headerHeight=0,paddingDirection=this._isRtl?"left":"right",idx=0;idx<toolbar.length;idx++)height-=toolbar.eq(idx).outerHeight();if(that.datesHeader&&(headerHeight=that.datesHeader.outerHeight()),that.timesHeader&&that.timesHeader.outerHeight()>headerHeight&&(headerHeight=that.timesHeader.outerHeight()),that.datesHeader&&that.timesHeader){var datesHeaderRows=that.datesHeader.find("table:first tr");that.timesHeader.find("tr").height(function(index){$(this).height(datesHeaderRows.eq(index).height())})}headerHeight&&(height-=headerHeight),that.footer&&(height-=that.footer.outerHeight());var isSchedulerHeightSet=function(el){var initialHeight,newHeight;return!!el[0].style.height||(initialHeight=el.height(),el.height("auto"),newHeight=el.height(),initialHeight!=newHeight?(el.height(""),!0):(el.height(""),!1))},contentDiv=that.content[0],scrollbarWidth=kendo.support.kineticScrollNeeded?0:scrollbar;if(isSchedulerHeightSet(that.element)){height>2*scrollbar?that.content.height(height):that.content.height(2*scrollbar+1),that.times.height(contentDiv.clientHeight);var timesTable=that.times.find("table");timesTable.length&&timesTable.height(that.content.find("table")[0].clientHeight)}contentDiv.offsetWidth-contentDiv.clientWidth>0?(that.table.addClass("k-scrollbar-v"),that.datesHeader.css("padding-"+paddingDirection,scrollbarWidth-parseInt(that.datesHeader.children().css("border-"+paddingDirection+"-width"),10))):that.datesHeader.css("padding-"+paddingDirection,""),contentDiv.offsetHeight-contentDiv.clientHeight>0||contentDiv.clientHeight>that.content.children(".k-scheduler-table").height()?that.table.addClass("k-scrollbar-h"):that.table.removeClass("k-scrollbar-h")},_topSection:function(columnLevels,allDaySlot,rowCount){this.timesHeader=timesHeader(columnLevels.length,allDaySlot,rowCount);var columnCount=columnLevels[columnLevels.length-1].length;return this.datesHeader=datesHeader(columnLevels,columnCount,allDaySlot),$("<tr>").append(this.timesHeader.add(this.datesHeader).wrap("<td>").parent())},_bottomSection:function(columnLevels,rowLevels,rowCount){return this.times=times(rowLevels,rowCount),this.content=content(columnLevels[columnLevels.length-1],rowLevels[rowLevels.length-1]),$("<tr>").append(this.times.add(this.content).wrap("<td>").parent())},_scroller:function(){var that=this;this.content.bind("scroll"+NS,function(){that.datesHeader.find(">.k-scheduler-header-wrap").scrollLeft(this.scrollLeft),that.times.scrollTop(this.scrollTop)});var touchScroller=kendo.touchScroller(this.content,{avoidScrolling:function(e){return $(e.event.target).closest(".k-event.k-event-active").length>0;
}});touchScroller&&touchScroller.movable&&(this._touchScroller=touchScroller,this.content=touchScroller.scrollElement,touchScroller.movable.bind("change",function(e){that.datesHeader.find(">.k-scheduler-header-wrap").scrollLeft(-e.sender.x),that.times.scrollTop(-e.sender.y)}))},_resourcesForGroups:function(){var result=[],groups=this.options.group,resources=this.options.resources;if(groups=groups&&groups.resources?groups.resources:[],resources&&groups.length)for(var idx=0,length=resources.length;idx<length;idx++)for(var groupIdx=0,groupLength=groups.length;groupIdx<groupLength;groupIdx++)resources[idx].name===groups[groupIdx]&&result.push(resources[idx]);this.groupedResources=result},_createColumnsLayout:function(resources,inner){return createLayoutConfiguration("columns",resources,inner)},_groupOrientation:function(){var groups=this.options.group;return groups&&groups.resources?groups.orientation:"horizontal"},_isVerticallyGrouped:function(){return this.groupedResources.length&&"vertical"===this._groupOrientation()},_createRowsLayout:function(resources,inner){return createLayoutConfiguration("rows",resources,inner)},selectionByElement:function(){return null},clearSelection:function(){this.content.find(".k-state-selected").removeAttr("id").attr("aria-selected",!1).removeClass("k-state-selected")},destroy:function(){var that=this;Widget.fn.destroy.call(this),that.table&&(kendo.destroy(that.table),that.table.remove()),that.groups=null,that.table=null,that.content=null,that.times=null,that.datesHeader=null,that.timesHeader=null,that.footer=null,that._resizeHint=null,that._moveHint=null},calendarInfo:function(){return kendo.getCulture().calendars.standard},prevGroupSlot:function(date,groupIndex,isDay){var collection,group=this.groups[groupIndex],slot=group.ranges(date,date,isDay,!1)[0].start;if(!(groupIndex<=0))return this._isVerticallyGrouped()?group.timeSlotCollectionCount()?(collection=group._collection(isDay?slot.index:slot.collectionIndex,!1),collection.last()):(collection=group._collection(group.daySlotCollectionCount()-1,!0),collection.at(slot.index)):group.timeSlotCollectionCount()?(collection=group._collection(isDay?0:group.timeSlotCollectionCount()-1,isDay),isDay?collection.last():collection.at(slot.index)):(collection=group._collection(slot.collectionIndex,!0),collection.last())},nextGroupSlot:function(date,groupIndex,isDay){var collection,daySlotCollectionCount,group=this.groups[groupIndex],slot=group.ranges(date,date,isDay,!1)[0].start;if(!(groupIndex>=this.groups.length-1))return this._isVerticallyGrouped()?group.timeSlotCollectionCount()?(daySlotCollectionCount=group.daySlotCollectionCount(),collection=group._collection(daySlotCollectionCount?0:slot.collectionIndex,daySlotCollectionCount),isDay?collection.first():collection.at(slot.collectionIndex)):(collection=group._collection(0,!0),collection.at(slot.index)):group.timeSlotCollectionCount()?(collection=group._collection(0,isDay),isDay?collection.first():collection.at(slot.index)):(collection=group._collection(slot.collectionIndex,!0),collection.first())}});var Color=function(value){var re,processor,parts,i,channels,color=this,formats=Color.formats;if(1===arguments.length)for(value=color.resolveColor(value),i=0;i<formats.length;i++)re=formats[i].re,processor=formats[i].process,parts=re.exec(value),parts&&(channels=processor(parts),color.r=channels[0],color.g=channels[1],color.b=channels[2]);else color.r=arguments[0],color.g=arguments[1],color.b=arguments[2];color.r=color.normalizeByte(color.r),color.g=color.normalizeByte(color.g),color.b=color.normalizeByte(color.b)};Color.prototype={resolveColor:function(value){return value=value||"#000","#"==value.charAt(0)&&(value=value.substr(1,6)),value=value.replace(/ /g,""),value=value.toLowerCase(),value=Color.namedColors[value]||value},normalizeByte:function(value){return value<0||isNaN(value)?0:value>255?255:value},percBrightness:function(){var color=this;return math.sqrt(.241*color.r*color.r+.691*color.g*color.g+.068*color.b*color.b)},isDark:function(){var color=this,brightnessValue=color.percBrightness();return brightnessValue<180}},Color.formats=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,process:function(parts){return[parseInt(parts[1],10),parseInt(parts[2],10),parseInt(parts[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,process:function(parts){return[parseInt(parts[1],16),parseInt(parts[2],16),parseInt(parts[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,process:function(parts){return[parseInt(parts[1]+parts[1],16),parseInt(parts[2]+parts[2],16),parseInt(parts[3]+parts[3],16)]}}],Color.namedColors={aqua:"00ffff",azure:"f0ffff",beige:"f5f5dc",black:"000000",blue:"0000ff",brown:"a52a2a",coral:"ff7f50",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgray:"a9a9a9",darkgreen:"006400",darkorange:"ff8c00",darkred:"8b0000",dimgray:"696969",fuchsia:"ff00ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lightblue:"add8e6",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumblue:"0000cd",navy:"000080",olive:"808000",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",pink:"ffc0cb",plum:"dda0dd",purple:"800080",red:"ff0000",royalblue:"4169e1",salmon:"fa8072",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",steelblue:"4682b4",tan:"d2b48c",teal:"008080",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};var selectedStateRegExp=/\s*k-state-selected/;$.extend(ui.SchedulerView,{createColumns:createColumns,createRows:createRows,rangeIndex:rangeIndex,collidingEvents:collidingEvents,groupEqFilter:groupEqFilter})}(window.kendo.jQuery),function($,undefined){function toInvariantTime(date){var staticDate=new Date(1980,1,1,0,0,0);return setTime(staticDate,getMilliseconds(date)),staticDate}function isInDateRange(value,min,max){return value>=min&&value<=max}function isInTimeRange(value,min,max,overlaps){return overlaps=overlaps?value<=max:value<max,value>min&&overlaps}function addContinuousEvent(group,range,element,isAllDay){var events=group._continuousEvents,lastEvent=events[events.length-1],startDate=getDate(range.start.startDate()).getTime();if(isAllDay&&lastEvent&&getDate(lastEvent.start.startDate()).getTime()==startDate){for(var idx=events.length-1;idx>-1&&!(events[idx].isAllDay||getDate(events[idx].start.startDate()).getTime()<startDate);idx--);events.splice(idx+1,0,{element:element,isAllDay:!0,uid:element.attr(kendo.attr("uid")),start:range.start,end:range.end})}else events.push({element:element,isAllDay:isAllDay,uid:element.attr(kendo.attr("uid")),start:range.start,end:range.end})}function getWorkDays(options){var workDays=[],dayIndex=options.workWeekStart;for(workDays.push(dayIndex);options.workWeekEnd!=dayIndex;)dayIndex>6?dayIndex-=7:dayIndex++,workDays.push(dayIndex);return workDays}var kendo=window.kendo,ui=kendo.ui,setTime=kendo.date.setTime,SchedulerView=ui.SchedulerView,extend=$.extend,proxy=$.proxy,getDate=kendo.date.getDate,MS_PER_MINUTE=kendo.date.MS_PER_MINUTE,MS_PER_DAY=kendo.date.MS_PER_DAY,getMilliseconds=kendo.date.getMilliseconds,NS=".kendoMultiDayView",DAY_VIEW_EVENT_TEMPLATE=kendo.template('<div title="(#=kendo.format("{0:t} - {1:t}", start, end)#): #=title.replace(/"/g,"&\\#34;")#"><div class="k-event-template k-event-time">#:kendo.format("{0:t} - {1:t}", start, end)#</div><div class="k-event-template">${title}</div></div>'),DAY_VIEW_ALL_DAY_EVENT_TEMPLATE=kendo.template('<div title="(#=kendo.format("{0:t}", start)#): #=title.replace(/"/g,"&\\#34;")#"><div class="k-event-template">${title}</div></div>'),DATA_HEADER_TEMPLATE=kendo.template("<span class='k-link k-nav-day'>#=kendo.toString(date, 'ddd M/dd')#</span>"),ALLDAY_EVENT_WRAPPER_STRING='<div role="gridcell" aria-selected="false" data-#=ns#uid="#=uid#"#if (resources[0]) { #style="background-color:#=resources[0].color#; border-color: #=resources[0].color#"class="k-event#=inverseColor ? " k-event-inverse" : ""#" #} else {#class="k-event"#}#><span class="k-event-actions"># if(data.tail || data.middle) {#<span class="k-icon k-i-arrow-w"></span>#}## if(data.isException()) {#<span class="k-icon k-i-exception"></span># } else if(data.isRecurring()) {#<span class="k-icon k-i-refresh"></span># } #</span>{0}<span class="k-event-actions">#if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"></span></a>#}## if(data.head || data.middle) {#<span class="k-icon k-i-arrow-e"></span>#}#</span>#if(resizable && !singleDay && !data.tail && !data.middle){#<span class="k-resize-handle k-resize-w"></span>#}##if(resizable && !singleDay && !data.head && !data.middle){#<span class="k-resize-handle k-resize-e"></span>#}#</div>',EVENT_WRAPPER_STRING='<div role="gridcell" aria-selected="false" data-#=ns#uid="#=uid#" #if (resources[0]) { #style="background-color:#=resources[0].color #; border-color: #=resources[0].color#"class="k-event#=inverseColor ? " k-event-inverse" : ""#"#} else {#class="k-event"#}#><span class="k-event-actions"># if(data.isException()) {#<span class="k-icon k-i-exception"></span># } else if(data.isRecurring()) {#<span class="k-icon k-i-refresh"></span># } #</span>{0}<span class="k-event-actions">#if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"></span></a>#}#</span><span class="k-event-top-actions"># if(data.tail || data.middle) {#<span class="k-icon k-i-arrow-n"></span># } #</span><span class="k-event-bottom-actions"># if(data.head || data.middle) {#<span class="k-icon k-i-arrow-s"></span># } #</span># if(resizable && !data.tail && !data.middle) {#<span class="k-resize-handle k-resize-n"></span># } ## if(resizable && !data.head && !data.middle) {#<span class="k-resize-handle k-resize-s"></span># } #</div>',MultiDayView=SchedulerView.extend({init:function(element,options){var that=this;SchedulerView.fn.init.call(that,element,options),that.title=that.options.title||that.options.name,that._workDays=getWorkDays(that.options),that._templates(),that._editable(),that.calculateDateRange(),that._groups()},_updateResizeHint:function(event,groupIndex,startTime,endTime){var multiday=event.isMultiDay(),group=this.groups[groupIndex],ranges=group.ranges(startTime,endTime,multiday,event.isAllDay);this._removeResizeHint();for(var rangeIndex=0;rangeIndex<ranges.length;rangeIndex++){var range=ranges[rangeIndex],start=range.startSlot(),width=start.offsetWidth,height=start.clientHeight,top=start.offsetTop;if(multiday)width=range.innerWidth();else{var rect=range.outerRect(startTime,endTime,this.options.snap);top=rect.top,height=rect.bottom-rect.top}var hint=SchedulerView.fn._createResizeHint.call(this,start.offsetLeft,top,width,height);this._resizeHint=this._resizeHint.add(hint)}var format="t",container=this.content;multiday&&(format="M/dd",container=this.element.find(".k-scheduler-header-wrap:has(.k-scheduler-header-all-day) > div"),container.length||(container=this.content)),this._resizeHint.appendTo(container),this._resizeHint.find(".k-label-top,.k-label-bottom").text(""),this._resizeHint.first().addClass("k-first").find(".k-label-top").text(kendo.toString(kendo.timezone.toLocalDate(startTime),format)),this._resizeHint.last().addClass("k-last").find(".k-label-bottom").text(kendo.toString(kendo.timezone.toLocalDate(endTime),format))},_updateMoveHint:function(event,groupIndex,distance){var multiday=event.isMultiDay(),group=this.groups[groupIndex],start=kendo.date.toUtcTime(event.start)+distance,end=start+event.duration(),ranges=group.ranges(start,end,multiday,event.isAllDay);start=kendo.timezone.toLocalDate(start),end=kendo.timezone.toLocalDate(end),this._removeMoveHint(),!multiday&&(0===getMilliseconds(end)||getMilliseconds(end)<getMilliseconds(this.startTime()))&&ranges.length>1&&ranges.pop();for(var rangeIndex=0;rangeIndex<ranges.length;rangeIndex++){var range=ranges[rangeIndex],startSlot=range.start,hint=this._createEventElement(event.clone({start:start,end:end}),!multiday);hint.addClass("k-event-drag-hint");var css={left:startSlot.offsetLeft+2,top:startSlot.offsetTop};if(this._isRtl&&(css.left=.1*startSlot.clientWidth+startSlot.offsetLeft+2),multiday)css.width=range.innerWidth()-4;else{var rect=range.outerRect(start,end,this.options.snap);css.top=rect.top,css.height=rect.bottom-rect.top,css.width=.9*startSlot.clientWidth-4}hint.css(css),this._moveHint=this._moveHint.add(hint)}var content=this.content;multiday&&(content=this.element.find(".k-scheduler-header-wrap:has(.k-scheduler-header-all-day) > div"),content.length||(content=this.content)),this._moveHint.appendTo(content)},_slotByPosition:function(x,y){var slot,offset;this._isVerticallyGrouped()?(offset=this.content.offset(),y+=this.content[0].scrollTop,x+=this.content[0].scrollLeft):offset=this.element.find(".k-scheduler-header-wrap:has(.k-scheduler-header-all-day)").find(">div").offset(),offset&&(x-=offset.left,y-=offset.top),x=Math.ceil(x),y=Math.ceil(y);var group,groupIndex;for(groupIndex=0;groupIndex<this.groups.length;groupIndex++)if(group=this.groups[groupIndex],slot=group.daySlotByPosition(x,y))return slot;for(offset&&(x+=offset.left,y+=offset.top),offset=this.content.offset(),x-=offset.left,y-=offset.top,this._isVerticallyGrouped()||(y+=this.content[0].scrollTop,x+=this.content[0].scrollLeft),x=Math.ceil(x),y=Math.ceil(y),groupIndex=0;groupIndex<this.groups.length;groupIndex++)if(group=this.groups[groupIndex],slot=group.timeSlotByPosition(x,y))return slot;return null},_groupCount:function(){var resources=this.groupedResources;return resources.length?"vertical"===this._groupOrientation()?this._rowCountForLevel(resources.length-1):this._columnCountForLevel(resources.length)/this._columnOffsetForResource(resources.length):1},_columnCountInResourceView:function(){var resources=this.groupedResources;return!resources.length||this._isVerticallyGrouped()?this._columnCountForLevel(0):this._columnOffsetForResource(resources.length)},_timeSlotGroups:function(groupCount,columnCount){var interval=this._timeSlotInterval(),tableRows=this.content.find("tr:not(.k-scheduler-header-all-day)");tableRows.attr("role","row");var rowCount=tableRows.length;this._isVerticallyGrouped()&&(rowCount=Math.floor(rowCount/groupCount));for(var groupIndex=0;groupIndex<groupCount;groupIndex++){var rowMultiplier=0;this._isVerticallyGrouped()&&(rowMultiplier=groupIndex);var time,rowIndex=rowMultiplier*rowCount,cellMultiplier=0;for(this._isVerticallyGrouped()||(cellMultiplier=groupIndex);rowIndex<(rowMultiplier+1)*rowCount;){var cells=tableRows[rowIndex].children,group=this.groups[groupIndex];rowIndex%rowCount===0&&(time=getMilliseconds(new Date((+this.startTime()))));for(var cellIndex=cellMultiplier*columnCount;cellIndex<(cellMultiplier+1)*columnCount;cellIndex++){var cell=cells[cellIndex],collectionIndex=cellIndex%columnCount,collection=group.getTimeSlotCollection(collectionIndex),currentDate=this._dates[collectionIndex],currentTime=Date.UTC(currentDate.getFullYear(),currentDate.getMonth(),currentDate.getDate()),start=currentTime+time,end=start+interval;cell.setAttribute("role","gridcell"),cell.setAttribute("aria-selected",!1),collection.addTimeSlot(cell,start,end)}time+=interval,rowIndex++}}},_daySlotGroups:function(groupCount,columnCount){var tableRows;tableRows=this._isVerticallyGrouped()?this.element.find(".k-scheduler-header-all-day"):this.element.find(".k-scheduler-header-all-day tr"),tableRows.attr("role","row");for(var groupIndex=0;groupIndex<groupCount;groupIndex++){var rowMultiplier=0;this._isVerticallyGrouped()&&(rowMultiplier=groupIndex);var group=this.groups[groupIndex],collection=group.getDaySlotCollection(0),cells=tableRows[rowMultiplier].children,cellMultiplier=0;this._isVerticallyGrouped()||(cellMultiplier=groupIndex);for(var cellCount=0,cellIndex=cellMultiplier*columnCount;cellIndex<(cellMultiplier+1)*columnCount;cellIndex++){var cell=cells[cellIndex];cellIndex%columnCount===0&&(cellCount=0);var start=this._dates[cellCount],currentTime=Date.UTC(start.getFullYear(),start.getMonth(),start.getDate());cellCount++,cell.setAttribute("role","gridcell"),cell.setAttribute("aria-selected",!1),collection.addDaySlot(cell,currentTime,currentTime+kendo.date.MS_PER_DAY)}}},_groups:function(){var groupCount=this._groupCount(),columnCount=this._columnCountInResourceView();this.groups=[];for(var idx=0;idx<groupCount;idx++){for(var view=this._addResourceView(idx),columnIndex=0;columnIndex<columnCount;columnIndex++)view.addTimeSlotCollection(this._dates[columnIndex],kendo.date.addDays(this._dates[columnIndex],1));this.options.allDaySlot&&view.addDaySlotCollection(this._dates[0],kendo.date.addDays(this._dates[this._dates.length-1],1))}this._timeSlotGroups(groupCount,columnCount),this.options.allDaySlot&&this._daySlotGroups(groupCount,columnCount)},options:{name:"MultiDayView",selectedDateFormat:"{0:D}",allDaySlot:!0,showWorkHours:!1,title:"",startTime:kendo.date.today(),endTime:kendo.date.today(),minorTickCount:2,majorTick:60,majorTimeHeaderTemplate:"#=kendo.toString(date, 't')#",minorTimeHeaderTemplate:"&nbsp;",slotTemplate:"&nbsp;",allDaySlotTemplate:"&nbsp;",eventTemplate:DAY_VIEW_EVENT_TEMPLATE,allDayEventTemplate:DAY_VIEW_ALL_DAY_EVENT_TEMPLATE,dateHeaderTemplate:DATA_HEADER_TEMPLATE,editable:!0,workDayStart:new Date(1980,1,1,8,0,0),workDayEnd:new Date(1980,1,1,17,0,0),workWeekStart:1,workWeekEnd:5,footer:{command:"workDay"},messages:{allDay:"all day",showFullDay:"Show full day",showWorkDay:"Show business hours"}},events:["remove","add","edit"],_templates:function(){var options=this.options,settings=extend({},kendo.Template,options.templateSettings);this.eventTemplate=this._eventTmpl(options.eventTemplate,EVENT_WRAPPER_STRING),this.allDayEventTemplate=this._eventTmpl(options.allDayEventTemplate,ALLDAY_EVENT_WRAPPER_STRING),this.majorTimeHeaderTemplate=kendo.template(options.majorTimeHeaderTemplate,settings),this.minorTimeHeaderTemplate=kendo.template(options.minorTimeHeaderTemplate,settings),this.dateHeaderTemplate=kendo.template(options.dateHeaderTemplate,settings),this.slotTemplate=kendo.template(options.slotTemplate,settings),this.allDaySlotTemplate=kendo.template(options.allDaySlotTemplate,settings)},_editable:function(){this.options.editable&&(this._isMobile()?this._touchEditable():this._mouseEditable())},_mouseEditable:function(){var that=this;that.element.on("click"+NS,".k-event a:has(.k-si-close)",function(e){that.trigger("remove",{uid:$(this).closest(".k-event").attr(kendo.attr("uid"))}),e.preventDefault()}),that.options.editable.create!==!1&&that.element.on("dblclick"+NS,".k-scheduler-content td",function(e){if(!$(this).parent().hasClass("k-scheduler-header-all-day")){var slot=that._slotByPosition(e.pageX,e.pageY);if(slot){var resourceInfo=that._resourceBySlot(slot);that.trigger("add",{eventInfo:extend({start:slot.startDate(),end:slot.endDate()},resourceInfo)})}e.preventDefault()}}).on("dblclick"+NS,".k-scheduler-header-all-day td",function(e){var slot=that._slotByPosition(e.pageX,e.pageY);if(slot){var resourceInfo=that._resourceBySlot(slot);that.trigger("add",{eventInfo:extend({},{isAllDay:!0,start:kendo.date.getDate(slot.startDate()),end:kendo.date.getDate(slot.startDate())},resourceInfo)})}e.preventDefault()}),that.options.editable.update!==!1&&that.element.on("dblclick"+NS,".k-event",function(e){that.trigger("edit",{uid:$(this).closest(".k-event").attr(kendo.attr("uid"))}),e.preventDefault()})},_touchEditable:function(){var that=this;that.options.editable.create!==!1&&(that._addUserEvents=new kendo.UserEvents(that.element,{filter:".k-scheduler-content td",tap:function(e){if(!$(e.target).parent().hasClass("k-scheduler-header-all-day")){var slot=that._slotByPosition(e.x.location,e.y.location);if(slot){var resourceInfo=that._resourceBySlot(slot);that.trigger("add",{eventInfo:extend({start:slot.startDate(),end:slot.endDate()},resourceInfo)})}e.preventDefault()}}}),that._allDayUserEvents=new kendo.UserEvents(that.element,{filter:".k-scheduler-header-all-day td",tap:function(e){var slot=that._slotByPosition(e.x.location,e.y.location);if(slot){var resourceInfo=that._resourceBySlot(slot);that.trigger("add",{eventInfo:extend({},{isAllDay:!0,start:kendo.date.getDate(slot.startDate()),end:kendo.date.getDate(slot.startDate())},resourceInfo)})}e.preventDefault()}})),that.options.editable.update!==!1&&(that._editUserEvents=new kendo.UserEvents(that.element,{filter:".k-event",tap:function(e){var eventElement=$(e.target).closest(".k-event");eventElement.hasClass("k-event-active")||that.trigger("edit",{uid:eventElement.attr(kendo.attr("uid"))}),e.preventDefault()}}))},_layout:function(dates){for(var columns=[],rows=[],options=this.options,that=this,idx=0;idx<dates.length;idx++){var column={};column.text=that.dateHeaderTemplate({date:dates[idx]}),kendo.date.isToday(dates[idx])&&(column.className="k-today"),columns.push(column)}var resources=this.groupedResources;return options.allDaySlot&&rows.push({text:options.messages.allDay,allDay:!0,cellContent:function(idx){var groupIndex=idx;return idx=resources.length&&"vertical"!==that._groupOrientation()?idx%dates.length:idx,that.allDaySlotTemplate({date:dates[idx],resources:function(){return that._resourceBySlot({groupIndex:groupIndex})}})}}),this._forTimeRange(this.startTime(),this.endTime(),function(date,majorTick,middleRow,lastSlotRow){var template=majorTick?that.majorTimeHeaderTemplate:that.minorTimeHeaderTemplate,row={text:template({date:date}),className:lastSlotRow?"k-slot-cell":""};rows.push(row)}),resources.length&&("vertical"===this._groupOrientation()?rows=this._createRowsLayout(resources,rows):columns=this._createColumnsLayout(resources,columns)),{columns:columns,rows:rows}},_footer:function(){var options=this.options;if(options.footer!==!1){var html='<div class="k-header k-scheduler-footer">',command=options.footer.command;command&&"workDay"===command?(html+='<ul class="k-reset k-header k-toolbar">',html+='<li class="k-state-default k-scheduler-fullday"><a href="#" class="k-link"><span class="k-icon k-i-clock"></span>',html+=(options.showWorkHours?options.messages.showFullDay:options.messages.showWorkDay)+"</a></li>",html+="</ul>"):html+="&nbsp;",html+="</div>",this.footer=$(html).appendTo(this.element);var that=this;this.footer.on("click"+NS,".k-scheduler-fullday",function(e){e.preventDefault(),that.trigger("navigate",{view:that.name||options.name,date:that.startDate(),isWorkDay:!options.showWorkHours})})}},_forTimeRange:function(min,max,action,after){min=toInvariantTime(min),max=toInvariantTime(max);var msStart,length,that=this,msMin=getMilliseconds(min),msMax=getMilliseconds(max),minorTickCount=that.options.minorTickCount,msMajorInterval=that.options.majorTick*MS_PER_MINUTE,msInterval=msMajorInterval/minorTickCount||1,start=new Date((+min)),startDay=start.getDate(),idx=0,html="";for(length=MS_PER_DAY/msInterval,msMin!=msMax&&(msMin>msMax&&(msMax+=MS_PER_DAY),length=(msMax-msMin)/msInterval),length=Math.round(length);idx<length;idx++){var majorTickDivider=idx%(msMajorInterval/msInterval),isMajorTickRow=0===majorTickDivider,isMiddleRow=majorTickDivider<minorTickCount-1,isLastSlotRow=majorTickDivider===minorTickCount-1;html+=action(start,isMajorTickRow,isMiddleRow,isLastSlotRow),setTime(start,msInterval,!1)}return msMax&&(msStart=getMilliseconds(start),startDay<start.getDate()&&(msStart+=MS_PER_DAY),msStart>msMax&&(start=new Date((+max)))),after&&(html+=after(start)),html},_content:function(dates){var allDayVerticalGroupRow,that=this,options=that.options,start=that.startTime(),end=this.endTime(),groupsCount=1,rowCount=1,columnCount=dates.length,html="",resources=this.groupedResources,slotTemplate=this.slotTemplate,allDaySlotTemplate=this.allDaySlotTemplate,isVerticalGroupped=!1;resources.length&&(isVerticalGroupped="vertical"===that._groupOrientation(),isVerticalGroupped?(rowCount=this._rowCountForLevel(this.rowLevels.length-2),options.allDaySlot&&(allDayVerticalGroupRow=function(groupIndex){for(var result='<tr class="k-scheduler-header-all-day">',resources=function(){return that._resourceBySlot({groupIndex:groupIndex})},idx=0,length=dates.length;idx<length;idx++)result+="<td>"+allDaySlotTemplate({date:dates[idx],resources:resources})+"</td>";return result+"</tr>"})):groupsCount=this._columnCountForLevel(this.columnLevels.length-2)),html+="<tbody>";for(var appendRow=function(date,majorTick){var idx,length,tmplDate,content="",classes="",groupIdx=0;content="<tr"+(majorTick?' class="k-middle-row"':"")+">";for(var resources=function(groupIndex){return function(){return that._resourceBySlot({groupIndex:groupIndex})}};groupIdx<groupsCount;groupIdx++)for(idx=0,length=columnCount;idx<length;idx++)classes="",kendo.date.isToday(dates[idx])&&(classes+="k-today"),(kendo.date.getMilliseconds(date)<kendo.date.getMilliseconds(that.options.workDayStart)||kendo.date.getMilliseconds(date)>=kendo.date.getMilliseconds(that.options.workDayEnd)||!that._isWorkDay(dates[idx]))&&(classes+=" k-nonwork-hour"),content+="<td"+(""!==classes?' class="'+classes+'"':"")+">",tmplDate=kendo.date.getDate(dates[idx]),kendo.date.setTime(tmplDate,kendo.date.getMilliseconds(date)),content+=slotTemplate({date:tmplDate,resources:resources(isVerticalGroupped?rowIdx:groupIdx)}),content+="</td>";return content+="</tr>"},rowIdx=0;rowIdx<rowCount;rowIdx++)html+=allDayVerticalGroupRow?allDayVerticalGroupRow(rowIdx):"",html+=this._forTimeRange(start,end,appendRow);html+="</tbody>",this.content.find("table").append(html)},_isWorkDay:function(date){for(var day=date.getDay(),workDays=this._workDays,i=0;i<workDays.length;i++)if(workDays[i]===day)return!0;return!1},_render:function(dates){var that=this;dates=dates||[],this._dates=dates,this._startDate=dates[0],this._endDate=dates[dates.length-1||0],this.createLayout(this._layout(dates)),this._content(dates),this._footer(),this.refreshLayout();var allDayHeader=this.element.find(".k-scheduler-header-all-day td");allDayHeader.length&&(this._allDayHeaderHeight=allDayHeader.first()[0].clientHeight),that.datesHeader.on("click"+NS,".k-nav-day",function(e){var th=$(e.currentTarget).closest("th"),offset=th.offset(),slot=that._slotByPosition(offset.left,offset.top+th.outerHeight());that.trigger("navigate",{view:"day",date:slot.startDate()})})},startTime:function(){var options=this.options;return options.showWorkHours?options.workDayStart:options.startTime},endTime:function(){var options=this.options;return options.showWorkHours?options.workDayEnd:options.endTime},startDate:function(){return this._startDate},endDate:function(){return this._endDate},_end:function(isAllDay){var time=getMilliseconds(this.endTime())||MS_PER_DAY;return isAllDay&&(time=0),new Date(this._endDate.getTime()+time)},nextDate:function(){return kendo.date.nextDay(this.endDate())},previousDate:function(){return kendo.date.previousDay(this.startDate())},calculateDateRange:function(){this._render([this.options.date])},destroy:function(){var that=this;that.datesHeader&&that.datesHeader.off(NS),that.element&&that.element.off(NS),that.footer&&that.footer.remove(),SchedulerView.fn.destroy.call(this),this._isMobile()&&that.options.editable&&(that.options.editable.create!==!1&&(that._addUserEvents.destroy(),that._allDayUserEvents.destroy()),that.options.editable.update!==!1&&that._editUserEvents.destroy())},inRange:function(options){var inRange=SchedulerView.fn.inRange.call(this,options),startTime=getMilliseconds(this.startTime()),endTime=getMilliseconds(this.endTime())||kendo.date.MS_PER_DAY,start=getMilliseconds(options.start),end=getMilliseconds(options.end)||kendo.date.MS_PER_DAY;return inRange&&startTime<=start&&end<=endTime},selectionByElement:function(cell){var offset=cell.offset();return this._slotByPosition(offset.left,offset.top)},_timeSlotInterval:function(){var options=this.options;return options.majorTick/options.minorTickCount*MS_PER_MINUTE},_timeSlotIndex:function(date){var options=this.options,eventStartTime=getMilliseconds(date),startTime=getMilliseconds(this.startTime()),timeSlotInterval=options.majorTick/options.minorTickCount*MS_PER_MINUTE;return(eventStartTime-startTime)/timeSlotInterval},_slotIndex:function(date,multiday){return multiday?this._dateSlotIndex(date):this._timeSlotIndex(date)},_dateSlotIndex:function(date,overlaps){var idx,length,slotStart,slotEnd,slots=this._dates||[],offset=1;for(idx=0,length=slots.length;idx<length;idx++)if(slotStart=kendo.date.getDate(slots[idx]),slotEnd=new Date(kendo.date.getDate(slots[idx]).getTime()+MS_PER_DAY-(overlaps?0:1)),isInDateRange(date,slotStart,slotEnd))return idx*offset;return-1},_positionAllDayEvent:function(element,slotRange){var slotWidth=slotRange.innerWidth(),startIndex=slotRange.start.index,endIndex=slotRange.end.index,allDayEvents=SchedulerView.collidingEvents(slotRange.events(),startIndex,endIndex),currentColumnCount=this._headerColumnCount||0,leftOffset=2,rightOffset=startIndex!==endIndex?5:4,eventHeight=this._allDayHeaderHeight,start=slotRange.startSlot();element.css({left:start.offsetLeft+leftOffset,width:slotWidth-rightOffset}),slotRange.addEvent({slotIndex:startIndex,start:startIndex,end:endIndex,element:element}),allDayEvents.push({slotIndex:startIndex,start:startIndex,end:endIndex,element:element});var rows=SchedulerView.createRows(allDayEvents);rows.length&&rows.length>currentColumnCount&&(this._headerColumnCount=rows.length);for(var top=slotRange.start.offsetTop,idx=0,length=rows.length;idx<length;idx++)for(var rowEvents=rows[idx].events,j=0,eventLength=rowEvents.length;j<eventLength;j++)$(rowEvents[j].element).css({top:top+idx*eventHeight})},_arrangeColumns:function(element,top,height,slotRange){var startSlot=slotRange.start;element={element:element,slotIndex:startSlot.index,start:top,end:top+height};var columns,columnEvents,slotWidth=startSlot.clientWidth,eventRightOffset=.1*slotWidth,eventElements=slotRange.events(),slotEvents=SchedulerView.collidingEvents(eventElements,element.start,element.end);slotRange.addEvent(element),slotEvents.push(element),columns=SchedulerView.createColumns(slotEvents);for(var columnWidth=(slotWidth-eventRightOffset)/columns.length,idx=0,length=columns.length;idx<length;idx++){columnEvents=columns[idx].events;for(var j=0,eventLength=columnEvents.length;j<eventLength;j++)columnEvents[j].element[0].style.width=columnWidth-4+"px",columnEvents[j].element[0].style.left=(this._isRtl?eventRightOffset:0)+startSlot.offsetLeft+idx*columnWidth+2+"px"}},_positionEvent:function(event,element,slotRange){var start=event.startTime||event.start,end=event.endTime||event.end,rect=slotRange.innerRect(start,end,!1),height=rect.bottom-rect.top-2;height<0&&(height=0),element.css({top:rect.top,height:height}),this._arrangeColumns(element,rect.top,element[0].clientHeight,slotRange)},_eventTmpl:function(template,wrapper){var options=this.options,settings=extend({},kendo.Template,options.templateSettings),paramName=settings.paramName,html="",type=typeof template,state={storage:{},count:0};"function"===type?(state.storage["tmpl"+state.count]=template,html+="#=this.tmpl"+state.count+"("+paramName+")#",state.count++):"string"===type&&(html+=template);var tmpl=kendo.template(kendo.format(wrapper,html),settings);return state.count>0&&(tmpl=proxy(tmpl,state.storage)),tmpl},_createEventElement:function(event,isOneDayEvent,head,tail){var middle,template=isOneDayEvent?this.eventTemplate:this.allDayEventTemplate,options=this.options,editable=options.editable,isMobile=this._isMobile(),showDelete=editable&&editable.destroy!==!1&&!isMobile,resizable=editable&&editable.resize!==!1,startDate=getDate(this.startDate()),endDate=getDate(this.endDate()),startTime=getMilliseconds(this.startTime()),endTime=getMilliseconds(this.endTime()),eventStartTime=event._time("start"),eventEndTime=event._time("end");startTime>=endTime&&(endTime=getMilliseconds(new Date(this.endTime().getTime()+MS_PER_DAY-1))),isOneDayEvent||event.isAllDay||(endDate=new Date(endDate.getTime()+MS_PER_DAY));
var eventStartDate=event.start,eventEndDate=event.end;event.isAllDay&&(eventEndDate=getDate(event.end)),!isInDateRange(getDate(eventStartDate),startDate,endDate)&&!isInDateRange(eventEndDate,startDate,endDate)||isOneDayEvent&&eventStartTime<startTime&&eventEndTime>endTime?middle=!0:getDate(eventStartDate)<startDate||isOneDayEvent&&eventStartTime<startTime?tail=!0:(eventEndDate>endDate&&!isOneDayEvent||isOneDayEvent&&eventEndTime>endTime)&&(head=!0);var resources=this.eventResources(event);return event.startTime&&(eventStartDate=new Date(eventStartTime),eventStartDate=kendo.timezone.apply(eventStartDate,"Etc/UTC")),event.endTime&&(eventEndDate=new Date(eventEndTime),eventEndDate=kendo.timezone.apply(eventEndDate,"Etc/UTC")),$(template(extend({},{ns:kendo.ns,resizable:resizable,showDelete:showDelete,middle:middle,head:head,tail:tail,singleDay:1==this._dates.length,resources:resources,inverseColor:!(!resources||!resources[0])&&this._shouldInverseResourceColor(resources[0])},event,{start:eventStartDate,end:eventEndDate})))},_isInTimeSlot:function(event){var slotStartTime=this.startTime(),slotEndTime=this.endTime(),startTime=event.startTime||event.start,endTime=event.endTime||event.end;if(getMilliseconds(slotEndTime)===getMilliseconds(kendo.date.getDate(slotEndTime))&&(slotEndTime=kendo.date.getDate(slotEndTime),setTime(slotEndTime,MS_PER_DAY-1)),event._date("end")>event._date("start")&&(endTime=+event._date("end")+(MS_PER_DAY-1)),endTime-=event._date("end"),startTime-=event._date("start"),slotEndTime=getMilliseconds(slotEndTime),slotStartTime=getMilliseconds(slotStartTime),slotStartTime===startTime&&startTime===endTime)return!0;var overlaps=startTime!==slotEndTime;return isInTimeRange(startTime,slotStartTime,slotEndTime,overlaps)||isInTimeRange(endTime,slotStartTime,slotEndTime,overlaps)||isInTimeRange(slotStartTime,startTime,endTime)||isInTimeRange(slotEndTime,startTime,endTime)},_isInDateSlot:function(event){var groups=this.groups[0],slotStart=groups.firstSlot().start,slotEnd=groups.lastSlot().end-1,startTime=kendo.date.toUtcTime(event.start),endTime=kendo.date.toUtcTime(event.end);return(isInDateRange(startTime,slotStart,slotEnd)||isInDateRange(endTime,slotStart,slotEnd)||isInDateRange(slotStart,startTime,endTime)||isInDateRange(slotEnd,startTime,endTime))&&(!isInDateRange(endTime,slotStart,slotStart)||isInDateRange(endTime,startTime,startTime)||event.isAllDay)},_updateAllDayHeaderHeight:function(height){if(this._height!==height){this._height=height;var allDaySlots=this.element.find(".k-scheduler-header-all-day td");if(allDaySlots.length){allDaySlots.parent().add(this.element.find(".k-scheduler-times-all-day").parent()).height(height);for(var groupIndex=0;groupIndex<this.groups.length;groupIndex++)this.groups[groupIndex].refresh()}}},_renderEvents:function(events,groupIndex){var event,idx,length,allDayEventContainer=this.datesHeader.find(".k-scheduler-header-wrap > div");for(idx=0,length=events.length;idx<length;idx++)if(event=events[idx],this._isInDateSlot(event)){var element,ranges,group,isMultiDayEvent=event.isAllDay||event.end.getTime()-event.start.getTime()>=MS_PER_DAY,container=isMultiDayEvent&&!this._isVerticallyGrouped()?allDayEventContainer:this.content;if(isMultiDayEvent)this.options.allDaySlot&&(group=this.groups[groupIndex],group._continuousEvents||(group._continuousEvents=[]),ranges=group.slotRanges(event),ranges.length&&(element=this._createEventElement(event,!isMultiDayEvent),this._positionAllDayEvent(element,ranges[0]),addContinuousEvent(group,ranges[0],element,!0),element.appendTo(container)));else if(this._isInTimeSlot(event)){group=this.groups[groupIndex],group._continuousEvents||(group._continuousEvents=[]),ranges=group.slotRanges(event);for(var rangeCount=ranges.length,rangeIndex=0;rangeIndex<rangeCount;rangeIndex++){var range=ranges[rangeIndex],start=event.start,end=event.end;rangeCount>1&&(0===rangeIndex?end=range.end.endDate():rangeIndex==rangeCount-1?start=range.start.startDate():(start=range.start.startDate(),end=range.end.endDate()));var occurrence=event.clone({start:start,end:end,startTime:event.startTime,endTime:event.endTime});if(this._isInTimeSlot(occurrence)){var head=range.head;element=this._createEventElement(event,!isMultiDayEvent,head,range.tail),element.appendTo(container),this._positionEvent(occurrence,element,range),addContinuousEvent(group,range,element,!1)}}}}},render:function(events){this._headerColumnCount=0,this._groups(),this.element.find(".k-event").remove(),events=new kendo.data.Query(events).sort([{field:"start",dir:"asc"},{field:"end",dir:"desc"}]).toArray();var eventsByResource=[];this._eventsByResource(events,this.groupedResources,eventsByResource);var eventsPerDate=$.map(this._dates,function(date){return Math.max.apply(null,$.map(eventsByResource,function(events){return $.grep(events,function(event){return event.isMultiDay()&&isInDateRange(date,getDate(event.start),getDate(event.end))}).length}))}),height=Math.max.apply(null,eventsPerDate);this._updateAllDayHeaderHeight((height+1)*this._allDayHeaderHeight);for(var groupIndex=0;groupIndex<eventsByResource.length;groupIndex++)this._renderEvents(eventsByResource[groupIndex],groupIndex);this.refreshLayout(),this.trigger("activate")},_eventsByResource:function(events,resources,result){var resource=resources[0];if(resource)for(var view=resource.dataSource.view(),itemIdx=0;itemIdx<view.length;itemIdx++){var value=this._resourceValue(resource,view[itemIdx]),eventsFilteredByResource=new kendo.data.Query(events).filter({field:resource.field,operator:SchedulerView.groupEqFilter(value)}).toArray();resources.length>1?this._eventsByResource(eventsFilteredByResource,resources.slice(1),result):result.push(eventsFilteredByResource)}else result.push(events)},_columnOffsetForResource:function(index){return this._columnCountForLevel(index)/this._columnCountForLevel(index-1)},_columnCountForLevel:function(level){var columnLevel=this.columnLevels[level];return columnLevel?columnLevel.length:0},_rowCountForLevel:function(level){var rowLevel=this.rowLevels[level];return rowLevel?rowLevel.length:0},clearSelection:function(){this.content.add(this.datesHeader).find(".k-state-selected").removeAttr("id").attr("aria-selected",!1).removeClass("k-state-selected")},_updateDirection:function(selection,ranges,multiple,reverse,vertical){var isDaySlot=selection.isAllDay,startSlot=ranges[0].start,endSlot=ranges[ranges.length-1].end;multiple&&(vertical?isDaySlot||startSlot.index!==endSlot.index||startSlot.collectionIndex!==endSlot.collectionIndex||(selection.backward=reverse):(isDaySlot&&startSlot.index===endSlot.index||!isDaySlot&&startSlot.collectionIndex===endSlot.collectionIndex)&&(selection.backward=reverse))},_changeViewPeriod:function(selection,reverse,vertical){if(!vertical){var date=reverse?this.previousDate():this.nextDate(),start=selection.start,end=selection.end;selection.start=new Date(date),selection.end=new Date(date);var endMilliseconds=selection.isAllDay?MS_PER_DAY:getMilliseconds(end);return setTime(selection.start,getMilliseconds(start)),setTime(selection.end,endMilliseconds),this._isVerticallyGrouped()||(selection.groupIndex=reverse?this.groups.length-1:0),selection.events=[],!0}}});extend(!0,ui,{MultiDayView:MultiDayView,DayView:MultiDayView.extend({options:{title:"Day"},name:"day"}),WeekView:MultiDayView.extend({options:{title:"Week",selectedDateFormat:"{0:D} - {1:D}"},name:"week",calculateDateRange:function(){var idx,length,selectedDate=this.options.date,start=kendo.date.dayOfWeek(selectedDate,this.calendarInfo().firstDay,-1),dates=[];for(idx=0,length=7;idx<length;idx++)dates.push(start),start=kendo.date.nextDay(start);this._render(dates)}}),WorkWeekView:MultiDayView.extend({options:{title:"Work Week",selectedDateFormat:"{0:D} - {1:D}"},name:"workweek",nextDate:function(){return kendo.date.dayOfWeek(kendo.date.nextDay(this.endDate()),this.options.workWeekStart,1)},previousDate:function(){return kendo.date.previousDay(this.startDate())},calculateDateRange:function(){for(var selectedDate=this.options.date,start=kendo.date.dayOfWeek(selectedDate,this.options.workWeekStart,-1),end=kendo.date.dayOfWeek(start,this.options.workWeekEnd,1),dates=[];start<=end;)dates.push(start),start=kendo.date.nextDay(start);this._render(dates)}})})}(window.kendo.jQuery),function($){function rowSpan(tasks){for(var result=0,idx=0,length=tasks.length;idx<length;idx++)result+=tasks[idx].items.length;return result}function resourceValue(resource,item){return resource.valuePrimitive&&(item=kendo.getter(resource.dataValueField)(item)),item}function flattenTaskGroups(groups){for(var item,idx=0,length=groups.length,result=[];idx<length;idx++)item=groups[idx],item.groups?(item=flattenGroup(item.groups),result=result.concat(item)):result=result.concat(flattenGroup(item.items));return result}function flattenGroup(groups){for(var items=[].concat(groups),item=items.shift(),result=[],push=[].push;item;)item.groups?push.apply(items,item.groups):item.items?push.apply(items,item.items):push.call(result,item),item=items.shift();return result}var kendo=window.kendo,ui=kendo.ui,NS=".kendoAgendaView";ui.AgendaView=ui.SchedulerView.extend({init:function(element,options){ui.SchedulerView.fn.init.call(this,element,options),options=this.options,options.editable&&(options.editable=$.extend({"delete":!0},options.editable,{create:!1,update:!1})),this.title=options.title,this.name="agenda",this._eventTemplate=kendo.template(options.eventTemplate),this._dateTemplate=kendo.template(options.eventDateTemplate),this._groupTemplate=kendo.template(options.eventGroupTemplate),this._timeTemplate=kendo.template(options.eventTimeTemplate),this.element.on("mouseenter"+NS,".k-scheduler-agenda .k-scheduler-content tr","_mouseenter").on("mouseleave"+NS,".k-scheduler-agenda .k-scheduler-content tr","_mouseleave").on("click"+NS,".k-scheduler-agenda .k-scheduler-content .k-link:has(.k-si-close)","_remove"),this._renderLayout(options.date)},_mouseenter:function(e){$(e.currentTarget).addClass("k-state-hover")},_mouseleave:function(e){$(e.currentTarget).removeClass("k-state-hover")},_remove:function(e){e.preventDefault(),this.trigger("remove",{uid:$(e.currentTarget).closest(".k-task").attr(kendo.attr("uid"))})},nextDate:function(){return kendo.date.nextDay(this.startDate())},startDate:function(){return this._startDate},endDate:function(){return this._endDate},previousDate:function(){return kendo.date.previousDay(this.startDate())},_renderLayout:function(date){this._startDate=date,this._endDate=kendo.date.addDays(date,7),this.createLayout(this._layout()),this.table.addClass("k-scheduler-agenda")},_layout:function(){var columns=[{text:this.options.messages.time,className:"k-scheduler-timecolumn"},{text:this.options.messages.event}];this._isMobilePhoneView()||columns.splice(0,0,{text:this.options.messages.date,className:"k-scheduler-datecolumn"});var resources=this.groupedResources;if(resources.length){for(var groupHeaders=[],idx=0;idx<resources.length;idx++)groupHeaders.push({text:"",className:"k-scheduler-groupcolumn"});columns=groupHeaders.concat(columns)}return{columns:columns}},_tasks:function(events){for(var tasks=[],idx=0;idx<events.length;idx++){var event=events[idx],start=event.start,end=event.end,eventDurationInDays=(kendo.date.getDate(end)-kendo.date.getDate(start))/kendo.date.MS_PER_DAY+1,task=event.clone();if(task.startDate=kendo.date.getDate(start),task.startDate>=this.startDate()&&tasks.push(task),eventDurationInDays>1){task.end=kendo.date.nextDay(start),task.head=!0;for(var day=1;day<eventDurationInDays;day++)start=task.end,task=event.clone(),task.start=start,task.startDate=kendo.date.getDate(start),task.end=kendo.date.nextDay(start),day==eventDurationInDays-1?(task.end=new Date(task.start.getFullYear(),task.start.getMonth(),task.start.getDate(),end.getHours(),end.getMinutes(),end.getSeconds(),end.getMilliseconds()),task.tail=!0):(task.isAllDay=!0,task.middle=!0),task.end<=this.endDate()&&task.start>=this.startDate()&&tasks.push(task)}}return new kendo.data.Query(tasks).sort([{field:"start",dir:"asc"},{field:"end",dir:"asc"}]).groupBy({field:"startDate"}).toArray()},_renderTaskGroups:function(tasksGroups,groups){for(var tableRows=[],editable=this.options.editable,showDelete=editable&&editable.destroy!==!1&&!this._isMobile(),isPhoneView=this._isMobilePhoneView(),taskGroupIndex=0;taskGroupIndex<tasksGroups.length;taskGroupIndex++)for(var date=tasksGroups[taskGroupIndex].value,tasks=tasksGroups[taskGroupIndex].items,today=kendo.date.isToday(date),taskIndex=0;taskIndex<tasks.length;taskIndex++){var task=tasks[taskIndex],tableRow=[],headerCells=isPhoneView?[]:tableRow;if(0===taskGroupIndex&&0===taskIndex&&groups.length)for(var idx=0;idx<groups.length;idx++)headerCells.push(kendo.format('<td class="k-scheduler-groupcolumn{2}" rowspan="{0}">{1}</td>',groups[idx].rowSpan,this._groupTemplate({value:groups[idx].text}),groups[idx].className));0===taskIndex&&(isPhoneView?(headerCells.push(kendo.format('<td class="k-scheduler-datecolumn" colspan="2">{0}</td>',this._dateTemplate({date:date}))),tableRows.push('<tr role="row" aria-selected="false"'+(today?' class="k-today">':">")+headerCells.join("")+"</tr>")):tableRow.push(kendo.format('<td class="k-scheduler-datecolumn{3}{2}" rowspan="{0}">{1}</td>',tasks.length,this._dateTemplate({date:date}),taskGroupIndex!=tasksGroups.length-1||groups.length?"":" k-last",groups.length?"":" k-first"))),task.head?task.format="{0:t}":task.tail?task.format="{1:t}":task.format="{0:t}-{1:t}",task.resources=this.eventResources(task),tableRow.push(kendo.format('<td class="k-scheduler-timecolumn"><div>{0}{1}{2}</div></td><td>{3}</td>',task.tail||task.middle?'<span class="k-icon k-i-arrow-w"></span>':"",this._timeTemplate(task.clone({start:task.startTime||task.start,end:task.endTime||task.end})),task.head||task.middle?'<span class="k-icon k-i-arrow-e"></span>':"",this._eventTemplate(task.clone({showDelete:showDelete})))),tableRows.push('<tr role="row" aria-selected="false"'+(today?' class="k-today">':">")+tableRow.join("")+"</tr>")}return tableRows.join("")},render:function(events){var table=this.content.find("table").empty(),groups=[];if(events.length>0){var resources=this.groupedResources;resources.length?(groups=this._createGroupConfiguration(events,resources,null),this._renderGroups(groups,table,[])):(groups=this._tasks(events),table.append(this._renderTaskGroups(groups,[])))}this._eventsList=flattenTaskGroups(groups),this.refreshLayout(),this.trigger("activate")},_renderGroups:function(groups,table,parentGroups){for(var idx=0,length=groups.length;idx<length;idx++){var parents=parentGroups.splice(0);parents.push(groups[idx]),groups[idx].groups?this._renderGroups(groups[idx].groups,table,parents):table.append(this._renderTaskGroups(groups[idx].items,parents))}},_createGroupConfiguration:function(events,resources,parent){for(var resource=resources[0],configuration=[],data=resource.dataSource.view(),isPhoneView=this._isMobilePhoneView(),dataIndex=0;dataIndex<data.length;dataIndex++){var value=resourceValue(resource,data[dataIndex]),tmp=new kendo.data.Query(events).filter({field:resource.field,operator:ui.SchedulerView.groupEqFilter(value)}).toArray();if(tmp.length){var tasks=this._tasks(tmp),className=parent?"":" k-first";dataIndex===data.length-1&&(!parent||parent.className.indexOf("k-last")>-1)&&(className+=" k-last");var obj={text:kendo.getter(resource.dataTextField)(data[dataIndex]),value:value,rowSpan:0,className:className};if(resources.length>1)obj.groups=this._createGroupConfiguration(tmp,resources.slice(1),obj),parent&&(parent.rowSpan+=obj.rowSpan);else{obj.items=tasks;var span=rowSpan(obj.items);isPhoneView&&(span+=obj.items.length),obj.rowSpan=span,parent&&(parent.rowSpan+=span)}configuration.push(obj)}}return configuration},selectionByElement:function(cell){var index,event;if(cell=$(cell),!cell.hasClass("k-scheduler-datecolumn")){if(this._isMobile()){var parent=cell.parent();index=parent.parent().children().filter(function(){return $(this).children(":not(.k-scheduler-datecolumn)").length}).index(parent)}else index=cell.parent().index();return event=this._eventsList[index],{index:index,start:event.start,end:event.end,isAllDay:event.isAllDay,uid:event.uid}}},select:function(selection){this.clearSelection();var row=this.table.find(".k-task").eq(selection.index).closest("tr").addClass("k-state-selected").attr("aria-selected",!0)[0];this.current(row)},move:function(selection,key){var handled=!1,index=selection.index;if(key==kendo.keys.UP?(index--,handled=!0):key==kendo.keys.DOWN&&(index++,handled=!0),handled){var event=this._eventsList[index];event&&(selection.start=event.start,selection.end=event.end,selection.isAllDay=event.isAllDay,selection.events=[event.uid],selection.index=index)}return handled},moveToEvent:function(){return!1},constrainSelection:function(selection){var event=this._eventsList[0];event&&(selection.start=event.start,selection.end=event.end,selection.isAllDay=event.isAllDay,selection.events=[event.uid],selection.index=0)},isInRange:function(){return!0},destroy:function(){this.element&&this.element.off(NS),ui.SchedulerView.fn.destroy.call(this)},options:{title:"Agenda",name:"agenda",editable:!0,selectedDateFormat:"{0:D}-{1:D}",eventTemplate:'<div class="k-task" title="#:title.replace(/"/g,"\'")#" data-#=kendo.ns#uid="#=uid#"># if (resources[0]) {#<span class="k-scheduler-mark" style="background-color:#=resources[0].color#"></span># } ## if (data.isException()) { #<span class="k-icon k-i-exception"></span># } else if (data.isRecurring()) {#<span class="k-icon k-i-refresh"></span># } ##:title##if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"></span></a>#}#</div>',eventTimeTemplate:"#if(data.isAllDay) {##=this.options.messages.allDay##} else { ##=kendo.format(format, start, end)## } #",eventDateTemplate:'<strong class="k-scheduler-agendaday">#=kendo.toString(date, "dd")#</strong><em class="k-scheduler-agendaweek">#=kendo.toString(date,"dddd")#</em><span class="k-scheduler-agendadate">#=kendo.toString(date, "y")#</span>',eventGroupTemplate:'<strong class="k-scheduler-adgendagroup">#=value#</strong>',messages:{event:"Event",date:"Date",time:"Time",allDay:"all day"}}})}(window.kendo.jQuery),function($){function shiftArray(array,idx){return array.slice(idx).concat(array.slice(0,idx))}function firstVisibleMonthDay(date,calendarInfo){for(var firstDay=calendarInfo.firstDay,firstVisibleDay=new Date(date.getFullYear(),date.getMonth(),0,date.getHours(),date.getMinutes(),date.getSeconds(),date.getMilliseconds());firstVisibleDay.getDay()!=firstDay;)kendo.date.setTime(firstVisibleDay,-1*MS_PER_DAY);return firstVisibleDay}function isInDateRange(value,min,max){var msValue,msMin=min,msMax=max;return msValue=value,msValue>=msMin&&msValue<=msMax}var kendo=window.kendo,ui=kendo.ui,SchedulerView=ui.SchedulerView,NS=".kendoMonthView",extend=$.extend,proxy=$.proxy,getDate=kendo.date.getDate,MS_PER_DAY=kendo.date.MS_PER_DAY,NUMBER_OF_ROWS=6,NUMBER_OF_COLUMNS=7,DAY_TEMPLATE=kendo.template('<span class="k-link k-nav-day">#:kendo.toString(date, "dd")#</span>'),EVENT_WRAPPER_STRING='<div role="gridcell" aria-selected="false" data-#=ns#uid="#=uid#"#if (resources[0]) { #style="background-color:#=resources[0].color #; border-color: #=resources[0].color#"class="k-event#=inverseColor ? " k-event-inverse" : ""#"#} else {#class="k-event"#}#><span class="k-event-actions"># if(data.tail || data.middle) {#<span class="k-icon k-i-arrow-w"></span>#}## if(data.isException()) {#<span class="k-icon k-i-exception"></span># } else if(data.isRecurring()) {#<span class="k-icon k-i-refresh"></span>#}#</span>{0}<span class="k-event-actions">#if (showDelete) {#<a href="\\#" class="k-link k-event-delete"><span class="k-icon k-si-close"></span></a>#}## if(data.head || data.middle) {#<span class="k-icon k-i-arrow-e"></span>#}#</span># if(resizable && !data.tail && !data.middle) {#<span class="k-resize-handle k-resize-w"></span>#}## if(resizable && !data.head && !data.middle) {#<span class="k-resize-handle k-resize-e"></span>#}#</div>',EVENT_TEMPLATE=kendo.template('<div title="#=title.replace(/"/g,"&\\#34;")#"><div class="k-event-template">#:title#</div></div>'),MORE_BUTTON_TEMPLATE=kendo.template('<div style="width:#=width#px;left:#=left#px;top:#=top#px" class="k-more-events k-button"><span>...</span></div>');ui.MonthView=SchedulerView.extend({init:function(element,options){var that=this;SchedulerView.fn.init.call(that,element,options),that.title=that.options.title,that.name="month",that._templates(),that._editable(),that._renderLayout(that.options.date),that._groups()},_updateDirection:function(selection,ranges,multiple,reverse,vertical){if(multiple){var updateDirection,startSlot=ranges[0].start,endSlot=ranges[ranges.length-1].end,isSameSlot=startSlot.index===endSlot.index,isSameCollection=startSlot.collectionIndex===endSlot.collectionIndex;updateDirection=vertical?isSameSlot&&isSameCollection||isSameCollection:isSameSlot&&isSameCollection,updateDirection&&(selection.backward=reverse)}},_changeViewPeriod:function(selection,reverse,vertical){var pad=vertical?7:1;return reverse&&(pad*=-1),selection.start=kendo.date.addDays(selection.start,pad),selection.end=kendo.date.addDays(selection.end,pad),(!vertical||vertical&&this._isVerticallyGrouped())&&(selection.groupIndex=reverse?this.groups.length-1:0),selection.events=[],!0},_continuousSlot:function(selection,ranges,reverse){var index=selection.backward?0:ranges.length-1,group=this.groups[selection.groupIndex];return group.continuousSlot(ranges[index].start,reverse)},_changeGroupContinuously:function(selection,continuousSlot,multiple,reverse){if(!multiple){var groupIndex=selection.groupIndex,lastGroupIndex=this.groups.length-1,vertical=this._isVerticallyGrouped(),group=this.groups[groupIndex];!continuousSlot&&vertical?(continuousSlot=group[reverse?"lastSlot":"firstSlot"](),groupIndex+=reverse?-1:1):continuousSlot&&!vertical&&(groupIndex=reverse?lastGroupIndex:0),(groupIndex<0||groupIndex>lastGroupIndex)&&(groupIndex=reverse?lastGroupIndex:0,continuousSlot=null),selection.groupIndex=groupIndex}return continuousSlot},_normalizeHorizontalSelection:function(selection,ranges,reverse){var slot;return slot=reverse?ranges[0].start:ranges[ranges.length-1].end},_normalizeVerticalSelection:function(selection,ranges){var slot;return slot=selection.backward?ranges[0].start:ranges[ranges.length-1].end},_templates:function(){var options=this.options,settings=extend({},kendo.Template,options.templateSettings);this.eventTemplate=this._eventTmpl(options.eventTemplate),this.dayTemplate=kendo.template(options.dayTemplate,settings)},dateForTitle:function(){return kendo.format(this.options.selectedDateFormat,this._firstDayOfMonth,this._lastDayOfMonth)},nextDate:function(){return kendo.date.nextDay(this._lastDayOfMonth)},previousDate:function(){return kendo.date.previousDay(this._firstDayOfMonth)},startDate:function(){return this._startDate},endDate:function(){return this._endDate},_renderLayout:function(date){var that=this;this._firstDayOfMonth=kendo.date.firstDayOfMonth(date),this._lastDayOfMonth=kendo.date.lastDayOfMonth(date),this._startDate=firstVisibleMonthDay(date,this.calendarInfo()),this.createLayout(this._layout()),this._content(),this.refreshLayout(),this.content.on("click"+NS,".k-nav-day,.k-more-events",function(e){var offset=$(e.currentTarget).offset(),slot=that._slotByPosition(offset.left,offset.top);e.preventDefault(),that.trigger("navigate",{view:"day",date:slot.startDate()})})},_editable:function(){this.options.editable&&!this._isMobilePhoneView()&&(this._isMobile()?this._touchEditable():this._mouseEditable())},_mouseEditable:function(){var that=this;that.element.on("click"+NS,".k-scheduler-monthview .k-event a:has(.k-si-close)",function(e){that.trigger("remove",{uid:$(this).closest(".k-event").attr(kendo.attr("uid"))}),e.preventDefault()}),that.options.editable.create!==!1&&that.element.on("dblclick"+NS,".k-scheduler-monthview .k-scheduler-content td",function(e){var offset=$(e.currentTarget).offset(),slot=that._slotByPosition(offset.left,offset.top);if(slot){var resourceInfo=that._resourceBySlot(slot);that.trigger("add",{eventInfo:extend({isAllDay:!0,start:slot.startDate(),end:slot.startDate()},resourceInfo)})}e.preventDefault()}),that.options.editable.update!==!1&&that.element.on("dblclick"+NS,".k-scheduler-monthview .k-event",function(e){that.trigger("edit",{uid:$(this).closest(".k-event").attr(kendo.attr("uid"))}),e.preventDefault()})},_touchEditable:function(){var that=this;that.options.editable.create!==!1&&(that._addUserEvents=new kendo.UserEvents(that.element,{filter:".k-scheduler-monthview .k-scheduler-content td",tap:function(e){var offset=$(e.target).offset(),slot=that._slotByPosition(offset.left,offset.top);if(slot){var resourceInfo=that._resourceBySlot(slot);that.trigger("add",{eventInfo:extend({isAllDay:!0,start:slot.startDate(),end:slot.startDate()},resourceInfo)})}e.preventDefault()}})),that.options.editable.update!==!1&&(that._editUserEvents=new kendo.UserEvents(that.element,{filter:".k-scheduler-monthview .k-event",tap:function(e){0===$(e.event.target).closest("a:has(.k-si-close)").length&&(that.trigger("edit",{uid:$(e.target).closest(".k-event").attr(kendo.attr("uid"))}),e.preventDefault())}}))},selectionByElement:function(cell){var offset=$(cell).offset();return this._slotByPosition(offset.left,offset.top)},_columnCountForLevel:function(level){var columnLevel=this.columnLevels[level];return columnLevel?columnLevel.length:0},_rowCountForLevel:function(level){var rowLevel=this.rowLevels[level];return rowLevel?rowLevel.length:0},_content:function(){var html="<tbody>",verticalGroupCount=1,resources=this.groupedResources;resources.length&&this._isVerticallyGrouped()&&(verticalGroupCount=this._rowCountForLevel(resources.length-1));for(var verticalGroupIdx=0;verticalGroupIdx<verticalGroupCount;verticalGroupIdx++)html+=this._createCalendar(verticalGroupIdx);html+="</tbody>",this.content.find("table").html(html)},_createCalendar:function(verticalGroupIndex){var start=this.startDate(),cellCount=NUMBER_OF_COLUMNS*NUMBER_OF_ROWS,cellsPerRow=NUMBER_OF_COLUMNS,weekStartDates=[start],html="",horizontalGroupCount=1,isVerticallyGrouped=this._isVerticallyGrouped(),resources=this.groupedResources;resources.length&&(isVerticallyGrouped||(horizontalGroupCount=this._columnCountForLevel(resources.length-1))),this._slotIndices={};for(var rowIdx=0,length=cellCount/cellsPerRow;rowIdx<length;rowIdx++){html+="<tr>",weekStartDates.push(start);for(var startIdx=rowIdx*cellsPerRow,groupIdx=0;groupIdx<horizontalGroupCount;groupIdx++)html+=this._createRow(start,startIdx,cellsPerRow,isVerticallyGrouped?verticalGroupIndex:groupIdx);start=kendo.date.addDays(start,cellsPerRow),html+="</tr>"}return this._weekStartDates=weekStartDates,this._endDate=kendo.date.previousDay(start),html},_createRow:function(startDate,startIdx,cellsPerRow,groupIndex){for(var that=this,min=that._firstDayOfMonth,max=that._lastDayOfMonth,content=that.dayTemplate,classes="",html="",resources=function(){return that._resourceBySlot({groupIndex:groupIndex})},cellIdx=0;cellIdx<cellsPerRow;cellIdx++)classes="",kendo.date.isToday(startDate)&&(classes+="k-today"),kendo.date.isInDateRange(startDate,min,max)||(classes+=" k-other-month"),html+="<td ",""!==classes&&(html+='class="'+classes+'"'),html+=">",html+=content({date:startDate,resources:resources}),html+="</td>",that._slotIndices[getDate(startDate).getTime()]=startIdx+cellIdx,startDate=kendo.date.nextDay(startDate);return html},_layout:function(){var rows,calendarInfo=this.calendarInfo(),weekDayNames=this._isMobile()?calendarInfo.days.namesShort:calendarInfo.days.names,names=shiftArray(weekDayNames,calendarInfo.firstDay),columns=$.map(names,function(value){return{text:value}}),resources=this.groupedResources;if(resources.length)if(this._isVerticallyGrouped()){for(var inner=[],idx=0;idx<6;idx++)inner.push({text:"<div>&nbsp;</div>",className:"k-hidden k-slot-cell"});rows=this._createRowsLayout(resources,inner)}else columns=this._createColumnsLayout(resources,columns);return{columns:columns,rows:rows}},_eventTmpl:function(template){var options=this.options,settings=extend({},kendo.Template,options.templateSettings),paramName=settings.paramName,html="",type=typeof template,state={storage:{},count:0};"function"===type?(state.storage["tmpl"+state.count]=template,html+="#=this.tmpl"+state.count+"("+paramName+")#",state.count++):"string"===type&&(html+=template);var tmpl=kendo.template(kendo.format(EVENT_WRAPPER_STRING,html),settings);return state.count>0&&(tmpl=proxy(tmpl,state.storage)),tmpl},_createEventElement:function(event){var options=this.options,editable=options.editable,isMobile=this._isMobile();return event.showDelete=editable&&editable.destroy!==!1&&!isMobile,event.resizable=editable&&editable.resize!==!1&&!isMobile,event.ns=kendo.ns,event.resources=this.eventResources(event),event.inverseColor=!(!event.resources||!event.resources[0])&&this._shouldInverseResourceColor(event.resources[0]),$(this.eventTemplate(event))},_isInDateSlot:function(event){var groups=this.groups[0],slotStart=groups.firstSlot().start,slotEnd=groups.lastSlot().end-1,startTime=kendo.date.toUtcTime(event.start),endTime=kendo.date.toUtcTime(event.end);return(isInDateRange(startTime,slotStart,slotEnd)||isInDateRange(endTime,slotStart,slotEnd)||isInDateRange(slotStart,startTime,endTime)||isInDateRange(slotEnd,startTime,endTime))&&(!isInDateRange(endTime,slotStart,slotStart)||isInDateRange(endTime,startTime,startTime)||event.isAllDay)},_slotIndex:function(date){return this._slotIndices[getDate(date).getTime()]},_positionMobileEvent:function(slotRange,element,group){var startSlot=slotRange.start;slotRange.start.offsetLeft>slotRange.end.offsetLeft&&(startSlot=slotRange.end);var startIndex=slotRange.start.index,endIndex=startIndex,eventCount=3,events=SchedulerView.collidingEvents(slotRange.events(),startIndex,endIndex);events.push({element:element,start:startIndex,end:endIndex});var rows=SchedulerView.createRows(events),slot=slotRange.collection.at(startIndex),container=slot.container;container||(container=$(kendo.format('<div class="k-events-container" style="top:{0};left:{1};width:{2}"/>',startSlot.offsetTop+startSlot.firstChildTop+startSlot.firstChildHeight-3+"px",startSlot.offsetLeft+"px",startSlot.offsetWidth+"px")),slot.container=container,this.content[0].appendChild(container[0])),rows.length<=eventCount&&(slotRange.addEvent({element:element,start:startIndex,end:endIndex,groupIndex:startSlot.groupIndex}),group._continuousEvents.push({element:element,uid:element.attr(kendo.attr("uid")),start:slotRange.start,end:slotRange.end}),container[0].appendChild(element[0]))},_positionEvent:function(slotRange,element,group){var eventHeight=this.options.eventHeight,startSlot=slotRange.start;slotRange.start.offsetLeft>slotRange.end.offsetLeft&&(startSlot=slotRange.end);var startIndex=slotRange.start.index,endIndex=slotRange.end.index,eventCount=startSlot.eventCount,events=SchedulerView.collidingEvents(slotRange.events(),startIndex,endIndex),rightOffset=startIndex!==endIndex?5:4;events.push({element:element,start:startIndex,end:endIndex});for(var rows=SchedulerView.createRows(events),idx=0,length=Math.min(rows.length,eventCount);idx<length;idx++)for(var rowEvents=rows[idx].events,eventTop=startSlot.offsetTop+startSlot.firstChildHeight+idx*eventHeight+3*idx+"px",j=0,eventLength=rowEvents.length;j<eventLength;j++)rowEvents[j].element[0].style.top=eventTop;if(rows.length>eventCount)for(var slotIndex=startIndex;slotIndex<=endIndex;slotIndex++){var collection=slotRange.collection,slot=collection.at(slotIndex);if(slot.more)return;slot.more=$(MORE_BUTTON_TEMPLATE({ns:kendo.ns,start:slotIndex,end:slotIndex,width:slot.clientWidth-2,left:slot.offsetLeft+2,top:slot.offsetTop+slot.firstChildHeight+eventCount*eventHeight+3*eventCount})),this.content[0].appendChild(slot.more[0])}else slotRange.addEvent({element:element,start:startIndex,end:endIndex,
groupIndex:startSlot.groupIndex}),element[0].style.width=slotRange.innerWidth()-rightOffset+"px",element[0].style.left=startSlot.offsetLeft+2+"px",element[0].style.height=eventHeight+"px",group._continuousEvents.push({element:element,uid:element.attr(kendo.attr("uid")),start:slotRange.start,end:slotRange.end}),this.content[0].appendChild(element[0])},_slotByPosition:function(x,y){var offset=this.content.offset();x-=offset.left,y-=offset.top,y+=this.content[0].scrollTop,x+=this.content[0].scrollLeft,x=Math.ceil(x),y=Math.ceil(y);for(var groupIndex=0;groupIndex<this.groups.length;groupIndex++){var slot=this.groups[groupIndex].daySlotByPosition(x,y);if(slot)return slot}return null},_createResizeHint:function(range){var left=range.startSlot().offsetLeft,top=range.start.offsetTop,width=range.innerWidth(),height=range.start.clientHeight-2,hint=SchedulerView.fn._createResizeHint.call(this,left,top,width,height);hint.appendTo(this.content),this._resizeHint=this._resizeHint.add(hint)},_updateResizeHint:function(event,groupIndex,startTime,endTime){this._removeResizeHint();for(var group=this.groups[groupIndex],ranges=group.ranges(startTime,endTime,!0,event.isAllDay),rangeIndex=0;rangeIndex<ranges.length;rangeIndex++)this._createResizeHint(ranges[rangeIndex]);this._resizeHint.find(".k-label-top,.k-label-bottom").text(""),this._resizeHint.first().addClass("k-first").find(".k-label-top").text(kendo.toString(kendo.timezone.toLocalDate(startTime),"M/dd")),this._resizeHint.last().addClass("k-last").find(".k-label-bottom").text(kendo.toString(kendo.timezone.toLocalDate(endTime),"M/dd"))},_updateMoveHint:function(event,groupIndex,distance){var start=kendo.date.toUtcTime(event.start)+distance,end=start+event.duration(),group=this.groups[groupIndex],ranges=group.ranges(start,end,!0,event.isAllDay);this._removeMoveHint();for(var rangeIndex=0;rangeIndex<ranges.length;rangeIndex++){var range=ranges[rangeIndex],startSlot=range.startSlot(),endSlot=range.endSlot(),hint=this._createEventElement(event.clone({head:range.head,tail:range.tail}));hint.css({left:startSlot.offsetLeft+2,top:startSlot.offsetTop+startSlot.firstChildHeight,height:this.options.eventHeight,width:range.innerWidth()-(startSlot.index!==endSlot.index?5:4)}),hint.addClass("k-event-drag-hint"),hint.appendTo(this.content),this._moveHint=this._moveHint.add(hint)}},_groups:function(){var groupCount=this._groupCount(),columnCount=NUMBER_OF_COLUMNS,rowCount=NUMBER_OF_ROWS;this.groups=[];for(var idx=0;idx<groupCount;idx++)this._addResourceView(idx);for(var tableRows=this.content[0].getElementsByTagName("tr"),groupIndex=0;groupIndex<groupCount;groupIndex++){var cellCount=0,rowMultiplier=0;this._isVerticallyGrouped()&&(rowMultiplier=groupIndex);for(var rowIndex=rowMultiplier*rowCount;rowIndex<(rowMultiplier+1)*rowCount;rowIndex++){var group=this.groups[groupIndex],collection=group.addDaySlotCollection(kendo.date.addDays(this.startDate(),cellCount),kendo.date.addDays(this.startDate(),cellCount+columnCount)),tableRow=tableRows[rowIndex],cells=tableRow.children,cellMultiplier=0;tableRow.setAttribute("role","row"),this._isVerticallyGrouped()||(cellMultiplier=groupIndex);for(var cellIndex=cellMultiplier*columnCount;cellIndex<(cellMultiplier+1)*columnCount;cellIndex++){var cell=cells[cellIndex],clientHeight=cell.clientHeight,firstChildHeight=cell.children.length?cell.children[0].offsetHeight+3:0,start=kendo.date.toUtcTime(kendo.date.addDays(this.startDate(),cellCount));cellCount++;var eventCount=Math.floor((clientHeight-firstChildHeight-this.options.moreButtonHeight)/(this.options.eventHeight+3));cell.setAttribute("role","gridcell"),cell.setAttribute("aria-selected",!1),collection.addDaySlot(cell,start,start+kendo.date.MS_PER_DAY,eventCount)}}}},render:function(events){this.content.children(".k-event,.k-more-events,.k-events-container").remove(),this._groups(),events=new kendo.data.Query(events).sort([{field:"start",dir:"asc"},{field:"end",dir:"desc"}]).toArray();var resources=this.groupedResources;resources.length?this._renderGroups(events,resources,0,1):this._renderEvents(events,0),this.refreshLayout(),this.trigger("activate")},_renderEvents:function(events,groupIndex){var event,idx,length,isMobilePhoneView=this._isMobilePhoneView();for(idx=0,length=events.length;idx<length;idx++)if(event=events[idx],this._isInDateSlot(event)){var group=this.groups[groupIndex];group._continuousEvents||(group._continuousEvents=[]);for(var ranges=group.slotRanges(event,!0),rangeCount=ranges.length,rangeIndex=0;rangeIndex<rangeCount;rangeIndex++){var range=ranges[rangeIndex],start=event.start,end=event.end;rangeCount>1&&(0===rangeIndex?end=range.end.endDate():rangeIndex==rangeCount-1?start=range.start.startDate():(start=range.start.startDate(),end=range.end.endDate()));var occurrence=event.clone({start:start,end:end,head:range.head,tail:range.tail});isMobilePhoneView?this._positionMobileEvent(range,this._createEventElement(occurrence),group):this._positionEvent(range,this._createEventElement(occurrence),group)}}},_renderGroups:function(events,resources,offset,columnLevel){var resource=resources[0];if(resource)for(var view=resource.dataSource.view(),itemIdx=0;itemIdx<view.length;itemIdx++){var value=this._resourceValue(resource,view[itemIdx]),tmp=new kendo.data.Query(events).filter({field:resource.field,operator:SchedulerView.groupEqFilter(value)}).toArray();resources.length>1?offset=this._renderGroups(tmp,resources.slice(1),offset++,columnLevel+1):this._renderEvents(tmp,offset++)}return offset},_groupCount:function(){var resources=this.groupedResources;return resources.length?this._isVerticallyGrouped()?this._rowCountForLevel(resources.length-1):this._columnCountForLevel(resources.length)/this._columnOffsetForResource(resources.length):1},_columnOffsetForResource:function(index){return this._columnCountForLevel(index)/this._columnCountForLevel(index-1)},destroy:function(){this.table&&this.table.removeClass("k-scheduler-monthview"),this.content&&this.content.off(NS),this.element&&this.element.off(NS),SchedulerView.fn.destroy.call(this),this._isMobile()&&!this._isMobilePhoneView()&&this.options.editable&&(this.options.editable.create!==!1&&this._addUserEvents.destroy(),this.options.editable.update!==!1&&this._editUserEvents.destroy())},events:["remove","add","edit","navigate"],options:{title:"Month",name:"month",eventHeight:25,moreButtonHeight:13,editable:!0,selectedDateFormat:"{0:y}",dayTemplate:DAY_TEMPLATE,eventTemplate:EVENT_TEMPLATE}})}(window.kendo.jQuery),function($,undefined){function intervalExcess(diff,interval){var excess;return 0!==diff&&diff<interval?excess=interval-diff:(excess=diff%interval,excess&&(excess=interval-excess)),excess}function dayInYear(date){var month=date.getMonth(),days=leapYear(date)?DAYS_IN_LEAPYEAR[month]:DAYS_IN_YEAR[month];return days+date.getDate()}function weekInYear(date,weekStart){var year,days;return date=new Date(date.getFullYear(),date.getMonth(),date.getDate()),adjustDST(date,0),year=date.getFullYear(),weekStart!==undefined?(setDayOfWeek(date,weekStart,-1),date.setDate(date.getDate()+4)):date.setDate(date.getDate()+(4-(date.getDay()||7))),adjustDST(date,0),days=Math.floor((date.getTime()-new Date(year,0,1,(-6)))/864e5),1+Math.floor(days/7)}function weekInMonth(date,weekStart){var firstWeekDay=firstDayOfMonth(date).getDay(),firstWeekLength=7-(firstWeekDay+7-(weekStart||7))||7;return firstWeekLength<0&&(firstWeekLength+=7),Math.ceil((date.getDate()-firstWeekLength)/7)+1}function normalizeDayIndex(weekDay,weekStart){return weekDay+(weekDay<weekStart?7:0)}function normalizeOffset(date,rule,weekStart){var offset=rule.offset;if(!offset)return weekInMonth(date,weekStart);var lastDate=new Date(date.getFullYear(),date.getMonth()+1,0),weeksInMonth=weekInMonth(lastDate,weekStart),day=normalizeDayIndex(rule.day,weekStart),skipFirst=day<normalizeDayIndex(new Date(date.getFullYear(),date.getMonth(),1).getDay(),weekStart),skipLast=day>normalizeDayIndex(lastDate.getDay(),weekStart);return offset<0?offset=weeksInMonth+(offset+1-(skipLast?1:0)):skipFirst&&(offset+=1),weeksInMonth-=skipLast?1:0,offset<(skipFirst?1:0)||offset>weeksInMonth?null:offset}function numberOfWeeks(date,weekStart){return weekInMonth(new Date(date.getFullYear(),date.getMonth()+1,0),weekStart)}function isInWeek(date,rule,weekStart){return weekInMonth(date,weekStart)===normalizeOffset(date,rule,weekStart)}function ruleWeekValues(weekDays,date,weekStart){for(var ruleWeekOffset,weekDay,day,weekNumber,currentDay=normalizeDayIndex(date.getDay(),weekStart),length=weekDays.length,result=[],idx=0;idx<length;idx++)if(weekDay=weekDays[idx],weekNumber=weekInMonth(date,weekStart),ruleWeekOffset=normalizeOffset(date,weekDay,weekStart),null!==ruleWeekOffset)if(weekNumber<ruleWeekOffset)result.push(weekDay);else if(weekNumber===ruleWeekOffset)if(day=normalizeDayIndex(weekDay.day,weekStart),currentDay<day)result.push(weekDay);else if(currentDay===day)return null;return result}function ruleValues(rules,value,normalize){for(var ruleValue,idx=0,length=rules.length,availableRules=[];idx<length;idx++){if(ruleValue=rules[idx],normalize&&(ruleValue=normalize(ruleValue)),value===ruleValue)return null;value<ruleValue&&availableRules.push(ruleValue)}return availableRules}function parseArray(list,range){for(var value,idx=0,length=list.length;idx<length;idx++){if(value=parseInt(list[idx],10),isNaN(value)||value<range.start||value>range.end||0===value&&range.start<0)return null;list[idx]=value}return list.sort(numberSortPredicate)}function parseWeekDayList(list){for(var value,valueLength,day,idx=0,length=list.length;idx<length;idx++){if(value=list[idx],valueLength=value.length,day=value.substring(valueLength-2).toUpperCase(),day=WEEK_DAYS_IDX[day],day===undefined)return null;list[idx]={offset:parseInt(value.substring(0,valueLength-2),10)||0,day:day}}return list}function serializeWeekDayList(list){for(var value,valueString,idx=0,length=list.length,result=[];idx<length;idx++)value=list[idx],"string"==typeof value?valueString=value:(valueString=""+WEEK_DAYS[value.day],value.offset&&(valueString=value.offset+valueString)),result.push(valueString);return result.toString()}function getMonthLength(date){var month=date.getMonth();return 1===month?1===new Date(date.getFullYear(),1,29).getMonth()?29:28:MONTHS[month]}function leapYear(year){return year=year.getFullYear(),year%4===0&&year%100!==0||year%400===0}function numberSortPredicate(a,b){return a-b}function parseExceptions(exceptions,zone){var length,date,idx=0,dates=[];if(exceptions)for(exceptions=exceptions.split(";"),length=exceptions.length;idx<length;idx++)date=parseUTCDate(exceptions[idx],zone),date&&dates.push(date);return dates}function isException(exceptions,date,zone){for(var dates=$.isArray(exceptions)?exceptions:parseExceptions(exceptions,zone),dateTime=date.getTime()-date.getMilliseconds(),idx=0,length=dates.length;idx<length;idx++)if(dates[idx].getTime()===dateTime)return!0;return!1}function toExceptionString(dates,zone){var length,date,idx=0,result=[].concat(dates);for(length=result.length;idx<length;idx++)date=result[idx],date=kendo.timezone.convert(date,zone||date.getTimezoneOffset(),"Etc/UTC"),result[idx]=kendo.toString(date,RECURRENCE_DATE_FORMAT);return result.join(";")+";"}function startPeriodByFreq(start,rule){var date=new Date(start);switch(rule.freq){case"yearly":date.setFullYear(date.getFullYear(),0,1);break;case"monthly":date.setFullYear(date.getFullYear(),date.getMonth(),1);break;case"weekly":setDayOfWeek(date,rule.weekStart,-1)}return rule.hours&&date.setHours(0),rule.minutes&&date.setMinutes(0),rule.seconds&&date.setSeconds(0),date}function endPeriodByFreq(start,rule){var date=new Date(start);switch(rule.freq){case"yearly":date.setFullYear(date.getFullYear(),11,31);break;case"monthly":date.setFullYear(date.getFullYear(),date.getMonth()+1,0);break;case"weekly":setDayOfWeek(date,rule.weekStart,-1),date.setDate(date.getDate()+6)}return rule.hours&&date.setHours(23),rule.minutes&&date.setMinutes(59),rule.seconds&&date.setSeconds(59),date}function normalizeEventsByPosition(events,start,rule){for(var position,event,periodEvents=events.slice(rule._startIdx),periodEventsLength=periodEvents.length,positions=rule.positions,list=[],idx=0,length=positions.length;idx<length;idx++)position=positions[idx],position<0?position=periodEventsLength+position:position-=1,event=periodEvents[position],event&&event.start>=start&&list.push(event);return events=events.slice(0,rule._startIdx).concat(list),rule._startIdx=events.length,events}function expand(event,start,end,zone){var startTime,endTime,endDate,hours,minutes,seconds,durationMS,startPeriod,inPeriod,ruleStart,ruleEnd,useEventStart,freqName,exceptionDates,eventStartTime,eventStartMS,eventStart,count,freq,positions,current,rule=parseRule(event.recurrenceRule,zone),events=[];if(!rule)return[event];if(positions=rule.positions,current=positions?0:1,ruleStart=rule.start,ruleEnd=rule.end,(ruleStart||ruleEnd)&&(event=event.clone({start:ruleStart?new Date(ruleStart.value[0]):undefined,end:ruleEnd?new Date(ruleEnd.value[0]):undefined})),eventStart=event.start,eventStartMS=eventStart.getTime(),eventStartTime=getMilliseconds(eventStart),exceptionDates=parseExceptions(event.recurrenceException,zone),!exceptionDates[0]&&rule.exdates&&(exceptionDates=rule.exdates.value,event.set("recurrenceException",toExceptionString(exceptionDates,zone))),startPeriod=start=new Date(start),end=new Date(end),freqName=rule.freq,freq=frequencies[freqName],count=rule.count,rule.until&&rule.until<end&&(end=new Date(rule.until)),useEventStart="yearly"===freqName||"monthly"===freqName||"weekly"===freqName,start<eventStartMS||count||rule.interval>1||useEventStart?start=new Date(eventStartMS):(hours=start.getHours(),minutes=start.getMinutes(),seconds=start.getSeconds(),rule.hours||(hours=eventStart.getHours()),rule.minutes||(minutes=eventStart.getMinutes()),rule.seconds||(seconds=eventStart.getSeconds()),start.setHours(hours,minutes,seconds,eventStart.getMilliseconds())),rule._startPeriod=new Date(start),positions){start=startPeriodByFreq(start,rule),end=endPeriodByFreq(end,rule);var diff=getMilliseconds(end)-getMilliseconds(start);diff<0&&(hours=start.getHours(),end.setHours(hours,start.getMinutes(),start.getSeconds(),start.getMilliseconds()),kendoDate.adjustDST(end,hours)),rule._startPeriod=new Date(start),rule._endPeriod=endPeriodByFreq(start,rule),rule._startIdx=0}for(durationMS=event.duration(),rule._startTime=startTime=kendoDate.toInvariantTime(start),freq.setup&&freq.setup(rule,eventStart,start),freq.limit(start,end,rule);start<=end;)if(endDate=new Date(start),setTime(endDate,durationMS),inPeriod=start>=startPeriod||endDate>startPeriod,(inPeriod&&!isException(exceptionDates,start,zone)||positions)&&(startTime=kendoDate.toUtcTime(kendoDate.getDate(start))+getMilliseconds(rule._startTime),endTime=startTime+durationMS,eventStartMS!==start.getTime()||eventStartTime!==getMilliseconds(rule._startTime)?events.push(event.toOccurrence({start:new Date(start),end:endDate,startTime:startTime,endTime:endTime})):(event.startTime=startTime,event.endTime=endTime,events.push(event))),positions){if(freq.next(start,rule),freq.limit(start,end,rule),start>rule._endPeriod&&(events=normalizeEventsByPosition(events,eventStart,rule),rule._endPeriod=endPeriodByFreq(start,rule),current=events.length),count&&count===current)break}else{if(count&&count===current)break;current++,freq.next(start,rule),freq.limit(start,end,rule)}return events}function parseUTCDate(value,zone){return value=kendo.parseDate(value,DATE_FORMATS),value&&zone&&(value=timezone.convert(value,value.getTimezoneOffset(),zone)),value}function parseDateRule(dateRule,zone){for(var pair,property,value,tzid,valueIdx,valueLength,pairs=dateRule.split(";"),idx=0,length=pairs.length;idx<length;idx++)if(pair=pairs[idx].split(":"),property=pair[0],value=pair[1],property.indexOf("TZID")!==-1&&(tzid=property.substring(property.indexOf("TZID")).split("=")[1]),value)for(value=value.split(","),valueIdx=0,valueLength=value.length;valueIdx<valueLength;valueIdx++)value[valueIdx]=parseUTCDate(value[valueIdx],tzid||zone);if(value)return{value:value,tzid:tzid}}function parseRule(recur,zone){var splits,value,length,rule,part,parts,property,weekStart,weekDays,instance={},idx=0,ruleValue=!1,predicate=function(a,b){var day1=a.day,day2=b.day;return day1<weekStart&&(day1+=7),day2<weekStart&&(day2+=7),day1-day2};if(!recur)return null;for(parts=recur.split("\n"),parts[1]||recur.indexOf("DTSTART")===-1&&recur.indexOf("DTEND")===-1&&recur.indexOf("EXDATE")===-1||(parts=recur.split(" ")),idx=0,length=parts.length;idx<length;idx++)part=parts[idx],part.indexOf("DTSTART")!==-1?instance.start=parseDateRule(part,zone):part.indexOf("DTEND")!==-1?instance.end=parseDateRule(part,zone):part.indexOf("EXDATE")!==-1?instance.exdates=parseDateRule(part,zone):rule=part.indexOf("RRULE")!==-1?part.substring(6):part;for(rule=rule.split(";"),idx=0,length=rule.length;idx<length;idx++)switch(property=rule[idx],splits=property.split("="),value=$.trim(splits[1]).split(","),$.trim(splits[0]).toUpperCase()){case"FREQ":instance.freq=value[0].toLowerCase();break;case"UNTIL":instance.until=parseUTCDate(value[0],zone);break;case"COUNT":instance.count=parseInt(value[0],10);break;case"INTERVAL":instance.interval=parseInt(value[0],10);break;case"BYSECOND":instance.seconds=parseArray(value,{start:0,end:60}),ruleValue=!0;break;case"BYMINUTE":instance.minutes=parseArray(value,{start:0,end:59}),ruleValue=!0;break;case"BYHOUR":instance.hours=parseArray(value,{start:0,end:23}),ruleValue=!0;break;case"BYMONTHDAY":instance.monthDays=parseArray(value,{start:-31,end:31}),ruleValue=!0;break;case"BYYEARDAY":instance.yearDays=parseArray(value,{start:-366,end:366}),ruleValue=!0;break;case"BYMONTH":instance.months=parseArray(value,{start:1,end:12}),ruleValue=!0;break;case"BYDAY":instance.weekDays=weekDays=parseWeekDayList(value),ruleValue=!0;break;case"BYWEEKNO":instance.weeks=parseArray(value,{start:-53,end:53}),ruleValue=!0;break;case"BYSETPOS":instance.positions=parseArray(value,{start:-366,end:366});break;case"WKST":instance.weekStart=weekStart=WEEK_DAYS_IDX[value[0]]}return instance.freq===undefined||instance.count!==undefined&&instance.until?null:(instance.interval||(instance.interval=1),weekStart===undefined&&(instance.weekStart=weekStart=kendo.culture().calendar.firstDay),weekDays&&(instance.weekDays=weekDays.sort(predicate)),instance.positions&&!ruleValue&&(instance.positions=null),instance._hasRuleValue=ruleValue,instance)}function serializeDateRule(dateRule,zone){for(var val,value=dateRule.value,tzid=dateRule.tzid||"",length=value.length,idx=0;idx<length;idx++)val=value[idx],val=timezone.convert(val,tzid||zone||val.getTimezoneOffset(),"Etc/UTC"),value[idx]=kendo.toString(val,"yyyyMMddTHHmmssZ");return tzid&&(tzid=";TZID="+tzid),tzid+":"+value.join(",")+" "}function serialize(rule,zone){var weekStart=rule.weekStart,ruleString="FREQ="+rule.freq.toUpperCase(),exdates=rule.exdates||"",start=rule.start||"",end=rule.end||"",until=rule.until;return rule.interval>1&&(ruleString+=";INTERVAL="+rule.interval),rule.count&&(ruleString+=";COUNT="+rule.count),until&&(until=timezone.convert(until,zone||until.getTimezoneOffset(),"Etc/UTC"),ruleString+=";UNTIL="+kendo.toString(until,"yyyyMMddTHHmmssZ")),rule.months&&(ruleString+=";BYMONTH="+rule.months),rule.weeks&&(ruleString+=";BYWEEKNO="+rule.weeks),rule.yearDays&&(ruleString+=";BYYEARDAY="+rule.yearDays),rule.monthDays&&(ruleString+=";BYMONTHDAY="+rule.monthDays),rule.weekDays&&(ruleString+=";BYDAY="+serializeWeekDayList(rule.weekDays)),rule.hours&&(ruleString+=";BYHOUR="+rule.hours),rule.minutes&&(ruleString+=";BYMINUTE="+rule.minutes),rule.seconds&&(ruleString+=";BYSECOND="+rule.seconds),rule.positions&&(ruleString+=";BYSETPOS="+rule.positions),weekStart!==undefined&&(ruleString+=";WKST="+WEEK_DAYS[weekStart]),start&&(start="DTSTART"+serializeDateRule(start,zone)),end&&(end="DTEND"+serializeDateRule(end,zone)),exdates&&(exdates="EXDATE"+serializeDateRule(exdates,zone)),(start||end||exdates)&&(ruleString=start+end+exdates+"RRULE:"+ruleString),ruleString}var kendo=window.kendo,timezone=kendo.timezone,Class=kendo.Class,ui=kendo.ui,Widget=ui.Widget,DropDownList=ui.DropDownList,kendoDate=kendo.date,setTime=kendoDate.setTime,setDayOfWeek=kendoDate.setDayOfWeek,adjustDST=kendoDate.adjustDST,firstDayOfMonth=kendoDate.firstDayOfMonth,getMilliseconds=kendoDate.getMilliseconds,DAYS_IN_LEAPYEAR=[0,31,60,91,121,152,182,213,244,274,305,335,366],DAYS_IN_YEAR=[0,31,59,90,120,151,181,212,243,273,304,334,365],MONTHS=[31,28,30,31,30,31,30,31,30,31,30,31],WEEK_DAYS={0:"SU",1:"MO",2:"TU",3:"WE",4:"TH",5:"FR",6:"SA"},WEEK_DAYS_IDX={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6},DATE_FORMATS=["yyyy-MM-ddTHH:mm:ss.fffzzz","yyyy-MM-ddTHH:mm:sszzz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mm","yyyy-MM-ddTHH","yyyy-MM-dd","yyyyMMddTHHmmssfffzzz","yyyyMMddTHHmmsszzz","yyyyMMddTHHmmss","yyyyMMddTHHmm","yyyyMMddTHH","yyyyMMdd"],RULE_NAMES=["months","weeks","yearDays","monthDays","weekDays","hours","minutes","seconds"],RULE_NAMES_LENGTH=RULE_NAMES.length,RECURRENCE_DATE_FORMAT="yyyyMMddTHHmmssZ",limitation={months:function(date,end,rule){var monthRules=rule.months,months=ruleValues(monthRules,date.getMonth()+1),changed=!1;return null!==months&&(months.length?date.setMonth(months[0]-1,1):date.setFullYear(date.getFullYear()+1,monthRules[0]-1,1),changed=!0),changed},monthDays:function(date,end,rule){for(var monthLength,month,days,changed=!1,hours=date.getHours(),normalize=function(monthDay){return monthDay<0&&(monthDay=monthLength+monthDay),monthDay};date<=end;){if(month=date.getMonth(),monthLength=getMonthLength(date),days=ruleValues(rule.monthDays,date.getDate(),normalize),null===days)return changed;if(changed=!0,days.length){if(date.setMonth(month,days.sort(numberSortPredicate)[0]),adjustDST(date,hours),month===date.getMonth())break}else date.setMonth(month+1,1)}return changed},yearDays:function(date,end,rule){for(var year,yearDays,changed=!1,hours=date.getHours(),normalize=function(yearDay){return yearDay<0&&(yearDay=year+yearDay),yearDay};date<end;){if(year=leapYear(date)?366:365,yearDays=ruleValues(rule.yearDays,dayInYear(date),normalize),null===yearDays)return changed;if(changed=!0,year=date.getFullYear(),yearDays.length){date.setFullYear(year,0,yearDays.sort(numberSortPredicate)[0]),adjustDST(date,hours);break}date.setFullYear(year+1,0,1)}return changed},weeks:function(date,end,rule){for(var year,weeks,day,weekStart=rule.weekStart,changed=!1,hours=date.getHours(),normalize=function(week){return week<0&&(week=53+week),week};date<end;){if(weeks=ruleValues(rule.weeks,weekInYear(date,weekStart),normalize),null===weeks)return changed;if(changed=!0,year=date.getFullYear(),weeks.length){day=7*weeks.sort(numberSortPredicate)[0]-1,date.setFullYear(year,0,day),setDayOfWeek(date,weekStart,-1),adjustDST(date,hours);break}date.setFullYear(year+1,0,1)}return changed},weekDays:function(date,end,rule){var weekDayRule,day,weekDays=rule.weekDays,weekStart=rule.weekStart,weekDayRules=ruleWeekValues(weekDays,date,weekStart),hours=date.getHours();if(null===weekDayRules)return!1;if(weekDayRule=weekDayRules[0],weekDayRule||(weekDayRule=weekDays[0],setDayOfWeek(date,weekStart)),day=weekDayRule.day,weekDayRule.offset)for(;date<=end&&!isInWeek(date,weekDayRule,weekStart);)weekInMonth(date,weekStart)===numberOfWeeks(date,weekStart)?(date.setMonth(date.getMonth()+1,1),adjustDST(date,hours)):(date.setDate(date.getDate()+7),adjustDST(date,hours),setDayOfWeek(date,weekStart,-1));return date.getDay()!==day&&setDayOfWeek(date,day),!0},hours:function(date,end,rule){var hourRules=rule.hours,startTime=rule._startTime,startHours=startTime.getHours(),hours=ruleValues(hourRules,startHours),changed=!1;return null!==hours&&(changed=!0,date.setHours(startHours),adjustDST(date,startHours),hours.length?(hours=hours[0],date.setHours(hours)):(hours=date.getHours(),date.setDate(date.getDate()+1),adjustDST(date,hours),hours=hourRules[0],date.setHours(hours),adjustDST(date,hours)),rule.minutes&&date.setMinutes(0),startTime.setHours(hours,date.getMinutes())),changed},minutes:function(date,end,rule){var minuteRules=rule.minutes,currentMinutes=date.getMinutes(),minutes=ruleValues(minuteRules,currentMinutes),hours=rule._startTime.getHours(),changed=!1;return null!==minutes&&(changed=!0,minutes.length?minutes=minutes[0]:(hours+=1,minutes=minuteRules[0]),rule.seconds&&date.setSeconds(0),date.setHours(hours,minutes),hours%=24,adjustDST(date,hours),rule._startTime.setHours(hours,minutes,date.getSeconds())),changed},seconds:function(date,end,rule){var secondRules=rule.seconds,hours=rule._startTime.getHours(),seconds=ruleValues(secondRules,date.getSeconds()),minutes=date.getMinutes(),changed=!1;return null!==seconds&&(changed=!0,seconds.length?date.setSeconds(seconds[0]):(minutes+=1,date.setMinutes(minutes,secondRules[0]),minutes>59&&(minutes%=60,hours=(hours+1)%24)),rule._startTime.setHours(hours,minutes,date.getSeconds())),changed}},BaseFrequency=Class.extend({next:function(date,rule){var minutes,seconds,startTime=rule._startTime,day=startTime.getDate();if(rule.seconds)seconds=date.getSeconds()+1,date.setSeconds(seconds),startTime.setSeconds(seconds),startTime.setDate(day);else{if(!rule.minutes)return!1;minutes=date.getMinutes()+1,date.setMinutes(minutes),startTime.setMinutes(minutes),startTime.setDate(day)}return!0},normalize:function(options){var rule=options.rule;4===options.idx&&rule.hours&&(rule._startTime.setHours(0),this._hour(options.date,rule))},limit:function(date,end,rule){for(var ruleName,firstRule,modified,idx,day,interval=rule.interval;date<=end;){for(modified=firstRule=undefined,day=date.getDate(),idx=0;idx<RULE_NAMES_LENGTH;idx++){if(ruleName=RULE_NAMES[idx],rule[ruleName]){if(modified=limitation[ruleName](date,end,rule),firstRule!==undefined&&modified)break;firstRule=modified}modified&&this.normalize({date:date,rule:rule,day:day,idx:idx})}if((1===interval||!this.interval(rule,date))&&idx===RULE_NAMES_LENGTH)break}},interval:function(rule,current){var diff,startTimeHours,start=new Date(rule._startPeriod),date=new Date(current),hours=current.getHours(),weekStart=rule.weekStart,interval=rule.interval,frequency=rule.freq,modified=!1,excess=0,month=0,day=1;return"hourly"===frequency?(diff=date.getTimezoneOffset()-start.getTimezoneOffset(),startTimeHours=rule._startTime.getHours(),date=date.getTime(),hours!==startTimeHours&&(date+=(startTimeHours-hours)*kendoDate.MS_PER_HOUR),date-=start,diff&&(date-=diff*kendoDate.MS_PER_MINUTE),diff=Math.floor(date/kendoDate.MS_PER_HOUR),excess=intervalExcess(diff,interval),0!==excess&&(this._hour(current,rule,excess),modified=!0)):"daily"===frequency?(kendoDate.setTime(date,-start),diff=Math.floor(date/kendoDate.MS_PER_DAY),excess=intervalExcess(diff,interval),0!==excess&&(this._date(current,rule,excess),modified=!0)):"weekly"===frequency?(diff=52*(current.getFullYear()-start.getFullYear()),excess=weekInYear(current,weekStart)-weekInYear(start,weekStart)+diff,excess=intervalExcess(excess,interval),0!==excess&&(kendoDate.setDayOfWeek(current,rule.weekStart,-1),current.setDate(current.getDate()+7*excess),adjustDST(current,hours),modified=!0)):"monthly"===frequency?(diff=current.getFullYear()-start.getFullYear(),diff=current.getMonth()-start.getMonth()+12*diff,excess=intervalExcess(diff,interval),0!==excess&&(day=rule._hasRuleValue?1:current.getDate(),current.setFullYear(current.getFullYear(),current.getMonth()+excess,day),adjustDST(current,hours),modified=!0)):"yearly"===frequency&&(diff=current.getFullYear()-start.getFullYear(),excess=intervalExcess(diff,interval),rule.months||(month=current.getMonth()),rule.yearDays||rule.monthDays||rule.weekDays||(day=current.getDate()),0!==excess&&(current.setFullYear(current.getFullYear()+excess,month,day),adjustDST(current,hours),modified=!0)),modified},_hour:function(date,rule,interval){var startTime=rule._startTime,hours=startTime.getHours();interval&&(hours+=interval),date.setHours(hours),hours%=24,startTime.setHours(hours),adjustDST(date,hours)},_date:function(date,rule,interval){var hours=date.getHours();date.setDate(date.getDate()+interval),adjustDST(date,hours)||this._hour(date,rule)}}),HourlyFrequency=BaseFrequency.extend({next:function(date,rule){BaseFrequency.fn.next(date,rule)||this._hour(date,rule,1)},normalize:function(options){var rule=options.rule;4===options.idx&&(rule._startTime.setHours(0),this._hour(options.date,rule))}}),DailyFrequency=BaseFrequency.extend({next:function(date,rule){BaseFrequency.fn.next(date,rule)||this[rule.hours?"_hour":"_date"](date,rule,1)}}),WeeklyFrequency=DailyFrequency.extend({setup:function(rule,eventStartDate){rule.weekDays||(rule.weekDays=[{day:eventStartDate.getDay(),offset:0}])}}),MonthlyFrequency=BaseFrequency.extend({next:function(date,rule){var day,hours;if(!BaseFrequency.fn.next(date,rule))if(rule.hours)this._hour(date,rule,1);else if(rule.monthDays||rule.weekDays||rule.yearDays||rule.weeks)this._date(date,rule,1);else{for(day=date.getDate(),hours=date.getHours(),date.setMonth(date.getMonth()+1),adjustDST(date,hours);date.getDate()!==day;)date.setDate(day),adjustDST(date,hours);this._hour(date,rule)}},normalize:function(options){var rule=options.rule,date=options.date,hours=date.getHours();0!==options.idx||rule.monthDays||rule.weekDays?BaseFrequency.fn.normalize(options):(date.setDate(options.day),adjustDST(date,hours))},setup:function(rule,eventStartDate,date){rule.monthDays||rule.weekDays||date.setDate(eventStartDate.getDate())}}),YearlyFrequency=MonthlyFrequency.extend({next:function(date,rule){var day,hours=date.getHours();if(!BaseFrequency.fn.next(date,rule))if(rule.hours)this._hour(date,rule,1);else if(rule.monthDays||rule.weekDays||rule.yearDays||rule.weeks)this._date(date,rule,1);else if(rule.months){for(day=date.getDate(),date.setMonth(date.getMonth()+1),adjustDST(date,hours);date.getDate()!==day;)date.setDate(day),adjustDST(date,hours);this._hour(date,rule)}else date.setFullYear(date.getFullYear()+1),adjustDST(date,hours),this._hour(date,rule)},setup:function(){}}),frequencies={hourly:new HourlyFrequency,daily:new DailyFrequency,weekly:new WeeklyFrequency,monthly:new MonthlyFrequency,yearly:new YearlyFrequency},CLICK="click";kendo.recurrence={rule:{parse:parseRule,serialize:serialize},expand:expand,dayInYear:dayInYear,weekInYear:weekInYear,weekInMonth:weekInMonth,numberOfWeeks:numberOfWeeks,isException:isException,toExceptionString:toExceptionString};var weekDayCheckBoxes=function(firstDay){for(var shortNames=kendo.culture().calendar.days.namesShort,length=shortNames.length,result="",idx=0,values=[];idx<length;idx++)values.push(idx);for(shortNames=shortNames.slice(firstDay).concat(shortNames.slice(0,firstDay)),values=values.slice(firstDay).concat(values.slice(0,firstDay)),idx=0;idx<length;idx++)result+='<label class="k-check"><input class="k-recur-weekday-checkbox" type="checkbox" value="'+values[idx]+'" /> '+shortNames[idx]+"</label>";return result},RECURRENCE_VIEW_TEMPLATE=kendo.template('# if (frequency !== "never") { #<div class="k-edit-label"><label>#:messages.repeatEvery#</label></div><div class="k-edit-field"><input class="k-recur-interval"/>#:messages.interval#</div># } ## if (frequency === "weekly") { #<div class="k-edit-label"><label>#:messages.repeatOn#</label></div><div class="k-edit-field">#=weekDayCheckBoxes(firstWeekDay)#</div># } else if (frequency === "monthly") { #<div class="k-edit-label"><label>#:messages.repeatOn#</label></div><div class="k-edit-field"><ul class="k-reset"><li><label><input class="k-recur-month-radio" type="radio" name="month" value="monthday" />#:messages.day#</label><input class="k-recur-monthday" /></li><li><input class="k-recur-month-radio" type="radio" name="month" value="weekday" /><input class="k-recur-weekday-offset" /><input class="k-recur-weekday" /></li></ul></div># } else if (frequency === "yearly") { #<div class="k-edit-label"><label>#:messages.repeatOn#</label></div><div class="k-edit-field"><ul class="k-reset"><li><input class="k-recur-year-radio" type="radio" name="year" value="monthday" /><input class="k-recur-month" /><input class="k-recur-monthday" /></li><li><input class="k-recur-year-radio" type="radio" name="year" value="weekday" /><input class="k-recur-weekday-offset" /><input class="k-recur-weekday" />#:messages.of#<input class="k-recur-month" /></li></ul></div># } ## if (frequency !== "never") { #<div class="k-edit-label"><label>#:end.label#</label></div><div class="k-edit-field"><ul class="k-reset"><li><label><input class="k-recur-end-never" type="radio" name="end" value="never" />#:end.never#</label></li><li><label><input class="k-recur-end-count" type="radio" name="end" value="count" />#:end.after#</label><input class="k-recur-count" />#:end.occurrence#</li><li><label><input class="k-recur-end-until" type="radio" name="end" value="until" />#:end.on#</label><input class="k-recur-until" /></li></ul></div># } #'),DAY_RULE=[{
day:0,offset:0},{day:1,offset:0},{day:2,offset:0},{day:3,offset:0},{day:4,offset:0},{day:5,offset:0},{day:6,offset:0}],WEEKDAY_RULE=[{day:1,offset:0},{day:2,offset:0},{day:3,offset:0},{day:4,offset:0},{day:5,offset:0}],WEEKEND_RULE=[{day:0,offset:0},{day:6,offset:0}],BaseRecurrenceEditor=Widget.extend({init:function(element,options){var start,that=this,frequencies=options&&options.frequencies;Widget.fn.init.call(that,element,options),that.wrapper=that.element,options=that.options,options.start=start=options.start||kendoDate.today(),frequencies&&(options.frequencies=frequencies),"string"==typeof start&&(options.start=kendo.parseDate(start,"yyyyMMddTHHmmss")),null===options.firstWeekDay&&(options.firstWeekDay=kendo.culture().calendar.firstDay),that._namespace="."+options.name},options:{value:"",start:"",timezone:"",spinners:!0,firstWeekDay:null,frequencies:["never","daily","weekly","monthly","yearly"],mobile:!1,messages:{frequencies:{never:"Never",hourly:"Hourly",daily:"Daily",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"},hourly:{repeatEvery:"Repeat every: ",interval:" hour(s)"},daily:{repeatEvery:"Repeat every: ",interval:" day(s)"},weekly:{interval:" week(s)",repeatEvery:"Repeat every: ",repeatOn:"Repeat on: "},monthly:{repeatEvery:"Repeat every: ",repeatOn:"Repeat on: ",interval:" month(s)",day:"Day "},yearly:{repeatEvery:"Repeat every: ",repeatOn:"Repeat on: ",interval:" year(s)",of:" of "},end:{label:"End:",mobileLabel:"Ends",never:"Never",after:"After ",occurrence:" occurrence(s)",on:"On "},offsetPositions:{first:"first",second:"second",third:"third",fourth:"fourth",last:"last"},weekdays:{day:"day",weekday:"weekday",weekend:"weekend day"}}},events:["change"],_initInterval:function(){var that=this,rule=that._value;that._container.find(".k-recur-interval").kendoNumericTextBox({spinners:that.options.spinners,value:rule.interval||1,decimals:0,format:"#",min:1,change:function(){rule.interval=this.value(),that._trigger()}})},_weekDayRule:function(clear){var that=this,weekday=(that._weekDay.element||that._weekDay).val(),offset=Number((that._weekDayOffset.element||that._weekDayOffset).val()),weekDays=null,positions=null;clear||("day"===weekday?(weekDays=DAY_RULE,positions=offset):"weekday"===weekday?(weekDays=WEEKDAY_RULE,positions=offset):"weekend"===weekday?(weekDays=WEEKEND_RULE,positions=offset):weekDays=[{offset:offset,day:Number(weekday)}]),that._value.weekDays=weekDays,that._value.positions=positions},_weekDayView:function(){var weekDayOffset,weekDayValue,length,method,that=this,weekDays=that._value.weekDays,positions=that._value.positions,weekDayOffsetWidget=that._weekDayOffset;weekDays&&(length=weekDays.length,positions&&(7===length?(weekDayValue="day",weekDayOffset=positions):5===length?(weekDayValue="weekday",weekDayOffset=positions):2===length&&(weekDayValue="weekend",weekDayOffset=positions)),weekDayValue||(weekDays=weekDays[0],weekDayValue=weekDays.day,weekDayOffset=weekDays.offset||""),method=weekDayOffsetWidget.value?"value":"val",weekDayOffsetWidget[method](weekDayOffset),that._weekDay[method](weekDayValue))},_initWeekDay:function(){var data,that=this,weekdayMessage=that.options.messages.weekdays,offsetMessage=that.options.messages.offsetPositions,weekDayInput=that._container.find(".k-recur-weekday"),change=function(){that._weekDayRule(),that._trigger()};weekDayInput[0]&&(that._weekDayOffset=new DropDownList(that._container.find(".k-recur-weekday-offset"),{change:change,dataTextField:"text",dataValueField:"value",dataSource:[{text:offsetMessage.first,value:"1"},{text:offsetMessage.second,value:"2"},{text:offsetMessage.third,value:"3"},{text:offsetMessage.fourth,value:"4"},{text:offsetMessage.last,value:"-1"}]}),data=[{text:weekdayMessage.day,value:"day"},{text:weekdayMessage.weekday,value:"weekday"},{text:weekdayMessage.weekend,value:"weekend"}],that._weekDay=new DropDownList(weekDayInput,{value:that.options.start.getDay(),change:change,dataTextField:"text",dataValueField:"value",dataSource:data.concat($.map(kendo.culture().calendar.days.names,function(dayName,idx){return{text:dayName,value:idx}}))}),that._weekDayView())},_initWeekDays:function(){var that=this,rule=that._value,weekDays=that._container.find(".k-recur-weekday-checkbox");if(weekDays[0]&&(weekDays.on(CLICK+that._namespace,function(){rule.weekDays=$.map(weekDays.filter(":checked"),function(checkbox){return{day:Number(checkbox.value),offset:0}}),that.options.mobile||that._trigger()}),rule.weekDays))for(var idx,weekDay,i=0,l=weekDays.length,length=rule.weekDays.length;i<l;i++)for(weekDay=weekDays[i],idx=0;idx<length;idx++)weekDay.value==rule.weekDays[idx].day&&(weekDay.checked=!0)},_initMonthDay:function(){var that=this,rule=that._value,monthDayInput=that._container.find(".k-recur-monthday");monthDayInput[0]&&(that._monthDay=new kendo.ui.NumericTextBox(monthDayInput,{spinners:that.options.spinners,min:1,max:31,decimals:0,format:"#",value:rule.monthDays?rule.monthDays[0]:that.options.start.getDate(),change:function(){var value=this.value();rule.monthDays=value?[value]:value,that._trigger()}}))},_initCount:function(){var that=this,input=that._container.find(".k-recur-count"),rule=that._value;that._count=input.kendoNumericTextBox({spinners:that.options.spinners,value:rule.count||1,decimals:0,format:"#",min:1,change:function(){rule.count=this.value(),that._trigger()}}).data("kendoNumericTextBox")},_initUntil:function(){var that=this,input=that._container.find(".k-recur-until"),start=that.options.start,rule=that._value,until=rule.until;that._until=input.kendoDatePicker({min:until&&until<start?until:start,value:until||start,change:function(){rule.until=this.value(),that._trigger()}}).data("kendoDatePicker")},_trigger:function(){this.options.mobile||this.trigger("change")}}),RecurrenceEditor=BaseRecurrenceEditor.extend({init:function(element,options){var that=this;BaseRecurrenceEditor.fn.init.call(that,element,options),that._initFrequency(),that._initContainer(),that.value(that.options.value)},options:{name:"RecurrenceEditor"},events:["change"],destroy:function(){var that=this;that._frequency.destroy(),that._container.find("input[type=radio],input[type=checkbox]").off(CLICK+that._namespace),kendo.destroy(that._container),BaseRecurrenceEditor.fn.destroy.call(that)},value:function(value){var that=this,timezone=that.options.timezone;return value===undefined?that._value.freq?serialize(that._value,timezone):"":(that._value=parseRule(value,timezone)||{},that._frequency.value(that._value.freq||""),void that._initView(that._frequency.value()))},_initContainer:function(){var element=this.element,container=$('<div class="k-recur-view" />'),editContainer=element.parent(".k-edit-field");editContainer[0]?container.insertAfter(editContainer):element.append(container),this._container=container},_initFrequency:function(){var frequency,that=this,options=that.options,frequencies=options.frequencies,messages=options.messages.frequencies,ddl=$("<input />");frequencies=$.map(frequencies,function(frequency){return{text:messages[frequency],value:frequency}}),frequency=frequencies[0],frequency&&"never"===frequency.value&&(frequency.value=""),that.element.append(ddl),that._frequency=new DropDownList(ddl,{dataTextField:"text",dataValueField:"value",dataSource:frequencies,change:function(){that._value={},that._initView(that._frequency.value()),that.trigger("change")}})},_initView:function(frequency){var that=this,rule=that._value,options=that.options,data={frequency:frequency||"never",weekDayCheckBoxes:weekDayCheckBoxes,firstWeekDay:options.firstWeekDay,messages:options.messages[frequency],end:options.messages.end};return kendo.destroy(that._container),that._container.html(RECURRENCE_VIEW_TEMPLATE(data)),frequency?(rule.freq=frequency,"weekly"!==frequency||rule.weekDays||(rule.weekDays=[{day:options.start.getDay(),offset:0}]),that._initInterval(),that._initWeekDays(),that._initMonthDay(),that._initWeekDay(),that._initMonth(),that._initCount(),that._initUntil(),that._period(),void that._end()):void(that._value={})},_initMonth:function(){var options,that=this,rule=that._value,month=rule.months||[that.options.start.getMonth()+1],monthInputs=that._container.find(".k-recur-month");monthInputs[0]&&(options={change:function(){rule.months=[Number(this.value())],that.trigger("change")},dataTextField:"text",dataValueField:"value",dataSource:$.map(kendo.culture().calendar.months.names,function(monthName,idx){return{text:monthName,value:idx+1}})},that._month1=new DropDownList(monthInputs[0],options),that._month2=new DropDownList(monthInputs[1],options),month&&(month=month[0],that._month1.value(month),that._month2.value(month)))},_end:function(){var endRule,that=this,rule=that._value,container=that._container,namespace=that._namespace,click=function(e){that._toggleEnd(e.currentTarget.value),that.trigger("change")};that._buttonNever=container.find(".k-recur-end-never").on(CLICK+namespace,click),that._buttonCount=container.find(".k-recur-end-count").on(CLICK+namespace,click),that._buttonUntil=container.find(".k-recur-end-until").on(CLICK+namespace,click),rule.count?endRule="count":rule.until&&(endRule="until"),that._toggleEnd(endRule)},_period:function(){var that=this,rule=that._value,monthly="monthly"===rule.freq,toggleRule=monthly?that._toggleMonthDay:that._toggleYear,selector=".k-recur-"+(monthly?"month":"year")+"-radio",radioButtons=that._container.find(selector);(monthly||"yearly"===rule.freq)&&(radioButtons.on(CLICK+that._namespace,function(e){toggleRule.call(that,e.currentTarget.value),that.trigger("change")}),that._buttonMonthDay=radioButtons.eq(0),that._buttonWeekDay=radioButtons.eq(1),toggleRule.call(that,rule.weekDays?"weekday":"monthday"))},_toggleEnd:function(endRule){var count,until,enableCount,enableUntil,that=this;"count"===endRule?(that._buttonCount.prop("checked",!0),enableCount=!0,enableUntil=!1,count=that._count.value(),until=null):"until"===endRule?(that._buttonUntil.prop("checked",!0),enableCount=!1,enableUntil=!0,count=null,until=that._until.value()):(that._buttonNever.prop("checked",!0),enableCount=enableUntil=!1,count=until=null),that._count.enable(enableCount),that._until.enable(enableUntil),that._value.count=count,that._value.until=until},_toggleMonthDay:function(monthRule){var monthDays,that=this,enableMonthDay=!1,enableWeekDay=!0,clear=!1;"monthday"===monthRule?(that._buttonMonthDay.prop("checked",!0),monthDays=[that._monthDay.value()],enableMonthDay=!0,enableWeekDay=!1,clear=!0):(that._buttonWeekDay.prop("checked",!0),monthDays=null),that._weekDay.enable(enableWeekDay),that._weekDayOffset.enable(enableWeekDay),that._monthDay.enable(enableMonthDay),that._value.monthDays=monthDays,that._weekDayRule(clear)},_toggleYear:function(yearRule){var month,that=this,enableMonth1=!1,enableMonth2=!0;"monthday"===yearRule?(enableMonth1=!0,enableMonth2=!1,month=that._month1.value()):month=that._month2.value(),that._month1.enable(enableMonth1),that._month2.enable(enableMonth2),that._value.months=[month],that._toggleMonthDay(yearRule)}});ui.plugin(RecurrenceEditor);var RECURRENCE_HEADER_TEMPLATE=kendo.template('<div class="k-edit-label"><label>#:headerTitle#</label></div><div class="k-edit-field k-recur-pattern k-scheduler-toolbar"></div><div class="k-recur-view"></div>'),RECURRENCE_REPEAT_PATTERN_TEMPLATE=kendo.template('# if (frequency !== "never") { #<div class="k-edit-label"><label>#:messages.repeatEvery#</label></div><div class="k-edit-field"><input class="k-recur-interval" pattern="\\\\d*"/>#:messages.interval#</div># } ## if (frequency === "weekly") { #<div class="k-edit-label"><label>#:messages.repeatOn#</label></div><div class="k-edit-field">#=weekDayCheckBoxes(firstWeekDay)#</div># } else if (frequency === "monthly") { #<div class="k-edit-label"><label>#:messages.repeatBy#</label></div><div class="k-edit-field k-scheduler-toolbar k-repeat-rule"></div><div class="k-monthday-view" style="display:none"><div class="k-edit-label"><label>#:messages.day#</label></div><div class="k-edit-field"><input class="k-recur-monthday" pattern="\\\\d*"/></div></div><div class="k-weekday-view" style="display:none"><div class="k-edit-label"><label>#:messages.every#</label></div><div class="k-edit-field"><select class="k-recur-weekday-offset"></select></div><div class="k-edit-label"><label>#:messages.day#</label></div><div class="k-edit-field"><select class="k-recur-weekday"></select></div></div># } else if (frequency === "yearly") { #<div class="k-edit-label"><label>#:messages.repeatBy#</label></div><div class="k-edit-field k-scheduler-toolbar k-repeat-rule"></div><div class="k-monthday-view" style="display:none"><div class="k-edit-label"><label>#:messages.day#</label></div><div class="k-edit-field"><input class="k-recur-monthday" pattern="\\\\d*"/></div></div><div class="k-weekday-view" style="display:none"><div class="k-edit-label"><label>#:messages.every#</label></div><div class="k-edit-field"><select class="k-recur-weekday-offset"></select></div><div class="k-edit-label"><label>#:messages.day#</label></div><div class="k-edit-field"><select class="k-recur-weekday"></select></div></div><div class="k-edit-label"><label>#:messages.month#</label></div><div class="k-edit-field"><select class="k-recur-month"></select></div># } #'),RECURRENCE_END_PATTERN_TEMPLATE=kendo.template('# if (endPattern === "count") { #<div class="k-edit-label"><label>#:messages.after#</label></div><div class="k-edit-field"><input class="k-recur-count" pattern="\\\\d*" /></div># } else if (endPattern === "until") { #<div class="k-edit-label"><label>#:messages.on#</label></div><div class="k-edit-field"><input type="date" class="k-recur-until" /></div># } #'),RECURRENCE_GROUP_BUTTON_TEMPLATE=kendo.template('<ul class="k-reset k-header k-toolbar k-scheduler-navigation">#for (var i = 0, length = dataSource.length; i < length; i++) {#<li class="k-state-default #= value === dataSource[i].value ? "k-state-selected" : "" #"><a role="button" href="\\#" class="k-link" data-#=ns#value="#=dataSource[i].value#">#:dataSource[i].text#</a></li>#}#</ul>'),MobileRecurrenceEditor=BaseRecurrenceEditor.extend({init:function(element,options){var that=this;BaseRecurrenceEditor.fn.init.call(that,element,options),options=that.options,that._optionTemplate=kendo.template('<option value="#:value#">#:text#</option>'),that.value(options.value),that._pane=options.pane,that._initRepeatButton(),that._initRepeatEnd(),that._defaultValue=that._value},options:{name:"MobileRecurrenceEditor",animations:{left:"slide",right:"slide:right"},mobile:!0,messages:{cancel:"Cancel",update:"Save",endTitle:"Repeat ends",repeatTitle:"Repeat pattern",headerTitle:"Repeat event",end:{patterns:{never:"Never",after:"After...",on:"On..."},never:"Never",after:"End repeat after",on:"End repeat on"},daily:{interval:""},hourly:{interval:""},weekly:{interval:""},monthly:{interval:"",repeatBy:"Repeat by: ",dayOfMonth:"Day of the month",dayOfWeek:"Day of the week",repeatEvery:"Repeat every",every:"Every",day:"Day "},yearly:{interval:"",repeatBy:"Repeat by: ",dayOfMonth:"Day of the month",dayOfWeek:"Day of the week",repeatEvery:"Repeat every: ",every:"Every",month:"Month",day:"Day"}}},events:["change"],value:function(value){var that=this,timezone=that.options.timezone;return value===undefined?that._value.freq?serialize(that._value,timezone):"":void(that._value=parseRule(value,timezone)||{})},destroy:function(){this._destroyView(),kendo.destroy(this._endFields),this._repeatButton.off(CLICK+this._namespace),BaseRecurrenceEditor.fn.destroy.call(this)},_initRepeatButton:function(){var that=this,freq=that.options.messages.frequencies[this._value.freq||"never"];that._repeatButton=$('<a href="#" class="k-button k-scheduler-recur">'+freq+"</a>").on(CLICK+that._namespace,function(e){e.preventDefault(),that._createView("repeat"),that._pane.navigate("recurrence",that.options.animations.left)}),that.element.append(that._repeatButton)},_initRepeatEnd:function(){var that=this,endLabelField=$('<div class="k-edit-label"><label>'+that.options.messages.end.mobileLabel+"</label></div>").insertAfter(that.element.parent(".k-edit-field")),endEditField=$('<div class="k-edit-field"><a href="#" class="k-button k-scheduler-recur-end"></a></div>').on(CLICK+that._namespace,function(e){e.preventDefault(),that._value.freq&&(that._createView("end"),that._pane.navigate("recurrence",that.options.animations.left))}).insertAfter(endLabelField);that._endFields=endLabelField.add(endEditField).toggleClass("k-state-disabled",!that._value.freq),that._endButton=endEditField.find(".k-scheduler-recur-end").text(that._endText())},_endText:function(){var rule=this._value,messages=this.options.messages.end,text=messages.never;return rule.count?text=kendo.format("{0} {1}",messages.after,rule.count):rule.until&&(text=kendo.format("{0} {1:d}",messages.on,rule.until)),text},_initFrequency:function(){var that=this,frequencyMessages=that.options.messages.frequencies,html=RECURRENCE_GROUP_BUTTON_TEMPLATE({dataSource:$.map(this.options.frequencies,function(frequency){return{text:frequencyMessages[frequency],value:"never"!==frequency?frequency:""}}),value:that._value.freq||"",ns:kendo.ns});that._view.element.find(".k-recur-pattern").append(html).on(CLICK+that._namespace,".k-scheduler-navigation li",function(e){var li=$(this);e.preventDefault(),li.addClass("k-state-selected").siblings().removeClass("k-state-selected"),that._value={freq:li.children("a").attr(kendo.attr("value"))},that._initRepeatView()})},_initEndNavigation:function(){var that=this,endMessages=that.options.messages.end.patterns,rule=that._value,value="";rule.count?value="count":rule.until&&(value="until");var html=RECURRENCE_GROUP_BUTTON_TEMPLATE({dataSource:[{text:endMessages.never,value:""},{text:endMessages.after,value:"count"},{text:endMessages.on,value:"until"}],value:value,ns:kendo.ns});that._view.element.find(".k-recur-pattern").append(html).on(CLICK+that._namespace,".k-scheduler-navigation li",function(e){var li=$(this),count=null,until=null;e.preventDefault(),li.addClass("k-state-selected").siblings().removeClass("k-state-selected"),that._initEndView(li.children("a").attr(kendo.attr("value"))),that._count?(count=that._count.value(),until=null):that._until&&(count=null,until=that._until.val?kendo.parseDate(that._until.val(),"yyyy-MM-dd"):that._until.value()),rule.count=count,rule.until=until})},_createView:function(viewType){var that=this,options=that.options,messages=options.messages,headerTitle=messages["repeat"===viewType?"repeatTitle":"endTitle"],html='<div data-role="view" class="k-popup-edit-form k-scheduler-edit-form k-mobile-list" id="recurrence"><div data-role="header" class="k-header"><a href="#" class="k-button k-scheduler-cancel">'+messages.cancel+"</a>"+messages.headerTitle+'<a href="#" class="k-button k-scheduler-update">'+messages.update+"</a></div>",returnViewId=that._pane.view().id;that._view=that._pane.append(html+RECURRENCE_HEADER_TEMPLATE({headerTitle:headerTitle})),that._view.element.on(CLICK+that._namespace,"a.k-scheduler-cancel, a.k-scheduler-update",function(e){e.preventDefault(),e.stopPropagation(),$(this).hasClass("k-scheduler-update")?(that.trigger("change"),that._defaultValue=$.extend({},that._value)):that._value=that._defaultValue;var frequency=that._value.freq;that._endButton.text(that._endText()),that._endFields.toggleClass("k-state-disabled",!frequency),that._repeatButton.text(messages.frequencies[frequency||"never"]),that._pane.one("viewShow",function(){that._destroyView()}),that._pane.navigate(returnViewId,that.options.animations.right)}),that._container=that._view.element.find(".k-recur-view"),"repeat"===viewType?(that._initFrequency(),that._initRepeatView()):(that._initEndNavigation(),that._initEndView())},_destroyView:function(){this._view&&(this._view.destroy(),this._view.element.remove()),this._view=null},_initRepeatView:function(){var that=this,frequency=that._value.freq||"never",data={frequency:frequency,weekDayCheckBoxes:weekDayCheckBoxes,firstWeekDay:that.options.firstWeekDay,messages:that.options.messages[frequency]},html=RECURRENCE_REPEAT_PATTERN_TEMPLATE(data),container=that._container,rule=that._value;return kendo.destroy(container),container.html(html),html?("weekly"!==frequency||rule.weekDays||(rule.weekDays=[{day:that.options.start.getDay(),offset:0}]),that._initInterval(),that._initMonthDay(),that._initWeekDays(),that._initWeekDay(),that._initMonth(),void that._period()):void(that._value={})},_initEndView:function(endPattern){var that=this,rule=that._value;endPattern===undefined&&(rule.count?endPattern="count":rule.until&&(endPattern="until"));var data={endPattern:endPattern,messages:that.options.messages.end};kendo.destroy(that._container),that._container.html(RECURRENCE_END_PATTERN_TEMPLATE(data)),that._initCount(),that._initUntil()},_initWeekDay:function(){var data,that=this,weekdayMessage=that.options.messages.weekdays,offsetMessage=that.options.messages.offsetPositions,weekDaySelect=that._container.find(".k-recur-weekday"),change=function(){that._weekDayRule(),that.trigger("change")};weekDaySelect[0]&&(that._weekDayOffset=that._container.find(".k-recur-weekday-offset").html(that._options([{text:offsetMessage.first,value:"1"},{text:offsetMessage.second,value:"2"},{text:offsetMessage.third,value:"3"},{text:offsetMessage.fourth,value:"4"},{text:offsetMessage.last,value:"-1"}])).change(change),data=[{text:weekdayMessage.day,value:"day"},{text:weekdayMessage.weekday,value:"weekday"},{text:weekdayMessage.weekend,value:"weekend"}],data=data.concat($.map(kendo.culture().calendar.days.names,function(dayName,idx){return{text:dayName,value:idx}})),that._weekDay=weekDaySelect.html(that._options(data)).change(change).val(that.options.start.getDay()),that._weekDayView())},_initMonth:function(){var that=this,rule=that._value,start=that.options.start,month=rule.months||[start.getMonth()+1],monthSelect=that._container.find(".k-recur-month"),monthNames=kendo.culture().calendar.months.names;if(monthSelect[0]){var data=$.map(monthNames,function(monthName,idx){return{text:monthName,value:idx+1}});monthSelect.html(that._options(data)).change(function(){rule.months=[Number(this.value)]}),that._monthSelect=monthSelect,month&&monthSelect.val(month[0])}},_period:function(){var that=this,rule=that._value,container=that._container,messages=that.options.messages[rule.freq],repeatRuleGroupButton=container.find(".k-repeat-rule"),weekDayView=container.find(".k-weekday-view"),monthDayView=container.find(".k-monthday-view");if(repeatRuleGroupButton[0]){var currentValue=rule.weekDays?"weekday":"monthday",html=RECURRENCE_GROUP_BUTTON_TEMPLATE({value:currentValue,dataSource:[{text:messages.dayOfMonth,value:"monthday"},{text:messages.dayOfWeek,value:"weekday"}],ns:kendo.ns}),init=function(val){var weekDayName=that._weekDay.val(),weekDayOffset=that._weekDayOffset.val(),monthDay=that._monthDay.value(),month=that._monthSelect?that._monthSelect.val():null;"monthday"===val?(rule.weekDays=null,rule.monthDays=monthDay?[monthDay]:monthDay,rule.months=month?[Number(month)]:month,weekDayView.hide(),monthDayView.show()):(rule.monthDays=null,rule.months=month?[Number(month)]:month,rule.weekDays=[{offset:Number(weekDayOffset),day:Number(weekDayName)}],weekDayView.show(),monthDayView.hide())};repeatRuleGroupButton.append(html).on(CLICK+that._namespace,".k-scheduler-navigation li",function(e){var li=$(this).addClass("k-state-selected");e.preventDefault(),li.siblings().removeClass("k-state-selected");var value=li.children("a").attr(kendo.attr("value"));init(value)}),init(currentValue)}},_initUntil:function(){var that=this,input=that._container.find(".k-recur-until"),start=that.options.start,rule=that._value,until=rule.until,min=until&&until<start?until:start;kendo.support.input.date?that._until=input.attr("min",kendo.toString(min,"yyyy-MM-dd")).val(kendo.toString(until||start,"yyyy-MM-dd")).on("change",function(){rule.until=kendo.parseDate(this.value,"yyyy-MM-dd")}):that._until=input.kendoDatePicker({min:min,value:until||start,change:function(){rule.until=this.value()}}).data("kendoDatePicker")},_options:function(data,optionLabel){var idx=0,html="",length=data.length,template=this._optionTemplate;for(optionLabel&&(html+=template({value:"",text:optionLabel}));idx<length;idx++)html+=template(data[idx]);return html}});ui.plugin(MobileRecurrenceEditor)}(window.kendo.jQuery),function($,undefined){function timezoneButtonText(model,message){return message=message||"",model.startTimezone&&(message=model.startTimezone,model.endTimezone&&(message+=" | "+model.endTimezone)),message}function appendTimezoneAttr(attrs,options){var timezone=options.timezone;timezone&&(attrs[kendo.attr("timezone")]=timezone)}function appendDateCompareValidator(attrs,options){var validationRules=options.model.fields[options.field].validation;if(validationRules){var dateCompareRule=validationRules.dateCompare;dateCompareRule&&isPlainObject(dateCompareRule)&&dateCompareRule.message&&(attrs[kendo.attr("dateCompare-msg")]=dateCompareRule.message)}}function wrapDataAccess(originalFunction,timezone){return function(data){return data=originalFunction(data),convertData(data,"apply",timezone),data||[]}}function wrapDataSerialization(originalFunction,timezone){return function(data){return data&&("[object Array]"===toString.call(data)||data instanceof kendo.data.ObservableArray||(data=[data])),convertData(data,"remove",timezone,!0),data=originalFunction(data),data||[]}}function convertData(data,method,timezone,removeUid){var event,idx,length;for(data=data||[],idx=0,length=data.length;idx<length;idx++)event=data[idx],removeUid?event.startTimezone||event.endTimezone?timezone?(event.start=kendo.timezone.convert(event.start,event.startTimezone||event.endTimezone,timezone),event.end=kendo.timezone.convert(event.end,event.endTimezone||event.startTimezone,timezone),event.start=kendo.timezone[method](event.start,timezone),event.end=kendo.timezone[method](event.end,timezone)):(event.start=kendo.timezone[method](event.start,event.startTimezone||event.endTimezone),event.end=kendo.timezone[method](event.end,event.endTimezone||event.startTimezone)):timezone&&(event.start=kendo.timezone[method](event.start,timezone),event.end=kendo.timezone[method](event.end,timezone)):event.startTimezone||event.endTimezone?(event.start=kendo.timezone[method](event.start,event.startTimezone||event.endTimezone),event.end=kendo.timezone[method](event.end,event.endTimezone||event.startTimezone),timezone&&(event.start=kendo.timezone.convert(event.start,event.startTimezone||event.endTimezone,timezone),event.end=kendo.timezone.convert(event.end,event.endTimezone||event.startTimezone,timezone))):timezone&&(event.start=kendo.timezone[method](event.start,timezone),event.end=kendo.timezone[method](event.end,timezone)),removeUid&&delete event.uid;return data}function getOccurrenceByUid(data,uid){for(var event,length=data.length,idx=0;idx<length;idx++)if(event=data[idx],event.uid===uid)return event}function applyZone(date,fromZone,toZone){return date=toZone?kendo.timezone.convert(date,fromZone,toZone):kendo.timezone.remove(date,fromZone)}function dateCompareValidator(input){if(input.filter("[name=end]").length){var container=input.closest(".k-scheduler-edit-form"),startInput=container.find("[name=start]:visible"),endInput=container.find("[name=end]:visible");if(endInput[0]&&startInput[0]){var start,end,startPicker=kendo.widgetInstance(startInput,kendo.ui),endPicker=kendo.widgetInstance(endInput,kendo.ui),editable=container.data("kendoEditable"),model=editable?editable.options.model:null;if(startPicker&&endPicker?(start=startPicker.value(),end=endPicker.value()):(start=kendo.parseDate(startInput.val()),end=kendo.parseDate(endInput.val())),start&&end){if(model){var timezone=startInput.attr(kendo.attr("timezone")),startTimezone=model.startTimezone,endTimezone=model.endTimezone;startTimezone=startTimezone||endTimezone,endTimezone=endTimezone||startTimezone,startTimezone&&(start=applyZone(start,startTimezone,timezone),end=applyZone(end,endTimezone,timezone))}return start<=end}}}return!0}function expandAll(events,start,end,zone){for(var length=events.length,data=[],idx=0;idx<length;idx++)data=data.concat(events[idx].expand(start,end,zone));return data}function trimOptions(options){return delete options.name,delete options.prefix,delete options.remove,delete options.edit,delete options.add,delete options.navigate,options}function dropDownResourceEditor(resource){return function(container){$(kendo.format('<select data-{0}bind="value:{1}">',kendo.ns,resource.field)).appendTo(container).kendoDropDownList({dataTextField:resource.dataTextField,dataValueField:resource.dataValueField,dataSource:resource.dataSource,valuePrimitive:resource.valuePrimitive,optionLabel:"None",template:kendo.format('<span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#',resource.dataColorField,resource.dataTextField)})}}function multiSelectResourceEditor(resource){return function(container){$(kendo.format('<select data-{0}bind="value:{1}">',kendo.ns,resource.field)).appendTo(container).kendoMultiSelect({dataTextField:resource.dataTextField,dataValueField:resource.dataValueField,dataSource:resource.dataSource,valuePrimitive:resource.valuePrimitive,itemTemplate:kendo.format('<span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#',resource.dataColorField,resource.dataTextField),tagTemplate:kendo.format('<span class="k-scheduler-mark" style="background-color:#= data.{0}?{0}:"none" #"></span>#={1}#',resource.dataColorField,resource.dataTextField)})}}function multiSelectResourceEditorMobile(resource){return function(container){for(var options="",view=resource.dataSource.view(),idx=0,length=view.length;idx<length;idx++)options+=kendo.format('<option value="{0}">{1}</option>',kendo.getter(resource.dataValueField)(view[idx]),kendo.getter(resource.dataTextField)(view[idx]));$(kendo.format('<select data-{0}bind="value:{1}" multiple="multiple" data-{0}value-primitive="{3}">{2}</select>',kendo.ns,resource.field,options,resource.valuePrimitive)).appendTo(container)}}function moveEventRange(event,distance){var duration=event.end.getTime()-event.start.getTime(),start=new Date(event.start.getTime());kendo.date.setTime(start,distance);var end=new Date(start.getTime());return kendo.date.setTime(end,duration,!0),{start:start,end:end}}var kendo=window.kendo,date=kendo.date,input_support=kendo.support.input,MS_PER_DAY=date.MS_PER_DAY,getDate=date.getDate,getMilliseconds=kendo.date.getMilliseconds,recurrence=kendo.recurrence,keys=kendo.keys,ui=kendo.ui,Widget=ui.Widget,STRING="string",Popup=ui.Popup,Calendar=ui.Calendar,DataSource=kendo.data.DataSource,isPlainObject=$.isPlainObject,extend=$.extend,proxy=$.proxy,toString=Object.prototype.toString,isArray=$.isArray,NS=".kendoScheduler",CLICK="click",CHANGE="change",CANCEL="cancel",REMOVE="remove",SAVE="save",ADD="add",EDIT="edit",valueStartEndBoundRegex=/(?:value:start|value:end)(?:,|$)/,TODAY=getDate(new Date),RECURRENCE_EXCEPTION="recurrenceException",DELETECONFIRM="Are you sure you want to delete this event?",DELETERECURRING="Do you want to delete only this event occurrence or the whole series?",EDITRECURRING="Do you want to edit only this event occurrence or the whole series?",COMMANDBUTTONTMPL='<a class="k-button #=className#" #=attr# href="\\#">#=text#</a>',TOOLBARTEMPLATE=kendo.template('<div class="k-floatwrap k-header k-scheduler-toolbar"><ul class="k-reset k-header k-toolbar k-scheduler-navigation"><li class="k-state-default k-nav-today"><a role="button" href="\\#" class="k-link">${messages.today}</a></li><li class="k-state-default k-nav-prev"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-arrow-w"></span></a></li><li class="k-state-default k-nav-next"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-arrow-e"></span></a></li><li class="k-state-default k-nav-current"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-calendar"></span><span data-#=ns#bind="text: formattedDate"></span></a></li></ul><ul class="k-reset k-header k-toolbar k-scheduler-views">#for(var view in views){#<li class="k-state-default k-view-#= view.toLowerCase() #" data-#=ns#name="#=view#"><a role="button" href="\\#" class="k-link">${views[view].title}</a></li>#}#</ul></div>'),MOBILETOOLBARTEMPLATE=kendo.template('<div class="k-floatwrap k-header k-scheduler-toolbar"><ul class="k-reset k-header k-toolbar k-scheduler-navigation"><li class="k-state-default k-nav-today"><a role="button" href="\\#" class="k-link">${messages.today}</a></li></ul><ul class="k-reset k-header k-toolbar k-scheduler-views">#for(var view in views){#<li class="k-state-default k-view-#= view.toLowerCase() #" data-#=ns#name="#=view#"><a role="button" href="\\#" class="k-link">${views[view].title}</a></li>#}#</ul></div><div class="k-floatwrap k-header k-scheduler-toolbar"><ul class="k-reset k-header k-toolbar k-scheduler-navigation"><li class="k-state-default k-nav-prev"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-arrow-w"></span></a></li><li class="k-state-default k-nav-current"><span data-#=ns#bind="text: formattedDate"></span></li><li class="k-state-default k-nav-next"><a role="button" href="\\#" class="k-link"><span class="k-icon k-i-arrow-e"></span></a></li></ul></div>'),MOBILEDATERANGEEDITOR=function(container,options){
var attr={name:options.field},datepicker_role=input_support.date?"":kendo.attr("role")+'="datepicker" ',datetimepicker_role=kendo.attr("role")+'="datetimepicker" ',isAllDay=options.model.isAllDay,dateTimeValidate=kendo.attr("validate")+"='"+!isAllDay+"'",dateValidate=kendo.attr("validate")+"='"+isAllDay+"'";appendTimezoneAttr(attr,options),appendDateCompareValidator(attr,options),$('<input type="datetime-local" required '+kendo.attr("type")+'="date" '+datetimepicker_role+kendo.attr("bind")+'="value:'+options.field+',invisible:isAllDay" '+dateTimeValidate+"/>").attr(attr).appendTo(container),$('<input type="date" required '+kendo.attr("type")+'="date" '+datepicker_role+kendo.attr("bind")+'="value:'+options.field+',visible:isAllDay" '+dateValidate+"/>").attr(attr).appendTo(container),$("<span "+kendo.attr("for")+'="'+options.field+'" class="k-invalid-msg"/>').hide().appendTo(container)},DATERANGEEDITOR=function(container,options){var attr={name:options.field},isAllDay=options.model.isAllDay,dateTimeValidate=kendo.attr("validate")+"='"+!isAllDay+"' ",dateValidate=kendo.attr("validate")+"='"+isAllDay+"' ";appendTimezoneAttr(attr,options),appendDateCompareValidator(attr,options),$('<input type="text" required '+kendo.attr("type")+'="date" '+kendo.attr("role")+'="datetimepicker" '+kendo.attr("bind")+'="value:'+options.field+',invisible:isAllDay" '+dateTimeValidate+"/>").attr(attr).appendTo(container),$('<input type="text" required '+kendo.attr("type")+'="date" '+kendo.attr("role")+'="datepicker" '+kendo.attr("bind")+'="value:'+options.field+',visible:isAllDay" '+dateValidate+"/>").attr(attr).appendTo(container),$("<span "+kendo.attr("bind")+'="text: '+options.field+'Timezone"></span>').appendTo(container),"end"===options.field&&$("<span "+kendo.attr("bind")+'="text: startTimezone, invisible: endTimezone"></span>').appendTo(container),$("<span "+kendo.attr("for")+'="'+options.field+'" class="k-invalid-msg"/>').hide().appendTo(container)},RECURRENCEEDITOR=function(container,options){$("<div "+kendo.attr("bind")+'="value:'+options.field+'" />').attr({name:options.field}).appendTo(container).kendoRecurrenceEditor({start:options.model.start,timezone:options.timezone,messages:options.messages})},MOBILERECURRENCEEDITOR=function(container,options){$("<div "+kendo.attr("bind")+'="value:'+options.field+'" />').attr({name:options.field}).appendTo(container).kendoMobileRecurrenceEditor({start:options.model.start,timezone:options.timezone,messages:options.messages,pane:options.pane,value:options.model[options.field]})},MOBILETIMEZONEPOPUP=function(container,options){var text=timezoneButtonText(options.model,options.messages.noTimezone);$('<a href="#" class="k-button k-timezone-button" data-bind="invisible:isAllDay">'+text+"</a>").click(options.click).appendTo(container)},TIMEZONEPOPUP=function(container,options){$('<a href="#" class="k-button" data-bind="invisible:isAllDay">'+options.messages.timezoneEditorButton+"</a>").click(options.click).appendTo(container)},MOBILETIMEZONEEDITOR=function(container,options){$("<div "+kendo.attr("bind")+'="value:'+options.field+'" />').attr({name:options.field}).toggle(options.visible).appendTo(container).kendoMobileTimezoneEditor({optionLabel:options.noTimezone})},TIMEZONEEDITOR=function(container,options){$("<div "+kendo.attr("bind")+'="value:'+options.field+'" />').attr({name:options.field}).toggle(options.visible).appendTo(container).kendoTimezoneEditor({optionLabel:options.noTimezone})},SchedulerDataReader=kendo.Class.extend({init:function(schema,reader){var timezone=schema.timezone;this.reader=reader,reader.model&&(this.model=reader.model),this.timezone=timezone,this.data=wrapDataAccess($.proxy(this.data,this),timezone),this.serialize=wrapDataSerialization($.proxy(this.serialize,this),timezone)},errors:function(data){return this.reader.errors(data)},parse:function(data){return this.reader.parse(data)},data:function(data){return this.reader.data(data)},total:function(data){return this.reader.total(data)},groups:function(data){return this.reader.groups(data)},aggregates:function(data){return this.reader.aggregates(data)},serialize:function(data){return this.reader.serialize(data)}}),SchedulerEvent=kendo.data.Model.define({init:function(value){var that=this;kendo.data.Model.fn.init.call(that,value),that._defaultId=that.defaults[that.idField]},_time:function(field){var date=this[field],fieldTime=field+"Time";return this[fieldTime]?this[fieldTime]-kendo.date.toUtcTime(kendo.date.getDate(date)):getMilliseconds(date)},_date:function(field){var fieldTime=field+"Time";return this[fieldTime]?this[fieldTime]-this._time(field):kendo.date.getDate(this[field])},clone:function(options,updateUid){var uid=this.uid,event=new this.constructor($.extend({},this.toJSON(),options));return updateUid||(event.uid=uid),event},duration:function(){var end=this.end,start=this.start,offset=(end.getTimezoneOffset()-start.getTimezoneOffset())*kendo.date.MS_PER_MINUTE;return end-start-offset},expand:function(start,end,zone){return recurrence?recurrence.expand(this,start,end,zone):[this]},update:function(eventInfo){for(var field in eventInfo)this.set(field,eventInfo[field]);this.startTime&&this.set("startTime",kendo.date.toUtcTime(this.start)),this.endTime&&this.set("endTime",kendo.date.toUtcTime(this.end))},isMultiDay:function(){return this.isAllDay||this.duration()>=kendo.date.MS_PER_DAY},isException:function(){return!this.isNew()&&this.recurrenceId},isOccurrence:function(){return this.isNew()&&this.recurrenceId},isRecurring:function(){return!(!this.recurrenceRule&&!this.recurrenceId)},isRecurrenceHead:function(){return!(!this.id||!this.recurrenceRule)},toOccurrence:function(options){return options=$.extend(options,{recurrenceException:null,recurrenceRule:null,recurrenceId:this.id||this.recurrenceId}),options[this.idField]=this.defaults[this.idField],this.clone(options,!0)},toJSON:function(){var obj=kendo.data.Model.fn.toJSON.call(this);return obj.uid=this.uid,delete obj.startTime,delete obj.endTime,obj},shouldSerialize:function(field){return kendo.data.Model.fn.shouldSerialize.call(this,field)&&"_defaultId"!==field},set:function(key,value){var isAllDay=this.isAllDay||!1;if(kendo.data.Model.fn.set.call(this,key,value),"isAllDay"==key&&value!=isAllDay){var start=kendo.date.getDate(this.start),end=new Date(this.end),milliseconds=kendo.date.getMilliseconds(end);0===milliseconds&&value&&(milliseconds=MS_PER_DAY),this.set("start",start),value===!0?(kendo.date.setTime(end,-milliseconds),end<start&&(end=start)):kendo.date.setTime(end,MS_PER_DAY-milliseconds),this.set("end",end)}},id:"id",fields:{id:{type:"number"},title:{defaultValue:"",type:"string"},start:{type:"date",validation:{required:!0}},startTimezone:{type:"string"},end:{type:"date",validation:{required:!0,dateCompare:{value:dateCompareValidator,message:"End date should be greater than or equal to the start date"}}},endTimezone:{type:"string"},recurrenceRule:{defaultValue:"",type:"string"},recurrenceException:{defaultValue:"",type:"string"},isAllDay:{type:"boolean",defaultValue:!1},description:{type:"string"}}}),SchedulerDataSource=DataSource.extend({init:function(options){DataSource.fn.init.call(this,extend(!0,{},{schema:{modelBase:SchedulerEvent,model:SchedulerEvent}},options)),this.reader=new SchedulerDataReader(this.options.schema,this.reader)},expand:function(start,end){var data=this.view(),filter={};return start&&end&&(end=new Date(end.getTime()+MS_PER_DAY-1),filter={logic:"or",filters:[{logic:"and",filters:[{field:"start",operator:"gte",value:start},{field:"end",operator:"gte",value:start},{field:"start",operator:"lte",value:end}]},{logic:"and",filters:[{field:"start",operator:"lte",value:new Date(start.getTime()+MS_PER_DAY-1)},{field:"end",operator:"gte",value:start}]}]},data=new kendo.data.Query(expandAll(data,start,end,this.reader.timezone)).filter(filter).toArray()),data},cancelChanges:function(model){model&&model.isOccurrence()&&this._removeExceptionDate(model),DataSource.fn.cancelChanges.call(this,model)},insert:function(index,model){if(model){if(!(model instanceof SchedulerEvent)){var eventInfo=model;model=this._createNewModel(),model.accept(eventInfo)}return(model.isRecurrenceHead()||model.recurrenceId)&&(model=model.recurrenceId?model:model.toOccurrence(),this._addExceptionDate(model)),DataSource.fn.insert.call(this,index,model)}},remove:function(model){return model.isRecurrenceHead()?this._removeExceptions(model):model.isRecurring()&&this._addExceptionDate(model),DataSource.fn.remove.call(this,model)},_removeExceptions:function(model){for(var data=this.data().slice(0),item=data.shift(),id=model.id;item;)item.recurrenceId===id&&DataSource.fn.remove.call(this,item),item=data.shift();model.set(RECURRENCE_EXCEPTION,"")},_removeExceptionDate:function(model){if(model.recurrenceId){var head=this.get(model.recurrenceId);if(head){var start=model.start;head.set(RECURRENCE_EXCEPTION,head.recurrenceException.replace(recurrence.toExceptionString(start,this.reader.timezone),""))}}},_addExceptionDate:function(model){var start=model.start,zone=this.reader.timezone,head=this.get(model.recurrenceId),recurrenceException=head.recurrenceException||"";recurrence.isException(recurrenceException,start,zone)||head.set(RECURRENCE_EXCEPTION,recurrenceException+recurrence.toExceptionString(start,zone))}});SchedulerDataSource.create=function(options){options=options&&options.push?{data:options}:options;var dataSource=options||{},data=dataSource.data;if(dataSource.data=data,!(dataSource instanceof SchedulerDataSource)&&dataSource instanceof kendo.data.DataSource)throw new Error("Incorrect DataSource type. Only SchedulerDataSource instances are supported");return dataSource instanceof SchedulerDataSource?dataSource:new SchedulerDataSource(dataSource)},extend(!0,kendo.data,{SchedulerDataSource:SchedulerDataSource,SchedulerDataReader:SchedulerDataReader,SchedulerEvent:SchedulerEvent});var defaultCommands={update:{text:"Save",className:"k-primary k-scheduler-update"},canceledit:{text:"Cancel",className:"k-scheduler-cancel"},destroy:{text:"Delete",imageClass:"k-delete",className:"k-primary k-scheduler-delete",iconClass:"k-icon"}},editors={mobile:{dateRange:MOBILEDATERANGEEDITOR,timezonePopUp:MOBILETIMEZONEPOPUP,timezone:MOBILETIMEZONEEDITOR,recurrence:MOBILERECURRENCEEDITOR,description:'<textarea name="description" class="k-textbox"/>',multipleResources:multiSelectResourceEditorMobile,resources:dropDownResourceEditor},desktop:{dateRange:DATERANGEEDITOR,timezonePopUp:TIMEZONEPOPUP,timezone:TIMEZONEEDITOR,recurrence:RECURRENCEEDITOR,description:'<textarea name="description" class="k-textbox"/>',multipleResources:multiSelectResourceEditor,resources:dropDownResourceEditor}},Editor=kendo.Observable.extend({init:function(element,options){kendo.Observable.fn.init.call(this),this.element=element,this.options=extend(!0,{},this.options,options),this.createButton=this.options.createButton,this.toggleDateValidationHandler=proxy(this._toggleDateValidation,this)},_toggleDateValidation:function(e){if("isAllDay"==e.field){var element,isDateTimeInput,shouldValidate,container=this.container,isAllDay=this.editable.options.model.isAllDay,bindAttribute=kendo.attr("bind");container.find("["+bindAttribute+"*=end],["+bindAttribute+"*=start]").each(function(){element=$(this),valueStartEndBoundRegex.test(element.attr(bindAttribute))&&(isDateTimeInput=element.is("["+kendo.attr("role")+"=datetimepicker],[type*=datetime]"),shouldValidate=isAllDay!==isDateTimeInput,element.attr(kendo.attr("validate"),shouldValidate))})}},fields:function(editors,model){var that=this,messages=that.options.messages,timezone=that.options.timezone,click=function(e){e.preventDefault(),that._initTimezoneEditor(model,this)},fields=[{field:"title",title:messages.editor.title},{field:"start",title:messages.editor.start,editor:editors.dateRange,timezone:timezone},{field:"end",title:messages.editor.end,editor:editors.dateRange,timezone:timezone},{field:"isAllDay",title:messages.editor.allDayEvent}];kendo.timezone.windows_zones&&(fields.push({field:"timezone",title:messages.editor.timezone,editor:editors.timezonePopUp,click:click,messages:messages.editor,model:model}),fields.push({field:"startTimezone",title:messages.editor.startTimezone,editor:editors.timezone,noTimezone:messages.editor.noTimezone}),fields.push({field:"endTimezone",title:messages.editor.endTimezone,editor:editors.timezone,noTimezone:messages.editor.noTimezone})),model.recurrenceId||fields.push({field:"recurrenceRule",title:messages.editor.repeat,editor:editors.recurrence,timezone:timezone,messages:messages.recurrenceEditor,pane:this.pane}),"description"in model&&fields.push({field:"description",title:messages.editor.description,editor:editors.description});for(var resourceIndex=0;resourceIndex<this.options.resources.length;resourceIndex++){var resource=this.options.resources[resourceIndex];fields.push({field:resource.field,title:resource.title,editor:resource.multiple?editors.multipleResources(resource):editors.resources(resource)})}return fields},end:function(){return this.editable.end()},_buildEditTemplate:function(model,fields,editableFields){var messages=this.options.messages,settings=extend({},kendo.Template,this.options.templateSettings),paramName=settings.paramName,template=this.options.editable.template,html="";if(template)typeof template===STRING&&(template=window.unescape(template)),html+=kendo.template(template,settings)(model);else for(var idx=0,length=fields.length;idx<length;idx++){var field=fields[idx];if("startTimezone"===field.field&&(html+='<div class="k-popup-edit-form k-scheduler-edit-form k-scheduler-timezones" style="display:none">',html+='<div class="k-edit-form-container">',html+='<div class="k-edit-label"></div>',html+='<div class="k-edit-field"><label class="k-check"><input class="k-timezone-toggle" type="checkbox" />'+messages.editor.separateTimezones+"</label></div>"),html+='<div class="k-edit-label"><label for="'+field.field+'">'+(field.title||field.field||"")+"</label></div>",!model.editable||model.editable(field.field))editableFields.push(field),html+="<div "+kendo.attr("container-for")+'="'+field.field+'" class="k-edit-field"></div>';else{var tmpl="#:";field.field?(field=kendo.expr(field.field,paramName),tmpl+=field+"==null?'':"+field):tmpl+="''",tmpl+="#",tmpl=kendo.template(tmpl,settings),html+='<div class="k-edit-field">'+tmpl(model)+"</div>"}"endTimezone"===field.field&&(html+=this._createEndTimezoneButton())}return html},_createEndTimezoneButton:function(){return"</div></div>"},_revertTimezones:function(model){model.set("startTimezone",this._startTimezone),model.set("endTimezone",this._endTimezone),delete this._startTimezone,delete this._endTimezone}}),MobileEditor=Editor.extend({init:function(){Editor.fn.init.apply(this,arguments),this.pane=kendo.mobile.ui.Pane.wrap(this.element),this.pane.element.parent().css("height",this.options.height),this.view=this.pane.view(),this._actionSheetButtonTemplate=kendo.template('<li><a #=attr# class="k-button #=className#" href="\\#">#:text#</a></li>'),this._actionSheetPopupOptions=$(document.documentElement).hasClass("km-root")?{modal:!1}:{align:"bottom center",position:"bottom center",effect:"slideIn:up"}},options:{animations:{left:"slide",right:"slide:right"}},destroy:function(){this.close(),this.unbind(),this.pane.destroy()},_initTimezoneEditor:function(model){var that=this,pane=that.pane,messages=that.options.messages,timezoneView=that.timezoneView,container=that.container.find(".k-scheduler-timezones"),checkbox=container.find(".k-timezone-toggle"),endTimezoneRow=container.find(".k-edit-label:last").add(container.find(".k-edit-field:last")),startTimezoneChange=function(e){if("startTimezone"===e.field){var value=model.startTimezone;checkbox.prop("disabled",!value),value||(endTimezoneRow.hide(),model.set("endTimezone",""),checkbox.prop("checked",!1))}};if(that._startTimezone=model.startTimezone||"",that._endTimezone=model.endTimezone||"",!timezoneView){var html='<div data-role="view" class="k-popup-edit-form k-scheduler-edit-form k-mobile-list"><div data-role="header" class="k-header"><a href="#" class="k-button k-scheduler-cancel">'+messages.cancel+"</a>"+messages.editor.timezoneTitle+'<a href="#" class="k-button k-scheduler-update">'+messages.save+"</a></div></div>";this.timezoneView=timezoneView=pane.append(html),timezoneView.contentElement().append(container.show()),timezoneView.element.on(CLICK+NS,".k-scheduler-cancel, .k-scheduler-update",function(e){e.preventDefault(),e.stopPropagation(),$(this).hasClass("k-scheduler-cancel")&&that._revertTimezones(model),model.unbind("change",startTimezoneChange);var editView=pane.element.find("#edit").data("kendoMobileView"),text=timezoneButtonText(model,messages.editor.noTimezone);editView.contentElement().find(".k-timezone-button").text(text),pane.navigate(editView,that.options.animations.right)}),checkbox.click(function(){endTimezoneRow.toggle(checkbox.prop("checked")),model.set("endTimezone","")}),model.bind("change",startTimezoneChange)}checkbox.prop("checked",model.endTimezone).prop("disabled",!model.startTimezone),model.endTimezone?endTimezoneRow.show():endTimezoneRow.hide(),pane.navigate(timezoneView,that.options.animations.left)},_createActionSheetButton:function(options){return options.template=this._actionSheetButtonTemplate,this.createButton(options)},showDialog:function(options){var type="",html='<ul><li class="km-actionsheet-title">'+options.title+"</li>",target=this.element.find(".k-event["+kendo.attr("uid")+"='"+options.model.uid+"']");this.container&&(target=this.container.find(".k-scheduler-delete"),target[0]&&(type="phone"));for(var buttonIndex=0;buttonIndex<options.buttons.length;buttonIndex++)html+=this._createActionSheetButton(options.buttons[buttonIndex]);html+="</ul>";var actionSheet=$(html).appendTo(this.pane.view().element).kendoMobileActionSheet({type:type,cancel:this.options.messages.cancel,cancelTemplate:'<li class="km-actionsheet-cancel"><a class="k-button" href="\\#">#:cancel#</a></li>',close:function(){this.destroy()},command:function(e){var buttonIndex=actionSheet.element.find("li:not(.km-actionsheet-cancel) > .k-button").index($(e.currentTarget));buttonIndex>-1&&(actionSheet.close(),options.buttons[buttonIndex].click())},popup:this._actionSheetPopupOptions}).data("kendoMobileActionSheet");actionSheet.open(target)},editEvent:function(model){var pane=this.pane,html="",messages=this.options.messages,updateText=messages.save,removeText=messages.destroy,cancelText=messages.cancel,titleText=messages.editor.editorTitle;html+='<div data-role="view" class="k-popup-edit-form k-scheduler-edit-form k-mobile-list" id="edit" '+kendo.attr("uid")+'="'+model.uid+'"><div data-role="header" class="k-header"><a href="#" class="k-button k-scheduler-cancel">'+cancelText+"</a>"+titleText+'<a href="#" class="k-button k-scheduler-update">'+updateText+"</a></div>";var fields=this.fields(editors.mobile,model),that=this,editableFields=[];html+=this._buildEditTemplate(model,fields,editableFields),!model.isNew()&&this.options.editable&&this.options.editable.destroy!==!1&&(html+='<div class="k-edit-buttons"><a href="#" class="k-scheduler-delete k-button">'+removeText+"</a></div>"),html+="</div>";var view=pane.append(html),container=this.container=view.element;return this.editable=container.kendoEditable({fields:editableFields,model:model,clearContainer:!1,validateOnBlur:!0}).data("kendoEditable"),container.find("input[type=checkbox],input[type=radio]").parent(".k-edit-field").addClass("k-check").prev(".k-edit-label").addClass("k-check").click(function(){$(this).next().children("input").click()}),this.trigger("edit",{container:container,model:model})?this.trigger("cancel",{container:container,model:model}):(container.on(CLICK+NS,"a.k-scheduler-edit, a.k-scheduler-cancel, a.k-scheduler-update, a.k-scheduler-delete",function(e){e.preventDefault(),e.stopPropagation();var button=$(this);if(button.hasClass("k-scheduler-edit"))pane.navigate("#edit",that.options.animations.right);else{var name="cancel";button.hasClass("k-scheduler-update")?name="save":button.hasClass("k-scheduler-delete")&&(name="remove"),that.trigger(name,{container:container,model:model})}}),pane.navigate(view,that.options.animations.left),model.bind("change",that.toggleDateValidationHandler)),this.editable},_views:function(){return this.pane.element.find(kendo.roleSelector("view")).not(this.view.element)},close:function(){if(this.container){this.pane.navigate("",this.options.animations.right);for(var view,views=this._views(),idx=0,length=views.length;idx<length;idx++)view=views.eq(idx).data("kendoMobileView"),view&&view.purge();views.remove(),this.container=null,this.editable&&(this.editable.options.model.unbind("change",this.toggleDateValidationHandler),this.editable.destroy(),this.editable=null),this.timezoneView=null}}}),PopupEditor=Editor.extend({destroy:function(){this.close(),this.unbind()},editEvent:function(model){return this.editable=this._createPopupEditor(model),this.editable},close:function(){var that=this,destroy=function(){that.editable&&(that.editable.options.model.unbind("change",that.toggleDateValidationHandler),that.editable.destroy(),that.editable=null,that.container=null),that.popup&&(that.popup.destroy(),that.popup=null)};that.editable?(that._timezonePopup&&that._timezonePopup.data("kendoWindow")&&(that._timezonePopup.data("kendoWindow").destroy(),that._timezonePopup=null),that.container.is(":visible")?that.container.data("kendoWindow").bind("deactivate",destroy).close():destroy()):destroy()},_createEndTimezoneButton:function(){var messages=this.options.messages,html="";return html+='<div class="k-edit-buttons k-state-default">',html+=this.createButton({name:"savetimezone",text:messages.save})+this.createButton({name:"canceltimezone",text:messages.cancel}),html+="</div></div></div>"},showDialog:function(options){var html=kendo.format("<div class='k-popup-edit-form'><div class='k-edit-form-container'><p class='k-popup-message'>{0}</p>",options.text);html+='<div class="k-edit-buttons k-state-default">';for(var buttonIndex=0;buttonIndex<options.buttons.length;buttonIndex++)html+=this.createButton(options.buttons[buttonIndex]);html+="</div></div></div>";var wrapper=this.element;this.popup&&this.popup.destroy();var popup=this.popup=$(html).appendTo(wrapper).eq(0).on("click",".k-button",function(e){e.preventDefault(),popup.close();var buttonIndex=$(e.currentTarget).index();options.buttons[buttonIndex].click()}).kendoWindow({modal:!0,resizable:!1,draggable:!1,title:options.title,visible:!1,close:function(){this.destroy(),wrapper.focus()}}).getKendoWindow();popup.center().open()},_createPopupEditor:function(model){var that=this,editable=that.options.editable,html="<div "+kendo.attr("uid")+'="'+model.uid+'" class="k-popup-edit-form k-scheduler-edit-form"><div class="k-edit-form-container">',messages=that.options.messages,updateText=messages.save,cancelText=messages.cancel,deleteText=messages.destroy,fields=this.fields(editors.desktop,model),editableFields=[];html+=this._buildEditTemplate(model,fields,editableFields);var attr,options=isPlainObject(editable)?editable.window:{};html+='<div class="k-edit-buttons k-state-default">',html+=this.createButton({name:"update",text:updateText,attr:attr})+this.createButton({name:"canceledit",text:cancelText,attr:attr}),model.isNew()||editable.destroy===!1||(html+=this.createButton({name:"delete",text:deleteText,attr:attr})),html+="</div></div></div>";var container=this.container=$(html).appendTo(that.element).eq(0).kendoWindow(extend({modal:!0,resizable:!1,draggable:!0,title:messages.editor.editorTitle,visible:!1,close:function(e){e.userTriggered&&that.trigger(CANCEL,{container:container,model:model})&&e.preventDefault()}},options)),editableWidget=container.kendoEditable({fields:editableFields,model:model,clearContainer:!1,validateOnBlur:!0}).data("kendoEditable");return that.trigger(EDIT,{container:container,model:model})?that.trigger(CANCEL,{container:container,model:model}):(container.data("kendoWindow").center().open(),container.on(CLICK+NS,"a.k-scheduler-cancel",function(e){e.preventDefault(),e.stopPropagation(),that.trigger(CANCEL,{container:container,model:model})}),container.on(CLICK+NS,"a.k-scheduler-update",function(e){e.preventDefault(),e.stopPropagation(),that.trigger("save",{container:container,model:model})}),container.on(CLICK+NS,"a.k-scheduler-delete",function(e){e.preventDefault(),e.stopPropagation(),that.trigger(REMOVE,{container:container,model:model})}),model.bind("change",that.toggleDateValidationHandler)),editableWidget},_initTimezoneEditor:function(model,activator){var wnd,that=this,container=that.container.find(".k-scheduler-timezones"),checkbox=container.find(".k-timezone-toggle"),endTimezoneRow=container.find(".k-edit-label:last").add(container.find(".k-edit-field:last")),saveButton=container.find(".k-scheduler-savetimezone"),cancelButton=container.find(".k-scheduler-canceltimezone"),timezonePopup=that._timezonePopup,startTimezoneChange=function(e){if("startTimezone"===e.field){var value=model.startTimezone;checkbox.prop("disabled",!value),value||(endTimezoneRow.hide(),model.set("endTimezone",""),checkbox.prop("checked",!1))}};that._startTimezone=model.startTimezone,that._endTimezone=model.endTimezone,timezonePopup||(that._timezonePopup=timezonePopup=container.kendoWindow({modal:!0,resizable:!1,draggable:!0,title:that.options.messages.editor.timezoneEditorTitle,visible:!1,close:function(e){model.unbind("change",startTimezoneChange),e.userTriggered&&that._revertTimezones(model),activator&&activator.focus()}}),checkbox.click(function(){endTimezoneRow.toggle(checkbox.prop("checked")),model.set("endTimezone","")}),saveButton.click(function(e){e.preventDefault(),wnd.close()}),cancelButton.click(function(e){e.preventDefault(),that._revertTimezones(model),wnd.close()}),model.bind("change",startTimezoneChange)),checkbox.prop("checked",model.endTimezone).prop("disabled",!model.startTimezone),model.endTimezone?endTimezoneRow.show():endTimezoneRow.hide(),wnd=timezonePopup.data("kendoWindow"),wnd.center().open()}}),Scheduler=Widget.extend({init:function(element,options){var that=this;Widget.fn.init.call(that,element,options),that.options.views&&that.options.views.length||(that.options.views=["day","week"]),that.resources=[],that._initModel(),that._wrapper(),that._views(),that._toolbar(),that._dataSource(),that._resources(),that._resizeHandler=proxy(that.resize,that),that.wrapper.on("mousedown"+NS+" selectstart"+NS,function(e){e.preventDefault()}),that.options.editable&&that.options.editable.resize!==!1&&that._resizable(),that._movable(),$(window).on("resize"+NS,that._resizeHandler),that.options.messages&&that.options.messages.recurrence&&(recurrence.options=that.options.messages.recurrence),that._selectable(),that._ariaId=kendo.guid(),that._createEditor()},_isMobile:function(){var options=this.options;return options.mobile===!0&&kendo.support.mobileOS||"phone"===options.mobile||"tablet"===options.mobile},_isMobilePhoneView:function(){var options=this.options;return options.mobile===!0&&kendo.support.mobileOS&&!kendo.support.mobileOS.tablet||"phone"===options.mobile},_selectable:function(){var that=this,wrapper=that.wrapper,selectEvent=kendo.support.mobileOS?"touchend":"mousedown";if(that.options.selectable){that._tabindex(),wrapper.on(selectEvent+NS,".k-scheduler-header-all-day td, .k-scheduler-content td, .k-event",function(e){var which=e.which,button=e.button,browser=kendo.support.browser,isRight=which&&3===which||button&&2==button;kendo.support.mobileOS&&e.isDefaultPrevented()||(isRight||that._createSelection(e.currentTarget),wrapper.focus(),browser.msie&&browser.version<9&&setTimeout(function(){wrapper.focus()}))});var mouseMoveHandler=$.proxy(that._mouseMove,that);wrapper.on("mousedown"+NS,".k-scheduler-header-all-day td, .k-scheduler-content td",function(e){var which=e.which,button=e.button,isRight=which&&3===which||button&&2==button;isRight||wrapper.on("mousemove"+NS,".k-scheduler-header-all-day td, .k-scheduler-content td",mouseMoveHandler)}),wrapper.on("mouseup"+NS+" mouseleave"+NS,function(){wrapper.off("mousemove"+NS,".k-scheduler-header-all-day td, .k-scheduler-content td",mouseMoveHandler)}),wrapper.on("focus"+NS,function(){that._selection||that._createSelection($(".k-scheduler-content").find("td:first")),that._select()}),wrapper.on("focusout"+NS,function(){that.view().clearSelection(),that._ctrlKey=that._shiftKey=!1}),wrapper.on("keydown"+NS,proxy(that._keydown,that)),wrapper.on("keyup"+NS,function(e){that._ctrlKey=e.ctrlKey,that._shiftKey=e.shiftKey})}},_select:function(){var that=this,view=that.view(),wrapper=that.wrapper,current=view.current(),selection=that._selection;if(current&&(current.removeAttribute("id"),current.removeAttribute("aria-label"),wrapper.removeAttr("aria-activedescendant")),view.select(selection),current=view.current(),current&&that._old!==current){var labelFormat,data=selection,events=that._selectedEvents(),slots=view._selectedSlots;events[0]?(data=events[0]||selection,labelFormat=kendo.format(that.options.messages.ariaEventLabel,data.title,data.start,data.start)):labelFormat=kendo.format(that.options.messages.ariaSlotLabel,data.start,data.end),current.setAttribute("id",that._ariaId),current.setAttribute("aria-label",labelFormat),wrapper.attr("aria-activedescendant",that._ariaId),that._old=current,that.trigger("change",{start:selection.start,end:selection.end,events:events,slots:slots,resources:view._resourceBySlot(selection)})}},_selectedEvents:function(){for(var event,uids=this._selection.events,length=uids.length,idx=0,events=[];idx<length;idx++)event=this.occurrenceByUid(uids[idx]),event&&events.push(event);return events},_mouseMove:function(e){var that=this;clearTimeout(that._moveTimer),that._moveTimer=setTimeout(function(){var view=that.view(),selection=that._selection;if(selection){var slot=view.selectionByElement($(e.currentTarget));if(slot&&selection.groupIndex===slot.groupIndex){var startDate=slot.startDate(),endDate=slot.endDate();startDate>=selection.end?selection.backward=!1:endDate<=selection.start&&(selection.backward=!0),selection.backward?selection.start=startDate:selection.end=endDate,that._select()}}},5)},_viewByIndex:function(index){var view,views=this.views;for(view in views){if(!index)return view;index--}},_keydown:function(e){var that=this,key=e.keyCode,view=that.view(),editable=view.options.editable,selection=that._selection,shiftKey=e.shiftKey;that._ctrlKey=e.ctrlKey,that._shiftKey=e.shiftKey,key===keys.TAB?view.moveToEvent(selection,shiftKey)&&(that._select(),e.preventDefault()):editable&&key===keys.ENTER?selection.events.length?editable.update!==!1&&that.editEvent(selection.events[0]):editable.create!==!1&&(selection.isAllDay&&(selection=$.extend({},selection,{end:kendo.date.addDays(selection.end,-1)})),that.addEvent(extend({},selection,view._resourceBySlot(selection)))):key===keys.DELETE&&editable!==!1&&editable.destroy!==!1?that.removeEvent(selection.events[0]):key>=49&&key<=57?that.view(that._viewByIndex(key-49)):view.move(selection,key,shiftKey)&&(view.inRange(selection)?that._select():that.date(selection.start),e.preventDefault()),that._adjustSelectedDate()},_createSelection:function(item){var uid,slot,selection;this._selection&&(this._ctrlKey||this._shiftKey)||(this._selection={events:[],groupIndex:0}),item=$(item),selection=this._selection,uid=item.attr(kendo.attr("uid")),slot=this.view().selectionByElement(item),slot&&(selection.groupIndex=slot.groupIndex||0),uid&&(slot=getOccurrenceByUid(this._data,uid)),slot&&slot.uid&&(uid=[slot.uid]),this._updateSelection(slot,uid),this._adjustSelectedDate()},_updateSelection:function(dataItem,events){var selection=this._selection;if(dataItem&&selection){if(this._shiftKey&&selection.start&&selection.end){var backward=dataItem.end<selection.end,view=this.view();selection.end=dataItem.endDate?dataItem.endDate():dataItem.end,backward&&view._timeSlotInterval&&kendo.date.setTime(selection.end,-view._timeSlotInterval());
}else selection.start=dataItem.startDate?dataItem.startDate():dataItem.start,selection.end=dataItem.endDate?dataItem.endDate():dataItem.end;"isDaySlot"in dataItem?selection.isAllDay=dataItem.isDaySlot:selection.isAllDay=dataItem.isAllDay,selection.index=dataItem.index,this._ctrlKey?selection.events=selection.events.concat(events||[]):selection.events=events||[]}},options:{name:"Scheduler",date:TODAY,editable:!0,autoBind:!0,snap:!0,mobile:!1,timezone:"",allDaySlot:!0,min:new Date(1900,0,1),max:new Date(2099,11,31),messages:{today:"Today",save:"Save",cancel:"Cancel",destroy:"Delete",deleteWindowTitle:"Delete event",ariaSlotLabel:"Selected from {0:t} to {1:t}",ariaEventLabel:"{0} on {1:D} at {2:t}",views:{day:"Day",week:"Week",workWeek:"Work Week",agenda:"Agenda",month:"Month"},recurrenceMessages:{deleteWindowTitle:"Delete Recurring Item",deleteWindowOccurrence:"Delete current occurrence",deleteWindowSeries:"Delete the series",editWindowTitle:"Edit Recurring Item",editWindowOccurrence:"Edit current occurrence",editWindowSeries:"Edit the series"},editor:{title:"Title",start:"Start",end:"End",allDayEvent:"All day event",description:"Description",repeat:"Repeat",timezone:" ",startTimezone:"Start timezone",endTimezone:"End timezone",separateTimezones:"Use separate start and end time zones",timezoneEditorTitle:"Timezones",timezoneEditorButton:"Time zone",timezoneTitle:"Time zones",noTimezone:"No timezone",editorTitle:"Event"}},height:null,width:null,resources:[],group:{resources:[],direction:"horizontal"},views:[],selectable:!1},events:[REMOVE,EDIT,CANCEL,SAVE,"add","dataBinding","dataBound","moveStart","move","moveEnd","resizeStart","resize","resizeEnd","navigate","change"],destroy:function(){var element,that=this;Widget.fn.destroy.call(that),that.dataSource&&that.dataSource.unbind(CHANGE,that._refreshHandler),that.calendar&&(that.calendar.destroy(),that.popup.destroy()),that.view()&&that.view().destroy(),that._editor&&that._editor.destroy(),this._moveDraggable&&this._moveDraggable.destroy(),this._resizeDraggable&&this._resizeDraggable.destroy(),element=that.element.add(that.wrapper).add(that.toolbar).add(that.popup),element.off(NS),clearTimeout(that._moveTimer),that._model=null,that.toolbar=null,that.element=null,$(window).off("resize"+NS,that._resizeHandler),kendo.destroy(that.wrapper)},setDataSource:function(dataSource){this.options.dataSource=dataSource,this._dataSource(),this.options.autoBind&&dataSource.fetch()},items:function(){return this.wrapper.children(".k-event, .k-task")},_movable:function(){var startSlot,endSlot,startTime,endTime,event,that=this,isMobile=that._isMobile(),movable=that.options.editable&&that.options.editable.move!==!1,resizable=that.options.editable&&that.options.editable.resize!==!1;(movable||resizable&&isMobile)&&(that._moveDraggable=new kendo.ui.Draggable(that.element,{distance:0,filter:".k-event",holdToDrag:isMobile}),movable&&that._moveDraggable.bind("dragstart",function(e){var view=that.view(),eventElement=e.currentTarget;return view.options.editable&&view.options.editable.move!==!1?isMobile&&!eventElement.hasClass("k-event-active")?(that.element.find(".k-event-active").removeClass("k-event-active"),void e.preventDefault()):(event=that.occurrenceByUid(eventElement.attr(kendo.attr("uid"))),startSlot=view._slotByPosition(e.x.location,e.y.location),startTime=startSlot.startOffset(e.x.location,e.y.location,that.options.snap),endSlot=startSlot,void(startSlot&&!that.trigger("moveStart",{event:event})||e.preventDefault())):void e.preventDefault()}).bind("drag",function(e){var view=that.view(),slot=view._slotByPosition(e.x.location,e.y.location);if(slot){endTime=slot.startOffset(e.x.location,e.y.location,that.options.snap);var distance=endTime-startTime;view._updateMoveHint(event,slot.groupIndex,distance);var range=moveEventRange(event,distance);that.trigger("move",{event:event,slot:{element:slot.element,start:slot.startDate(),end:slot.endDate()},resources:view._resourceBySlot(slot),start:range.start,end:range.end})?view._updateMoveHint(event,slot.groupIndex,distance):endSlot=slot}}).bind("dragend",function(e){that.view()._removeMoveHint();var distance=endTime-startTime,range=moveEventRange(event,distance),start=range.start,end=range.end,endResources=that.view()._resourceBySlot(endSlot),startResources=that.view()._resourceBySlot(startSlot),prevented=that.trigger("moveEnd",{event:event,slot:{element:endSlot.element,start:endSlot.startDate(),end:endSlot.endDate()},start:start,end:end,resources:endResources});prevented||event.start.getTime()==start.getTime()&&event.end.getTime()==end.getTime()&&kendo.stringify(endResources)==kendo.stringify(startResources)||that._updateEvent(null,event,$.extend({start:start,end:end},endResources)),e.currentTarget.removeClass("k-event-active"),this.cancelHold()}).bind("dragcancel",function(){that.view()._removeMoveHint(),this.cancelHold()}),isMobile&&(that._moveDraggable.bind("hold",function(e){that.element.find(".k-scheduler-monthview").length&&e.preventDefault(),that.element.find(".k-event-active").removeClass("k-event-active"),e.currentTarget.addClass("k-event-active")}),that._moveDraggable.userEvents.bind("press",function(e){e.preventDefault()})))},_resizable:function(){function direction(handle){var directions={"k-resize-e":"east","k-resize-w":"west","k-resize-n":"north","k-resize-s":"south"};for(var key in directions)if(handle.hasClass(key))return directions[key]}var startTime,endTime,event,slot,that=this;that._resizeDraggable=new kendo.ui.Draggable(that.element,{distance:0,filter:".k-resize-handle",dragstart:function(e){var dragHandle=$(e.currentTarget),eventElement=dragHandle.closest(".k-event"),uid=eventElement.attr(kendo.attr("uid"));event=that.occurrenceByUid(uid),slot=that.view()._slotByPosition(e.x.location,e.y.location),that.trigger("resizeStart",{event:event})&&e.preventDefault(),startTime=kendo.date.toUtcTime(event.start),endTime=kendo.date.toUtcTime(event.end)},drag:function(e){if(slot){var dragHandle=$(e.currentTarget),dir=direction(dragHandle),view=that.view(),currentSlot=view._slotByPosition(e.x.location,e.y.location);if(currentSlot&&slot.groupIndex==currentSlot.groupIndex){slot=currentSlot;var originalStart=startTime,originalEnd=endTime;"south"==dir?!slot.isDaySlot&&slot.end-kendo.date.toUtcTime(event.start)>=view._timeSlotInterval()&&(endTime=event.isAllDay?slot.startOffset(e.x.location,e.y.location,that.options.snap):slot.endOffset(e.x.location,e.y.location,that.options.snap)):"north"==dir?!slot.isDaySlot&&kendo.date.toUtcTime(event.end)-slot.start>=view._timeSlotInterval()&&(startTime=slot.startOffset(e.x.location,e.y.location,that.options.snap)):"east"==dir?slot.isDaySlot&&kendo.date.toUtcTime(kendo.date.getDate(slot.endDate()))>=kendo.date.toUtcTime(kendo.date.getDate(event.start))&&(endTime=event.isAllDay?slot.startOffset(e.x.location,e.y.location,that.options.snap):slot.endOffset(e.x.location,e.y.location,that.options.snap)):"west"==dir&&slot.isDaySlot&&kendo.date.toUtcTime(kendo.date.getDate(event.end))>=kendo.date.toUtcTime(kendo.date.getDate(slot.startDate()))&&(startTime=slot.startOffset(e.x.location,e.y.location,that.options.snap)),that.trigger("resize",{event:event,slot:{element:slot.element,start:slot.startDate(),end:slot.endDate()},start:kendo.timezone.toLocalDate(startTime),end:kendo.timezone.toLocalDate(endTime),resources:view._resourceBySlot(slot)})?(startTime=originalStart,endTime=originalEnd):view._updateResizeHint(event,slot.groupIndex,startTime,endTime)}}},dragend:function(e){var dragHandle=$(e.currentTarget),start=new Date(event.start.getTime()),end=new Date(event.end.getTime()),dir=direction(dragHandle);that.view()._removeResizeHint(),"south"==dir?end=kendo.timezone.toLocalDate(endTime):"north"==dir?start=kendo.timezone.toLocalDate(startTime):"east"==dir?end=kendo.date.getDate(kendo.timezone.toLocalDate(endTime)):"west"==dir&&(start=new Date(kendo.timezone.toLocalDate(startTime)),start.setHours(0),start.setMinutes(0));var prevented=that.trigger("resizeEnd",{event:event,slot:{element:slot.element,start:slot.startDate(),end:slot.endDate()},start:start,end:end,resources:that.view()._resourceBySlot(slot)});!prevented&&end.getTime()>=start.getTime()&&(event.start.getTime()==start.getTime()&&event.end.getTime()==end.getTime()||that._updateEvent(dir,event,{start:start,end:end})),slot=null,event=null},dragcancel:function(){that.view()._removeResizeHint(),slot=null,event=null}})},_updateEvent:function(dir,event,eventInfo){var that=this,updateEvent=function(event,callback){try{that._preventRefresh=!0,event.update(eventInfo),that._convertDates(event)}finally{that._preventRefresh=!1}that.trigger(SAVE,{event:event})||(callback&&callback(),that._updateSelection(event),that.dataSource.sync())},recurrenceHead=function(event){return event.recurrenceRule?that.dataSource.getByUid(event.uid):that.dataSource.get(event.recurrenceId)},updateSeries=function(){var head=recurrenceHead(event);if("south"==dir||"north"==dir){if(eventInfo.start){var start=kendo.date.getDate(head.start);kendo.date.setTime(start,getMilliseconds(eventInfo.start)),eventInfo.start=start}if(eventInfo.end){var end=kendo.date.getDate(head.end);kendo.date.setTime(end,getMilliseconds(eventInfo.end)),eventInfo.end=end}}that.dataSource._removeExceptions(head),updateEvent(head)},updateOccurrence=function(){var head=recurrenceHead(event),callback=function(){that._convertDates(head)},exception=head.toOccurrence({start:event.start,end:event.end});updateEvent(that.dataSource.add(exception),callback)},recurrenceMessages=that.options.messages.recurrenceMessages;event.recurrenceRule||event.isOccurrence()?that.showDialog({model:event,title:recurrenceMessages.editWindowTitle,text:recurrenceMessages.editRecurring?recurrenceMessages.editRecurring:EDITRECURRING,buttons:[{text:recurrenceMessages.editWindowOccurrence,click:updateOccurrence},{text:recurrenceMessages.editWindowSeries,click:updateSeries}]}):updateEvent(that.dataSource.getByUid(event.uid))},_modelForContainer:function(container){return container=$(container).closest("["+kendo.attr("uid")+"]"),this.dataSource.getByUid(container.attr(kendo.attr("uid")))},showDialog:function(options){this._editor.showDialog(options)},focus:function(){this.wrapper.focus()},_confirmation:function(callback,model){var editable=this.options.editable;if(editable===!0||editable.confirmation!==!1){var messages=this.options.messages,text=typeof editable.confirmation===STRING?editable.confirmation:DELETECONFIRM,buttons=[{name:"destroy",text:messages.destroy,click:function(){callback()}}];this._isMobile()&&kendo.mobile.ui.Pane||buttons.push({name:"canceledit",text:messages.cancel,click:function(){callback(!0)}}),this.showDialog({model:model,text:text,title:messages.deleteWindowTitle,buttons:buttons})}else callback()},addEvent:function(eventInfo){var event,editable=this._editor.editable,dataSource=this.dataSource;eventInfo=eventInfo||{};var prevented=this.trigger("add",{event:eventInfo});!prevented&&(editable&&editable.end()||!editable)&&(this.cancelEvent(),eventInfo&&eventInfo.toJSON&&(eventInfo=eventInfo.toJSON()),event=dataSource.add(eventInfo),event&&(this.cancelEvent(),this._editEvent(event)))},saveEvent:function(){var editor=this._editor;if(editor){var editable=editor.editable,container=editor.container,model=this._modelForContainer(container);container&&editable&&editable.end()&&!this.trigger(SAVE,{container:container,event:model})&&(model.isRecurrenceHead()&&this.dataSource._removeExceptions(model),model.dirty||model.isOccurrence()||this._convertDates(model,"remove"),this.dataSource.sync())}},cancelEvent:function(){var model,editor=this._editor,container=editor.container;container&&(model=this._modelForContainer(container),model&&model.isOccurrence()&&(this._convertDates(model,"remove"),this._convertDates(this.dataSource.get(model.recurrenceId),"remove")),this.dataSource.cancelChanges(model),editor.close())},editEvent:function(uid){var model="string"==typeof uid?this.occurrenceByUid(uid):uid;model&&(this.cancelEvent(),model.isRecurring()?this._editRecurringDialog(model):this._editEvent(model))},_editEvent:function(model){this._createPopupEditor(model)},_editRecurringDialog:function(model){var that=this,editOccurrence=function(){model.isException()?that._editEvent(model):that.addEvent(model)},editSeries=function(){model.recurrenceId&&(model=that.dataSource.get(model.recurrenceId)),that._editEvent(model)},recurrenceMessages=that.options.messages.recurrenceMessages;that.showDialog({model:model,title:recurrenceMessages.editWindowTitle,text:recurrenceMessages.editRecurring?recurrenceMessages.editRecurring:EDITRECURRING,buttons:[{text:recurrenceMessages.editWindowOccurrence,click:editOccurrence},{text:recurrenceMessages.editWindowSeries,click:editSeries}]})},_createButton:function(command){var template=command.template||COMMANDBUTTONTMPL,commandName=typeof command===STRING?command:command.name||command.text,options={className:"k-scheduler-"+(commandName||"").replace(/\s/g,""),text:commandName,attr:""};if(!(commandName||isPlainObject(command)&&command.template))throw new Error("Custom commands should have name specified");return isPlainObject(command)?(command.className&&(command.className+=" "+options.className),"edit"===commandName&&isPlainObject(command.text)&&(command=extend(!0,{},command),command.text=command.text.edit),options=extend(!0,options,defaultCommands[commandName],command)):options=extend(!0,options,defaultCommands[commandName]),kendo.template(template)(options)},_convertDates:function(model,method){var timezone=this.dataSource.reader.timezone,startTimezone=model.startTimezone,endTimezone=model.endTimezone,start=model.start,end=model.start;method=method||"apply",startTimezone=startTimezone||endTimezone,endTimezone=endTimezone||startTimezone,startTimezone&&(timezone?"apply"===method?(start=kendo.timezone.convert(model.start,timezone,startTimezone),end=kendo.timezone.convert(model.end,timezone,endTimezone)):(start=kendo.timezone.convert(model.start,startTimezone,timezone),end=kendo.timezone.convert(model.end,endTimezone,timezone)):(start=kendo.timezone[method](model.start,startTimezone),end=kendo.timezone[method](model.end,endTimezone)),model._set("start",start),model._set("end",end))},_createEditor:function(){var editor,that=this;editor=this._isMobile()&&kendo.mobile.ui.Pane?that._editor=new MobileEditor(this.wrapper,extend({},this.options,{timezone:that.dataSource.reader.timezone,resources:that.resources,createButton:proxy(this._createButton,this)})):that._editor=new PopupEditor(this.wrapper,extend({},this.options,{createButton:proxy(this._createButton,this),timezone:that.dataSource.reader.timezone,resources:that.resources})),editor.bind("cancel",function(e){return that.trigger("cancel",{container:e.container,event:e.model})?void e.preventDefault():(that.cancelEvent(),void that.focus())}),editor.bind("edit",function(e){that.trigger(EDIT,{container:e.container,event:e.model})&&e.preventDefault()}),editor.bind("save",function(){that.saveEvent()}),editor.bind("remove",function(e){that.removeEvent(e.model)})},_createPopupEditor:function(model){var editor=this._editor;model.isNew()&&!model.isOccurrence()||(model.isOccurrence()&&this._convertDates(model.recurrenceId?this.dataSource.get(model.recurrenceId):model),this._convertDates(model)),this.editable=editor.editEvent(model)},removeEvent:function(uid){var that=this,model="string"==typeof uid?that.occurrenceByUid(uid):uid;model&&(model.isRecurring()?that._deleteRecurringDialog(model):that._confirmation(function(cancel){cancel||that._removeEvent(model)},model))},occurrenceByUid:function(uid){var occurrence=this.dataSource.getByUid(uid);return occurrence||(occurrence=getOccurrenceByUid(this._data,uid)),occurrence},occurrencesInRange:function(start,end){return new kendo.data.Query(this._data).filter({logic:"or",filters:[{logic:"and",filters:[{field:"start",operator:"gte",value:start},{field:"end",operator:"gte",value:start},{field:"start",operator:"lt",value:end}]},{logic:"and",filters:[{field:"start",operator:"lte",value:start},{field:"end",operator:"gt",value:start}]}]}).toArray()},_removeEvent:function(model){this.trigger(REMOVE,{event:model})||this.dataSource.remove(model)&&this.dataSource.sync()},_deleteRecurringDialog:function(model){var that=this,currentModel=model,deleteOccurrence=function(){var occurrence=currentModel.recurrenceId?currentModel:currentModel.toOccurrence(),head=that.dataSource.get(occurrence.recurrenceId);that._convertDates(head),that._removeEvent(occurrence)},deleteSeries=function(){currentModel.recurrenceId&&(currentModel=that.dataSource.get(currentModel.recurrenceId)),that._removeEvent(currentModel)},recurrenceMessages=that.options.messages.recurrenceMessages;that.showDialog({model:model,title:recurrenceMessages.deleteWindowTitle,text:recurrenceMessages.deleteRecurring?recurrenceMessages.deleteRecurring:DELETERECURRING,buttons:[{text:recurrenceMessages.deleteWindowOccurrence,click:deleteOccurrence},{text:recurrenceMessages.deleteWindowSeries,click:deleteSeries}]})},_unbindView:function(view){view.destroy()},_bindView:function(view){var that=this;that.options.editable&&(that._viewRemoveHandler&&view.unbind(REMOVE,that._viewRemoveHandler),that._viewRemoveHandler=function(e){that.removeEvent(e.uid)},view.bind(REMOVE,that._viewRemoveHandler),that._viewAddHandler&&view.unbind(ADD,that._viewAddHandler),that._viewAddHandler=function(e){that.addEvent(e.eventInfo)},view.bind(ADD,this._viewAddHandler),that._viewEditHandler&&view.unbind(EDIT,that._viewEditHandler),that._viewEditHandler=function(e){that.editEvent(e.uid)},view.bind(EDIT,this._viewEditHandler)),that._viewNavigateHandler&&view.unbind("navigate",that._viewNavigateHandler),that._viewNavigateHandler=function(e){if(e.view){var switchWorkDay="isWorkDay"in e,action=switchWorkDay?"changeWorkDay":"changeView";that.trigger("navigate",{view:e.view,isWorkDay:e.isWorkDay,action:action,date:e.date})||(switchWorkDay&&(that._workDayMode=e.isWorkDay),that._selectView(e.view),that.date(e.date))}},view.bind("navigate",that._viewNavigateHandler),that._viewActivateHandler&&view.unbind("activate",that._viewActivateHandler),that._viewActivateHandler=function(){var view=this;that._selection&&(view.constrainSelection(that._selection),that._select(),that._adjustSelectedDate())},view.bind("activate",that._viewActivateHandler)},_selectView:function(name){var that=this;name&&that.views[name]&&(that._selectedView&&that._unbindView(that._selectedView),that._selectedView=that._renderView(name),that._selectedViewName=name,that.toolbar.find(".k-scheduler-views li").removeClass("k-state-selected").end().find(".k-view-"+name.replace(/\./g,"\\.").toLowerCase()).addClass("k-state-selected"))},view:function(name){var that=this;return name?(that._selectView(name),void that.rebind()):that._selectedView},_renderView:function(name){var view=this._initializeView(name);return this._bindView(view),this._model.set("formattedDate",view.dateForTitle()),view},resize:function(force){var size=this.getSize(),currentSize=this._size,view=this.view();view&&view.groups&&(!force&&currentSize&&size.width===currentSize.width&&size.height===currentSize.height||(this.refresh({action:"resize"}),this._size=size))},_adjustSelectedDate:function(){var date=this._model.selectedDate,selection=this._selection,start=selection.start;start&&!kendo.date.isInDateRange(date,getDate(start),getDate(selection.end))&&date.setFullYear(start.getFullYear(),start.getMonth(),start.getDate())},_initializeView:function(name){var view=this.views[name];if(view){var isSettings=isPlainObject(view),type=view.type;if(typeof type===STRING&&(type=kendo.getter(view.type)(window)),!type)throw new Error("There is no such view");view=new type(this.wrapper,trimOptions(extend(!0,{},this.options,isSettings?view:{},{resources:this.resources,date:this.date(),showWorkHours:this._workDayMode})))}return view},_views:function(){var view,defaultView,selected,isSettings,name,type,idx,length,views=this.options.views;for(this.views={},idx=0,length=views.length;idx<length;idx++){var hasType=!1;view=views[idx],isSettings=isPlainObject(view),isSettings?(type=name=view.type?view.type:view,typeof type!==STRING&&(name=view.title,hasType=!0)):type=name=view,defaultView=defaultViews[name],defaultView&&!hasType&&(view.type=defaultView.type,defaultView.title=this.options.messages.views[name],"day"===defaultView.type?defaultView.messages={allDay:this.options.messages.allDay}:"agenda"===defaultView.type&&(defaultView.messages={event:this.options.messages.event,date:this.options.messages.date,time:this.options.messages.time})),view=extend({title:name},defaultView,isSettings?view:{}),name&&(this.views[name]=view,selected&&!view.selected||(selected=name))}selected&&(this._selectedViewName=selected)},rebind:function(){this.dataSource.fetch()},_dataSource:function(){var that=this,options=that.options,dataSource=options.dataSource;dataSource=isArray(dataSource)?{data:dataSource}:dataSource,!options.timezone||dataSource instanceof SchedulerDataSource||(dataSource=extend(!0,dataSource,{schema:{timezone:options.timezone}})),that.dataSource&&that._refreshHandler?that.dataSource.unbind(CHANGE,that._refreshHandler).unbind("progress",that._progressHandler).unbind("error",that._errorHandler):(that._refreshHandler=proxy(that.refresh,that),that._progressHandler=proxy(that._requestStart,that),that._errorHandler=proxy(that._error,that)),that.dataSource=kendo.data.SchedulerDataSource.create(dataSource).bind(CHANGE,that._refreshHandler).bind("progress",that._progressHandler).bind("error",that._errorHandler)},_error:function(){this._progress(!1)},_requestStart:function(){this._progress(!0)},_progress:function(toggle){var element=this.element.find(".k-scheduler-content");kendo.ui.progress(element,toggle)},_resources:function(){for(var that=this,resources=that.options.resources,idx=0;idx<resources.length;idx++){var resource=resources[idx],field=resource.field,dataSource=resource.dataSource;if(!field||!dataSource)throw new Error('The "field" and "dataSource" options of the scheduler resource are mandatory.');that.resources.push({field:field,name:resource.name||field,title:resource.title||field,dataTextField:resource.dataTextField||"text",dataValueField:resource.dataValueField||"value",dataColorField:resource.dataColorField||"color",valuePrimitive:null==resource.valuePrimitive||resource.valuePrimitive,multiple:resource.multiple||!1,dataSource:kendo.data.DataSource.create(dataSource)})}var promises=$.map(that.resources,function(resource){return resource.dataSource.fetch()});$.when.apply(null,promises).then(function(){that.options.autoBind?that.view(that._selectedViewName):that._selectView(that._selectedViewName)})},_initModel:function(){var that=this;that._model=kendo.observable({selectedDate:new Date(this.options.date),formattedDate:""}),that._model.bind("change",function(e){"selectedDate"===e.field&&that.view(that._selectedViewName)})},_wrapper:function(){var that=this,options=that.options,height=options.height,width=options.width;that.wrapper=that.element.addClass("k-widget k-scheduler k-floatwrap").attr("role","grid").attr("aria-multiselectable",!0),that._isMobile()&&that.wrapper.addClass("k-scheduler-mobile"),that._isMobilePhoneView()&&that.wrapper.addClass("k-scheduler-phone"),height&&that.wrapper.height(height),width&&that.wrapper.width(width)},date:function(value){return null!=value&&getDate(value)>=getDate(this.options.min)&&getDate(value)<=getDate(this.options.max)&&this._model.set("selectedDate",value),getDate(this._model.get("selectedDate"))},_toolbar:function(){var that=this,options=that.options,template=this._isMobilePhoneView()?MOBILETOOLBARTEMPLATE:TOOLBARTEMPLATE,toolbar=$(template({messages:options.messages,ns:kendo.ns,views:that.views}));that.wrapper.append(toolbar),that.toolbar=toolbar,kendo.bind(that.toolbar,that._model),toolbar.on(CLICK+NS,".k-scheduler-navigation li",function(e){var li=$(this),date=new Date(that.date()),action="";if(e.preventDefault(),li.hasClass("k-nav-today"))action="today",date=new Date;else if(li.hasClass("k-nav-next"))action="next",date=that.view().nextDate();else if(li.hasClass("k-nav-prev"))action="previous",date=that.view().previousDate();else if(li.hasClass("k-nav-current")&&!that._isMobilePhoneView())return void that._showCalendar();that.trigger("navigate",{view:that._selectedViewName,action:action,date:date})||that.date(date)}),toolbar.on(CLICK+NS,".k-scheduler-views li",function(e){e.preventDefault();var name=$(this).attr(kendo.attr("name"));that.trigger("navigate",{view:name,action:"changeView",date:that.date()})||that.view(name)}),toolbar.find("li").hover(function(){$(this).addClass("k-state-hover")},function(){$(this).removeClass("k-state-hover")})},_showCalendar:function(){var that=this,target=that.toolbar.find(".k-nav-current"),html=$('<div class="k-calendar-container"><div class="k-scheduler-calendar"/></div>');that.popup||(that.popup=new Popup(html,{anchor:target,activate:function(){that.calendar||(that.calendar=new Calendar(this.element.find(".k-scheduler-calendar"),{change:function(){var date=this.value();that.trigger("navigate",{view:that._selectedViewName,action:"changeDate",date:date})||(that.date(date),that.popup.close())},min:that.options.min,max:that.options.max})),that.calendar.value(that.date())},copyAnchorStyles:!1})),that.popup.open()},refresh:function(e){var view=this.view();this._progress(!1),e=e||{},view&&(e&&"itemchange"===e.action&&(this._editor.editable||this._preventRefresh)||this.trigger("dataBinding",{action:e.action||"rebind",index:e.index,items:e.items})||(e&&"resize"===e.action||!this._editor||this._editor.close(),this._data=this.dataSource.expand(view.startDate(),view.endDate()),view.render(this._data),this.trigger("dataBound")))},slotByPosition:function(x,y){var view=this.view();if(!view._slotByPosition)return null;var slot=view._slotByPosition(x,y);return slot?{startDate:slot.startDate(),endDate:slot.endDate(),groupIndex:slot.groupIndex,element:slot.element,isDaySlot:slot.isDaySlot}:null},slotByElement:function(element){var offset=$(element).offset();return this.slotByPosition(offset.left,offset.top)},resourcesBySlot:function(slot){return this.view()._resourceBySlot(slot)}}),defaultViews={day:{type:"kendo.ui.DayView"},week:{type:"kendo.ui.WeekView"},workWeek:{type:"kendo.ui.WorkWeekView"},agenda:{type:"kendo.ui.AgendaView"},month:{type:"kendo.ui.MonthView"}};ui.plugin(Scheduler);var TimezoneEditor=Widget.extend({init:function(element,options){var that=this,zones=kendo.timezone.windows_zones;if(!zones||!kendo.timezone.zones_titles)throw new Error("kendo.timezones.min.js is not included.");Widget.fn.init.call(that,element,options),that.wrapper=that.element,that._zonesQuery=new kendo.data.Query(zones),that._zoneTitleId=kendo.guid(),that._zoneTitlePicker(),that._zonePicker(),that.value(that.options.value)},options:{name:"TimezoneEditor",value:"",optionLabel:"No timezone"},events:["change"],_zoneTitlePicker:function(){var that=this,zoneTitle=$('<input id="'+that._zoneTitleId+'"/>').appendTo(that.wrapper);that._zoneTitle=new kendo.ui.DropDownList(zoneTitle,{dataSource:kendo.timezone.zones_titles,dataValueField:"other_zone",dataTextField:"name",optionLabel:that.options.optionLabel,cascade:function(){this.value()||that._zone.wrapper.hide()}})},_zonePicker:function(){var that=this,zone=$("<input />").appendTo(this.wrapper);that._zone=new kendo.ui.DropDownList(zone,{dataValueField:"zone",dataTextField:"territory",dataSource:that._zonesQuery.data,cascadeFrom:that._zoneTitleId,cascade:function(){that._value=this.value(),that.trigger("change")},dataBound:function(){that._value=this.value(),this.wrapper.toggle(this.dataSource.view().length>1)}}),that._zone.wrapper.hide()},destroy:function(){Widget.fn.destroy.call(this),kendo.destroy(this.wrapper)},value:function(value){var zone,that=this;return value===undefined?that._value:(zone=that._zonesQuery.filter({field:"zone",operator:"eq",value:value}).data[0],void(zone?(that._zoneTitle.value(zone.other_zone),that._zone.value(zone.zone)):that._zoneTitle.value("")))}});ui.plugin(TimezoneEditor);var ZONETITLEOPTIONTEMPLATE=kendo.template('<option value="#=other_zone#">#=name#</option>'),ZONEOPTIONTEMPLATE=kendo.template('<option value="#=zone#">#=territory#</option>'),MobileTimezoneEditor=Widget.extend({init:function(element,options){var that=this,zones=kendo.timezone.windows_zones;if(!zones||!kendo.timezone.zones_titles)throw new Error("kendo.timezones.min.js is not included.");Widget.fn.init.call(that,element,options),that.wrapper=that.element,that._zonesQuery=new kendo.data.Query(zones),that._zoneTitlePicker(),that._zonePicker(),that.value(that.options.value)},options:{name:"MobileTimezoneEditor",optionLabel:"No timezone",value:""},events:["change"],_bindZones:function(value){var data=value?this._filter(value):[];this._zone.html(this._options(data,ZONEOPTIONTEMPLATE))},_filter:function(value){return this._zonesQuery.filter({field:"other_zone",operator:"eq",value:value}).data},_options:function(data,template,optionLabel){var idx=0,html="",length=data.length;for(optionLabel&&(html+=template({other_zone:"",name:optionLabel}));idx<length;idx++)html+=template(data[idx]);return html},_zoneTitlePicker:function(){var that=this,options=that._options(kendo.timezone.zones_titles,ZONETITLEOPTIONTEMPLATE,that.options.optionLabel);that._zoneTitle=$("<select>"+options+"</select>").appendTo(that.wrapper).change(function(){var value=this.value,zone=that._zone;that._bindZones(value),value&&zone[0].children.length>1?zone.show():zone.hide(),that._value=zone[0].value,that.trigger("change")})},_zonePicker:function(){var that=this;that._zone=$('<select style="display:none"></select>').appendTo(this.wrapper).change(function(){that._value=this.value,that.trigger("change")}),that._bindZones(that._zoneTitle.val()),that._value=that._zone[0].value},destroy:function(){Widget.fn.destroy.call(this),kendo.destroy(this.wrapper)},value:function(value){var zone,that=this,zonePicker=that._zone,other_zone="",zone_value="";return value===undefined?that._value:(zone=that._zonesQuery.filter({field:"zone",operator:"eq",value:value}).data[0],zone&&(zone_value=zone.zone,other_zone=zone.other_zone),that._zoneTitle.val(other_zone),that._bindZones(other_zone),zonePicker.val(zone_value),zone_value=zonePicker[0].value,zone_value&&zonePicker[0].children.length>1?zonePicker.show():zonePicker.hide(),void(that._value=zone_value))}});ui.plugin(MobileTimezoneEditor)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(_,f){f()});